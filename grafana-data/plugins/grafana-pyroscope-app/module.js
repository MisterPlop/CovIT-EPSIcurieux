/*! For license information please see module.js.LICENSE.txt */
define(["@grafana/data","@emotion/css","@grafana/runtime","@grafana/ui","react","react-router-dom","d3","lodash","rxjs","react-dom"],((__WEBPACK_EXTERNAL_MODULE__7781__,__WEBPACK_EXTERNAL_MODULE__6089__,__WEBPACK_EXTERNAL_MODULE__8531__,__WEBPACK_EXTERNAL_MODULE__2007__,__WEBPACK_EXTERNAL_MODULE__5959__,__WEBPACK_EXTERNAL_MODULE__3806__,__WEBPACK_EXTERNAL_MODULE__4201__,__WEBPACK_EXTERNAL_MODULE__3241__,__WEBPACK_EXTERNAL_MODULE__1269__,__WEBPACK_EXTERNAL_MODULE__8398__)=>(()=>{var __webpack_modules__={6233:e=>{"use strict";e.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,a=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,o){n[r]=function(e){if(a)if(a=!1,e)o(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){a&&(a=!1,o(e))}}))}},1979:(e,t)=>{"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),i=new Array(123),a=0;a<64;)i[r[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;n.encode=function(e,t,n){for(var i,a=null,o=[],s=0,l=0;t<n;){var c=e[t++];switch(l){case 0:o[s++]=r[c>>2],i=(3&c)<<4,l=1;break;case 1:o[s++]=r[i|c>>4],i=(15&c)<<2,l=2;break;case 2:o[s++]=r[i|c>>6],o[s++]=r[63&c],l=0}s>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,o)),s=0)}return l&&(o[s++]=r[i],o[s++]=61,1===l&&(o[s++]=61)),a?(s&&a.push(String.fromCharCode.apply(String,o.slice(0,s))),a.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var o="invalid encoding";n.decode=function(e,t,n){for(var r,a=n,s=0,l=0;l<e.length;){var c=e.charCodeAt(l++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error(o);switch(s){case 0:r=c,s=1;break;case 1:t[n++]=r<<2|(48&c)>>4,r=c,s=2;break;case 2:t[n++]=(15&r)<<4|(60&c)>>2,r=c,s=3;break;case 3:t[n++]=(3&r)<<6|c,s=0}}if(1===s)throw Error(o);return n-a},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},7669:e=>{"use strict";function t(e,n){"string"==typeof e&&(n=e,e=void 0);var r=[];function i(e){if("string"!=typeof e){var n=a();if(t.verbose&&console.log("codegen: "+n),n="return "+n,e){for(var o=Object.keys(e),s=new Array(o.length+1),l=new Array(o.length),c=0;c<o.length;)s[c]=o[c],l[c]=e[o[c++]];return s[c]=n,Function.apply(null,s).apply(null,l)}return Function(n)()}for(var u=new Array(arguments.length-1),d=0;d<u.length;)u[d]=arguments[++d];if(d=0,e=e.replace(/%([%dfijs])/g,(function(e,t){var n=u[d++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"})),d!==u.length)throw Error("parameter count mismatch");return r.push(e),i}function a(t){return"function "+(t||n||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return i.toString=a,i}e.exports=t,t.verbose=!1},3474:e=>{"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},9240:(e,t,n)=>{"use strict";e.exports=a;var r=n(6233),i=n(1925)("fs");function a(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),n?!t.xhr&&i&&i.readFile?i.readFile(e,(function(r,i){return r&&"undefined"!=typeof XMLHttpRequest?a.xhr(e,t,n):r?n(r):n(null,t.binary?i:i.toString("utf8"))})):a.xhr(e,t,n):r(a,this,e,t)}a.xhr=function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){if(0!==r.status&&200!==r.status)return n(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var i=0;i<r.responseText.length;++i)e.push(255&r.responseText.charCodeAt(i))}return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return n(null,r.responseText)}},t.binary&&("overrideMimeType"in r&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.responseType="arraybuffer"),r.open("GET",e),r.send()}},5750:e=>{"use strict";function t(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function a(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:a,e.writeFloatBE=r?a:i,e.readFloatLE=r?o:s,e.readFloatBE=r?s:o}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var a=Math.floor(Math.log(t)/Math.LN2);e((i<<31|a+127<<23|8388607&Math.round(t*Math.pow(2,-a)*8388608))>>>0,n,r)}}function o(e,t,n){var r=e(t,n),i=2*(r>>31)+1,a=r>>>23&255,o=8388607&r;return 255===a?o?NaN:i*(1/0):0===a?1401298464324817e-60*i*o:i*Math.pow(2,a-150)*(o+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,r),e.readFloatLE=o.bind(null,i),e.readFloatBE=o.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function a(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function o(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:a,e.writeDoubleBE=r?a:i,e.readDoubleLE=r?o:s,e.readDoubleBE=r?s:o}():function(){function t(e,t,n,r,i,a){var o=r<0?1:0;if(o&&(r=-r),0===r)e(0,i,a+t),e(1/r>0?0:2147483648,i,a+n);else if(isNaN(r))e(0,i,a+t),e(2146959360,i,a+n);else if(r>17976931348623157e292)e(0,i,a+t),e((o<<31|2146435072)>>>0,i,a+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,a+t),e((o<<31|s/4294967296)>>>0,i,a+n);else{var l=Math.floor(Math.log(r)/Math.LN2);1024===l&&(l=1023),e(4503599627370496*(s=r*Math.pow(2,-l))>>>0,i,a+t),e((o<<31|l+1023<<20|1048576*s&1048575)>>>0,i,a+n)}}}function o(e,t,n,r,i){var a=e(r,i+t),o=e(r,i+n),s=2*(o>>31)+1,l=o>>>20&2047,c=4294967296*(1048575&o)+a;return 2047===l?c?NaN:s*(1/0):0===l?5e-324*s*c:s*Math.pow(2,l-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,r,4,0),e.readDoubleLE=o.bind(null,i,0,4),e.readDoubleBE=o.bind(null,a,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function r(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function i(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},1925:module=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},2459:(e,t)=>{"use strict";var n=t,r=n.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},i=n.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=r(e),i="";n&&(i=t.shift()+"/");for(var a=0;a<t.length;)".."===t[a]?a>0&&".."!==t[a-1]?t.splice(--a,2):n?t.splice(a,1):++a:"."===t[a]?t.splice(a,1):++a;return i+t.join("/")};n.resolve=function(e,t,n){return n||(t=i(t)),r(t)?t:(n||(e=i(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?i(e+"/"+t):t)}},4226:e=>{"use strict";e.exports=function(e,t,n){var r=n||8192,i=r>>>1,a=null,o=r;return function(n){if(n<1||n>i)return e(n);o+n>r&&(a=e(r),o=0);var s=t.call(a,o,o+=n);return 7&o&&(o=1+(7|o)),s}}},2971:(e,t)=>{"use strict";var n=t;n.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,a=[],o=0;t<n;)(r=e[t++])<128?a[o++]=r:r>191&&r<224?a[o++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,a[o++]=55296+(r>>10),a[o++]=56320+(1023&r)):a[o++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),o=0);return i?(o&&i.push(String.fromCharCode.apply(String,a.slice(0,o))),i.join("")):String.fromCharCode.apply(String,a.slice(0,o))},n.write=function(e,t,n){for(var r,i,a=n,o=0;o<e.length;++o)(r=e.charCodeAt(o))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(o+1)))?(r=65536+((1023&r)<<10)+(1023&i),++o,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-a}},7951:(e,t,n)=>{const r=n(2880),i={};for(const e of Object.keys(r))i[r[e]]=e;const a={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};e.exports=a;for(const e of Object.keys(a)){if(!("channels"in a[e]))throw new Error("missing channels property: "+e);if(!("labels"in a[e]))throw new Error("missing channel labels property: "+e);if(a[e].labels.length!==a[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:n}=a[e];delete a[e].channels,delete a[e].labels,Object.defineProperty(a[e],"channels",{value:t}),Object.defineProperty(a[e],"labels",{value:n})}a.rgb.hsl=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=a-i;let s,l;a===i?s=0:t===a?s=(n-r)/o:n===a?s=2+(r-t)/o:r===a&&(s=4+(t-n)/o),s=Math.min(60*s,360),s<0&&(s+=360);const c=(i+a)/2;return l=a===i?0:c<=.5?o/(a+i):o/(2-a-i),[s,100*l,100*c]},a.rgb.hsv=function(e){let t,n,r,i,a;const o=e[0]/255,s=e[1]/255,l=e[2]/255,c=Math.max(o,s,l),u=c-Math.min(o,s,l),d=function(e){return(c-e)/6/u+.5};return 0===u?(i=0,a=0):(a=u/c,t=d(o),n=d(s),r=d(l),o===c?i=r-n:s===c?i=1/3+t-r:l===c&&(i=2/3+n-t),i<0?i+=1:i>1&&(i-=1)),[360*i,100*a,100*c]},a.rgb.hwb=function(e){const t=e[0],n=e[1];let r=e[2];const i=a.rgb.hsl(e)[0],o=1/255*Math.min(t,Math.min(n,r));return r=1-1/255*Math.max(t,Math.max(n,r)),[i,100*o,100*r]},a.rgb.cmyk=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.min(1-t,1-n,1-r);return[100*((1-t-i)/(1-i)||0),100*((1-n-i)/(1-i)||0),100*((1-r-i)/(1-i)||0),100*i]},a.rgb.keyword=function(e){const t=i[e];if(t)return t;let n,a=1/0;for(const t of Object.keys(r)){const i=(s=r[t],((o=e)[0]-s[0])**2+(o[1]-s[1])**2+(o[2]-s[2])**2);i<a&&(a=i,n=t)}var o,s;return n},a.keyword.rgb=function(e){return r[e]},a.rgb.xyz=function(e){let t=e[0]/255,n=e[1]/255,r=e[2]/255;return t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92,r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,[100*(.4124*t+.3576*n+.1805*r),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},a.rgb.lab=function(e){const t=a.rgb.xyz(e);let n=t[0],r=t[1],i=t[2];return n/=95.047,r/=100,i/=108.883,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,[116*r-16,500*(n-r),200*(r-i)]},a.hsl.rgb=function(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100;let i,a,o;if(0===n)return o=255*r,[o,o,o];i=r<.5?r*(1+n):r+n-r*n;const s=2*r-i,l=[0,0,0];for(let e=0;e<3;e++)a=t+1/3*-(e-1),a<0&&a++,a>1&&a--,o=6*a<1?s+6*(i-s)*a:2*a<1?i:3*a<2?s+(i-s)*(2/3-a)*6:s,l[e]=255*o;return l},a.hsl.hsv=function(e){const t=e[0];let n=e[1]/100,r=e[2]/100,i=n;const a=Math.max(r,.01);return r*=2,n*=r<=1?r:2-r,i*=a<=1?a:2-a,[t,100*(0===r?2*i/(a+i):2*n/(r+n)),(r+n)/2*100]},a.hsv.rgb=function(e){const t=e[0]/60,n=e[1]/100;let r=e[2]/100;const i=Math.floor(t)%6,a=t-Math.floor(t),o=255*r*(1-n),s=255*r*(1-n*a),l=255*r*(1-n*(1-a));switch(r*=255,i){case 0:return[r,l,o];case 1:return[s,r,o];case 2:return[o,r,l];case 3:return[o,s,r];case 4:return[l,o,r];case 5:return[r,o,s]}},a.hsv.hsl=function(e){const t=e[0],n=e[1]/100,r=e[2]/100,i=Math.max(r,.01);let a,o;o=(2-n)*r;const s=(2-n)*i;return a=n*i,a/=s<=1?s:2-s,a=a||0,o/=2,[t,100*a,100*o]},a.hwb.rgb=function(e){const t=e[0]/360;let n=e[1]/100,r=e[2]/100;const i=n+r;let a;i>1&&(n/=i,r/=i);const o=Math.floor(6*t),s=1-r;a=6*t-o,1&o&&(a=1-a);const l=n+a*(s-n);let c,u,d;switch(o){default:case 6:case 0:c=s,u=l,d=n;break;case 1:c=l,u=s,d=n;break;case 2:c=n,u=s,d=l;break;case 3:c=n,u=l,d=s;break;case 4:c=l,u=n,d=s;break;case 5:c=s,u=n,d=l}return[255*c,255*u,255*d]},a.cmyk.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i)),255*(1-Math.min(1,r*(1-i)+i))]},a.xyz.rgb=function(e){const t=e[0]/100,n=e[1]/100,r=e[2]/100;let i,a,o;return i=3.2406*t+-1.5372*n+-.4986*r,a=-.9689*t+1.8758*n+.0415*r,o=.0557*t+-.204*n+1.057*r,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,a=a>.0031308?1.055*a**(1/2.4)-.055:12.92*a,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,i=Math.min(Math.max(0,i),1),a=Math.min(Math.max(0,a),1),o=Math.min(Math.max(0,o),1),[255*i,255*a,255*o]},a.xyz.lab=function(e){let t=e[0],n=e[1],r=e[2];return t/=95.047,n/=100,r/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,[116*n-16,500*(t-n),200*(n-r)]},a.lab.xyz=function(e){let t,n,r;n=(e[0]+16)/116,t=e[1]/500+n,r=n-e[2]/200;const i=n**3,a=t**3,o=r**3;return n=i>.008856?i:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=o>.008856?o:(r-16/116)/7.787,t*=95.047,n*=100,r*=108.883,[t,n,r]},a.lab.lch=function(e){const t=e[0],n=e[1],r=e[2];let i;return i=360*Math.atan2(r,n)/2/Math.PI,i<0&&(i+=360),[t,Math.sqrt(n*n+r*r),i]},a.lch.lab=function(e){const t=e[0],n=e[1],r=e[2]/360*2*Math.PI;return[t,n*Math.cos(r),n*Math.sin(r)]},a.rgb.ansi16=function(e,t=null){const[n,r,i]=e;let o=null===t?a.rgb.hsv(e)[2]:t;if(o=Math.round(o/50),0===o)return 30;let s=30+(Math.round(i/255)<<2|Math.round(r/255)<<1|Math.round(n/255));return 2===o&&(s+=60),s},a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])},a.rgb.ansi256=function(e){const t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},a.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},a.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;return e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},a.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},a.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let n=t[0];3===t[0].length&&(n=n.split("").map((e=>e+e)).join(""));const r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},a.rgb.hcg=function(e){const t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(Math.max(t,n),r),a=Math.min(Math.min(t,n),r),o=i-a;let s,l;return s=o<1?a/(1-o):0,l=o<=0?0:i===t?(n-r)/o%6:i===n?2+(r-t)/o:4+(t-n)/o,l/=6,l%=1,[360*l,100*o,100*s]},a.hsl.hcg=function(e){const t=e[1]/100,n=e[2]/100,r=n<.5?2*t*n:2*t*(1-n);let i=0;return r<1&&(i=(n-.5*r)/(1-r)),[e[0],100*r,100*i]},a.hsv.hcg=function(e){const t=e[1]/100,n=e[2]/100,r=t*n;let i=0;return r<1&&(i=(n-r)/(1-r)),[e[0],100*r,100*i]},a.hcg.rgb=function(e){const t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];const i=[0,0,0],a=t%1*6,o=a%1,s=1-o;let l=0;switch(Math.floor(a)){case 0:i[0]=1,i[1]=o,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=o;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=o,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return l=(1-n)*r,[255*(n*i[0]+l),255*(n*i[1]+l),255*(n*i[2]+l)]},a.hcg.hsv=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);let r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},a.hcg.hsl=function(e){const t=e[1]/100,n=e[2]/100*(1-t)+.5*t;let r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},a.hcg.hwb=function(e){const t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},a.hwb.hcg=function(e){const t=e[1]/100,n=1-e[2]/100,r=n-t;let i=0;return r<1&&(i=(n-r)/(1-r)),[e[0],100*r,100*i]},a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},a.gray.hsl=function(e){return[0,0,e[0]]},a.gray.hsv=a.gray.hsl,a.gray.hwb=function(e){return[0,100,e[0]]},a.gray.cmyk=function(e){return[0,0,0,e[0]]},a.gray.lab=function(e){return[e[0],0,0]},a.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},8666:(e,t,n)=>{const r=n(7951),i=n(1247),a={};Object.keys(r).forEach((e=>{a[e]={},Object.defineProperty(a[e],"channels",{value:r[e].channels}),Object.defineProperty(a[e],"labels",{value:r[e].labels});const t=i(e);Object.keys(t).forEach((n=>{const r=t[n];a[e][n]=function(e){const t=function(...t){const n=t[0];if(null==n)return n;n.length>1&&(t=n);const r=e(t);if("object"==typeof r)for(let e=r.length,t=0;t<e;t++)r[t]=Math.round(r[t]);return r};return"conversion"in e&&(t.conversion=e.conversion),t}(r),a[e][n].raw=function(e){const t=function(...t){const n=t[0];return null==n?n:(n.length>1&&(t=n),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))})),e.exports=a},1247:(e,t,n)=>{const r=n(7951);function i(e,t){return function(n){return t(e(n))}}function a(e,t){const n=[t[e].parent,e];let a=r[t[e].parent][e],o=t[e].parent;for(;t[o].parent;)n.unshift(t[o].parent),a=i(r[t[o].parent][o],a),o=t[o].parent;return a.conversion=n,a}e.exports=function(e){const t=function(e){const t=function(){const e={},t=Object.keys(r);for(let n=t.length,r=0;r<n;r++)e[t[r]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;){const e=n.pop(),i=Object.keys(r[e]);for(let r=i.length,a=0;a<r;a++){const r=i[a],o=t[r];-1===o.distance&&(o.distance=t[e].distance+1,o.parent=e,n.unshift(r))}}return t}(e),n={},i=Object.keys(t);for(let e=i.length,r=0;r<e;r++){const e=i[r];null!==t[e].parent&&(n[e]=a(e,t))}return n}},2880:e=>{"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},6250:(e,t,n)=>{var r=n(2880),i=n(6852),a=Object.hasOwnProperty,o=Object.create(null);for(var s in r)a.call(r,s)&&(o[r[s]]=s);var l=e.exports={to:{},get:{}};function c(e,t,n){return Math.min(Math.max(t,e),n)}function u(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}l.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=l.get.hsl(e),n="hsl";break;case"hwb":t=l.get.hwb(e),n="hwb";break;default:t=l.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},l.get.rgb=function(e){if(!e)return null;var t,n,i,o=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(i=t[2],t=t[1],n=0;n<3;n++){var s=2*n;o[n]=parseInt(t.slice(s,s+2),16)}i&&(o[3]=parseInt(i,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(i=(t=t[1])[3],n=0;n<3;n++)o[n]=parseInt(t[n]+t[n],16);i&&(o[3]=parseInt(i+i,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)o[n]=parseInt(t[n+1],0);t[4]&&(t[5]?o[3]=.01*parseFloat(t[4]):o[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:a.call(r,t[1])?((o=r[t[1]])[3]=1,o):null:null;for(n=0;n<3;n++)o[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(t[5]?o[3]=.01*parseFloat(t[4]):o[3]=parseFloat(t[4]))}for(n=0;n<3;n++)o[n]=c(o[n],0,255);return o[3]=c(o[3],0,1),o},l.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},l.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(n)?1:n,0,1)]}return null},l.to.hex=function(){var e=i(arguments);return"#"+u(e[0])+u(e[1])+u(e[2])+(e[3]<1?u(Math.round(255*e[3])):"")},l.to.rgb=function(){var e=i(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},l.to.rgb.percent=function(){var e=i(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},l.to.hsl=function(){var e=i(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},l.to.hwb=function(){var e=i(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},l.to.keyword=function(e){return o[e.slice(0,3)]}},4308:(e,t,n)=>{const r=n(6250),i=n(8666),a=["keyword","gray","hex"],o={};for(const e of Object.keys(i))o[[...i[e].labels].sort().join("")]=e;const s={};function l(e,t){if(!(this instanceof l))return new l(e,t);if(t&&t in a&&(t=null),t&&!(t in i))throw new Error("Unknown model: "+t);let n,c;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof l)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if("string"==typeof e){const t=r.get(e);if(null===t)throw new Error("Unable to parse color from string: "+e);this.model=t.model,c=i[this.model].channels,this.color=t.value.slice(0,c),this.valpha="number"==typeof t.value[c]?t.value[c]:1}else if(e.length>0){this.model=t||"rgb",c=i[this.model].channels;const n=Array.prototype.slice.call(e,0,c);this.color=p(n,c),this.valpha="number"==typeof e[c]?e[c]:1}else if("number"==typeof e)this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;const t=Object.keys(e);"alpha"in e&&(t.splice(t.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);const r=t.sort().join("");if(!(r in o))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=o[r];const{labels:a}=i[this.model],s=[];for(n=0;n<a.length;n++)s.push(e[a[n]]);this.color=p(s)}if(s[this.model])for(c=i[this.model].channels,n=0;n<c;n++){const e=s[this.model][n];e&&(this.color[n]=e(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}l.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in r.to?this:this.rgb();t=t.round("number"==typeof e?e:1);const n=1===t.valpha?t.color:[...t.color,this.valpha];return r.to[t.model](n)},percentString(e){const t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:[...t.color,this.valpha];return r.to.rgb.percent(n)},array(){return 1===this.valpha?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:t}=i[this.model],{labels:n}=i[this.model];for(let r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new l([...this.color.map(c(e)),this.valpha],this.model)},alpha(e){return void 0!==e?new l([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:u("rgb",0,d(255)),green:u("rgb",1,d(255)),blue:u("rgb",2,d(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,(e=>(e%360+360)%360)),saturationl:u("hsl",1,d(100)),lightness:u("hsl",2,d(100)),saturationv:u("hsv",1,d(100)),value:u("hsv",2,d(100)),chroma:u("hcg",1,d(100)),gray:u("hcg",2,d(100)),white:u("hwb",1,d(100)),wblack:u("hwb",2,d(100)),cyan:u("cmyk",0,d(100)),magenta:u("cmyk",1,d(100)),yellow:u("cmyk",2,d(100)),black:u("cmyk",3,d(100)),x:u("xyz",0,d(95.047)),y:u("xyz",1,d(100)),z:u("xyz",2,d(108.833)),l:u("lab",0,d(100)),a:u("lab",1),b:u("lab",2),keyword(e){return void 0!==e?new l(e):i[this.model].keyword(this.color)},hex(e){return void 0!==e?new l(e):r.to.hex(this.rgb().round().color)},hexa(e){if(void 0!==e)return new l(e);const t=this.rgb().round().color;let n=Math.round(255*this.valpha).toString(16).toUpperCase();return 1===n.length&&(n="0"+n),r.to.hex(t)+n},rgbNumber(){const e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity(){const e=this.rgb().color,t=[];for(const[n,r]of e.entries()){const e=r/255;t[n]=e<=.04045?e/12.92:((e+.055)/1.055)**2.4}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){const t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level(e){const t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(2126*e[0]+7152*e[1]+722*e[2])/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){const t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){const t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){const t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){const t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){const t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){const t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){const e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return l.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const t=this.hsl();let n=t.color[0];return n=(n+e)%360,n=n<0?360+n:n,t.color[0]=n,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const n=e.rgb(),r=this.rgb(),i=void 0===t?.5:t,a=2*i-1,o=n.alpha()-r.alpha(),s=((a*o==-1?a:(a+o)/(1+a*o))+1)/2,c=1-s;return l.rgb(s*n.red()+c*r.red(),s*n.green()+c*r.green(),s*n.blue()+c*r.blue(),n.alpha()*i+r.alpha()*(1-i))}};for(const e of Object.keys(i)){if(a.includes(e))continue;const{channels:t}=i[e];l.prototype[e]=function(...t){return this.model===e?new l(this):t.length>0?new l(t,e):new l([...(n=i[this.model][e].raw(this.color),Array.isArray(n)?n:[n]),this.valpha],e);var n},l[e]=function(...n){let r=n[0];return"number"==typeof r&&(r=p(n,t)),new l(r,e)}}function c(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}function u(e,t,n){e=Array.isArray(e)?e:[e];for(const r of e)(s[r]||(s[r]=[]))[t]=n;return e=e[0],function(r){let i;return void 0!==r?(n&&(r=n(r)),i=this[e](),i.color[t]=r,i):(i=this[e]().color[t],n&&(i=n(i)),i)}}function d(e){return function(t){return Math.max(0,Math.min(e,t))}}function p(e,t){for(let n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}e.exports=l},2249:function(e,t,n){var r,i;void 0===(i="function"==typeof(r=function(){"use strict";function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){s(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,n,o){var s=a.URL||a.webkitURL,l=document.createElement("a");n=n||e.name||"download",l.download=n,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):r(l.href)?t(e,n,o):i(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),n);else if(r(e))t(e,n,a);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout((function(){i(o)}))}}:function(e,n,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var s="application/octet-stream"===e.type,l=/constructor/i.test(a.HTMLElement)||a.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},u.readAsDataURL(e)}else{var d=a.URL||a.webkitURL,p=d.createObjectURL(e);i?i.location=p:location.href=p,i=null,setTimeout((function(){d.revokeObjectURL(p)}),4e4)}});a.saveAs=s.saveAs=s,e.exports=s})?r.apply(t,[]):r)||(e.exports=i)},7842:(e,t,n)=>{e=n.nmd(e);var r="__lodash_hash_undefined__",i=1,a=2,o=9007199254740991,s="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",d="[object Date]",p="[object Error]",h="[object Function]",f="[object GeneratorFunction]",m="[object Map]",g="[object Number]",y="[object Null]",b="[object Object]",v="[object Promise]",w="[object Proxy]",S="[object RegExp]",E="[object Set]",x="[object String]",_="[object Undefined]",O="[object WeakMap]",T="[object ArrayBuffer]",C="[object DataView]",k=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,A={};A["[object Float32Array]"]=A["[object Float64Array]"]=A["[object Int8Array]"]=A["[object Int16Array]"]=A["[object Int32Array]"]=A["[object Uint8Array]"]=A["[object Uint8ClampedArray]"]=A["[object Uint16Array]"]=A["[object Uint32Array]"]=!0,A[s]=A[l]=A[T]=A[u]=A[C]=A[d]=A[p]=A[h]=A[m]=A[g]=A[b]=A[S]=A[E]=A[x]=A[O]=!1;var R="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,D="object"==typeof self&&self&&self.Object===Object&&self,j=R||D||Function("return this")(),I=t&&!t.nodeType&&t,N=I&&e&&!e.nodeType&&e,L=N&&N.exports===I,M=L&&R.process,F=function(){try{return M&&M.binding&&M.binding("util")}catch(e){}}(),$=F&&F.isTypedArray;function B(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function V(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function z(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var U,q,H,G=Array.prototype,W=Function.prototype,Q=Object.prototype,K=j["__core-js_shared__"],Y=W.toString,X=Q.hasOwnProperty,J=(U=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"",Z=Q.toString,ee=RegExp("^"+Y.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=L?j.Buffer:void 0,ne=j.Symbol,re=j.Uint8Array,ie=Q.propertyIsEnumerable,ae=G.splice,oe=ne?ne.toStringTag:void 0,se=Object.getOwnPropertySymbols,le=te?te.isBuffer:void 0,ce=(q=Object.keys,H=Object,function(e){return q(H(e))}),ue=Ne(j,"DataView"),de=Ne(j,"Map"),pe=Ne(j,"Promise"),he=Ne(j,"Set"),fe=Ne(j,"WeakMap"),me=Ne(Object,"create"),ge=$e(ue),ye=$e(de),be=$e(pe),ve=$e(he),we=$e(fe),Se=ne?ne.prototype:void 0,Ee=Se?Se.valueOf:void 0;function xe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _e(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Oe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Te(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Oe;++t<n;)this.add(e[t])}function Ce(e){var t=this.__data__=new _e(e);this.size=t.size}function ke(e,t){for(var n=e.length;n--;)if(Be(e[n][0],t))return n;return-1}function Pe(e){return null==e?void 0===e?_:y:oe&&oe in Object(e)?function(e){var t=X.call(e,oe),n=e[oe];try{e[oe]=void 0;var r=!0}catch(e){}var i=Z.call(e);return r&&(t?e[oe]=n:delete e[oe]),i}(e):function(e){return Z.call(e)}(e)}function Ae(e){return We(e)&&Pe(e)==s}function Re(e,t,n,r,o){return e===t||(null==e||null==t||!We(e)&&!We(t)?e!=e&&t!=t:function(e,t,n,r,o,c){var h=ze(e),f=ze(t),y=h?l:Me(e),v=f?l:Me(t),w=(y=y==s?b:y)==b,_=(v=v==s?b:v)==b,O=y==v;if(O&&Ue(e)){if(!Ue(t))return!1;h=!0,w=!1}if(O&&!w)return c||(c=new Ce),h||Qe(e)?De(e,t,n,r,o,c):function(e,t,n,r,o,s,l){switch(n){case C:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case T:return!(e.byteLength!=t.byteLength||!s(new re(e),new re(t)));case u:case d:case g:return Be(+e,+t);case p:return e.name==t.name&&e.message==t.message;case S:case x:return e==t+"";case m:var c=V;case E:var h=r&i;if(c||(c=z),e.size!=t.size&&!h)return!1;var f=l.get(e);if(f)return f==t;r|=a,l.set(e,t);var y=De(c(e),c(t),r,o,s,l);return l.delete(e),y;case"[object Symbol]":if(Ee)return Ee.call(e)==Ee.call(t)}return!1}(e,t,y,n,r,o,c);if(!(n&i)){var k=w&&X.call(e,"__wrapped__"),P=_&&X.call(t,"__wrapped__");if(k||P){var A=k?e.value():e,R=P?t.value():t;return c||(c=new Ce),o(A,R,n,r,c)}}return!!O&&(c||(c=new Ce),function(e,t,n,r,a,o){var s=n&i,l=je(e),c=l.length;if(c!=je(t).length&&!s)return!1;for(var u=c;u--;){var d=l[u];if(!(s?d in t:X.call(t,d)))return!1}var p=o.get(e);if(p&&o.get(t))return p==t;var h=!0;o.set(e,t),o.set(t,e);for(var f=s;++u<c;){var m=e[d=l[u]],g=t[d];if(r)var y=s?r(g,m,d,t,e,o):r(m,g,d,e,t,o);if(!(void 0===y?m===g||a(m,g,n,r,o):y)){h=!1;break}f||(f="constructor"==d)}if(h&&!f){var b=e.constructor,v=t.constructor;b==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof v&&v instanceof v||(h=!1)}return o.delete(e),o.delete(t),h}(e,t,n,r,o,c))}(e,t,n,r,Re,o))}function De(e,t,n,r,o,s){var l=n&i,c=e.length,u=t.length;if(c!=u&&!(l&&u>c))return!1;var d=s.get(e);if(d&&s.get(t))return d==t;var p=-1,h=!0,f=n&a?new Te:void 0;for(s.set(e,t),s.set(t,e);++p<c;){var m=e[p],g=t[p];if(r)var y=l?r(g,m,p,t,e,s):r(m,g,p,e,t,s);if(void 0!==y){if(y)continue;h=!1;break}if(f){if(!B(t,(function(e,t){if(i=t,!f.has(i)&&(m===e||o(m,e,n,r,s)))return f.push(t);var i}))){h=!1;break}}else if(m!==g&&!o(m,g,n,r,s)){h=!1;break}}return s.delete(e),s.delete(t),h}function je(e){return function(e,t,n){var r=t(e);return ze(e)?r:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(r,n(e))}(e,Ke,Le)}function Ie(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Ne(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!Ge(e)||function(e){return!!J&&J in e}(e))&&(qe(e)?ee:k).test($e(e))}(n)?n:void 0}xe.prototype.clear=function(){this.__data__=me?me(null):{},this.size=0},xe.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},xe.prototype.get=function(e){var t=this.__data__;if(me){var n=t[e];return n===r?void 0:n}return X.call(t,e)?t[e]:void 0},xe.prototype.has=function(e){var t=this.__data__;return me?void 0!==t[e]:X.call(t,e)},xe.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=me&&void 0===t?r:t,this},_e.prototype.clear=function(){this.__data__=[],this.size=0},_e.prototype.delete=function(e){var t=this.__data__,n=ke(t,e);return!(n<0||(n==t.length-1?t.pop():ae.call(t,n,1),--this.size,0))},_e.prototype.get=function(e){var t=this.__data__,n=ke(t,e);return n<0?void 0:t[n][1]},_e.prototype.has=function(e){return ke(this.__data__,e)>-1},_e.prototype.set=function(e,t){var n=this.__data__,r=ke(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Oe.prototype.clear=function(){this.size=0,this.__data__={hash:new xe,map:new(de||_e),string:new xe}},Oe.prototype.delete=function(e){var t=Ie(this,e).delete(e);return this.size-=t?1:0,t},Oe.prototype.get=function(e){return Ie(this,e).get(e)},Oe.prototype.has=function(e){return Ie(this,e).has(e)},Oe.prototype.set=function(e,t){var n=Ie(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Te.prototype.add=Te.prototype.push=function(e){return this.__data__.set(e,r),this},Te.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.clear=function(){this.__data__=new _e,this.size=0},Ce.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Ce.prototype.get=function(e){return this.__data__.get(e)},Ce.prototype.has=function(e){return this.__data__.has(e)},Ce.prototype.set=function(e,t){var n=this.__data__;if(n instanceof _e){var r=n.__data__;if(!de||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Oe(r)}return n.set(e,t),this.size=n.size,this};var Le=se?function(e){return null==e?[]:(e=Object(e),function(t,n){for(var r=-1,i=null==t?0:t.length,a=0,o=[];++r<i;){var s=t[r];l=s,ie.call(e,l)&&(o[a++]=s)}var l;return o}(se(e)))}:function(){return[]},Me=Pe;function Fe(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||P.test(e))&&e>-1&&e%1==0&&e<t}function $e(e){if(null!=e){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Be(e,t){return e===t||e!=e&&t!=t}(ue&&Me(new ue(new ArrayBuffer(1)))!=C||de&&Me(new de)!=m||pe&&Me(pe.resolve())!=v||he&&Me(new he)!=E||fe&&Me(new fe)!=O)&&(Me=function(e){var t=Pe(e),n=t==b?e.constructor:void 0,r=n?$e(n):"";if(r)switch(r){case ge:return C;case ye:return m;case be:return v;case ve:return E;case we:return O}return t});var Ve=Ae(function(){return arguments}())?Ae:function(e){return We(e)&&X.call(e,"callee")&&!ie.call(e,"callee")},ze=Array.isArray,Ue=le||function(){return!1};function qe(e){if(!Ge(e))return!1;var t=Pe(e);return t==h||t==f||t==c||t==w}function He(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}function Ge(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function We(e){return null!=e&&"object"==typeof e}var Qe=$?function(e){return function(t){return e(t)}}($):function(e){return We(e)&&He(e.length)&&!!A[Pe(e)]};function Ke(e){return null!=(t=e)&&He(t.length)&&!qe(t)?function(e,t){var n=ze(e),r=!n&&Ve(e),i=!n&&!r&&Ue(e),a=!n&&!r&&!i&&Qe(e),o=n||r||i||a,s=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var c in e)!t&&!X.call(e,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Fe(c,l))||s.push(c);return s}(e):function(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||Q))return ce(e);var t,n,r=[];for(var i in Object(e))X.call(e,i)&&"constructor"!=i&&r.push(i);return r}(e);var t}e.exports=function(e,t){return Re(e,t)}},1664:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,i){for(var a,o,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var c in a=Object(arguments[l]))n.call(a,c)&&(s[c]=a[c]);if(t){o=t(a);for(var u=0;u<o.length;u++)r.call(a,o[u])&&(s[o[u]]=a[o[u]])}}return s}},362:(e,t,n)=>{"use strict";var r=n(6441);function i(){}function a(){}a.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,a,o){if(o!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:i};return n.PropTypes=n,n}},2688:(e,t,n)=>{e.exports=n(362)()},6441:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},585:(e,t,n)=>{"use strict";e.exports=n(5481)},3804:(e,t,n)=>{"use strict";var r=t,i=n(2775),a=n(6866);function o(e,t,n,r){var a=!1;if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(d%s){",r);for(var o=t.resolvedType.values,s=Object.keys(o),l=0;l<s.length;++l)o[s[l]]!==t.typeDefault||a||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),t.repeated||e("break"),a=!0),e("case%j:",s[l])("case %i:",o[s[l]])("m%s=%j",r,o[s[l]])("break");e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,c)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r)}}return e}function s(e,t,n,r){if(t.resolvedType)t.resolvedType instanceof i?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,n,r,r,n,r,r):e("d%s=types[%i].toObject(m%s,o)",r,n,r);else{var a=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":a=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,a?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r)}}return e}r.fromObject=function(e){var t=e.fieldsArray,n=a.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<t.length;++r){var s=t[r].resolve(),l=a.safeProp(s.name);s.map?(n("if(d%s){",l)('if(typeof d%s!=="object")',l)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",l)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",l),o(n,s,r,l+"[ks[i]]")("}")("}")):s.repeated?(n("if(d%s){",l)("if(!Array.isArray(d%s))",l)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",l)("for(var i=0;i<d%s.length;++i){",l),o(n,s,r,l+"[i]")("}")("}")):(s.resolvedType instanceof i||n("if(d%s!=null){",l),o(n,s,r,l),s.resolvedType instanceof i||n("}"))}return n("return m")},r.toObject=function(e){var t=e.fieldsArray.slice().sort(a.compareFieldsById);if(!t.length)return a.codegen()("return {}");for(var n=a.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),r=[],o=[],l=[],c=0;c<t.length;++c)t[c].partOf||(t[c].resolve().repeated?r:t[c].map?o:l).push(t[c]);if(r.length){for(n("if(o.arrays||o.defaults){"),c=0;c<r.length;++c)n("d%s=[]",a.safeProp(r[c].name));n("}")}if(o.length){for(n("if(o.objects||o.defaults){"),c=0;c<o.length;++c)n("d%s={}",a.safeProp(o[c].name));n("}")}if(l.length){for(n("if(o.defaults){"),c=0;c<l.length;++c){var u=l[c],d=a.safeProp(u.name);if(u.resolvedType instanceof i)n("d%s=o.enums===String?%j:%j",d,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",d)("}else")("d%s=o.longs===String?%j:%i",d,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var p="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",d,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",d,p)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",d,d)("}")}else n("d%s=%j",d,u.typeDefault)}n("}")}var h=!1;for(c=0;c<t.length;++c){u=t[c];var f=e._fieldsArray.indexOf(u);d=a.safeProp(u.name),u.map?(h||(h=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",d,d)("d%s={}",d)("for(var j=0;j<ks2.length;++j){"),s(n,u,f,d+"[ks2[j]]")("}")):u.repeated?(n("if(m%s&&m%s.length){",d,d)("d%s=[]",d)("for(var j=0;j<m%s.length;++j){",d),s(n,u,f,d+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",d,u.name),s(n,u,f,d),u.partOf&&n("if(o.oneofs)")("d%s=%j",a.safeProp(u.partOf.name),u.name)),n("}")}return n("return d")}},9980:(e,t,n)=>{"use strict";e.exports=function(e){var t=a.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");e.group&&t("if((t&7)===4)")("break"),t("switch(t>>>3){");for(var n=0;n<e.fieldsArray.length;++n){var s=e._fieldsArray[n].resolve(),l=s.resolvedType instanceof r?"int32":s.type,c="m"+a.safeProp(s.name);t("case %i: {",s.id),s.map?(t("if(%s===util.emptyObject)",c)("%s={}",c)("var c2 = r.uint32()+r.pos"),void 0!==i.defaults[s.keyType]?t("k=%j",i.defaults[s.keyType]):t("k=null"),void 0!==i.defaults[l]?t("value=%j",i.defaults[l]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),void 0===i.basic[l]?t("value=types[%i].decode(r,r.uint32())",n):t("value=r.%s()",l),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==i.long[s.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',c):t("%s[k]=value",c)):s.repeated?(t("if(!(%s&&%s.length))",c,c)("%s=[]",c),void 0!==i.packed[l]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",c,l)("}else"),void 0===i.basic[l]?t(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",c,n):t("%s.push(r.%s())",c,l)):void 0===i.basic[l]?t(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",c,n):t("%s=r.%s()",c,l),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<e._fieldsArray.length;++n){var u=e._fieldsArray[n];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",o(u))}return t("return m")};var r=n(2775),i=n(1517),a=n(6866);function o(e){return"missing required '"+e.name+"'"}},8852:(e,t,n)=>{"use strict";e.exports=function(e){for(var t,n=a.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),s=e.fieldsArray.slice().sort(a.compareFieldsById),l=0;l<s.length;++l){var c=s[l].resolve(),u=e._fieldsArray.indexOf(c),d=c.resolvedType instanceof r?"int32":c.type,p=i.basic[d];t="m"+a.safeProp(c.name),c.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",t,c.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",t)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(c.id<<3|2)>>>0,8|i.mapKey[c.keyType],c.keyType),void 0===p?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,t):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|p,d,t),n("}")("}")):c.repeated?(n("if(%s!=null&&%s.length){",t,t),c.packed&&void 0!==i.packed[d]?n("w.uint32(%i).fork()",(c.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",t)("w.%s(%s[i])",d,t)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",t),void 0===p?o(n,c,u,t+"[i]"):n("w.uint32(%i).%s(%s[i])",(c.id<<3|p)>>>0,d,t)),n("}")):(c.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",t,c.name),void 0===p?o(n,c,u,t):n("w.uint32(%i).%s(%s)",(c.id<<3|p)>>>0,d,t))}return n("return w")};var r=n(2775),i=n(1517),a=n(6866);function o(e,t,n,r){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,r,(t.id<<3|2)>>>0)}},2775:(e,t,n)=>{"use strict";e.exports=o;var r=n(4349);((o.prototype=Object.create(r.prototype)).constructor=o).className="Enum";var i=n(2815),a=n(6866);function o(e,t,n,i,a,o){if(r.call(this,e,n),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=a||{},this.valuesOptions=o,this.reserved=void 0,t)for(var s=Object.keys(t),l=0;l<s.length;++l)"number"==typeof t[s[l]]&&(this.valuesById[this.values[s[l]]=t[s[l]]]=s[l])}o.fromJSON=function(e,t){var n=new o(e,t.values,t.options,t.comment,t.comments);return n.reserved=t.reserved,n},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},o.prototype.add=function(e,t,n,r){if(!a.isString(e))throw TypeError("name must be a string");if(!a.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return r&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=r||null),this.comments[e]=n||null,this},o.prototype.remove=function(e){if(!a.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},o.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},o.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)}},3796:(e,t,n)=>{"use strict";e.exports=c;var r=n(4349);((c.prototype=Object.create(r.prototype)).constructor=c).className="Field";var i,a=n(2775),o=n(1517),s=n(6866),l=/^required|optional|repeated$/;function c(e,t,n,i,a,c,u){if(s.isObject(i)?(u=a,c=i,i=a=void 0):s.isObject(a)&&(u=c,c=a,a=void 0),r.call(this,e,c),!s.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!s.isString(n))throw TypeError("type must be a string");if(void 0!==i&&!l.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==a&&!s.isString(a))throw TypeError("extend must be a string");"proto3_optional"===i&&(i="optional"),this.rule=i&&"optional"!==i?i:void 0,this.type=n,this.id=t,this.extend=a||void 0,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!s.Long&&void 0!==o.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=u}c.fromJSON=function(e,t){return new c(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)},Object.defineProperty(c.prototype,"packed",{get:function(){return null===this._packed&&(this._packed=!1!==this.getOption("packed")),this._packed}}),c.prototype.setOption=function(e,t,n){return"packed"===e&&(this._packed=null),r.prototype.setOption.call(this,e,t,n)},c.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return s.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},c.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=o.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof a&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof a)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=s.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;s.base64.test(this.typeDefault)?s.base64.decode(this.typeDefault,e=s.newBuffer(s.base64.length(this.typeDefault)),0):s.utf8.write(this.typeDefault,e=s.newBuffer(s.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=s.emptyObject:this.repeated?this.defaultValue=s.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this)},c.d=function(e,t,n,r){return"function"==typeof t?t=s.decorateType(t).name:t&&"object"==typeof t&&(t=s.decorateEnum(t).name),function(i,a){s.decorateType(i.constructor).add(new c(a,e,t,n,{default:r}))}},c._configure=function(e){i=e}},5481:(e,t,n)=>{"use strict";var r=e.exports=n(7134);r.build="light",r.load=function(e,t,n){return"function"==typeof t?(n=t,t=new r.Root):t||(t=new r.Root),t.load(e,n)},r.loadSync=function(e,t){return t||(t=new r.Root),t.loadSync(e)},r.encoder=n(8852),r.decoder=n(9980),r.verifier=n(3040),r.converter=n(3804),r.ReflectionObject=n(4349),r.Namespace=n(2815),r.Root=n(8038),r.Enum=n(2775),r.Type=n(6),r.Field=n(3796),r.OneOf=n(8957),r.MapField=n(9504),r.Service=n(6467),r.Method=n(3055),r.Message=n(6619),r.wrappers=n(6942),r.types=n(1517),r.util=n(6866),r.ReflectionObject._configure(r.Root),r.Namespace._configure(r.Type,r.Service,r.Enum),r.Root._configure(r.Type),r.Field._configure(r.Type)},7134:(e,t,n)=>{"use strict";var r=t;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(4301),r.BufferWriter=n(8422),r.Reader=n(1137),r.BufferReader=n(4010),r.util=n(5382),r.rpc=n(9691),r.roots=n(381),r.configure=i,i()},9504:(e,t,n)=>{"use strict";e.exports=o;var r=n(3796);((o.prototype=Object.create(r.prototype)).constructor=o).className="MapField";var i=n(1517),a=n(6866);function o(e,t,n,i,o,s){if(r.call(this,e,t,i,void 0,void 0,o,s),!a.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}o.fromJSON=function(e,t){return new o(e,t.id,t.keyType,t.type,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},o.prototype.resolve=function(){if(this.resolved)return this;if(void 0===i.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)},o.d=function(e,t,n){return"function"==typeof n?n=a.decorateType(n).name:n&&"object"==typeof n&&(n=a.decorateEnum(n).name),function(r,i){a.decorateType(r.constructor).add(new o(i,e,t,n))}}},6619:(e,t,n)=>{"use strict";e.exports=i;var r=n(5382);function i(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}i.create=function(e){return this.$type.create(e)},i.encode=function(e,t){return this.$type.encode(e,t)},i.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},i.decode=function(e){return this.$type.decode(e)},i.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},i.verify=function(e){return this.$type.verify(e)},i.fromObject=function(e){return this.$type.fromObject(e)},i.toObject=function(e,t){return this.$type.toObject(e,t)},i.prototype.toJSON=function(){return this.$type.toObject(this,r.toJSONOptions)}},3055:(e,t,n)=>{"use strict";e.exports=a;var r=n(4349);((a.prototype=Object.create(r.prototype)).constructor=a).className="Method";var i=n(6866);function a(e,t,n,a,o,s,l,c,u){if(i.isObject(o)?(l=o,o=s=void 0):i.isObject(s)&&(l=s,s=void 0),void 0!==t&&!i.isString(t))throw TypeError("type must be a string");if(!i.isString(n))throw TypeError("requestType must be a string");if(!i.isString(a))throw TypeError("responseType must be a string");r.call(this,e,l),this.type=t||"rpc",this.requestType=n,this.requestStream=!!o||void 0,this.responseType=a,this.responseStream=!!s||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=c,this.parsedOptions=u}a.fromJSON=function(e,t){return new a(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},a.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return i.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},a.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),r.prototype.resolve.call(this))}},2815:(e,t,n)=>{"use strict";e.exports=d;var r=n(4349);((d.prototype=Object.create(r.prototype)).constructor=d).className="Namespace";var i,a,o,s=n(3796),l=n(6866),c=n(8957);function u(e,t){if(e&&e.length){for(var n={},r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}}function d(e,t){r.call(this,e,t),this.nested=void 0,this._nestedArray=null}function p(e){return e._nestedArray=null,e}d.fromJSON=function(e,t){return new d(e,t.options).addJSON(t.nested)},d.arrayToJSON=u,d.isReservedId=function(e,t){if(e)for(var n=0;n<e.length;++n)if("string"!=typeof e[n]&&e[n][0]<=t&&e[n][1]>t)return!0;return!1},d.isReservedName=function(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},Object.defineProperty(d.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),d.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},d.prototype.addJSON=function(e){if(e)for(var t,n=Object.keys(e),r=0;r<n.length;++r)t=e[n[r]],this.add((void 0!==t.fields?i.fromJSON:void 0!==t.values?o.fromJSON:void 0!==t.methods?a.fromJSON:void 0!==t.id?s.fromJSON:d.fromJSON)(n[r],t));return this},d.prototype.get=function(e){return this.nested&&this.nested[e]||null},d.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof o)return this.nested[e].values;throw Error("no such enum: "+e)},d.prototype.add=function(e){if(!(e instanceof s&&void 0!==e.extend||e instanceof i||e instanceof c||e instanceof o||e instanceof a||e instanceof d))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t){if(!(t instanceof d&&e instanceof d)||t instanceof i||t instanceof a)throw Error("duplicate name '"+e.name+"' in "+this);for(var n=t.nestedArray,r=0;r<n.length;++r)e.add(n[r]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}}else this.nested={};return this.nested[e.name]=e,e.onAdd(this),p(this)},d.prototype.remove=function(e){if(!(e instanceof r))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),p(this)},d.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var n=this;e.length>0;){var r=e.shift();if(n.nested&&n.nested[r]){if(!((n=n.nested[r])instanceof d))throw Error("path conflicts with non-namespace objects")}else n.add(n=new d(r))}return t&&n.addJSON(t),n},d.prototype.resolveAll=function(){for(var e=this.nestedArray,t=0;t<e.length;)e[t]instanceof d?e[t++].resolveAll():e[t++].resolve();return this.resolve()},d.prototype.lookup=function(e,t,n){if("boolean"==typeof t?(n=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;if(""===e[0])return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(1===e.length){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof d&&(r=r.lookup(e.slice(1),t,!0)))return r}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof d&&(r=this._nestedArray[i].lookup(e,t,!0)))return r;return null===this.parent||n?null:this.parent.lookup(e,t)},d.prototype.lookupType=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such type: "+e);return t},d.prototype.lookupEnum=function(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},d.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[i,o]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},d.prototype.lookupService=function(e){var t=this.lookup(e,[a]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},d._configure=function(e,t,n){i=e,a=t,o=n}},4349:(e,t,n)=>{"use strict";e.exports=a,a.className="ReflectionObject";var r,i=n(6866);function a(e,t){if(!i.isString(e))throw TypeError("name must be a string");if(t&&!i.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(a.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),a.prototype.toJSON=function(){throw Error()},a.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof r&&t._handleAdd(this)},a.prototype.onRemove=function(e){var t=e.root;t instanceof r&&t._handleRemove(this),this.parent=null,this.resolved=!1},a.prototype.resolve=function(){return this.resolved||this.root instanceof r&&(this.resolved=!0),this},a.prototype.getOption=function(e){if(this.options)return this.options[e]},a.prototype.setOption=function(e,t,n){return n&&this.options&&void 0!==this.options[e]||((this.options||(this.options={}))[e]=t),this},a.prototype.setParsedOption=function(e,t,n){this.parsedOptions||(this.parsedOptions=[]);var r=this.parsedOptions;if(n){var a=r.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(a){var o=a[e];i.setProperty(o,n,t)}else(a={})[e]=i.setProperty({},n,t),r.push(a)}else{var s={};s[e]=t,r.push(s)}return this},a.prototype.setOptions=function(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this},a.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},a._configure=function(e){r=e}},8957:(e,t,n)=>{"use strict";e.exports=o;var r=n(4349);((o.prototype=Object.create(r.prototype)).constructor=o).className="OneOf";var i=n(3796),a=n(6866);function o(e,t,n,i){if(Array.isArray(t)||(n=t,t=void 0),r.call(this,e,n),void 0!==t&&!Array.isArray(t))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=i}function s(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}o.fromJSON=function(e,t){return new o(e,t.oneof,t.options,t.comment)},o.prototype.toJSON=function(e){var t=!!e&&Boolean(e.keepComments);return a.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},o.prototype.add=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,s(this),this},o.prototype.remove=function(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},o.prototype.onAdd=function(e){r.prototype.onAdd.call(this,e);for(var t=0;t<this.oneof.length;++t){var n=e.get(this.oneof[t]);n&&!n.partOf&&(n.partOf=this,this.fieldsArray.push(n))}s(this)},o.prototype.onRemove=function(e){for(var t,n=0;n<this.fieldsArray.length;++n)(t=this.fieldsArray[n]).parent&&t.parent.remove(t);r.prototype.onRemove.call(this,e)},o.d=function(){for(var e=new Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,n){a.decorateType(t.constructor).add(new o(n,e)),Object.defineProperty(t,n,{get:a.oneOfGetter(e),set:a.oneOfSetter(e)})}}},1137:(e,t,n)=>{"use strict";e.exports=l;var r,i=n(5382),a=i.LongBits,o=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var c,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},d=function(){return i.Buffer?function(e){return(l.create=function(e){return i.Buffer.isBuffer(e)?new r(e):u(e)})(e)}:u};function p(){var e=new a(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw s(this,8);return new a(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}l.create=d(),l.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,l.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return c}),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return h(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|h(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var r=i.Buffer;return r?r.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},l.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){r=e,l.create=d(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(l.prototype,{int64:function(){return p.call(this)[t](!1)},uint64:function(){return p.call(this)[t](!0)},sint64:function(){return p.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},4010:(e,t,n)=>{"use strict";e.exports=a;var r=n(1137);(a.prototype=Object.create(r.prototype)).constructor=a;var i=n(5382);function a(e){r.call(this,e)}a._configure=function(){i.Buffer&&(a.prototype._slice=i.Buffer.prototype.slice)},a.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},a._configure()},8038:(e,t,n)=>{"use strict";e.exports=d;var r=n(2815);((d.prototype=Object.create(r.prototype)).constructor=d).className="Root";var i,a,o,s=n(3796),l=n(2775),c=n(8957),u=n(6866);function d(e){r.call(this,"",e),this.deferred=[],this.files=[]}function p(){}d.fromJSON=function(e,t){return t||(t=new d),e.options&&t.setOptions(e.options),t.addJSON(e.nested)},d.prototype.resolvePath=u.path.resolve,d.prototype.fetch=u.fetch,d.prototype.load=function e(t,n,r){"function"==typeof n&&(r=n,n=void 0);var i=this;if(!r)return u.asPromise(e,i,t,n);var s=r===p;function l(e,t){if(r){if(s)throw e;var n=r;r=null,n(e,t)}}function c(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in o)return n}return null}function d(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){a.filename=e;var r,o=a(t,i,n),d=0;if(o.imports)for(;d<o.imports.length;++d)(r=c(o.imports[d])||i.resolvePath(e,o.imports[d]))&&h(r);if(o.weakImports)for(d=0;d<o.weakImports.length;++d)(r=c(o.weakImports[d])||i.resolvePath(e,o.weakImports[d]))&&h(r,!0)}else i.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}s||f||l(null,i)}function h(e,t){if(e=c(e)||e,!(i.files.indexOf(e)>-1))if(i.files.push(e),e in o)s?d(e,o[e]):(++f,setTimeout((function(){--f,d(e,o[e])})));else if(s){var n;try{n=u.fs.readFileSync(e).toString("utf8")}catch(e){return void(t||l(e))}d(e,n)}else++f,i.fetch(e,(function(n,a){--f,r&&(n?t?f||l(null,i):l(n):d(e,a))}))}var f=0;u.isString(t)&&(t=[t]);for(var m,g=0;g<t.length;++g)(m=i.resolvePath("",t[g]))&&h(m);if(s)return i;f||l(null,i)},d.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,p)},d.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var h=/^[A-Z]/;function f(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new s(t.fullName,t.id,t.type,t.rule,void 0,t.options);return n.get(r.name)||(r.declaringField=t,t.extensionField=r,n.add(r)),!0}return!1}d.prototype._handleAdd=function(e){if(e instanceof s)void 0===e.extend||e.extensionField||f(0,e)||this.deferred.push(e);else if(e instanceof l)h.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof c)){if(e instanceof i)for(var t=0;t<this.deferred.length;)f(0,this.deferred[t])?this.deferred.splice(t,1):++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);h.test(e.name)&&(e.parent[e.name]=e)}},d.prototype._handleRemove=function(e){if(e instanceof s){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof l)h.test(e.name)&&delete e.parent[e.name];else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);h.test(e.name)&&delete e.parent[e.name]}},d._configure=function(e,t,n){i=e,a=t,o=n}},381:e=>{"use strict";e.exports={}},9691:(e,t,n)=>{"use strict";t.Service=n(4447)},4447:(e,t,n)=>{"use strict";e.exports=i;var r=n(5382);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,a,o){if(!a)throw TypeError("request must be specified");var s=this;if(!o)return r.asPromise(e,s,t,n,i,a);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](a).finish(),(function(e,n){if(e)return s.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),o(e)}return s.emit("data",n,t),o(null,n)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},6467:(e,t,n)=>{"use strict";e.exports=s;var r=n(2815);((s.prototype=Object.create(r.prototype)).constructor=s).className="Service";var i=n(3055),a=n(6866),o=n(9691);function s(e,t){r.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}s.fromJSON=function(e,t){var n=new s(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),a=0;a<r.length;++a)n.add(i.fromJSON(r[a],t.methods[r[a]]));return t.nested&&n.addJSON(t.nested),n.comment=t.comment,n},s.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return a.toObject(["options",t&&t.options||void 0,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(s.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=a.toArray(this.methods))}}),s.prototype.get=function(e){return this.methods[e]||r.prototype.get.call(this,e)},s.prototype.resolveAll=function(){for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)},s.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof i?(this.methods[e.name]=e,e.parent=this,l(this)):r.prototype.add.call(this,e)},s.prototype.remove=function(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,l(this)}return r.prototype.remove.call(this,e)},s.prototype.create=function(e,t,n){for(var r,i=new o.Service(e,t,n),s=0;s<this.methodsArray.length;++s){var l=a.lcFirst((r=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[l]=a.codegen(["r","c"],a.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:r,q:r.resolvedRequestType.ctor,s:r.resolvedResponseType.ctor})}return i}},6:(e,t,n)=>{"use strict";e.exports=b;var r=n(2815);((b.prototype=Object.create(r.prototype)).constructor=b).className="Type";var i=n(2775),a=n(8957),o=n(3796),s=n(9504),l=n(6467),c=n(6619),u=n(1137),d=n(4301),p=n(6866),h=n(8852),f=n(9980),m=n(3040),g=n(3804),y=n(6942);function b(e,t){r.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function v(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(b.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=p.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=p.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=b.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof c||((e.prototype=new c).constructor=e,p.merge(e.prototype,t)),e.$type=e.prototype.$type=this,p.merge(e,c,!0),this._ctor=e;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:p.oneOfGetter(this._oneofsArray[n].oneof),set:p.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(e.prototype,r)}}}),b.generateConstructor=function(e){for(var t,n=p.codegen(["p"],e.name),r=0;r<e.fieldsArray.length;++r)(t=e._fieldsArray[r]).map?n("this%s={}",p.safeProp(t.name)):t.repeated&&n("this%s=[]",p.safeProp(t.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},b.fromJSON=function(e,t){var n=new b(e,t.options);n.extensions=t.extensions,n.reserved=t.reserved;for(var c=Object.keys(t.fields),u=0;u<c.length;++u)n.add((void 0!==t.fields[c[u]].keyType?s.fromJSON:o.fromJSON)(c[u],t.fields[c[u]]));if(t.oneofs)for(c=Object.keys(t.oneofs),u=0;u<c.length;++u)n.add(a.fromJSON(c[u],t.oneofs[c[u]]));if(t.nested)for(c=Object.keys(t.nested),u=0;u<c.length;++u){var d=t.nested[c[u]];n.add((void 0!==d.id?o.fromJSON:void 0!==d.fields?b.fromJSON:void 0!==d.values?i.fromJSON:void 0!==d.methods?l.fromJSON:r.fromJSON)(c[u],d))}return t.extensions&&t.extensions.length&&(n.extensions=t.extensions),t.reserved&&t.reserved.length&&(n.reserved=t.reserved),t.group&&(n.group=!0),t.comment&&(n.comment=t.comment),n},b.prototype.toJSON=function(e){var t=r.prototype.toJSON.call(this,e),n=!!e&&Boolean(e.keepComments);return p.toObject(["options",t&&t.options||void 0,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",n?this.comment:void 0])},b.prototype.resolveAll=function(){for(var e=this.fieldsArray,t=0;t<e.length;)e[t++].resolve();var n=this.oneofsArray;for(t=0;t<n.length;)n[t++].resolve();return r.prototype.resolveAll.call(this)},b.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},b.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof o&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),v(this)}return e instanceof a?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),v(this)):r.prototype.add.call(this,e)},b.prototype.remove=function(e){if(e instanceof o&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),v(this)}if(e instanceof a){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),v(this)}return r.prototype.remove.call(this,e)},b.prototype.isReservedId=function(e){return r.isReservedId(this.reserved,e)},b.prototype.isReservedName=function(e){return r.isReservedName(this.reserved,e)},b.prototype.create=function(e){return new this.ctor(e)},b.prototype.setup=function(){for(var e=this.fullName,t=[],n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=h(this)({Writer:d,types:t,util:p}),this.decode=f(this)({Reader:u,types:t,util:p}),this.verify=m(this)({types:t,util:p}),this.fromObject=g.fromObject(this)({types:t,util:p}),this.toObject=g.toObject(this)({types:t,util:p});var r=y[e];if(r){var i=Object.create(this);i.fromObject=this.fromObject,this.fromObject=r.fromObject.bind(i),i.toObject=this.toObject,this.toObject=r.toObject.bind(i)}return this},b.prototype.encode=function(e,t){return this.setup().encode(e,t)},b.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},b.prototype.decode=function(e,t){return this.setup().decode(e,t)},b.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},b.prototype.verify=function(e){return this.setup().verify(e)},b.prototype.fromObject=function(e){return this.setup().fromObject(e)},b.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},b.d=function(e){return function(t){p.decorateType(t,e)}}},1517:(e,t,n)=>{"use strict";var r=t,i=n(6866),a=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function o(e,t){var n=0,r={};for(t|=0;n<e.length;)r[a[n+t]]=e[n++];return r}r.basic=o([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),r.defaults=o([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",i.emptyArray,null]),r.long=o([0,0,0,1,1],7),r.mapKey=o([0,0,0,5,5,0,0,0,1,1,0,2],2),r.packed=o([1,5,0,0,0,5,5,0,0,0,1,1,0])},6866:(e,t,n)=>{"use strict";var r,i,a=e.exports=n(5382),o=n(381);a.codegen=n(7669),a.fetch=n(9240),a.path=n(2459),a.fs=a.inquire("fs"),a.toArray=function(e){if(e){for(var t=Object.keys(e),n=new Array(t.length),r=0;r<t.length;)n[r]=e[t[r++]];return n}return[]},a.toObject=function(e){for(var t={},n=0;n<e.length;){var r=e[n++],i=e[n++];void 0!==i&&(t[r]=i)}return t};var s=/\\/g,l=/"/g;a.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},a.safeProp=function(e){return!/^[$\w_]+$/.test(e)||a.isReserved(e)?'["'+e.replace(s,"\\\\").replace(l,'\\"')+'"]':"."+e},a.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;a.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(c,(function(e,t){return t.toUpperCase()}))},a.compareFieldsById=function(e,t){return e.id-t.id},a.decorateType=function(e,t){if(e.$type)return t&&e.$type.name!==t&&(a.decorateRoot.remove(e.$type),e.$type.name=t,a.decorateRoot.add(e.$type)),e.$type;r||(r=n(6));var i=new r(t||e.name);return a.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var u=0;a.decorateEnum=function(e){if(e.$type)return e.$type;i||(i=n(2775));var t=new i("Enum"+u++,e);return a.decorateRoot.add(t),Object.defineProperty(e,"$type",{value:t,enumerable:!1}),t},a.setProperty=function(e,t,n){if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return function e(t,n,r){var i=n.shift();if("__proto__"===i||"prototype"===i)return t;if(n.length>0)t[i]=e(t[i]||{},n,r);else{var a=t[i];a&&(r=[].concat(a).concat(r)),t[i]=r}return t}(e,t=t.split("."),n)},Object.defineProperty(a,"decorateRoot",{get:function(){return o.decorated||(o.decorated=new(n(8038)))}})},5003:(e,t,n)=>{"use strict";e.exports=i;var r=n(5382);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var a=i.zero=new i(0,0);a.toNumber=function(){return 0},a.zzEncode=a.zzDecode=function(){return this},a.length=function(){return 1};var o=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return a;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):a},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;i.fromHash=function(e){return e===o?a:new i((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},5382:function(e,t,n){"use strict";var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function a(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}r.asPromise=n(6233),r.base64=n(1979),r.EventEmitter=n(3474),r.float=n(5750),r.inquire=n(1925),r.utf8=n(2971),r.pool=n(4226),r.LongBits=n(5003),r.isNode=Boolean(void 0!==n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),r.global=r.isNode&&n.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=a,r.ProtocolError=a("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}},3040:(e,t,n)=>{"use strict";e.exports=function(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n={};e.oneofsArray.length&&t("var p={}");for(var r=0;r<e.fieldsArray.length;++r){var l=e._fieldsArray[r].resolve(),c="m"+i.safeProp(l.name);if(l.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",c,l.name),l.map)t("if(!util.isObject(%s))",c)("return%j",a(l,"object"))("var k=Object.keys(%s)",c)("for(var i=0;i<k.length;++i){"),s(t,l,"k[i]"),o(t,l,r,c+"[k[i]]")("}");else if(l.repeated)t("if(!Array.isArray(%s))",c)("return%j",a(l,"array"))("for(var i=0;i<%s.length;++i){",c),o(t,l,r,c+"[i]")("}");else{if(l.partOf){var u=i.safeProp(l.partOf.name);1===n[l.partOf.name]&&t("if(p%s===1)",u)("return%j",l.partOf.name+": multiple values"),n[l.partOf.name]=1,t("p%s=1",u)}o(t,l,r,c)}l.optional&&t("}")}return t("return null")};var r=n(2775),i=n(6866);function a(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function o(e,t,n,i){if(t.resolvedType)if(t.resolvedType instanceof r){e("switch(%s){",i)("default:")("return%j",a(t,"enum value"));for(var o=Object.keys(t.resolvedType.values),s=0;s<o.length;++s)e("case %i:",t.resolvedType.values[o[s]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",n,i)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",a(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",a(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",a(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",a(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",a(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",a(t,"buffer"))}return e}function s(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",a(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",a(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",a(t,"boolean key"))}return e}},6942:(e,t,n)=>{"use strict";var r=t,i=n(6619);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),n=this.lookup(t);if(n){var r="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return-1===r.indexOf("/")&&(r="/"+r),this.create({type_url:r,value:n.encode(n.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n="",r="";if(t&&t.json&&e.type_url&&e.value){r=e.type_url.substring(e.type_url.lastIndexOf("/")+1),n=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var a=this.lookup(r);a&&(e=a.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof i){var o=e.$type.toObject(e,t);return""===n&&(n="type.googleapis.com/"),r=n+("."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName),o["@type"]=r,o}return this.toObject(e,t)}}},4301:(e,t,n)=>{"use strict";e.exports=d;var r,i=n(5382),a=i.LongBits,o=i.base64,s=i.utf8;function l(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function c(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function d(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}var p=function(){return i.Buffer?function(){return(d.create=function(){return new r})()}:function(){return new d}};function h(e,t,n){t[n]=255&e}function f(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function g(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}d.create=p(),d.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(d.alloc=i.pool(d.alloc,i.Array.prototype.subarray)),d.prototype._push=function(e,t,n){return this.tail=this.tail.next=new l(e,t,n),this.len+=t,this},f.prototype=Object.create(l.prototype),f.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},d.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},d.prototype.int32=function(e){return e<0?this._push(m,10,a.fromNumber(e)):this.uint32(e)},d.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},d.prototype.uint64=function(e){var t=a.from(e);return this._push(m,t.length(),t)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function(e){var t=a.from(e).zzEncode();return this._push(m,t.length(),t)},d.prototype.bool=function(e){return this._push(h,1,e?1:0)},d.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function(e){var t=a.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},d.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var y=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};d.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(i.isString(e)){var n=d.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(y,t,e)},d.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(h,1,0)},d.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(c,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},d.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},d.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},d._configure=function(e){r=e,d.create=p(),r._configure()}},8422:(e,t,n)=>{"use strict";e.exports=a;var r=n(4301);(a.prototype=Object.create(r.prototype)).constructor=a;var i=n(5382);function a(){r.call(this)}function o(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}a._configure=function(){a.alloc=i._Buffer_allocUnsafe,a.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},a.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(a.writeBytesBuffer,t,e),this},a.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},a._configure()},9111:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(5959)),i=p(n(2688)),a=p(n(8398)),o=p(n(8262)),s=n(2837),l=n(402),c=n(6732),u=p(n(1060)),d=p(n(7988));function p(e){return e&&e.__esModule?e:{default:e}}function h(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)}function m(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class g extends r.Component{static getDerivedStateFromProps(e,t){let{position:n}=e,{prevPropsPosition:r}=t;return!n||r&&n.x===r.x&&n.y===r.y?null:((0,d.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:r}),{x:n.x,y:n.y,prevPropsPosition:{...n}})}constructor(e){super(e),m(this,"onDragStart",((e,t)=>{if((0,d.default)("Draggable: onDragStart: %j",t),!1===this.props.onStart(e,(0,l.createDraggableData)(this,t)))return!1;this.setState({dragging:!0,dragged:!0})})),m(this,"onDrag",((e,t)=>{if(!this.state.dragging)return!1;(0,d.default)("Draggable: onDrag: %j",t);const n=(0,l.createDraggableData)(this,t),r={x:n.x,y:n.y,slackX:0,slackY:0};if(this.props.bounds){const{x:e,y:t}=r;r.x+=this.state.slackX,r.y+=this.state.slackY;const[i,a]=(0,l.getBoundPosition)(this,r.x,r.y);r.x=i,r.y=a,r.slackX=this.state.slackX+(e-r.x),r.slackY=this.state.slackY+(t-r.y),n.x=r.x,n.y=r.y,n.deltaX=r.x-this.state.x,n.deltaY=r.y-this.state.y}if(!1===this.props.onDrag(e,n))return!1;this.setState(r)})),m(this,"onDragStop",((e,t)=>{if(!this.state.dragging)return!1;if(!1===this.props.onStop(e,(0,l.createDraggableData)(this,t)))return!1;(0,d.default)("Draggable: onDragStop: %j",t);const n={dragging:!1,slackX:0,slackY:0};if(Boolean(this.props.position)){const{x:e,y:t}=this.props.position;n.x=e,n.y=t}this.setState(n)})),this.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,prevPropsPosition:{...e.position},slackX:0,slackY:0,isElementSVG:!1},!e.position||e.onDrag||e.onStop||console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){void 0!==window.SVGElement&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var e,t;return null!==(e=null===(t=this.props)||void 0===t||null===(t=t.nodeRef)||void 0===t?void 0:t.current)&&void 0!==e?e:a.default.findDOMNode(this)}render(){const{axis:e,bounds:t,children:n,defaultPosition:i,defaultClassName:a,defaultClassNameDragging:c,defaultClassNameDragged:d,position:p,positionOffset:h,scale:m,...g}=this.props;let y={},b=null;const v=!Boolean(p)||this.state.dragging,w=p||i,S={x:(0,l.canDragX)(this)&&v?this.state.x:w.x,y:(0,l.canDragY)(this)&&v?this.state.y:w.y};this.state.isElementSVG?b=(0,s.createSVGTransform)(S,h):y=(0,s.createCSSTransform)(S,h);const E=(0,o.default)(n.props.className||"",a,{[c]:this.state.dragging,[d]:this.state.dragged});return r.createElement(u.default,f({},g,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),r.cloneElement(r.Children.only(n),{className:E,style:{...n.props.style,...y},transform:b}))}}t.default=g,m(g,"displayName","Draggable"),m(g,"propTypes",{...u.default.propTypes,axis:i.default.oneOf(["both","x","y","none"]),bounds:i.default.oneOfType([i.default.shape({left:i.default.number,right:i.default.number,top:i.default.number,bottom:i.default.number}),i.default.string,i.default.oneOf([!1])]),defaultClassName:i.default.string,defaultClassNameDragging:i.default.string,defaultClassNameDragged:i.default.string,defaultPosition:i.default.shape({x:i.default.number,y:i.default.number}),positionOffset:i.default.shape({x:i.default.oneOfType([i.default.number,i.default.string]),y:i.default.oneOfType([i.default.number,i.default.string])}),position:i.default.shape({x:i.default.number,y:i.default.number}),className:c.dontSetMe,style:c.dontSetMe,transform:c.dontSetMe}),m(g,"defaultProps",{...u.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})},1060:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(5959)),i=u(n(2688)),a=u(n(8398)),o=n(2837),s=n(402),l=n(6732),c=u(n(7988));function u(e){return e&&e.__esModule?e:{default:e}}function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const h={start:"touchstart",move:"touchmove",stop:"touchend"},f={start:"mousedown",move:"mousemove",stop:"mouseup"};let m=f;class g extends r.Component{constructor(){super(...arguments),p(this,"dragging",!1),p(this,"lastX",NaN),p(this,"lastY",NaN),p(this,"touchIdentifier",null),p(this,"mounted",!1),p(this,"handleDragStart",(e=>{if(this.props.onMouseDown(e),!this.props.allowAnyClick&&"number"==typeof e.button&&0!==e.button)return!1;const t=this.findDOMNode();if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:n}=t;if(this.props.disabled||!(e.target instanceof n.defaultView.Node)||this.props.handle&&!(0,o.matchesSelectorAndParentsTo)(e.target,this.props.handle,t)||this.props.cancel&&(0,o.matchesSelectorAndParentsTo)(e.target,this.props.cancel,t))return;"touchstart"===e.type&&e.preventDefault();const r=(0,o.getTouchIdentifier)(e);this.touchIdentifier=r;const i=(0,s.getControlPosition)(e,r,this);if(null==i)return;const{x:a,y:l}=i,u=(0,s.createCoreData)(this,a,l);(0,c.default)("DraggableCore: handleDragStart: %j",u),(0,c.default)("calling",this.props.onStart),!1!==this.props.onStart(e,u)&&!1!==this.mounted&&(this.props.enableUserSelectHack&&(0,o.addUserSelectStyles)(n),this.dragging=!0,this.lastX=a,this.lastY=l,(0,o.addEvent)(n,m.move,this.handleDrag),(0,o.addEvent)(n,m.stop,this.handleDragStop))})),p(this,"handleDrag",(e=>{const t=(0,s.getControlPosition)(e,this.touchIdentifier,this);if(null==t)return;let{x:n,y:r}=t;if(Array.isArray(this.props.grid)){let e=n-this.lastX,t=r-this.lastY;if([e,t]=(0,s.snapToGrid)(this.props.grid,e,t),!e&&!t)return;n=this.lastX+e,r=this.lastY+t}const i=(0,s.createCoreData)(this,n,r);if((0,c.default)("DraggableCore: handleDrag: %j",i),!1!==this.props.onDrag(e,i)&&!1!==this.mounted)this.lastX=n,this.lastY=r;else try{this.handleDragStop(new MouseEvent("mouseup"))}catch(e){const t=document.createEvent("MouseEvents");t.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(t)}})),p(this,"handleDragStop",(e=>{if(!this.dragging)return;const t=(0,s.getControlPosition)(e,this.touchIdentifier,this);if(null==t)return;let{x:n,y:r}=t;if(Array.isArray(this.props.grid)){let e=n-this.lastX||0,t=r-this.lastY||0;[e,t]=(0,s.snapToGrid)(this.props.grid,e,t),n=this.lastX+e,r=this.lastY+t}const i=(0,s.createCoreData)(this,n,r);if(!1===this.props.onStop(e,i)||!1===this.mounted)return!1;const a=this.findDOMNode();a&&this.props.enableUserSelectHack&&(0,o.removeUserSelectStyles)(a.ownerDocument),(0,c.default)("DraggableCore: handleDragStop: %j",i),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,a&&((0,c.default)("DraggableCore: Removing handlers"),(0,o.removeEvent)(a.ownerDocument,m.move,this.handleDrag),(0,o.removeEvent)(a.ownerDocument,m.stop,this.handleDragStop))})),p(this,"onMouseDown",(e=>(m=f,this.handleDragStart(e)))),p(this,"onMouseUp",(e=>(m=f,this.handleDragStop(e)))),p(this,"onTouchStart",(e=>(m=h,this.handleDragStart(e)))),p(this,"onTouchEnd",(e=>(m=h,this.handleDragStop(e))))}componentDidMount(){this.mounted=!0;const e=this.findDOMNode();e&&(0,o.addEvent)(e,h.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const e=this.findDOMNode();if(e){const{ownerDocument:t}=e;(0,o.removeEvent)(t,f.move,this.handleDrag),(0,o.removeEvent)(t,h.move,this.handleDrag),(0,o.removeEvent)(t,f.stop,this.handleDragStop),(0,o.removeEvent)(t,h.stop,this.handleDragStop),(0,o.removeEvent)(e,h.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,o.removeUserSelectStyles)(t)}}findDOMNode(){var e,t;return null!==(e=this.props)&&void 0!==e&&e.nodeRef?null===(t=this.props)||void 0===t||null===(t=t.nodeRef)||void 0===t?void 0:t.current:a.default.findDOMNode(this)}render(){return r.cloneElement(r.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}t.default=g,p(g,"displayName","DraggableCore"),p(g,"propTypes",{allowAnyClick:i.default.bool,children:i.default.node.isRequired,disabled:i.default.bool,enableUserSelectHack:i.default.bool,offsetParent:function(e,t){if(e[t]&&1!==e[t].nodeType)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:i.default.arrayOf(i.default.number),handle:i.default.string,cancel:i.default.string,nodeRef:i.default.object,onStart:i.default.func,onDrag:i.default.func,onStop:i.default.func,onMouseDown:i.default.func,scale:i.default.number,className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe}),p(g,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})},8230:(e,t,n)=>{"use strict";const{default:r,DraggableCore:i}=n(9111);e.exports=r,e.exports.default=r,e.exports.DraggableCore=i},2837:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addClassName=c,t.addEvent=function(e,t,n,r){if(!e)return;const i={capture:!0,...r};e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},t.addUserSelectStyles=function(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=".react-draggable-transparent-selection *::-moz-selection {all: inherit;}\n",t.innerHTML+=".react-draggable-transparent-selection *::selection {all: inherit;}\n",e.getElementsByTagName("head")[0].appendChild(t)),e.body&&c(e.body,"react-draggable-transparent-selection")},t.createCSSTransform=function(e,t){const n=l(e,t,"px");return{[(0,i.browserPrefixToKey)("transform",i.default)]:n}},t.createSVGTransform=function(e,t){return l(e,t,"")},t.getTouch=function(e,t){return e.targetTouches&&(0,r.findInArray)(e.targetTouches,(e=>t===e.identifier))||e.changedTouches&&(0,r.findInArray)(e.changedTouches,(e=>t===e.identifier))},t.getTouchIdentifier=function(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:void 0},t.getTranslation=l,t.innerHeight=function(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,r.int)(n.paddingTop),t-=(0,r.int)(n.paddingBottom),t},t.innerWidth=function(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,r.int)(n.paddingLeft),t-=(0,r.int)(n.paddingRight),t},t.matchesSelector=s,t.matchesSelectorAndParentsTo=function(e,t,n){let r=e;do{if(s(r,t))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1},t.offsetXYFromParent=function(e,t,n){const r=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect();return{x:(e.clientX+t.scrollLeft-r.left)/n,y:(e.clientY+t.scrollTop-r.top)/n}},t.outerHeight=function(e){let t=e.clientHeight;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,r.int)(n.borderTopWidth),t+=(0,r.int)(n.borderBottomWidth),t},t.outerWidth=function(e){let t=e.clientWidth;const n=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,r.int)(n.borderLeftWidth),t+=(0,r.int)(n.borderRightWidth),t},t.removeClassName=u,t.removeEvent=function(e,t,n,r){if(!e)return;const i={capture:!0,...r};e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},t.removeUserSelectStyles=function(e){if(e)try{if(e.body&&u(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{const t=(e.defaultView||window).getSelection();t&&"Caret"!==t.type&&t.removeAllRanges()}}catch(e){}};var r=n(6732),i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(7350));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}let o="";function s(e,t){return o||(o=(0,r.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],(function(t){return(0,r.isFunction)(e[t])}))),!!(0,r.isFunction)(e[o])&&e[o](t)}function l(e,t,n){let{x:r,y:i}=e,a="translate(".concat(r).concat(n,",").concat(i).concat(n,")");if(t){const e="".concat("string"==typeof t.x?t.x:t.x+n),r="".concat("string"==typeof t.y?t.y:t.y+n);a="translate(".concat(e,", ").concat(r,")")+a}return a}function c(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function u(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}},7350:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browserPrefixToKey=i,t.browserPrefixToStyle=function(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e},t.default=void 0,t.getPrefix=r;const n=["Moz","Webkit","O","ms"];function r(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform";if("undefined"==typeof window)return"";const r=null===(e=window.document)||void 0===e||null===(e=e.documentElement)||void 0===e?void 0:e.style;if(!r)return"";if(t in r)return"";for(let e=0;e<n.length;e++)if(i(t,n[e])in r)return n[e];return""}function i(e,t){return t?"".concat(t).concat(function(e){let t="",n=!0;for(let r=0;r<e.length;r++)n?(t+=e[r].toUpperCase(),n=!1):"-"===e[r]?n=!0:t+=e[r];return t}(e)):e}t.default=r()},7988:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){}},402:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDragX=function(e){return"both"===e.props.axis||"x"===e.props.axis},t.canDragY=function(e){return"both"===e.props.axis||"y"===e.props.axis},t.createCoreData=function(e,t,n){const i=!(0,r.isNum)(e.lastX),o=a(e);return i?{node:o,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:o,deltaX:t-e.lastX,deltaY:n-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:n}},t.createDraggableData=function(e,t){const n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}},t.getBoundPosition=function(e,t,n){if(!e.props.bounds)return[t,n];let{bounds:o}=e.props;o="string"==typeof o?o:function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}(o);const s=a(e);if("string"==typeof o){const{ownerDocument:e}=s,t=e.defaultView;let n;if(n="parent"===o?s.parentNode:e.querySelector(o),!(n instanceof t.HTMLElement))throw new Error('Bounds selector "'+o+'" could not find an element.');const a=n,l=t.getComputedStyle(s),c=t.getComputedStyle(a);o={left:-s.offsetLeft+(0,r.int)(c.paddingLeft)+(0,r.int)(l.marginLeft),top:-s.offsetTop+(0,r.int)(c.paddingTop)+(0,r.int)(l.marginTop),right:(0,i.innerWidth)(a)-(0,i.outerWidth)(s)-s.offsetLeft+(0,r.int)(c.paddingRight)-(0,r.int)(l.marginRight),bottom:(0,i.innerHeight)(a)-(0,i.outerHeight)(s)-s.offsetTop+(0,r.int)(c.paddingBottom)-(0,r.int)(l.marginBottom)}}return(0,r.isNum)(o.right)&&(t=Math.min(t,o.right)),(0,r.isNum)(o.bottom)&&(n=Math.min(n,o.bottom)),(0,r.isNum)(o.left)&&(t=Math.max(t,o.left)),(0,r.isNum)(o.top)&&(n=Math.max(n,o.top)),[t,n]},t.getControlPosition=function(e,t,n){const r="number"==typeof t?(0,i.getTouch)(e,t):null;if("number"==typeof t&&!r)return null;const o=a(n),s=n.props.offsetParent||o.offsetParent||o.ownerDocument.body;return(0,i.offsetXYFromParent)(r||e,s,n.props.scale)},t.snapToGrid=function(e,t,n){return[Math.round(t/e[0])*e[0],Math.round(n/e[1])*e[1]]};var r=n(6732),i=n(2837);function a(e){const t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}},6732:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dontSetMe=function(e,t,n){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(n," - do not set this, set it on the child."))},t.findInArray=function(e,t){for(let n=0,r=e.length;n<r;n++)if(t.apply(t,[e[n],n,e]))return e[n]},t.int=function(e){return parseInt(e,10)},t.isFunction=function(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)},t.isNum=function(e){return"number"==typeof e&&!isNaN(e)}},8262:(e,t,n)=>{"use strict";function r(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function i(){for(var e,t,n=0,i="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(i&&(i+=" "),i+=t);return i}n.r(t),n.d(t,{clsx:()=>i,default:()=>a});const a=i},7383:e=>{var t="undefined"!=typeof Element,n="function"==typeof Map,r="function"==typeof Set,i="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function a(e,o){if(e===o)return!0;if(e&&o&&"object"==typeof e&&"object"==typeof o){if(e.constructor!==o.constructor)return!1;var s,l,c,u;if(Array.isArray(e)){if((s=e.length)!=o.length)return!1;for(l=s;0!=l--;)if(!a(e[l],o[l]))return!1;return!0}if(n&&e instanceof Map&&o instanceof Map){if(e.size!==o.size)return!1;for(u=e.entries();!(l=u.next()).done;)if(!o.has(l.value[0]))return!1;for(u=e.entries();!(l=u.next()).done;)if(!a(l.value[1],o.get(l.value[0])))return!1;return!0}if(r&&e instanceof Set&&o instanceof Set){if(e.size!==o.size)return!1;for(u=e.entries();!(l=u.next()).done;)if(!o.has(l.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(o)){if((s=e.length)!=o.length)return!1;for(l=s;0!=l--;)if(e[l]!==o[l])return!1;return!0}if(e.constructor===RegExp)return e.source===o.source&&e.flags===o.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof o.valueOf)return e.valueOf()===o.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof o.toString)return e.toString()===o.toString();if((s=(c=Object.keys(e)).length)!==Object.keys(o).length)return!1;for(l=s;0!=l--;)if(!Object.prototype.hasOwnProperty.call(o,c[l]))return!1;if(t&&e instanceof Element)return!1;for(l=s;0!=l--;)if(("_owner"!==c[l]&&"__v"!==c[l]&&"__o"!==c[l]||!e.$$typeof)&&!a(e[c[l]],o[c[l]]))return!1;return!0}return e!=e&&o!=o}e.exports=function(e,t){try{return a(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw e}}},8100:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=p(n(5959)),a=p(n(2688)),o=n(8230),s=n(936),l=n(414),c=n(906),u=n(7222),d=p(n(7256));function p(e){return e&&e.__esModule?e:{default:e}}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},b(e)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(h,e);var t,n,a,u,p=(a=h,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(a);if(u){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return y(e)}(this,e)});function h(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(y(e=p.call.apply(p,[this].concat(n))),"state",{resizing:null,dragging:null,className:""}),v(y(e),"elementRef",i.default.createRef()),v(y(e),"onDragStart",(function(t,n){var r=n.node,i=e.props,a=i.onDragStart,o=i.transformScale;if(a){var s={top:0,left:0},l=r.offsetParent;if(l){var u=l.getBoundingClientRect(),d=r.getBoundingClientRect(),p=d.left/o,h=u.left/o,f=d.top/o,m=u.top/o;s.left=p-h+l.scrollLeft,s.top=f-m+l.scrollTop,e.setState({dragging:s});var g=(0,c.calcXY)(e.getPositionParams(),s.top,s.left,e.props.w,e.props.h),b=g.x,v=g.y;return a.call(y(e),e.props.i,b,v,{e:t,node:r,newPosition:s})}}})),v(y(e),"onDrag",(function(t,n){var r=n.node,i=n.deltaX,a=n.deltaY,o=e.props.onDrag;if(o){if(!e.state.dragging)throw new Error("onDrag called before onDragStart.");var s=e.state.dragging.top+a,l=e.state.dragging.left+i,u=e.props,d=u.isBounded,p=u.i,h=u.w,f=u.h,m=u.containerWidth,g=e.getPositionParams();if(d){var b=r.offsetParent;if(b){var v=e.props,w=v.margin,S=v.rowHeight,E=b.clientHeight-(0,c.calcGridItemWHPx)(f,S,w[1]);s=(0,c.clamp)(s,0,E);var x=(0,c.calcGridColWidth)(g),_=m-(0,c.calcGridItemWHPx)(h,x,w[0]);l=(0,c.clamp)(l,0,_)}}var O={top:s,left:l};e.setState({dragging:O});var T=(0,c.calcXY)(g,s,l,h,f),C=T.x,k=T.y;return o.call(y(e),p,C,k,{e:t,node:r,newPosition:O})}})),v(y(e),"onDragStop",(function(t,n){var r=n.node,i=e.props.onDragStop;if(i){if(!e.state.dragging)throw new Error("onDragEnd called before onDragStart.");var a=e.props,o=a.w,s=a.h,l=a.i,u=e.state.dragging,d=u.left,p=u.top,h={top:p,left:d};e.setState({dragging:null});var f=(0,c.calcXY)(e.getPositionParams(),p,d,o,s),m=f.x,g=f.y;return i.call(y(e),l,m,g,{e:t,node:r,newPosition:h})}})),v(y(e),"onResizeStop",(function(t,n){e.onResizeHandler(t,n,"onResizeStop")})),v(y(e),"onResizeStart",(function(t,n){e.onResizeHandler(t,n,"onResizeStart")})),v(y(e),"onResize",(function(t,n){e.onResizeHandler(t,n,"onResize")})),e}return t=h,n=[{key:"shouldComponentUpdate",value:function(e,t){if(this.props.children!==e.children)return!0;if(this.props.droppingPosition!==e.droppingPosition)return!0;var n=(0,c.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),r=(0,c.calcGridItemPosition)(this.getPositionParams(e),e.x,e.y,e.w,e.h,t);return!(0,l.fastPositionEqual)(n,r)||this.props.useCSSTransforms!==e.useCSSTransforms}},{key:"componentDidMount",value:function(){this.moveDroppingItem({})}},{key:"componentDidUpdate",value:function(e){this.moveDroppingItem(e)}},{key:"moveDroppingItem",value:function(e){var t=this.props.droppingPosition;if(t){var n=this.elementRef.current;if(n){var r=e.droppingPosition||{left:0,top:0},i=this.state.dragging,a=i&&t.left!==r.left||t.top!==r.top;if(i){if(a){var o=t.left-i.left,s=t.top-i.top;this.onDrag(t.e,{node:n,deltaX:o,deltaY:s})}}else this.onDragStart(t.e,{node:n,deltaX:t.left,deltaY:t.top})}}}},{key:"getPositionParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;return{cols:e.cols,containerPadding:e.containerPadding,containerWidth:e.containerWidth,margin:e.margin,maxRows:e.maxRows,rowHeight:e.rowHeight}}},{key:"createStyle",value:function(e){var t,n=this.props,r=n.usePercentages,i=n.containerWidth;return n.useCSSTransforms?t=(0,l.setTransform)(e):(t=(0,l.setTopLeft)(e),r&&(t.left=(0,l.perc)(e.left/i),t.width=(0,l.perc)(e.width/i))),t}},{key:"mixinDraggable",value:function(e,t){return i.default.createElement(o.DraggableCore,{disabled:!t,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},e)}},{key:"mixinResizable",value:function(e,t,n){var r=this.props,a=r.cols,o=r.x,l=r.minW,u=r.minH,d=r.maxW,p=r.maxH,h=r.transformScale,f=r.resizeHandles,m=r.resizeHandle,g=this.getPositionParams(),y=(0,c.calcGridItemPosition)(g,0,0,a-o,0).width,b=(0,c.calcGridItemPosition)(g,0,0,l,u),v=(0,c.calcGridItemPosition)(g,0,0,d,p),w=[b.width,b.height],S=[Math.min(v.width,y),Math.min(v.height,1/0)];return i.default.createElement(s.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:t.width,height:t.height,minConstraints:w,maxConstraints:S,onResizeStop:this.onResizeStop,onResizeStart:this.onResizeStart,onResize:this.onResize,transformScale:h,resizeHandles:f,handle:m},e)}},{key:"onResizeHandler",value:function(e,t,n){var r=t.node,i=t.size,a=this.props[n];if(a){var o=this.props,s=o.cols,l=o.x,u=o.y,d=o.i,p=o.maxH,h=o.minH,f=this.props,m=f.minW,g=f.maxW,y=(0,c.calcWH)(this.getPositionParams(),i.width,i.height,l,u),b=y.w,v=y.h;m=Math.max(m,1),g=Math.min(g,s-l),b=(0,c.clamp)(b,m,g),v=(0,c.clamp)(v,h,p),this.setState({resizing:"onResizeStop"===n?null:i}),a.call(this,d,b,v,{e,node:r,size:i})}}},{key:"render",value:function(){var e=this.props,t=e.x,n=e.y,r=e.w,a=e.h,o=e.isDraggable,s=e.isResizable,l=e.droppingPosition,u=e.useCSSTransforms,p=(0,c.calcGridItemPosition)(this.getPositionParams(),t,n,r,a,this.state),h=i.default.Children.only(this.props.children),m=i.default.cloneElement(h,{ref:this.elementRef,className:(0,d.default)("react-grid-item",h.props.className,this.props.className,{static:this.props.static,resizing:Boolean(this.state.resizing),"react-draggable":o,"react-draggable-dragging":Boolean(this.state.dragging),dropping:Boolean(l),cssTransforms:u}),style:f(f(f({},this.props.style),h.props.style),this.createStyle(p))});return m=this.mixinResizable(m,p,s),this.mixinDraggable(m,o)}}],n&&m(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),h}(i.default.Component);t.default=w,v(w,"propTypes",{children:a.default.element,cols:a.default.number.isRequired,containerWidth:a.default.number.isRequired,rowHeight:a.default.number.isRequired,margin:a.default.array.isRequired,maxRows:a.default.number.isRequired,containerPadding:a.default.array.isRequired,x:a.default.number.isRequired,y:a.default.number.isRequired,w:a.default.number.isRequired,h:a.default.number.isRequired,minW:function(e,t){var n=e[t];return"number"!=typeof n?new Error("minWidth not Number"):n>e.w||n>e.maxW?new Error("minWidth larger than item width/maxWidth"):void 0},maxW:function(e,t){var n=e[t];return"number"!=typeof n?new Error("maxWidth not Number"):n<e.w||n<e.minW?new Error("maxWidth smaller than item width/minWidth"):void 0},minH:function(e,t){var n=e[t];return"number"!=typeof n?new Error("minHeight not Number"):n>e.h||n>e.maxH?new Error("minHeight larger than item height/maxHeight"):void 0},maxH:function(e,t){var n=e[t];return"number"!=typeof n?new Error("maxHeight not Number"):n<e.h||n<e.minH?new Error("maxHeight smaller than item height/minHeight"):void 0},i:a.default.string.isRequired,resizeHandles:u.resizeHandleAxesType,resizeHandle:u.resizeHandleType,onDragStop:a.default.func,onDragStart:a.default.func,onDrag:a.default.func,onResizeStop:a.default.func,onResizeStart:a.default.func,onResize:a.default.func,isDraggable:a.default.bool.isRequired,isResizable:a.default.bool.isRequired,isBounded:a.default.bool.isRequired,static:a.default.bool,useCSSTransforms:a.default.bool.isRequired,transformScale:a.default.number,className:a.default.string,handle:a.default.string,cancel:a.default.string,droppingPosition:a.default.shape({e:a.default.object.isRequired,left:a.default.number.isRequired,top:a.default.number.isRequired})}),v(w,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1})},9482:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(5959)),a=d(n(7842)),o=d(n(7256)),s=n(414),l=n(906),c=d(n(8100)),u=d(n(7222));function d(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function S(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E="react-grid-layout",x=!1;try{x=/firefox/i.test(navigator.userAgent)}catch(e){}var _=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(_,e);var t,n,u,d,p,h=(d=_,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(d);if(p){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}(this,e)});function _(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return S(v(e=h.call.apply(h,[this].concat(n))),"state",{activeDrag:null,layout:(0,s.synchronizeLayoutWithChildren)(e.props.layout,e.props.children,e.props.cols,(0,s.compactType)(e.props),e.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,droppingDOMNode:null,children:[]}),S(v(e),"dragEnterCounter",0),S(v(e),"onDragStart",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state.layout,c=(0,s.getLayoutItem)(l,t);if(c)return e.setState({oldDragItem:(0,s.cloneLayoutItem)(c),oldLayout:l}),e.props.onDragStart(l,c,c,null,a,o)})),S(v(e),"onDrag",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state.oldDragItem,c=e.state.layout,u=e.props,d=u.cols,p=u.allowOverlap,h=u.preventCollision,f=(0,s.getLayoutItem)(c,t);if(f){var m={w:f.w,h:f.h,x:f.x,y:f.y,placeholder:!0,i:t};c=(0,s.moveElement)(c,f,n,r,!0,h,(0,s.compactType)(e.props),d,p),e.props.onDrag(c,l,f,m,a,o),e.setState({layout:p?c:(0,s.compact)(c,(0,s.compactType)(e.props),d),activeDrag:m})}})),S(v(e),"onDragStop",(function(t,n,r,i){var a=i.e,o=i.node;if(e.state.activeDrag){var l=e.state.oldDragItem,c=e.state.layout,u=e.props,d=u.cols,p=u.preventCollision,h=u.allowOverlap,f=(0,s.getLayoutItem)(c,t);if(f){c=(0,s.moveElement)(c,f,n,r,!0,p,(0,s.compactType)(e.props),d,h),e.props.onDragStop(c,l,f,null,a,o);var m=h?c:(0,s.compact)(c,(0,s.compactType)(e.props),d),g=e.state.oldLayout;e.setState({activeDrag:null,layout:m,oldDragItem:null,oldLayout:null}),e.onLayoutMaybeChanged(m,g)}}})),S(v(e),"onResizeStart",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state.layout,c=(0,s.getLayoutItem)(l,t);c&&(e.setState({oldResizeItem:(0,s.cloneLayoutItem)(c),oldLayout:e.state.layout}),e.props.onResizeStart(l,c,c,null,a,o))})),S(v(e),"onResize",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state,c=l.layout,u=l.oldResizeItem,d=e.props,p=d.cols,h=d.preventCollision,g=d.allowOverlap,y=(0,s.withLayoutItem)(c,t,(function(e){var t;if(h&&!g){var i=(0,s.getAllCollisions)(c,f(f({},e),{},{w:n,h:r})).filter((function(t){return t.i!==e.i}));if(t=i.length>0){var a=1/0,o=1/0;i.forEach((function(t){t.x>e.x&&(a=Math.min(a,t.x)),t.y>e.y&&(o=Math.min(o,t.y))})),Number.isFinite(a)&&(e.w=a-e.x),Number.isFinite(o)&&(e.h=o-e.y)}}return t||(e.w=n,e.h=r),e})),b=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(y,2),v=b[0],w=b[1];if(w){var S={w:w.w,h:w.h,x:w.x,y:w.y,static:!0,i:t};e.props.onResize(v,u,w,S,a,o),e.setState({layout:g?v:(0,s.compact)(v,(0,s.compactType)(e.props),p),activeDrag:S})}})),S(v(e),"onResizeStop",(function(t,n,r,i){var a=i.e,o=i.node,l=e.state,c=l.layout,u=l.oldResizeItem,d=e.props,p=d.cols,h=d.allowOverlap,f=(0,s.getLayoutItem)(c,t);e.props.onResizeStop(c,u,f,null,a,o);var m=h?c:(0,s.compact)(c,(0,s.compactType)(e.props),p),g=e.state.oldLayout;e.setState({activeDrag:null,layout:m,oldResizeItem:null,oldLayout:null}),e.onLayoutMaybeChanged(m,g)})),S(v(e),"onDragOver",(function(t){var n;if(t.preventDefault(),t.stopPropagation(),x&&(null===(n=t.nativeEvent.target)||void 0===n||!n.classList.contains(E)))return!1;var r=e.props,a=r.droppingItem,o=r.onDropDragOver,s=r.margin,c=r.cols,u=r.rowHeight,d=r.maxRows,p=r.width,h=r.containerPadding,y=r.transformScale,b=null==o?void 0:o(t);if(!1===b)return e.state.droppingDOMNode&&e.removeDroppingPlaceholder(),!1;var v,w=f(f({},a),b),S=e.state.layout,_=t.nativeEvent,O=_.layerX,T=_.layerY,C={left:O/y,top:T/y,e:t};if(e.state.droppingDOMNode){if(e.state.droppingPosition){var k=e.state.droppingPosition,P=k.left,A=k.top;(P!=O||A!=T)&&e.setState({droppingPosition:C})}}else{var R={cols:c,margin:s,maxRows:d,rowHeight:u,containerWidth:p,containerPadding:h||s},D=(0,l.calcXY)(R,T,O,w.w,w.h);e.setState({droppingDOMNode:i.createElement("div",{key:w.i}),droppingPosition:C,layout:[].concat((v=S,function(e){if(Array.isArray(e))return g(e)}(v)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(v)||m(v)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[f(f({},w),{},{x:D.x,y:D.y,static:!1,isDraggable:!0})])})}})),S(v(e),"removeDroppingPlaceholder",(function(){var t=e.props,n=t.droppingItem,r=t.cols,i=e.state.layout,a=(0,s.compact)(i.filter((function(e){return e.i!==n.i})),(0,s.compactType)(e.props),r);e.setState({layout:a,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})})),S(v(e),"onDragLeave",(function(t){t.preventDefault(),t.stopPropagation(),e.dragEnterCounter--,0===e.dragEnterCounter&&e.removeDroppingPlaceholder()})),S(v(e),"onDragEnter",(function(t){t.preventDefault(),t.stopPropagation(),e.dragEnterCounter++})),S(v(e),"onDrop",(function(t){t.preventDefault(),t.stopPropagation();var n=e.props.droppingItem,r=e.state.layout,i=r.find((function(e){return e.i===n.i}));e.dragEnterCounter=0,e.removeDroppingPlaceholder(),e.props.onDrop(r,i,t)})),e}return t=_,u=[{key:"getDerivedStateFromProps",value:function(e,t){var n;return t.activeDrag?null:((0,a.default)(e.layout,t.propsLayout)&&e.compactType===t.compactType?(0,s.childrenEqual)(e.children,t.children)||(n=t.layout):n=e.layout,n?{layout:(0,s.synchronizeLayoutWithChildren)(n,e.children,e.cols,(0,s.compactType)(e),e.allowOverlap),compactType:e.compactType,children:e.children,propsLayout:e.layout}:null)}}],(n=[{key:"componentDidMount",value:function(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}},{key:"shouldComponentUpdate",value:function(e,t){return this.props.children!==e.children||!(0,s.fastRGLPropsEqual)(this.props,e,a.default)||this.state.activeDrag!==t.activeDrag||this.state.mounted!==t.mounted||this.state.droppingPosition!==t.droppingPosition}},{key:"componentDidUpdate",value:function(e,t){if(!this.state.activeDrag){var n=this.state.layout,r=t.layout;this.onLayoutMaybeChanged(n,r)}}},{key:"containerHeight",value:function(){if(this.props.autoSize){var e=(0,s.bottom)(this.state.layout),t=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return e*this.props.rowHeight+(e-1)*this.props.margin[1]+2*t+"px"}}},{key:"onLayoutMaybeChanged",value:function(e,t){t||(t=this.state.layout),(0,a.default)(t,e)||this.props.onLayoutChange(e)}},{key:"placeholder",value:function(){var e=this.state.activeDrag;if(!e)return null;var t=this.props,n=t.width,r=t.cols,a=t.margin,o=t.containerPadding,s=t.rowHeight,l=t.maxRows,u=t.useCSSTransforms,d=t.transformScale;return i.createElement(c.default,{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,className:"react-grid-placeholder",containerWidth:n,cols:r,margin:a,containerPadding:o||a,maxRows:l,rowHeight:s,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:u,transformScale:d},i.createElement("div",null))}},{key:"processGridItem",value:function(e,t){if(e&&e.key){var n=(0,s.getLayoutItem)(this.state.layout,String(e.key));if(!n)return null;var r=this.props,a=r.width,o=r.cols,l=r.margin,u=r.containerPadding,d=r.rowHeight,p=r.maxRows,h=r.isDraggable,f=r.isResizable,m=r.isBounded,g=r.useCSSTransforms,y=r.transformScale,b=r.draggableCancel,v=r.draggableHandle,w=r.resizeHandles,S=r.resizeHandle,E=this.state,x=E.mounted,_=E.droppingPosition,O="boolean"==typeof n.isDraggable?n.isDraggable:!n.static&&h,T="boolean"==typeof n.isResizable?n.isResizable:!n.static&&f,C=n.resizeHandles||w,k=O&&m&&!1!==n.isBounded;return i.createElement(c.default,{containerWidth:a,cols:o,margin:l,containerPadding:u||l,maxRows:p,rowHeight:d,cancel:b,handle:v,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:O,isResizable:T,isBounded:k,useCSSTransforms:g&&x,usePercentages:!x,transformScale:y,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:t?_:void 0,resizeHandles:C,resizeHandle:S},e)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.className,r=t.style,a=t.isDroppable,l=t.innerRef,c=(0,o.default)(E,n),u=f({height:this.containerHeight()},r);return i.createElement("div",{ref:l,className:c,style:u,onDrop:a?this.onDrop:s.noop,onDragLeave:a?this.onDragLeave:s.noop,onDragEnter:a?this.onDragEnter:s.noop,onDragOver:a?this.onDragOver:s.noop},i.Children.map(this.props.children,(function(t){return e.processGridItem(t)})),a&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}}])&&y(t.prototype,n),u&&y(t,u),Object.defineProperty(t,"prototype",{writable:!1}),_}(i.Component);t.default=_,S(_,"displayName","ReactGridLayout"),S(_,"propTypes",u.default),S(_,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:s.noop,onDragStart:s.noop,onDrag:s.noop,onDragStop:s.noop,onResizeStart:s.noop,onResize:s.noop,onResizeStop:s.noop,onDrop:s.noop,onDropDragOver:s.noop})},7222:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resizeHandleType=t.resizeHandleAxesType=t.default=void 0;var r=a(n(2688)),i=a(n(5959));function a(e){return e&&e.__esModule?e:{default:e}}var o=r.default.arrayOf(r.default.oneOf(["s","w","e","n","sw","nw","se","ne"]));t.resizeHandleAxesType=o;var s=r.default.oneOfType([r.default.node,r.default.func]);t.resizeHandleType=s;var l={className:r.default.string,style:r.default.object,width:r.default.number,autoSize:r.default.bool,cols:r.default.number,draggableCancel:r.default.string,draggableHandle:r.default.string,verticalCompact:function(e){e.verticalCompact},compactType:r.default.oneOf(["vertical","horizontal"]),layout:function(e){var t=e.layout;void 0!==t&&n(414).validateLayout(t,"layout")},margin:r.default.arrayOf(r.default.number),containerPadding:r.default.arrayOf(r.default.number),rowHeight:r.default.number,maxRows:r.default.number,isBounded:r.default.bool,isDraggable:r.default.bool,isResizable:r.default.bool,allowOverlap:r.default.bool,preventCollision:r.default.bool,useCSSTransforms:r.default.bool,transformScale:r.default.number,isDroppable:r.default.bool,resizeHandles:o,resizeHandle:s,onLayoutChange:r.default.func,onDragStart:r.default.func,onDrag:r.default.func,onDragStop:r.default.func,onResizeStart:r.default.func,onResize:r.default.func,onResizeStop:r.default.func,onDrop:r.default.func,droppingItem:r.default.shape({i:r.default.string.isRequired,w:r.default.number.isRequired,h:r.default.number.isRequired}),children:function(e,t){var n=e[t],r={};i.default.Children.forEach(n,(function(e){if(null!=(null==e?void 0:e.key)){if(r[e.key])throw new Error('Duplicate child key "'+e.key+'" found! This will cause problems in ReactGridLayout.');r[e.key]=!0}}))},innerRef:r.default.any};t.default=l},4636:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.default=void 0;var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=p(t);if(n&&n.has(e))return n.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(5959)),a=d(n(2688)),o=d(n(7842)),s=n(414),l=n(544),c=d(n(9482)),u=["breakpoint","breakpoints","cols","layouts","margin","containerPadding","onBreakpointChange","onLayoutChange","onWidthChange"];function d(e){return e&&e.__esModule?e:{default:e}}function p(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(p=function(e){return e?n:t})(e)}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(e){return Object.prototype.toString.call(e)};function E(e,t){return null==e?null:Array.isArray(e)?e:e[t]}var x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y(e,t)}(S,e);var t,n,a,d,p,f=(d=S,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(d);if(p){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return b(e)}(this,e)});function S(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,S);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return w(b(e=f.call.apply(f,[this].concat(n))),"state",e.generateInitialState()),w(b(e),"onLayoutChange",(function(t){e.props.onLayoutChange(t,m(m({},e.props.layouts),{},w({},e.state.breakpoint,t)))})),e}return t=S,a=[{key:"getDerivedStateFromProps",value:function(e,t){if(!(0,o.default)(e.layouts,t.layouts)){var n=t.breakpoint,r=t.cols;return{layout:(0,l.findOrGenerateResponsiveLayout)(e.layouts,e.breakpoints,n,n,r,e.compactType),layouts:e.layouts}}return null}}],(n=[{key:"generateInitialState",value:function(){var e=this.props,t=e.width,n=e.breakpoints,r=e.layouts,i=e.cols,a=(0,l.getBreakpointFromWidth)(n,t),o=(0,l.getColsFromBreakpoint)(a,i),s=!1===this.props.verticalCompact?null:this.props.compactType;return{layout:(0,l.findOrGenerateResponsiveLayout)(r,n,a,a,o,s),breakpoint:a,cols:o}}},{key:"componentDidUpdate",value:function(e){this.props.width==e.width&&this.props.breakpoint===e.breakpoint&&(0,o.default)(this.props.breakpoints,e.breakpoints)&&(0,o.default)(this.props.cols,e.cols)||this.onWidthChange(e)}},{key:"onWidthChange",value:function(e){var t=this.props,n=t.breakpoints,r=t.cols,i=t.layouts,a=t.compactType,o=this.props.breakpoint||(0,l.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),c=this.state.breakpoint,u=(0,l.getColsFromBreakpoint)(o,r),d=m({},i);if(c!==o||e.breakpoints!==n||e.cols!==r){c in d||(d[c]=(0,s.cloneLayout)(this.state.layout));var p=(0,l.findOrGenerateResponsiveLayout)(d,n,o,c,u,a);p=(0,s.synchronizeLayoutWithChildren)(p,this.props.children,u,a,this.props.allowOverlap),d[o]=p,this.props.onLayoutChange(p,d),this.props.onBreakpointChange(o,u),this.setState({breakpoint:o,layout:p,cols:u})}var h=E(this.props.margin,o),f=E(this.props.containerPadding,o);this.props.onWidthChange(this.props.width,h,u,f)}},{key:"render",value:function(){var e=this.props,t=(e.breakpoint,e.breakpoints,e.cols,e.layouts,e.margin),n=e.containerPadding,r=(e.onBreakpointChange,e.onLayoutChange,e.onWidthChange,function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,u));return i.createElement(c.default,h({},r,{margin:E(t,this.state.breakpoint),containerPadding:E(n,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}}])&&g(t.prototype,n),a&&g(t,a),Object.defineProperty(t,"prototype",{writable:!1}),S}(i.Component);t.default=x,w(x,"propTypes",{breakpoint:a.default.string,breakpoints:a.default.object,allowOverlap:a.default.bool,cols:a.default.object,margin:a.default.oneOfType([a.default.array,a.default.object]),containerPadding:a.default.oneOfType([a.default.array,a.default.object]),layouts:function(e,t){if("[object Object]"!==S(e[t]))throw new Error("Layout property must be an object. Received: "+S(e[t]));Object.keys(e[t]).forEach((function(t){if(!(t in e.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,s.validateLayout)(e.layouts[t],"layouts."+t)}))},width:a.default.number.isRequired,onBreakpointChange:a.default.func,onLayoutChange:a.default.func,onWidthChange:a.default.func}),w(x,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:s.noop,onLayoutChange:s.noop,onWidthChange:s.noop})},906:(e,t)=>{"use strict";function n(e){var t=e.margin,n=e.containerPadding,r=e.containerWidth,i=e.cols;return(r-t[0]*(i-1)-2*n[0])/i}function r(e,t,n){return Number.isFinite(e)?Math.round(t*e+Math.max(0,e-1)*n):e}function i(e,t,n){return Math.max(Math.min(e,n),t)}Object.defineProperty(t,"__esModule",{value:!0}),t.calcGridColWidth=n,t.calcGridItemPosition=function(e,t,i,a,o,s){var l=e.margin,c=e.containerPadding,u=e.rowHeight,d=n(e),p={};return s&&s.resizing?(p.width=Math.round(s.resizing.width),p.height=Math.round(s.resizing.height)):(p.width=r(a,d,l[0]),p.height=r(o,u,l[1])),s&&s.dragging?(p.top=Math.round(s.dragging.top),p.left=Math.round(s.dragging.left)):(p.top=Math.round((u+l[1])*i+c[1]),p.left=Math.round((d+l[0])*t+c[0])),p},t.calcGridItemWHPx=r,t.calcWH=function(e,t,r,a,o){var s=e.margin,l=e.maxRows,c=e.cols,u=e.rowHeight,d=n(e),p=Math.round((t+s[0])/(d+s[0])),h=Math.round((r+s[1])/(u+s[1]));return{w:p=i(p,0,c-a),h:h=i(h,0,l-o)}},t.calcXY=function(e,t,r,a,o){var s=e.margin,l=e.cols,c=e.rowHeight,u=e.maxRows,d=n(e),p=Math.round((r-s[0])/(d+s[0])),h=Math.round((t-s[1])/(c+s[1]));return{x:p=i(p,0,l-a),y:h=i(h,0,u-o)}},t.clamp=i},6805:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.default=function(e){var t;return t=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}(b,t);var n,a,l,c,y=(n=b,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(n);if(a){var i=f(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}(this,e)});function b(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return m(h(e=y.call.apply(y,[this].concat(n))),"state",{width:1280}),m(h(e),"elementRef",i.createRef()),m(h(e),"mounted",!1),m(h(e),"onWindowResize",(function(){if(e.mounted){var t=e.elementRef.current;t instanceof HTMLElement&&t.offsetWidth&&e.setState({width:t.offsetWidth})}})),e}return l=b,(c=[{key:"componentDidMount",value:function(){this.mounted=!0,window.addEventListener("resize",this.onWindowResize),this.onWindowResize()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,window.removeEventListener("resize",this.onWindowResize)}},{key:"render",value:function(){var t=this.props,n=t.measureBeforeMount,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,s);return n&&!this.mounted?i.createElement("div",{className:(0,o.default)(this.props.className,g),style:this.props.style,ref:this.elementRef}):i.createElement(e,u({innerRef:this.elementRef},r,this.state))}}])&&d(l.prototype,c),Object.defineProperty(l,"prototype",{writable:!1}),b}(i.Component),m(t,"defaultProps",{measureBeforeMount:!1}),m(t,"propTypes",{measureBeforeMount:a.default.bool}),t};var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(5959)),a=l(n(2688)),o=l(n(7256)),s=["measureBeforeMount"];function l(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g="react-grid-layout"},7434:e=>{e.exports=function(e,t,n){return e===t||e.className===t.className&&n(e.style,t.style)&&e.width===t.width&&e.autoSize===t.autoSize&&e.cols===t.cols&&e.draggableCancel===t.draggableCancel&&e.draggableHandle===t.draggableHandle&&n(e.verticalCompact,t.verticalCompact)&&n(e.compactType,t.compactType)&&n(e.layout,t.layout)&&n(e.margin,t.margin)&&n(e.containerPadding,t.containerPadding)&&e.rowHeight===t.rowHeight&&e.maxRows===t.maxRows&&e.isBounded===t.isBounded&&e.isDraggable===t.isDraggable&&e.isResizable===t.isResizable&&e.allowOverlap===t.allowOverlap&&e.preventCollision===t.preventCollision&&e.useCSSTransforms===t.useCSSTransforms&&e.transformScale===t.transformScale&&e.isDroppable===t.isDroppable&&n(e.resizeHandles,t.resizeHandles)&&n(e.resizeHandle,t.resizeHandle)&&e.onLayoutChange===t.onLayoutChange&&e.onDragStart===t.onDragStart&&e.onDrag===t.onDrag&&e.onDragStop===t.onDragStop&&e.onResizeStart===t.onResizeStart&&e.onResize===t.onResize&&e.onResizeStop===t.onResizeStop&&e.onDrop===t.onDrop&&n(e.droppingItem,t.droppingItem)&&n(e.innerRef,t.innerRef)}},544:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findOrGenerateResponsiveLayout=function(e,t,n,a,o,s){if(e[n])return(0,r.cloneLayout)(e[n]);for(var l=e[a],c=i(t),u=c.slice(c.indexOf(n)),d=0,p=u.length;d<p;d++){var h=u[d];if(e[h]){l=e[h];break}}return l=(0,r.cloneLayout)(l||[]),(0,r.compact)((0,r.correctBounds)(l,{cols:o}),s,o)},t.getBreakpointFromWidth=function(e,t){for(var n=i(e),r=n[0],a=1,o=n.length;a<o;a++){var s=n[a];t>e[s]&&(r=s)}return r},t.getColsFromBreakpoint=function(e,t){if(!t[e])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+e+" is missing!");return t[e]},t.sortBreakpoints=i;var r=n(414);function i(e){return Object.keys(e).sort((function(t,n){return e[t]-e[n]}))}},414:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bottom=d,t.childrenEqual=function(e,t){return(0,r.default)(i.default.Children.map(e,(function(e){return null==e?void 0:e.key})),i.default.Children.map(t,(function(e){return null==e?void 0:e.key})))},t.cloneLayout=p,t.cloneLayoutItem=f,t.collides=g,t.compact=y,t.compactItem=w,t.compactType=function(e){var t=e||{},n=t.verticalCompact,r=t.compactType;return!1===n?null:r},t.correctBounds=S,t.fastPositionEqual=function(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height},t.fastRGLPropsEqual=void 0,t.getAllCollisions=_,t.getFirstCollision=x,t.getLayoutItem=E,t.getStatics=O,t.modifyLayout=h,t.moveElement=T,t.moveElementAwayFromCollision=C,t.noop=void 0,t.perc=function(e){return 100*e+"%"},t.setTopLeft=function(e){var t=e.top,n=e.left,r=e.width,i=e.height;return{top:"".concat(t,"px"),left:"".concat(n,"px"),width:"".concat(r,"px"),height:"".concat(i,"px"),position:"absolute"}},t.setTransform=function(e){var t=e.top,n=e.left,r=e.width,i=e.height,a="translate(".concat(n,"px,").concat(t,"px)");return{transform:a,WebkitTransform:a,MozTransform:a,msTransform:a,OTransform:a,width:"".concat(r,"px"),height:"".concat(i,"px"),position:"absolute"}},t.sortLayoutItems=k,t.sortLayoutItemsByColRow=A,t.sortLayoutItemsByRowCol=P,t.synchronizeLayoutWithChildren=function(e,t,n,r,a){e=e||[];var o=[];i.default.Children.forEach(t,(function(t){if(null!=(null==t?void 0:t.key)){var n=E(e,String(t.key));if(n)o.push(f(n));else{!c&&t.props._grid&&console.warn("`_grid` properties on children have been deprecated as of React 15.2. Please use `data-grid` or add your properties directly to the `layout`.");var r=t.props["data-grid"]||t.props._grid;r?(c||R([r],"ReactGridLayout.children"),o.push(f(s(s({},r),{},{i:t.key})))):o.push(f({w:1,h:1,x:0,y:d(o),i:String(t.key)}))}}}));var l=S(o,{cols:n});return a?l:y(l,r,n)},t.validateLayout=R,t.withLayoutItem=function(e,t,n){var r=E(e,t);return r?[e=h(e,r=n(f(r))),r]:[e,null]};var r=a(n(7842)),i=a(n(5959));function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=!0,u=!1;function d(e){for(var t,n=0,r=0,i=e.length;r<i;r++)(t=e[r].y+e[r].h)>n&&(n=t);return n}function p(e){for(var t=Array(e.length),n=0,r=e.length;n<r;n++)t[n]=f(e[n]);return t}function h(e,t){for(var n=Array(e.length),r=0,i=e.length;r<i;r++)t.i===e[r].i?n[r]=t:n[r]=e[r];return n}function f(e){return{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,minW:e.minW,maxW:e.maxW,minH:e.minH,maxH:e.maxH,moved:Boolean(e.moved),static:Boolean(e.static),isDraggable:e.isDraggable,isResizable:e.isResizable,resizeHandles:e.resizeHandles,isBounded:e.isBounded}}var m=n(7434);function g(e,t){return!(e.i===t.i||e.x+e.w<=t.x||e.x>=t.x+t.w||e.y+e.h<=t.y||e.y>=t.y+t.h)}function y(e,t,n){for(var r=O(e),i=k(e,t),a=Array(e.length),o=0,s=i.length;o<s;o++){var l=f(i[o]);l.static||(l=w(r,l,t,n,i),r.push(l)),a[e.indexOf(i[o])]=l,l.moved=!1}return a}t.fastRGLPropsEqual=m;var b={x:"w",y:"h"};function v(e,t,n,r){var i=b[r];t[r]+=1;for(var a=e.map((function(e){return e.i})).indexOf(t.i)+1;a<e.length;a++){var o=e[a];if(!o.static){if(o.y>t.y+t.h)break;g(t,o)&&v(e,o,n+t[i],r)}}t[r]=n}function w(e,t,n,r,i){var a,o="horizontal"===n;if("vertical"===n)for(t.y=Math.min(d(e),t.y);t.y>0&&!x(e,t);)t.y--;else if(o)for(;t.x>0&&!x(e,t);)t.x--;for(;a=x(e,t);)o?v(i,t,a.x+a.w,"x"):v(i,t,a.y+a.h,"y"),o&&t.x+t.w>r&&(t.x=r-t.w,t.y++);return t.y=Math.max(t.y,0),t.x=Math.max(t.x,0),t}function S(e,t){for(var n=O(e),r=0,i=e.length;r<i;r++){var a=e[r];if(a.x+a.w>t.cols&&(a.x=t.cols-a.w),a.x<0&&(a.x=0,a.w=t.cols),a.static)for(;x(n,a);)a.y++;else n.push(a)}return e}function E(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n].i===t)return e[n]}function x(e,t){for(var n=0,r=e.length;n<r;n++)if(g(e[n],t))return e[n]}function _(e,t){return e.filter((function(e){return g(e,t)}))}function O(e){return e.filter((function(e){return e.static}))}function T(e,t,n,r,i,a,o,s,l){if(t.static&&!0!==t.isDraggable)return e;if(t.y===r&&t.x===n)return e;D("Moving element ".concat(t.i," to [").concat(String(n),",").concat(String(r),"] from [").concat(t.x,",").concat(t.y,"]"));var c=t.x,u=t.y;"number"==typeof n&&(t.x=n),"number"==typeof r&&(t.y=r),t.moved=!0;var d=k(e,o);("vertical"===o&&"number"==typeof r?u>=r:"horizontal"===o&&"number"==typeof n&&c>=n)&&(d=d.reverse());var h=_(d,t),f=h.length>0;if(f&&l)return p(e);if(f&&a)return D("Collision prevented on ".concat(t.i,", reverting.")),t.x=c,t.y=u,t.moved=!1,e;for(var m=0,g=h.length;m<g;m++){var y=h[m];D("Resolving collision between ".concat(t.i," at [").concat(t.x,",").concat(t.y,"] and ").concat(y.i," at [").concat(y.x,",").concat(y.y,"]")),y.moved||(e=y.static?C(e,y,t,i,o,s):C(e,t,y,i,o,s))}return e}function C(e,t,n,r,i,a){var o="horizontal"===i,s="horizontal"!==i,l=t.static;if(r){r=!1;var c={x:o?Math.max(t.x-n.w,0):n.x,y:s?Math.max(t.y-n.h,0):n.y,w:n.w,h:n.h,i:"-1"};if(!x(e,c))return D("Doing reverse collision on ".concat(n.i," up to [").concat(c.x,",").concat(c.y,"].")),T(e,n,o?c.x:void 0,s?c.y:void 0,r,l,i,a)}return T(e,n,o?n.x+1:void 0,s?n.y+1:void 0,r,l,i,a)}function k(e,t){return"horizontal"===t?A(e):"vertical"===t?P(e):e}function P(e){return e.slice(0).sort((function(e,t){return e.y>t.y||e.y===t.y&&e.x>t.x?1:e.y===t.y&&e.x===t.x?0:-1}))}function A(e){return e.slice(0).sort((function(e,t){return e.x>t.x||e.x===t.x&&e.y>t.y?1:-1}))}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Layout",n=["x","y","w","h"];if(!Array.isArray(e))throw new Error(t+" must be an array!");for(var r=0,i=e.length;r<i;r++)for(var a=e[r],o=0;o<n.length;o++)if("number"!=typeof a[n[o]])throw new Error("ReactGridLayout: "+t+"["+r+"]."+n[o]+" must be a number!")}function D(){var e;u&&(e=console).log.apply(e,arguments)}t.noop=function(){}},2548:(e,t,n)=>{e.exports=n(9482).default,e.exports.utils=n(414),e.exports.Responsive=n(4636).default,e.exports.Responsive.utils=n(544),e.exports.WidthProvider=n(6805).default},7256:(e,t,n)=>{"use strict";function r(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function i(){for(var e,t,n=0,i="";n<arguments.length;)(e=arguments[n++])&&(t=r(e))&&(i&&(i+=" "),i+=t);return i}n.r(t),n.d(t,{clsx:()=>i,default:()=>a});const a=i},1794:(e,t,n)=>{"use strict";t.__esModule=!0,t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(5959)),i=n(8230),a=n(9954),o=n(6333),s=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}var f=function(e){var t,n;function o(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).handleRefs={},t.lastHandleRect=null,t.slack=null,t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,h(t,n);var l=o.prototype;return l.componentWillUnmount=function(){this.resetData()},l.resetData=function(){this.lastHandleRect=this.slack=null},l.runConstraints=function(e,t){var n=this.props,r=n.minConstraints,i=n.maxConstraints,a=n.lockAspectRatio;if(!r&&!i&&!a)return[e,t];if(a){var o=this.props.width/this.props.height,s=e-this.props.width,l=t-this.props.height;Math.abs(s)>Math.abs(l*o)?t=e/o:e=t*o}var c=e,u=t,d=this.slack||[0,0],p=d[0],h=d[1];return e+=p,t+=h,r&&(e=Math.max(r[0],e),t=Math.max(r[1],t)),i&&(e=Math.min(i[0],e),t=Math.min(i[1],t)),this.slack=[p+(c-e),h+(u-t)],[e,t]},l.resizeHandler=function(e,t){var n=this;return function(r,i){var a=i.node,o=i.deltaX,s=i.deltaY;"onResizeStart"===e&&n.resetData();var l=("both"===n.props.axis||"x"===n.props.axis)&&"n"!==t&&"s"!==t,c=("both"===n.props.axis||"y"===n.props.axis)&&"e"!==t&&"w"!==t;if(l||c){var u=t[0],d=t[t.length-1],p=a.getBoundingClientRect();null!=n.lastHandleRect&&("w"===d&&(o+=p.left-n.lastHandleRect.left),"n"===u&&(s+=p.top-n.lastHandleRect.top)),n.lastHandleRect=p,"w"===d&&(o=-o),"n"===u&&(s=-s);var h=n.props.width+(l?o/n.props.transformScale:0),f=n.props.height+(c?s/n.props.transformScale:0),m=n.runConstraints(h,f);h=m[0],f=m[1];var g=h!==n.props.width||f!==n.props.height,y="function"==typeof n.props[e]?n.props[e]:null;y&&!("onResize"===e&&!g)&&(null==r.persist||r.persist(),y(r,{node:a,size:{width:h,height:f},handle:t})),"onResizeStop"===e&&n.resetData()}}},l.renderResizeHandle=function(e,t){var n=this.props.handle;if(!n)return r.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+e,ref:t});if("function"==typeof n)return n(e,t);var i=d({ref:t},"string"==typeof n.type?{}:{handleAxis:e});return r.cloneElement(n,i)},l.render=function(){var e=this,t=this.props,n=t.children,o=t.className,l=t.draggableOpts,u=(t.width,t.height,t.handle,t.handleSize,t.lockAspectRatio,t.axis,t.minConstraints,t.maxConstraints,t.onResize,t.onResizeStop,t.onResizeStart,t.resizeHandles),p=(t.transformScale,function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(t,s));return(0,a.cloneElement)(n,d(d({},p),{},{className:(o?o+" ":"")+"react-resizable",children:[].concat(n.props.children,u.map((function(t){var n,a=null!=(n=e.handleRefs[t])?n:e.handleRefs[t]=r.createRef();return r.createElement(i.DraggableCore,c({},l,{nodeRef:a,key:"resizableHandle-"+t,onStop:e.resizeHandler("onResizeStop",t),onStart:e.resizeHandler("onResizeStart",t),onDrag:e.resizeHandler("onResize",t)}),e.renderResizeHandle(t,a))})))}))},o}(r.Component);t.default=f,f.propTypes=o.resizableProps,f.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1}},6609:(e,t,n)=>{"use strict";t.default=void 0;var r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}(n(5959)),i=l(n(2688)),a=l(n(1794)),o=n(6333),s=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function l(e){return e&&e.__esModule?e:{default:e}}function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}var m=function(e){var t,n;function i(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).state={width:t.props.width,height:t.props.height,propsWidth:t.props.width,propsHeight:t.props.height},t.onResize=function(e,n){var r=n.size;t.props.onResize?(null==e.persist||e.persist(),t.setState(r,(function(){return t.props.onResize&&t.props.onResize(e,n)}))):t.setState(r)},t}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,f(t,n),i.getDerivedStateFromProps=function(e,t){return t.propsWidth!==e.width||t.propsHeight!==e.height?{width:e.width,height:e.height,propsWidth:e.width,propsHeight:e.height}:null},i.prototype.render=function(){var e=this.props,t=e.handle,n=e.handleSize,i=(e.onResize,e.onResizeStart),o=e.onResizeStop,l=e.draggableOpts,c=e.minConstraints,d=e.maxConstraints,h=e.lockAspectRatio,f=e.axis,m=(e.width,e.height,e.resizeHandles),g=e.style,y=e.transformScale,b=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,s);return r.createElement(a.default,{axis:f,draggableOpts:l,handle:t,handleSize:n,height:this.state.height,lockAspectRatio:h,maxConstraints:d,minConstraints:c,onResizeStart:i,onResize:this.onResize,onResizeStop:o,resizeHandles:m,transformScale:y,width:this.state.width},r.createElement("div",u({},b,{style:p(p({},g),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},i}(r.Component);t.default=m,m.propTypes=p(p({},o.resizableProps),{},{children:i.default.element})},6333:(e,t,n)=>{"use strict";t.__esModule=!0,t.resizableProps=void 0;var r,i=(r=n(2688))&&r.__esModule?r:{default:r};n(8230);var a={axis:i.default.oneOf(["both","x","y","none"]),className:i.default.string,children:i.default.element.isRequired,draggableOpts:i.default.shape({allowAnyClick:i.default.bool,cancel:i.default.string,children:i.default.node,disabled:i.default.bool,enableUserSelectHack:i.default.bool,offsetParent:i.default.node,grid:i.default.arrayOf(i.default.number),handle:i.default.string,nodeRef:i.default.object,onStart:i.default.func,onDrag:i.default.func,onStop:i.default.func,onMouseDown:i.default.func,scale:i.default.number}),height:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,a=t[0];return"both"===a.axis||"y"===a.axis?(r=i.default.number).isRequired.apply(r,t):i.default.number.apply(i.default,t)},handle:i.default.oneOfType([i.default.node,i.default.func]),handleSize:i.default.arrayOf(i.default.number),lockAspectRatio:i.default.bool,maxConstraints:i.default.arrayOf(i.default.number),minConstraints:i.default.arrayOf(i.default.number),onResizeStop:i.default.func,onResizeStart:i.default.func,onResize:i.default.func,resizeHandles:i.default.arrayOf(i.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:i.default.number,width:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,a=t[0];return"both"===a.axis||"x"===a.axis?(r=i.default.number).isRequired.apply(r,t):i.default.number.apply(i.default,t)}};t.resizableProps=a},9954:(e,t,n)=>{"use strict";t.__esModule=!0,t.cloneElement=function(e,t){return t.style&&e.props.style&&(t.style=o(o({},e.props.style),t.style)),t.className&&e.props.className&&(t.className=e.props.className+" "+t.className),i.default.cloneElement(e,t)};var r,i=(r=n(5959))&&r.__esModule?r:{default:r};function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},936:(e,t,n)=>{"use strict";e.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")},e.exports.Resizable=n(1794).default,e.exports.ResizableBox=n(6609).default},9406:(e,t,n)=>{"use strict";var r,i=n(5959),a=(r=i)&&"object"==typeof r&&"default"in r?r.default:r;function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=!("undefined"==typeof window||!window.document||!window.document.createElement);e.exports=function(e,t,n){if("function"!=typeof e)throw new Error("Expected reducePropsToState to be a function.");if("function"!=typeof t)throw new Error("Expected handleStateChangeOnClient to be a function.");if(void 0!==n&&"function"!=typeof n)throw new Error("Expected mapStateOnServer to either be undefined or a function.");return function(r){if("function"!=typeof r)throw new Error("Expected WrappedComponent to be a React component.");var l,c=[];function u(){l=e(c.map((function(e){return e.props}))),d.canUseDOM?t(l):n&&(l=n(l))}var d=function(e){var t,n;function i(){return e.apply(this,arguments)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,i.peek=function(){return l},i.rewind=function(){if(i.canUseDOM)throw new Error("You may only call rewind() on the server. Call peek() to read the current state.");var e=l;return l=void 0,c=[],e};var o=i.prototype;return o.UNSAFE_componentWillMount=function(){c.push(this),u()},o.componentDidUpdate=function(){u()},o.componentWillUnmount=function(){var e=c.indexOf(this);c.splice(e,1),u()},o.render=function(){return a.createElement(r,this.props)},i}(i.PureComponent);return o(d,"displayName","SideEffect("+function(e){return e.displayName||e.name||"Component"}(r)+")"),o(d,"canUseDOM",s),d}}},4386:(e,t,n)=>{"use strict";var r=n(4629),i=n(5959),a=r.__importDefault(n(5690));t.A=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var r=a.default(e,t),o=r[0],s=r[1],l=r[2];return i.useEffect(l,n),[o,s]}},1336:(e,t,n)=>{"use strict";var r=n(5959);t.A=function(e){var t=r.useRef();return r.useEffect((function(){t.current=e})),t.current}},5690:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5959);t.default=function(e,t){void 0===t&&(t=0);var n=r.useRef(!1),i=r.useRef(),a=r.useRef(e),o=r.useCallback((function(){return n.current}),[]),s=r.useCallback((function(){n.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){n.current=!0,a.current()}),t)}),[t]),l=r.useCallback((function(){n.current=null,i.current&&clearTimeout(i.current)}),[]);return r.useEffect((function(){a.current=e}),[e]),r.useEffect((function(){return s(),l}),[t]),[o,l,s]}},2192:(e,t,n)=>{"use strict";var r=n(5959),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},2540:(e,t,n)=>{"use strict";e.exports=n(2192)},9524:(e,t,n)=>{const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(e,t){if(t=a(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new u(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):!((t=a(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=i;const a=n(7095),{safeRe:o,t:s}=n(6850),l=n(3811),c=n(9796),u=n(7944),d=n(8395)},8395:(e,t,n)=>{class r{constructor(e,t){if(t=a(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof o)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!g(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&f)|(this.options.loose&&m))+":"+e,n=i.get(t);if(n)return n;const r=this.options.loose,a=r?c[u.HYPHENRANGELOOSE]:c[u.HYPHENRANGE];e=e.replace(a,P(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(c[u.COMPARATORTRIM],d),s("comparator trim",e),e=e.replace(c[u.TILDETRIM],p),s("tilde trim",e),e=e.replace(c[u.CARETTRIM],h),s("caret trim",e);let l=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>k(e,this.options)));r&&(l=l.filter((e=>(s("loose invalid filter",e,this.options),!!e.match(c[u.COMPARATORLOOSE]))))),s("range list",l);const y=new Map,b=l.map((e=>new o(e,this.options)));for(const e of b){if(g(e))return[e];y.set(e.value,e)}y.size>1&&y.has("")&&y.delete("");const w=[...y.values()];return i.set(t,w),w}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some((n=>b(n,t)&&e.set.some((e=>b(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(A(this.set[t],e,this.options))return!0;return!1}}e.exports=r;const i=new(n(1158)),a=n(7095),o=n(9524),s=n(9796),l=n(7944),{safeRe:c,t:u,comparatorTrimReplace:d,tildeTrimReplace:p,caretTrimReplace:h}=n(6850),{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:m}=n(9630),g=e=>"<0.0.0-0"===e.value,y=e=>""===e.value,b=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every((e=>i.intersects(e,t))),i=r.pop();return n},v=(e,t)=>(s("comp",e,t),e=x(e,t),s("caret",e),e=S(e,t),s("tildes",e),e=O(e,t),s("xrange",e),e=C(e,t),s("stars",e),e),w=e=>!e||"x"===e.toLowerCase()||"*"===e,S=(e,t)=>e.trim().split(/\s+/).map((e=>E(e,t))).join(" "),E=(e,t)=>{const n=t.loose?c[u.TILDELOOSE]:c[u.TILDE];return e.replace(n,((t,n,r,i,a)=>{let o;return s("tilde",e,t,n,r,i,a),w(n)?o="":w(r)?o=`>=${n}.0.0 <${+n+1}.0.0-0`:w(i)?o=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:a?(s("replaceTilde pr",a),o=`>=${n}.${r}.${i}-${a} <${n}.${+r+1}.0-0`):o=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,s("tilde return",o),o}))},x=(e,t)=>e.trim().split(/\s+/).map((e=>_(e,t))).join(" "),_=(e,t)=>{s("caret",e,t);const n=t.loose?c[u.CARETLOOSE]:c[u.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,a,o)=>{let l;return s("caret",e,t,n,i,a,o),w(n)?l="":w(i)?l=`>=${n}.0.0${r} <${+n+1}.0.0-0`:w(a)?l="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:o?(s("replaceCaret pr",o),l="0"===n?"0"===i?`>=${n}.${i}.${a}-${o} <${n}.${i}.${+a+1}-0`:`>=${n}.${i}.${a}-${o} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${a}-${o} <${+n+1}.0.0-0`):(s("no pr"),l="0"===n?"0"===i?`>=${n}.${i}.${a}${r} <${n}.${i}.${+a+1}-0`:`>=${n}.${i}.${a}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${a} <${+n+1}.0.0-0`),s("caret return",l),l}))},O=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>T(e,t))).join(" ")),T=(e,t)=>{e=e.trim();const n=t.loose?c[u.XRANGELOOSE]:c[u.XRANGE];return e.replace(n,((n,r,i,a,o,l)=>{s("xRange",e,n,r,i,a,o,l);const c=w(i),u=c||w(a),d=u||w(o),p=d;return"="===r&&p&&(r=""),l=t.includePrerelease?"-0":"",c?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&p?(u&&(a=0),o=0,">"===r?(r=">=",u?(i=+i+1,a=0,o=0):(a=+a+1,o=0)):"<="===r&&(r="<",u?i=+i+1:a=+a+1),"<"===r&&(l="-0"),n=`${r+i}.${a}.${o}${l}`):u?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${a}.0${l} <${i}.${+a+1}.0-0`),s("xRange return",n),n}))},C=(e,t)=>(s("replaceStars",e,t),e.trim().replace(c[u.STAR],"")),k=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(c[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),P=e=>(t,n,r,i,a,o,s,l,c,u,d,p)=>`${n=w(r)?"":w(i)?`>=${r}.0.0${e?"-0":""}`:w(a)?`>=${r}.${i}.0${e?"-0":""}`:o?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=w(c)?"":w(u)?`<${+c+1}.0.0-0`:w(d)?`<${c}.${+u+1}.0-0`:p?`<=${c}.${u}.${d}-${p}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),A=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(s(e[n].semver),e[n].semver!==o.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},7944:(e,t,n)=>{const r=n(9796),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=n(9630),{safeRe:o,t:s}=n(6850),l=n(7095),{compareIdentifiers:c}=n(4031);class u{constructor(e,t){if(t=l(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<a)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},7994:(e,t,n)=>{const r=n(5860);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},3811:(e,t,n)=>{const r=n(6909),i=n(7659),a=n(144),o=n(2077),s=n(599),l=n(7092);e.exports=(e,t,n,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,c);case"!=":return i(e,n,c);case">":return a(e,n,c);case">=":return o(e,n,c);case"<":return s(e,n,c);case"<=":return l(e,n,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},5334:(e,t,n)=>{const r=n(7944),i=n(5860),{safeRe:a,t:o}=n(6850);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){const r=t.includePrerelease?a[o.COERCERTLFULL]:a[o.COERCERTL];let i;for(;(i=r.exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),r.lastIndex=i.index+i[1].length+i[2].length;r.lastIndex=-1}else n=e.match(t.includePrerelease?a[o.COERCEFULL]:a[o.COERCE]);if(null===n)return null;const s=n[2],l=n[3]||"0",c=n[4]||"0",u=t.includePrerelease&&n[5]?`-${n[5]}`:"",d=t.includePrerelease&&n[6]?`+${n[6]}`:"";return i(`${s}.${l}.${c}${u}${d}`,t)}},2801:(e,t,n)=>{const r=n(7944);e.exports=(e,t,n)=>{const i=new r(e,n),a=new r(t,n);return i.compare(a)||i.compareBuild(a)}},7023:(e,t,n)=>{const r=n(5380);e.exports=(e,t)=>r(e,t,!0)},5380:(e,t,n)=>{const r=n(7944);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},660:(e,t,n)=>{const r=n(5860);e.exports=(e,t)=>{const n=r(e,null,!0),i=r(t,null,!0),a=n.compare(i);if(0===a)return null;const o=a>0,s=o?n:i,l=o?i:n,c=!!s.prerelease.length;if(l.prerelease.length&&!c)return l.patch||l.minor?s.patch?"patch":s.minor?"minor":"major":"major";const u=c?"pre":"";return n.major!==i.major?u+"major":n.minor!==i.minor?u+"minor":n.patch!==i.patch?u+"patch":"prerelease"}},6909:(e,t,n)=>{const r=n(5380);e.exports=(e,t,n)=>0===r(e,t,n)},144:(e,t,n)=>{const r=n(5380);e.exports=(e,t,n)=>r(e,t,n)>0},2077:(e,t,n)=>{const r=n(5380);e.exports=(e,t,n)=>r(e,t,n)>=0},5955:(e,t,n)=>{const r=n(7944);e.exports=(e,t,n,i,a)=>{"string"==typeof n&&(a=i,i=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,i,a).version}catch(e){return null}}},599:(e,t,n)=>{const r=n(5380);e.exports=(e,t,n)=>r(e,t,n)<0},7092:(e,t,n)=>{const r=n(5380);e.exports=(e,t,n)=>r(e,t,n)<=0},2966:(e,t,n)=>{const r=n(7944);e.exports=(e,t)=>new r(e,t).major},5986:(e,t,n)=>{const r=n(7944);e.exports=(e,t)=>new r(e,t).minor},7659:(e,t,n)=>{const r=n(5380);e.exports=(e,t,n)=>0!==r(e,t,n)},5860:(e,t,n)=>{const r=n(7944);e.exports=(e,t,n=!1)=>{if(e instanceof r)return e;try{return new r(e,t)}catch(e){if(!n)return null;throw e}}},1617:(e,t,n)=>{const r=n(7944);e.exports=(e,t)=>new r(e,t).patch},9613:(e,t,n)=>{const r=n(5860);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},2862:(e,t,n)=>{const r=n(5380);e.exports=(e,t,n)=>r(t,e,n)},6033:(e,t,n)=>{const r=n(2801);e.exports=(e,t)=>e.sort(((e,n)=>r(n,e,t)))},1722:(e,t,n)=>{const r=n(8395);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(e){return!1}return t.test(e)}},603:(e,t,n)=>{const r=n(2801);e.exports=(e,t)=>e.sort(((e,n)=>r(e,n,t)))},7645:(e,t,n)=>{const r=n(5860);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},8449:(e,t,n)=>{const r=n(6850),i=n(9630),a=n(7944),o=n(4031),s=n(5860),l=n(7645),c=n(7994),u=n(5955),d=n(660),p=n(2966),h=n(5986),f=n(1617),m=n(9613),g=n(5380),y=n(2862),b=n(7023),v=n(2801),w=n(603),S=n(6033),E=n(144),x=n(599),_=n(6909),O=n(7659),T=n(2077),C=n(7092),k=n(3811),P=n(5334),A=n(9524),R=n(8395),D=n(1722),j=n(651),I=n(7840),N=n(7930),L=n(3489),M=n(7494),F=n(5463),$=n(7871),B=n(4266),V=n(1112),z=n(1465),U=n(9252);e.exports={parse:s,valid:l,clean:c,inc:u,diff:d,major:p,minor:h,patch:f,prerelease:m,compare:g,rcompare:y,compareLoose:b,compareBuild:v,sort:w,rsort:S,gt:E,lt:x,eq:_,neq:O,gte:T,lte:C,cmp:k,coerce:P,Comparator:A,Range:R,satisfies:D,toComparators:j,maxSatisfying:I,minSatisfying:N,minVersion:L,validRange:M,outside:F,gtr:$,ltr:B,intersects:V,simplifyRange:z,subset:U,SemVer:a,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},9630:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},9796:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},4031:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},1158:e=>{e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},7095:e=>{const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:n},6850:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:a}=n(9630),o=n(9796),s=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.t={};let d=0;const p="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",a],[p,i]],f=(e,t,n)=>{const r=(e=>{for(const[t,n]of h)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;o(e,i,t),u[e]=i,c[i]=t,s[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(r,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),f("MAINVERSION",`(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})\\.(${c[u.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})\\.(${c[u.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${c[u.NUMERICIDENTIFIER]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${c[u.NUMERICIDENTIFIERLOOSE]}|${c[u.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${c[u.PRERELEASEIDENTIFIER]}(?:\\.${c[u.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${c[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[u.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${p}+`),f("BUILD",`(?:\\+(${c[u.BUILDIDENTIFIER]}(?:\\.${c[u.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${c[u.MAINVERSION]}${c[u.PRERELEASE]}?${c[u.BUILD]}?`),f("FULL",`^${c[u.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${c[u.MAINVERSIONLOOSE]}${c[u.PRERELEASELOOSE]}?${c[u.BUILD]}?`),f("LOOSE",`^${c[u.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${c[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${c[u.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:\\.(${c[u.XRANGEIDENTIFIER]})(?:${c[u.PRERELEASE]})?${c[u.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[u.XRANGEIDENTIFIERLOOSE]})(?:${c[u.PRERELEASELOOSE]})?${c[u.BUILD]}?)?)?`),f("XRANGE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${c[u.GTLT]}\\s*${c[u.XRANGEPLAINLOOSE]}$`),f("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),f("COERCE",`${c[u.COERCEPLAIN]}(?:$|[^\\d])`),f("COERCEFULL",c[u.COERCEPLAIN]+`(?:${c[u.PRERELEASE]})?`+`(?:${c[u.BUILD]})?(?:$|[^\\d])`),f("COERCERTL",c[u.COERCE],!0),f("COERCERTLFULL",c[u.COERCEFULL],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${c[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${c[u.LONETILDE]}${c[u.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${c[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${c[u.LONECARET]}${c[u.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${c[u.LONECARET]}${c[u.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${c[u.GTLT]}\\s*(${c[u.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${c[u.GTLT]}\\s*(${c[u.LOOSEPLAIN]}|${c[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${c[u.XRANGEPLAIN]})\\s+-\\s+(${c[u.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${c[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[u.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},7871:(e,t,n)=>{const r=n(5463);e.exports=(e,t,n)=>r(e,t,">",n)},1112:(e,t,n)=>{const r=n(8395);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t,n))},4266:(e,t,n)=>{const r=n(5463);e.exports=(e,t,n)=>r(e,t,"<",n)},7840:(e,t,n)=>{const r=n(7944),i=n(8395);e.exports=(e,t,n)=>{let a=null,o=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(a&&-1!==o.compare(e)||(a=e,o=new r(a,n)))})),a}},7930:(e,t,n)=>{const r=n(7944),i=n(8395);e.exports=(e,t,n)=>{let a=null,o=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach((e=>{s.test(e)&&(a&&1!==o.compare(e)||(a=e,o=new r(a,n)))})),a}},3489:(e,t,n)=>{const r=n(7944),i=n(8395),a=n(144);e.exports=(e,t)=>{e=new i(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let o=null;i.forEach((e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!a(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!o||n&&!a(n,o)||(n=o)}return n&&e.test(n)?n:null}},5463:(e,t,n)=>{const r=n(7944),i=n(9524),{ANY:a}=i,o=n(8395),s=n(1722),l=n(144),c=n(599),u=n(7092),d=n(2077);e.exports=(e,t,n,p)=>{let h,f,m,g,y;switch(e=new r(e,p),t=new o(t,p),n){case">":h=l,f=u,m=c,g=">",y=">=";break;case"<":h=c,f=d,m=l,g="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,p))return!1;for(let n=0;n<t.set.length;++n){const r=t.set[n];let o=null,s=null;if(r.forEach((e=>{e.semver===a&&(e=new i(">=0.0.0")),o=o||e,s=s||e,h(e.semver,o.semver,p)?o=e:m(e.semver,s.semver,p)&&(s=e)})),o.operator===g||o.operator===y)return!1;if((!s.operator||s.operator===g)&&f(e,s.semver))return!1;if(s.operator===y&&m(e,s.semver))return!1}return!0}},1465:(e,t,n)=>{const r=n(1722),i=n(5380);e.exports=(e,t,n)=>{const a=[];let o=null,s=null;const l=e.sort(((e,t)=>i(e,t,n)));for(const e of l)r(e,t,n)?(s=e,o||(o=e)):(s&&a.push([o,s]),s=null,o=null);o&&a.push([o,null]);const c=[];for(const[e,t]of a)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},9252:(e,t,n)=>{const r=n(8395),i=n(9524),{ANY:a}=i,o=n(1722),s=n(5380),l=[new i(">=0.0.0-0")],c=[new i(">=0.0.0")],u=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===a){if(1===t.length&&t[0].semver===a)return!0;e=n.includePrerelease?l:c}if(1===t.length&&t[0].semver===a){if(n.includePrerelease)return!0;t=c}const r=new Set;let i,u,h,f,m,g,y;for(const t of e)">"===t.operator||">="===t.operator?i=d(i,t,n):"<"===t.operator||"<="===t.operator?u=p(u,t,n):r.add(t.semver);if(r.size>1)return null;if(i&&u){if(h=s(i.semver,u.semver,n),h>0)return null;if(0===h&&(">="!==i.operator||"<="!==u.operator))return null}for(const e of r){if(i&&!o(e,String(i),n))return null;if(u&&!o(e,String(u),n))return null;for(const r of t)if(!o(e,String(r),n))return!1;return!0}let b=!(!u||n.includePrerelease||!u.semver.prerelease.length)&&u.semver,v=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;b&&1===b.prerelease.length&&"<"===u.operator&&0===b.prerelease[0]&&(b=!1);for(const e of t){if(y=y||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,i)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),">"===e.operator||">="===e.operator){if(f=d(i,e,n),f===e&&f!==i)return!1}else if(">="===i.operator&&!o(i.semver,String(e),n))return!1;if(u)if(b&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===b.major&&e.semver.minor===b.minor&&e.semver.patch===b.patch&&(b=!1),"<"===e.operator||"<="===e.operator){if(m=p(u,e,n),m===e&&m!==u)return!1}else if("<="===u.operator&&!o(u.semver,String(e),n))return!1;if(!e.operator&&(u||i)&&0!==h)return!1}return!(i&&g&&!u&&0!==h||u&&y&&!i&&0!==h||v||b)},d=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new r(e,n),t=new r(t,n);let i=!1;e:for(const r of e.set){for(const e of t.set){const t=u(r,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},651:(e,t,n)=>{const r=n(8395);e.exports=(e,t)=>new r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},7494:(e,t,n)=>{const r=n(8395);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},6852:(e,t,n)=>{"use strict";var r=n(8036),i=Array.prototype.concat,a=Array.prototype.slice,o=e.exports=function(e){for(var t=[],n=0,o=e.length;n<o;n++){var s=e[n];r(s)?t=i.call(t,a.call(s)):t.push(s)}return t};o.wrap=function(e){return function(){return e(o(arguments))}}},8036:e=>{e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},6660:function(e,t,n){var r;!function(i,a){"use strict";var o="function",s="undefined",l="object",c="string",u="major",d="model",p="name",h="type",f="vendor",m="version",g="architecture",y="console",b="mobile",v="tablet",w="smarttv",S="wearable",E="embedded",x="Amazon",_="Apple",O="ASUS",T="BlackBerry",C="Browser",k="Chrome",P="Firefox",A="Google",R="Huawei",D="LG",j="Microsoft",I="Motorola",N="Opera",L="Samsung",M="Sharp",F="Sony",$="Xiaomi",B="Zebra",V="Facebook",z="Chromium OS",U="Mac OS",q=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},H=function(e,t){return typeof e===c&&-1!==G(t).indexOf(G(e))},G=function(e){return e.toLowerCase()},W=function(e,t){if(typeof e===c)return e=e.replace(/^\s\s*/,""),typeof t===s?e:e.substring(0,500)},Q=function(e,t){for(var n,r,i,s,c,u,d=0;d<t.length&&!c;){var p=t[d],h=t[d+1];for(n=r=0;n<p.length&&!c&&p[n];)if(c=p[n++].exec(e))for(i=0;i<h.length;i++)u=c[++r],typeof(s=h[i])===l&&s.length>0?2===s.length?typeof s[1]==o?this[s[0]]=s[1].call(this,u):this[s[0]]=s[1]:3===s.length?typeof s[1]!==o||s[1].exec&&s[1].test?this[s[0]]=u?u.replace(s[1],s[2]):a:this[s[0]]=u?s[1].call(this,u,s[2]):a:4===s.length&&(this[s[0]]=u?s[3].call(this,u.replace(s[1],s[2])):a):this[s]=u||a;d+=2}},K=function(e,t){for(var n in t)if(typeof t[n]===l&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(H(t[n][r],e))return"?"===n?a:n}else if(H(t[n],e))return"?"===n?a:n;return e},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},X={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[p,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[p,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[p,m],[/opios[\/ ]+([\w\.]+)/i],[m,[p,N+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[m,[p,N+" GX"]],[/\bopr\/([\w\.]+)/i],[m,[p,N]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[p,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[p,m],[/\bddg\/([\w\.]+)/i],[m,[p,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[p,"UC"+C]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[p,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[p,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[p,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[p,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[p,"Smart Lenovo "+C]],[/(avast|avg)\/([\w\.]+)/i],[[p,/(.+)/,"$1 Secure "+C],m],[/\bfocus\/([\w\.]+)/i],[m,[p,P+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[p,N+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[p,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[p,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[p,N+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[p,"MIUI "+C]],[/fxios\/([-\w\.]+)/i],[m,[p,P]],[/\bqihu|(qi?ho?o?|360)browser/i],[[p,"360 "+C]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[p,/(.+)/,"$1 "+C],m],[/samsungbrowser\/([\w\.]+)/i],[m,[p,L+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[p,/_/g," "],m],[/metasr[\/ ]?([\d\.]+)/i],[m,[p,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[p,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[p,m],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[p],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[p,V],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[p,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[p,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[p,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[p,k+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[p,k+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[p,"Android "+C]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[p,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[p,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,p],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[p,[m,K,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[p,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[p,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[p,P+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[p,m],[/(cobalt)\/([\w\.]+)/i],[p,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,G]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,"",G]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,G]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[f,L],[h,v]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[d,[f,L],[h,b]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[f,_],[h,b]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[f,_],[h,v]],[/(macintosh);/i],[d,[f,_]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[f,M],[h,b]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[f,R],[h,v]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[f,R],[h,b]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[d,/_/g," "],[f,$],[h,b]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[f,$],[h,v]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[f,"OPPO"],[h,b]],[/\b(opd2\d{3}a?) bui/i],[d,[f,"OPPO"],[h,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[f,"Vivo"],[h,b]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[f,"Realme"],[h,b]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[f,I],[h,b]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[f,I],[h,v]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[f,D],[h,v]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[f,D],[h,b]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[f,"Lenovo"],[h,v]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[f,"Nokia"],[h,b]],[/(pixel c)\b/i],[d,[f,A],[h,v]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[f,A],[h,b]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[f,F],[h,b]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[f,F],[h,v]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[f,"OnePlus"],[h,b]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[f,x],[h,v]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[f,x],[h,b]],[/(playbook);[-\w\),; ]+(rim)/i],[d,f,[h,v]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[f,T],[h,b]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[f,O],[h,v]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[f,O],[h,b]],[/(nexus 9)/i],[d,[f,"HTC"],[h,v]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[f,[d,/_/g," "],[h,b]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[f,"Acer"],[h,v]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[f,"Meizu"],[h,b]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[f,"Ulefone"],[h,b]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[f,d,[h,b]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[f,d,[h,v]],[/(surface duo)/i],[d,[f,j],[h,v]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[f,"Fairphone"],[h,b]],[/(u304aa)/i],[d,[f,"AT&T"],[h,b]],[/\bsie-(\w*)/i],[d,[f,"Siemens"],[h,b]],[/\b(rct\w+) b/i],[d,[f,"RCA"],[h,v]],[/\b(venue[\d ]{2,7}) b/i],[d,[f,"Dell"],[h,v]],[/\b(q(?:mv|ta)\w+) b/i],[d,[f,"Verizon"],[h,v]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[f,"Barnes & Noble"],[h,v]],[/\b(tm\d{3}\w+) b/i],[d,[f,"NuVision"],[h,v]],[/\b(k88) b/i],[d,[f,"ZTE"],[h,v]],[/\b(nx\d{3}j) b/i],[d,[f,"ZTE"],[h,b]],[/\b(gen\d{3}) b.+49h/i],[d,[f,"Swiss"],[h,b]],[/\b(zur\d{3}) b/i],[d,[f,"Swiss"],[h,v]],[/\b((zeki)?tb.*\b) b/i],[d,[f,"Zeki"],[h,v]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[f,"Dragon Touch"],d,[h,v]],[/\b(ns-?\w{0,9}) b/i],[d,[f,"Insignia"],[h,v]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[f,"NextBook"],[h,v]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[f,"Voice"],d,[h,b]],[/\b(lvtel\-)?(v1[12]) b/i],[[f,"LvTel"],d,[h,b]],[/\b(ph-1) /i],[d,[f,"Essential"],[h,b]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[f,"Envizen"],[h,v]],[/\b(trio[-\w\. ]+) b/i],[d,[f,"MachSpeed"],[h,v]],[/\btu_(1491) b/i],[d,[f,"Rotor"],[h,v]],[/(shield[\w ]+) b/i],[d,[f,"Nvidia"],[h,v]],[/(sprint) (\w+)/i],[f,d,[h,b]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[f,j],[h,b]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[f,B],[h,v]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[f,B],[h,b]],[/smart-tv.+(samsung)/i],[f,[h,w]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[f,L],[h,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[f,D],[h,w]],[/(apple) ?tv/i],[f,[d,_+" TV"],[h,w]],[/crkey/i],[[d,k+"cast"],[f,A],[h,w]],[/droid.+aft(\w+)( bui|\))/i],[d,[f,x],[h,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[f,M],[h,w]],[/(bravia[\w ]+)( bui|\))/i],[d,[f,F],[h,w]],[/(mitv-\w{5}) bui/i],[d,[f,$],[h,w]],[/Hbbtv.*(technisat) (.*);/i],[f,d,[h,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[f,W],[d,W],[h,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[f,d,[h,y]],[/droid.+; (shield) bui/i],[d,[f,"Nvidia"],[h,y]],[/(playstation [345portablevi]+)/i],[d,[f,F],[h,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[f,j],[h,y]],[/((pebble))app/i],[f,d,[h,S]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[f,_],[h,S]],[/droid.+; (glass) \d/i],[d,[f,A],[h,S]],[/droid.+; (wt63?0{2,3})\)/i],[d,[f,B],[h,S]],[/(quest( \d| pro)?)/i],[d,[f,V],[h,S]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[f,[h,E]],[/(aeobc)\b/i],[d,[f,x],[h,E]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[h,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[h,v]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,v]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,b]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[f,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[p,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[p,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[p,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,p]],os:[[/microsoft (windows) (vista|xp)/i],[p,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[p,[m,K,Y]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,K,Y],[p,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[p,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[p,U],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,p],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[p,m],[/\(bb(10);/i],[m,[p,T]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[p,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[p,P+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[p,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[p,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[p,k+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[p,z],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[p,m],[/(sunos) ?([\w\.\d]*)/i],[[p,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[p,m]]},J=function(e,t){if(typeof e===l&&(t=e,e=a),!(this instanceof J))return new J(e,t).getResult();var n=typeof i!==s&&i.navigator?i.navigator:a,r=e||(n&&n.userAgent?n.userAgent:""),y=n&&n.userAgentData?n.userAgentData:a,w=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(X,t):X,S=n&&n.userAgent==r;return this.getBrowser=function(){var e,t={};return t[p]=a,t[m]=a,Q.call(t,r,w.browser),t[u]=typeof(e=t[m])===c?e.replace(/[^\d\.]/g,"").split(".")[0]:a,S&&n&&n.brave&&typeof n.brave.isBrave==o&&(t[p]="Brave"),t},this.getCPU=function(){var e={};return e[g]=a,Q.call(e,r,w.cpu),e},this.getDevice=function(){var e={};return e[f]=a,e[d]=a,e[h]=a,Q.call(e,r,w.device),S&&!e[h]&&y&&y.mobile&&(e[h]=b),S&&"Macintosh"==e[d]&&n&&typeof n.standalone!==s&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[h]=v),e},this.getEngine=function(){var e={};return e[p]=a,e[m]=a,Q.call(e,r,w.engine),e},this.getOS=function(){var e={};return e[p]=a,e[m]=a,Q.call(e,r,w.os),S&&!e[p]&&y&&y.platform&&"Unknown"!=y.platform&&(e[p]=y.platform.replace(/chrome os/i,z).replace(/macos/i,U)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===c&&e.length>500?W(e,500):e,this},this.setUA(r),this};J.VERSION="1.0.38",J.BROWSER=q([p,m,u]),J.CPU=q([g]),J.DEVICE=q([d,f,h,y,b,w,v,S,E]),J.ENGINE=J.OS=q([p,m]),typeof t!==s?(e.exports&&(t=e.exports=J),t.UAParser=J):n.amdO?(r=function(){return J}.call(t,n,t,e))===a||(e.exports=r):typeof i!==s&&(i.UAParser=J);var Z=typeof i!==s&&(i.jQuery||i.Zepto);if(Z&&!Z.ua){var ee=new J;Z.ua=ee.getResult(),Z.ua.get=function(){return ee.getUA()},Z.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var n in t)Z.ua[n]=t[n]}}}("object"==typeof window?window:this)},6089:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__6089__},7781:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__7781__},8531:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__8531__},2007:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__2007__},4201:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__4201__},3241:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__3241__},5959:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__5959__},8398:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__8398__},3806:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__3806__},1269:e=>{"use strict";e.exports=__WEBPACK_EXTERNAL_MODULE__1269__},4629:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>I,__assign:()=>a,__asyncDelegator:()=>O,__asyncGenerator:()=>_,__asyncValues:()=>T,__await:()=>x,__awaiter:()=>f,__classPrivateFieldGet:()=>R,__classPrivateFieldIn:()=>j,__classPrivateFieldSet:()=>D,__createBinding:()=>g,__decorate:()=>s,__disposeResources:()=>L,__esDecorate:()=>c,__exportStar:()=>y,__extends:()=>i,__generator:()=>m,__importDefault:()=>A,__importStar:()=>P,__makeTemplateObject:()=>C,__metadata:()=>h,__param:()=>l,__propKey:()=>d,__read:()=>v,__rest:()=>o,__runInitializers:()=>u,__setFunctionName:()=>p,__spread:()=>w,__spreadArray:()=>E,__spreadArrays:()=>S,__values:()=>b,default:()=>M});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function s(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function l(e,t){return function(n,r){t(n,r,e)}}function c(e,t,n,r,i,a){function o(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var s,l=r.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?r.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),p=!1,h=n.length-1;h>=0;h--){var f={};for(var m in r)f[m]="access"===m?{}:r[m];for(var m in r.access)f.access[m]=r.access[m];f.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(e||null))};var g=(0,n[h])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(s=o(g.get))&&(d.get=s),(s=o(g.set))&&(d.set=s),(s=o(g.init))&&i.unshift(s)}else(s=o(g))&&("field"===l?i.unshift(s):d[c]=s)}u&&Object.defineProperty(u,r.name,d),p=!0}function u(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function p(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function h(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))}function m(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(o=0)),o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}}var g=Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||g(t,e,n)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function S(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function E(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}function x(e){return this instanceof x?(this.v=e,this):new x(e)}function _(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),r[Symbol.asyncIterator]=function(){return this},r;function o(e,t){i[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||s(e,t)}))},t&&(r[e]=t(r[e])))}function s(e,t){try{(n=i[e](t)).value instanceof x?Promise.resolve(n.value.v).then(l,c):u(a[0][2],n)}catch(e){u(a[0][3],e)}var n}function l(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function O(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:x(e[r](t)),done:!1}:i?i(t):t}:i}}function T(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=b(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var k=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&g(t,e,n);return k(t,e),t}function A(e){return e&&e.__esModule?e:{default:e}}function R(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function D(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}function j(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function I(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var N="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function L(e){function t(t){e.error=e.hasError?new N(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var i=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(i).then(n,(function(e){return t(e),n()}))}catch(e){t(e)}}if(e.hasError)throw e.error}()}const M={__extends:i,__assign:a,__rest:o,__decorate:s,__param:l,__metadata:h,__awaiter:f,__generator:m,__createBinding:g,__exportStar:y,__values:b,__read:v,__spread:w,__spreadArrays:S,__spreadArray:E,__await:x,__asyncGenerator:_,__asyncDelegator:O,__asyncValues:T,__makeTemplateObject:C,__importStar:P,__importDefault:A,__classPrivateFieldGet:R,__classPrivateFieldSet:D,__classPrivateFieldIn:j,__addDisposableResource:I,__disposeResources:L}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.amdO={},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{plugin:()=>KM});var e=__webpack_require__(7781),t=__webpack_require__(6089),n=__webpack_require__(8531),r=__webpack_require__(2007),i="undefined"==typeof window||"Deno"in globalThis;function a(){}function o(e){return"number"==typeof e&&e>=0&&e!==1/0}function s(e,t){return Math.max(e+(t||0)-Date.now(),0)}function l(e,t){return"function"==typeof e?e(t):e}function c(e,t){return"function"==typeof e?e(t):e}function u(e,t){const{type:n="all",exact:r,fetchStatus:i,predicate:a,queryKey:o,stale:s}=e;if(o)if(r){if(t.queryHash!==p(o,t.options))return!1}else if(!f(t.queryKey,o))return!1;if("all"!==n){const e=t.isActive();if("active"===n&&!e)return!1;if("inactive"===n&&e)return!1}return!("boolean"==typeof s&&t.isStale()!==s||i&&i!==t.state.fetchStatus||a&&!a(t))}function d(e,t){const{exact:n,status:r,predicate:i,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(n){if(h(t.options.mutationKey)!==h(a))return!1}else if(!f(t.options.mutationKey,a))return!1}return!(r&&t.state.status!==r||i&&!i(t))}function p(e,t){return(t?.queryKeyHashFn||h)(e)}function h(e){return JSON.stringify(e,((e,t)=>b(t)?Object.keys(t).sort().reduce(((e,n)=>(e[n]=t[n],e)),{}):t))}function f(e,t){return e===t||typeof e==typeof t&&!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&!Object.keys(t).some((n=>!f(e[n],t[n])))}function m(e,t){if(e===t)return e;const n=y(e)&&y(t);if(n||b(e)&&b(t)){const r=n?e:Object.keys(e),i=r.length,a=n?t:Object.keys(t),o=a.length,s=n?[]:{};let l=0;for(let i=0;i<o;i++){const o=n?i:a[i];(!n&&r.includes(o)||n)&&void 0===e[o]&&void 0===t[o]?(s[o]=void 0,l++):(s[o]=m(e[o],t[o]),s[o]===e[o]&&void 0!==e[o]&&l++)}return i===o&&l===i?e:s}return t}function g(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function y(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function b(e){if(!v(e))return!1;const t=e.constructor;if(void 0===t)return!0;const n=t.prototype;return!!v(n)&&!!n.hasOwnProperty("isPrototypeOf")&&Object.getPrototypeOf(e)===Object.prototype}function v(e){return"[object Object]"===Object.prototype.toString.call(e)}function w(e,t,n){return"function"==typeof n.structuralSharing?n.structuralSharing(e,t):!1!==n.structuralSharing?m(e,t):t}function S(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function E(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var x=Symbol(),_=(e,t)=>!e.queryFn&&t?.initialPromise?()=>t.initialPromise:e.queryFn&&e.queryFn!==x?e.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)),O=function(){let e=[],t=0,n=e=>{e()},r=e=>{e()},i=e=>setTimeout(e,0);const a=r=>{t?e.push(r):i((()=>{n(r)}))};return{batch:a=>{let o;t++;try{o=a()}finally{t--,t||(()=>{const t=e;e=[],t.length&&i((()=>{r((()=>{t.forEach((e=>{n(e)}))}))}))})()}return o},batchCalls:e=>(...t)=>{a((()=>{e(...t)}))},schedule:a,setNotifyFunction:e=>{n=e},setBatchNotifyFunction:e=>{r=e},setScheduler:e=>{i=e}}}(),T=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},C=new class extends T{#e;#t;#n;constructor(){super(),this.#n=e=>{if(!i&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e((e=>{"boolean"==typeof e?this.setFocused(e):this.onFocus()}))}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach((t=>{t(e)}))}isFocused(){return"boolean"==typeof this.#e?this.#e:"hidden"!==globalThis.document?.visibilityState}},k=new class extends T{#r=!0;#t;#n;constructor(){super(),this.#n=e=>{if(!i&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#n=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#r!==e&&(this.#r=e,this.listeners.forEach((t=>{t(e)})))}isOnline(){return this.#r}};function P(e){return Math.min(1e3*2**e,3e4)}function A(e){return"online"!==(e??"online")||k.isOnline()}var R=class{constructor(e){this.revert=e?.revert,this.silent=e?.silent}};function D(e){return e instanceof R}function j(e){let t,n,r,a=!1,o=0,s=!1;const l=new Promise(((e,t)=>{n=e,r=t})),c=()=>C.isFocused()&&("always"===e.networkMode||k.isOnline())&&e.canRun(),u=()=>A(e.networkMode)&&e.canRun(),d=r=>{s||(s=!0,e.onSuccess?.(r),t?.(),n(r))},p=n=>{s||(s=!0,e.onError?.(n),t?.(),r(n))},h=()=>new Promise((n=>{t=e=>{(s||c())&&n(e)},e.onPause?.()})).then((()=>{t=void 0,s||e.onContinue?.()})),f=()=>{if(s)return;let t;const n=0===o?e.initialPromise:void 0;try{t=n??e.fn()}catch(e){t=Promise.reject(e)}Promise.resolve(t).then(d).catch((t=>{if(s)return;const n=e.retry??(i?0:3),r=e.retryDelay??P,l="function"==typeof r?r(o,t):r,u=!0===n||"number"==typeof n&&o<n||"function"==typeof n&&n(o,t);var d;!a&&u?(o++,e.onFail?.(o,t),(d=l,new Promise((e=>{setTimeout(e,d)}))).then((()=>c()?void 0:h())).then((()=>{a?p(t):f()}))):p(t)}))};return{promise:l,cancel:t=>{s||(p(new R(t)),e.abort?.())},continue:()=>(t?.(),l),cancelRetry:()=>{a=!0},continueRetry:()=>{a=!1},canStart:u,start:()=>(u()?f():h().then(f),l)}}var I=class{#i;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),o(this.gcTime)&&(this.#i=setTimeout((()=>{this.optionalRemove()}),this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(i?1/0:3e5))}clearGcTimeout(){this.#i&&(clearTimeout(this.#i),this.#i=void 0)}},N=class extends I{#a;#o;#s;#l;#c;#u;constructor(e){super(),this.#u=!1,this.#c=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#s=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#a=e.state||function(e){const t="function"==typeof e.initialData?e.initialData():e.initialData,n=void 0!==t,r=n?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}(this.options),this.state=this.#a,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#l?.promise}setOptions(e){this.options={...this.#c,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){this.observers.length||"idle"!==this.state.fetchStatus||this.#s.remove(this)}setData(e,t){const n=w(this.state.data,e,this.options);return this.#d({data:n,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),n}setState(e,t){this.#d({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#l?.promise;return this.#l?.cancel(e),t?t.then(a).catch(a):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#a)}isActive(){return this.observers.some((e=>!1!==c(e.options.enabled,this)))}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return!!this.state.isInvalidated||(this.getObserversCount()>0?this.observers.some((e=>e.getCurrentResult().isStale)):void 0===this.state.data)}isStaleByTime(e=0){return this.state.isInvalidated||void 0===this.state.data||!s(this.state.dataUpdatedAt,e)}onFocus(){const e=this.observers.find((e=>e.shouldFetchOnWindowFocus()));e?.refetch({cancelRefetch:!1}),this.#l?.continue()}onOnline(){const e=this.observers.find((e=>e.shouldFetchOnReconnect()));e?.refetch({cancelRefetch:!1}),this.#l?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter((t=>t!==e)),this.observers.length||(this.#l&&(this.#u?this.#l.cancel({revert:!0}):this.#l.cancelRetry()),this.scheduleGc()),this.#s.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#d({type:"invalidate"})}fetch(e,t){if("idle"!==this.state.fetchStatus)if(void 0!==this.state.data&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#l)return this.#l.continueRetry(),this.#l.promise;if(e&&this.setOptions(e),!this.options.queryFn){const e=this.observers.find((e=>e.options.queryFn));e&&this.setOptions(e.options)}const n=new AbortController,r=e=>{Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(this.#u=!0,n.signal)})},i={fetchOptions:t,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:()=>{const e=_(this.options,t),n={queryKey:this.queryKey,meta:this.meta};return r(n),this.#u=!1,this.options.persister?this.options.persister(e,n,this):e(n)}};r(i),this.options.behavior?.onFetch(i,this),this.#o=this.state,"idle"!==this.state.fetchStatus&&this.state.fetchMeta===i.fetchOptions?.meta||this.#d({type:"fetch",meta:i.fetchOptions?.meta});const a=e=>{D(e)&&e.silent||this.#d({type:"error",error:e}),D(e)||(this.#s.config.onError?.(e,this),this.#s.config.onSettled?.(this.state.data,e,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return this.#l=j({initialPromise:t?.initialPromise,fn:i.fetchFn,abort:n.abort.bind(n),onSuccess:e=>{void 0!==e?(this.setData(e),this.#s.config.onSuccess?.(e,this),this.#s.config.onSettled?.(e,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1):a(new Error(`${this.queryHash} data is undefined`))},onError:a,onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:()=>{this.#d({type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0}),this.#l.start()}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...L(t.data,this.options),fetchMeta:e.meta??null};case"success":return{...t,data:e.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=e.error;return D(n)&&n.revert&&this.#o?{...this.#o,fetchStatus:"idle"}:{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...e.state}}})(this.state),O.batch((()=>{this.observers.forEach((e=>{e.onQueryUpdate()})),this.#s.notify({query:this,type:"updated",action:e})}))}};function L(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:A(t.networkMode)?"fetching":"paused",...void 0===e&&{error:null,status:"pending"}}}var M=class extends T{constructor(e={}){super(),this.config=e,this.#p=new Map}#p;build(e,t,n){const r=t.queryKey,i=t.queryHash??p(r,t);let a=this.get(i);return a||(a=new N({cache:this,queryKey:r,queryHash:i,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(r)}),this.add(a)),a}add(e){this.#p.has(e.queryHash)||(this.#p.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#p.get(e.queryHash);t&&(e.destroy(),t===e&&this.#p.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){O.batch((()=>{this.getAll().forEach((e=>{this.remove(e)}))}))}get(e){return this.#p.get(e)}getAll(){return[...this.#p.values()]}find(e){const t={exact:!0,...e};return this.getAll().find((e=>u(t,e)))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter((t=>u(e,t))):t}notify(e){O.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}onFocus(){O.batch((()=>{this.getAll().forEach((e=>{e.onFocus()}))}))}onOnline(){O.batch((()=>{this.getAll().forEach((e=>{e.onOnline()}))}))}},F=class extends I{#h;#f;#l;constructor(e){super(),this.mutationId=e.mutationId,this.#f=e.mutationCache,this.#h=[],this.state=e.state||{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0},this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#h.includes(e)||(this.#h.push(e),this.clearGcTimeout(),this.#f.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#h=this.#h.filter((t=>t!==e)),this.scheduleGc(),this.#f.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#h.length||("pending"===this.state.status?this.scheduleGc():this.#f.remove(this))}continue(){return this.#l?.continue()??this.execute(this.state.variables)}async execute(e){this.#l=j({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(e,t)=>{this.#d({type:"failed",failureCount:e,error:t})},onPause:()=>{this.#d({type:"pause"})},onContinue:()=>{this.#d({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#f.canRun(this)});const t="pending"===this.state.status,n=!this.#l.canStart();try{if(!t){this.#d({type:"pending",variables:e,isPaused:n}),await(this.#f.config.onMutate?.(e,this));const t=await(this.options.onMutate?.(e));t!==this.state.context&&this.#d({type:"pending",context:t,variables:e,isPaused:n})}const r=await this.#l.start();return await(this.#f.config.onSuccess?.(r,e,this.state.context,this)),await(this.options.onSuccess?.(r,e,this.state.context)),await(this.#f.config.onSettled?.(r,null,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(r,null,e,this.state.context)),this.#d({type:"success",data:r}),r}catch(t){try{throw await(this.#f.config.onError?.(t,e,this.state.context,this)),await(this.options.onError?.(t,e,this.state.context)),await(this.#f.config.onSettled?.(void 0,t,this.state.variables,this.state.context,this)),await(this.options.onSettled?.(void 0,t,e,this.state.context)),t}finally{this.#d({type:"error",error:t})}}finally{this.#f.runNext(this)}}#d(e){this.state=(t=>{switch(e.type){case"failed":return{...t,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...t,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:e.error,failureCount:t.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}})(this.state),O.batch((()=>{this.#h.forEach((t=>{t.onMutationUpdate(e)})),this.#f.notify({mutation:this,type:"updated",action:e})}))}},$=class extends T{constructor(e={}){super(),this.config=e,this.#m=new Map,this.#g=Date.now()}#m;#g;build(e,t,n){const r=new F({mutationCache:this,mutationId:++this.#g,options:e.defaultMutationOptions(t),state:n});return this.add(r),r}add(e){const t=B(e),n=this.#m.get(t)??[];n.push(e),this.#m.set(t,n),this.notify({type:"added",mutation:e})}remove(e){const t=B(e);if(this.#m.has(t)){const n=this.#m.get(t)?.filter((t=>t!==e));n&&(0===n.length?this.#m.delete(t):this.#m.set(t,n))}this.notify({type:"removed",mutation:e})}canRun(e){const t=this.#m.get(B(e))?.find((e=>"pending"===e.state.status));return!t||t===e}runNext(e){const t=this.#m.get(B(e))?.find((t=>t!==e&&t.state.isPaused));return t?.continue()??Promise.resolve()}clear(){O.batch((()=>{this.getAll().forEach((e=>{this.remove(e)}))}))}getAll(){return[...this.#m.values()].flat()}find(e){const t={exact:!0,...e};return this.getAll().find((e=>d(t,e)))}findAll(e={}){return this.getAll().filter((t=>d(e,t)))}notify(e){O.batch((()=>{this.listeners.forEach((t=>{t(e)}))}))}resumePausedMutations(){const e=this.getAll().filter((e=>e.state.isPaused));return O.batch((()=>Promise.all(e.map((e=>e.continue().catch(a))))))}};function B(e){return e.options.scope?.id??String(e.mutationId)}function V(e,{pages:t,pageParams:n}){const r=t.length-1;return e.getNextPageParam(t[r],t,n[r],n)}function z(e,{pages:t,pageParams:n}){return e.getPreviousPageParam?.(t[0],t,n[0],n)}const U=new class{#y;#f;#c;#b;#v;#w;#S;#E;constructor(e={}){this.#y=e.queryCache||new M,this.#f=e.mutationCache||new $,this.#c=e.defaultOptions||{},this.#b=new Map,this.#v=new Map,this.#w=0}mount(){this.#w++,1===this.#w&&(this.#S=C.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#y.onFocus())})),this.#E=k.subscribe((async e=>{e&&(await this.resumePausedMutations(),this.#y.onOnline())})))}unmount(){this.#w--,0===this.#w&&(this.#S?.(),this.#S=void 0,this.#E?.(),this.#E=void 0)}isFetching(e){return this.#y.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#f.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#y.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.getQueryData(e.queryKey);if(void 0===t)return this.fetchQuery(e);{const n=this.defaultQueryOptions(e),r=this.#y.build(this,n);return e.revalidateIfStale&&r.isStaleByTime(l(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(t)}}getQueriesData(e){return this.#y.findAll(e).map((({queryKey:e,state:t})=>[e,t.data]))}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),i=this.#y.get(r.queryHash),a=i?.state.data,o=function(e,t){return"function"==typeof e?e(t):e}(t,a);if(void 0!==o)return this.#y.build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return O.batch((()=>this.#y.findAll(e).map((({queryKey:e})=>[e,this.setQueryData(e,t,n)]))))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#y.get(t.queryHash)?.state}removeQueries(e){const t=this.#y;O.batch((()=>{t.findAll(e).forEach((e=>{t.remove(e)}))}))}resetQueries(e,t){const n=this.#y,r={type:"active",...e};return O.batch((()=>(n.findAll(e).forEach((e=>{e.reset()})),this.refetchQueries(r,t))))}cancelQueries(e={},t={}){const n={revert:!0,...t},r=O.batch((()=>this.#y.findAll(e).map((e=>e.cancel(n)))));return Promise.all(r).then(a).catch(a)}invalidateQueries(e={},t={}){return O.batch((()=>{if(this.#y.findAll(e).forEach((e=>{e.invalidate()})),"none"===e.refetchType)return Promise.resolve();const n={...e,type:e.refetchType??e.type??"active"};return this.refetchQueries(n,t)}))}refetchQueries(e={},t){const n={...t,cancelRefetch:t?.cancelRefetch??!0},r=O.batch((()=>this.#y.findAll(e).filter((e=>!e.isDisabled())).map((e=>{let t=e.fetch(void 0,n);return n.throwOnError||(t=t.catch(a)),"paused"===e.state.fetchStatus?Promise.resolve():t}))));return Promise.all(r).then(a)}fetchQuery(e){const t=this.defaultQueryOptions(e);void 0===t.retry&&(t.retry=!1);const n=this.#y.build(this,t);return n.isStaleByTime(l(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(a).catch(a)}fetchInfiniteQuery(e){return e.behavior=(t=e.pages,{onFetch:(e,n)=>{const r=async()=>{const n=e.options,r=e.fetchOptions?.meta?.fetchMore?.direction,i=e.state.data?.pages||[],a=e.state.data?.pageParams||[],o={pages:[],pageParams:[]};let s=!1;const l=_(e.options,e.fetchOptions),c=async(t,n,r)=>{if(s)return Promise.reject();if(null==n&&t.pages.length)return Promise.resolve(t);const i={queryKey:e.queryKey,pageParam:n,direction:r?"backward":"forward",meta:e.options.meta};var a;a=i,Object.defineProperty(a,"signal",{enumerable:!0,get:()=>(e.signal.aborted?s=!0:e.signal.addEventListener("abort",(()=>{s=!0})),e.signal)});const o=await l(i),{maxPages:c}=e.options,u=r?E:S;return{pages:u(t.pages,o,c),pageParams:u(t.pageParams,n,c)}};let u;if(r&&i.length){const e="backward"===r,t={pages:i,pageParams:a},o=(e?z:V)(n,t);u=await c(t,o,e)}else{u=await c(o,a[0]??n.initialPageParam);const e=t??i.length;for(let t=1;t<e;t++){const e=V(n,u);u=await c(u,e)}}return u};e.options.persister?e.fetchFn=()=>e.options.persister?.(r,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=r}}),this.fetchQuery(e);var t}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(a).catch(a)}resumePausedMutations(){return k.isOnline()?this.#f.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#y}getMutationCache(){return this.#f}getDefaultOptions(){return this.#c}setDefaultOptions(e){this.#c=e}setQueryDefaults(e,t){this.#b.set(h(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#b.values()];let n={};return t.forEach((t=>{f(e,t.queryKey)&&(n={...n,...t.defaultOptions})})),n}setMutationDefaults(e,t){this.#v.set(h(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#v.values()];let n={};return t.forEach((t=>{f(e,t.mutationKey)&&(n={...n,...t.defaultOptions})})),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#c.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=p(t.queryKey,t)),void 0===t.refetchOnReconnect&&(t.refetchOnReconnect="always"!==t.networkMode),void 0===t.throwOnError&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),!0!==t.enabled&&t.queryFn===x&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#c.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#y.clear(),this.#f.clear()}}({defaultOptions:{queries:{networkMode:"always",retry:!1,refetchOnWindowFocus:!1}}});var q;!function(e){e.EXCEPTION="exception",e.LOG="log",e.MEASUREMENT="measurement",e.TRACE="trace",e.EVENT="event"}(q||(q={}));const H={[q.EXCEPTION]:"exceptions",[q.LOG]:"logs",[q.MEASUREMENT]:"measurements",[q.TRACE]:"traces",[q.EVENT]:"events"};function G(){return Date.now()}function W(){return(new Date).toISOString()}function Q(e){return new Date(e).toISOString()}function K(e,t){return typeof e===t}function Y(e,t){return Object.prototype.toString.call(e)===`[object ${t}]`}function X(e,t){try{return e instanceof t}catch(e){return!1}}const J=e=>K(e,"null"),Z=e=>K(e,"string"),ee=e=>K(e,"number")&&!isNaN(e)||K(e,"bigint"),te=e=>!J(e)&&K(e,"object"),ne=e=>K(e,"function"),re=e=>Y(e,"Array"),ie="undefined"!=typeof Event,ae=e=>ie&&X(e,Event),oe="undefined"!=typeof Error,se=e=>oe&&X(e,Error),le=e=>Y(e,"ErrorEvent"),ce=e=>Y(e,"DOMError"),ue=e=>Y(e,"DOMException");function de(e,t){if(e===t)return!0;if(K(e,"number")&&isNaN(e))return K(t,"number")&&isNaN(t);const n=re(e),r=re(t);if(n!==r)return!1;if(n&&r){const n=e.length;if(n!==t.length)return!1;for(let r=n;0!=r--;)if(!de(e[r],t[r]))return!1;return!0}const i=te(e),a=te(t);if(i!==a)return!1;if(e&&t&&i&&a){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(let e of n)if(!r.includes(e))return!1;for(let r of n)if(!de(e[r],t[r]))return!1;return!0}return!1}const pe="Error";let he;var fe;!function(e){e.TRACE="trace",e.DEBUG="debug",e.INFO="info",e.LOG="log",e.WARN="warn",e.ERROR="error"}(fe||(fe={}));const me=fe.LOG,ge=[fe.TRACE,fe.DEBUG,fe.INFO,fe.LOG,fe.WARN,fe.ERROR],ye=e=>e.map((e=>{try{return String(e)}catch(e){return""}})).join(" ");function be(){}var ve;!function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.VERBOSE=4]="VERBOSE"}(ve||(ve={}));const we={debug:be,error:be,info:be,prefix:"Faro",warn:be},Se=ve.ERROR,Ee=Object.assign({},console);function xe(e=Ee,t=Se){const n=we;return t>ve.OFF&&(n.error=t>=ve.ERROR?function(...t){e.error(`${n.prefix}\n`,...t)}:be,n.warn=t>=ve.WARN?function(...t){e.warn(`${n.prefix}\n`,...t)}:be,n.info=t>=ve.INFO?function(...t){e.info(`${n.prefix}\n`,...t)}:be,n.debug=t>=ve.VERBOSE?function(...t){e.debug(`${n.prefix}\n`,...t)}:be),n}let _e=we;function Oe(e,t){return _e=xe(e,t.internalLoggerLevel),_e}const Te="undefined"!=typeof globalThis?globalThis:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:void 0,Ce="1.10.0",ke="_faroInternal";let Pe={};function Ae(e,t,n,r,i,a,o){return t.debug("Initializing Faro"),Pe={api:a,config:n,instrumentations:o,internalLogger:t,metas:r,pause:i.pause,transports:i,unpatchedConsole:e,unpause:i.unpause},function(e){e.config.isolate?e.internalLogger.debug("Skipping registering internal Faro instance on global object"):(e.internalLogger.debug("Registering internal Faro instance on global object"),Object.defineProperty(Te,ke,{configurable:!1,enumerable:!1,writable:!1,value:e}))}(Pe),function(e){if(e.config.preventGlobalExposure)e.internalLogger.debug("Skipping registering public Faro instance in the global scope");else{if(e.internalLogger.debug(`Registering public faro reference in the global scope using "${e.config.globalObjectKey}" key`),e.config.globalObjectKey in Te)return void e.internalLogger.warn(`Skipping global registration due to key "${e.config.globalObjectKey}" being used already. Please set "globalObjectKey" to something else or set "preventGlobalExposure" to "true"`);Object.defineProperty(Te,e.config.globalObjectKey,{configurable:!1,writable:!1,value:e})}}(Pe),Pe}class Re{constructor(e,t){var n,r;this.signalBuffer=[],this.itemLimit=null!==(n=null==t?void 0:t.itemLimit)&&void 0!==n?n:50,this.sendTimeout=null!==(r=null==t?void 0:t.sendTimeout)&&void 0!==r?r:250,this.paused=(null==t?void 0:t.paused)||!1,this.sendFn=e,this.flushInterval=-1,this.paused||this.start(),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState&&this.flush()}))}addItem(e){this.paused||(this.signalBuffer.push(e),this.signalBuffer.length>=this.itemLimit&&this.flush())}start(){this.paused=!1,this.sendTimeout>0&&(this.flushInterval=window.setInterval((()=>this.flush()),this.sendTimeout))}pause(){this.paused=!0,clearInterval(this.flushInterval)}groupItems(e){const t=new Map;return e.forEach((e=>{const n=JSON.stringify(e.meta);let r=t.get(n);r=void 0===r?[e]:[...r,e],t.set(n,r)})),Array.from(t.values())}flush(){this.paused||0===this.signalBuffer.length||(this.groupItems(this.signalBuffer).forEach(this.sendFn),this.signalBuffer=[])}}function De(e,t,n,r){var i;t.debug("Initializing transports");const a=[];let o=n.paused,s=[];const l=e=>{let t=e;for(const e of s){const n=t.map(e).filter(Boolean);if(0===n.length)return[];t=n}return t};let c;return(null===(i=n.batching)||void 0===i?void 0:i.enabled)&&(c=new Re((e=>{const n=l(e);if(0!==n.length)for(const e of a)t.debug(`Transporting item using ${e.name}\n`,n),e.isBatched()&&e.send(n)}),{sendTimeout:n.batching.sendTimeout,itemLimit:n.batching.itemLimit,paused:o})),{add:(...i)=>{t.debug("Adding transports"),i.forEach((i=>{t.debug(`Adding "${i.name}" transport`),a.some((e=>e===i))?t.warn(`Transport ${i.name} is already added`):(i.unpatchedConsole=e,i.internalLogger=t,i.config=n,i.metas=r,a.push(i))}))},addBeforeSendHooks:(...e)=>{t.debug("Adding beforeSendHooks\n",s),e.forEach((e=>{e&&s.push(e)}))},addIgnoreErrorsPatterns:(...e)=>{t.debug("Adding ignoreErrorsPatterns\n",e),e.forEach((e=>{var t;e&&s.push((t=e,e=>{if(e.type===q.EXCEPTION&&e.payload){const n=e.payload,r=`${n.type}: ${n.value}`;if(function(e,t){return e.some((e=>Z(e)?t.includes(e):!!t.match(e)))}(t,r))return null}return e}))}))},getBeforeSendHooks:()=>[...s],execute:e=>{var r;o||((null===(r=n.batching)||void 0===r?void 0:r.enabled)&&(null==c||c.addItem(e)),(e=>{var r,i;if((null===(r=n.batching)||void 0===r?void 0:r.enabled)&&a.every((e=>e.isBatched())))return;const[o]=l([e]);if(void 0!==o)for(const e of a)t.debug(`Transporting item using ${e.name}\n`,o),e.isBatched()?(null===(i=n.batching)||void 0===i?void 0:i.enabled)||e.send([o]):e.send(o)})(e))},isPaused:()=>o,pause:()=>{t.debug("Pausing transports"),null==c||c.pause(),o=!0},remove:(...e)=>{t.debug("Removing transports"),e.forEach((e=>{t.debug(`Removing "${e.name}" transport`);const n=a.indexOf(e);-1!==n?a.splice(n,1):t.warn(`Transport "${e.name}" is not added`)}))},removeBeforeSendHooks:(...e)=>{s.filter((t=>!e.includes(t)))},get transports(){return[...a]},unpause:()=>{t.debug("Unpausing transports"),null==c||c.start(),o=!1}}}let je=Ee;function Ie(e){var t;return je=null!==(t=e.unpatchedConsole)&&void 0!==t?t:je,je}function Ne(e){const t=Ie(e),n=Oe(t,e);if(ke in Te&&!e.isolate)return void n.error('Faro is already registered. Either add instrumentations, transports etc. to the global faro instance or use the "isolate" property');n.debug("Initializing");const r=function(e,t,n){let r=[],i=[];const a=()=>r.reduce(((e,t)=>Object.assign(e,ne(t)?t():t)),{}),o=()=>{if(i.length){const e=a();i.forEach((t=>t(e)))}};return{add:(...e)=>{t.debug("Adding metas\n",e),r.push(...e),o()},remove:(...e)=>{t.debug("Removing metas\n",e),r=r.filter((t=>!e.includes(t))),o()},addListener:e=>{t.debug("Adding metas listener\n",e),i.push(e)},removeListener:e=>{t.debug("Removing metas listener\n",e),i=i.filter((t=>t!==e))},get value(){return a()}}}(0,n),i=De(t,n,e,r),a=function(e,t,n,r,i){t.debug("Initializing API");const a=function(e,t,n,r,i){let a;return t.debug("Initializing traces API"),{getOTEL:()=>a,getTraceContext:()=>{const e=null==a?void 0:a.trace.getSpanContext(a.context.active());return e?{trace_id:e.traceId,span_id:e.spanId}:void 0},initOTEL:(e,n)=>{t.debug("Initializing OpenTelemetry"),a={trace:e,context:n}},isOTELInitialized:()=>!!a,pushTraces:e=>{try{const n={type:q.TRACE,payload:e,meta:r.value};t.debug("Pushing trace\n",n),i.execute(n)}catch(e){t.error("Error pushing trace\n",e)}}}}(0,t,0,r,i);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a),function(e,t,n,r,i,a){var o;t.debug("Initializing exceptions API");let s=null;he=null!==(o=n.parseStacktrace)&&void 0!==o?o:he;const l=e=>{t.debug("Changing stacktrace parser"),he=null!=e?e:he};return l(n.parseStacktrace),{changeStacktraceParser:l,getStacktraceParser:()=>he,pushError:(e,{skipDedupe:o,stackFrames:l,type:c,context:u,spanContext:d,timestampOverwriteMs:p}={})=>{c=c||e.name||pe;const h={meta:r.value,payload:{type:c,value:e.message,timestamp:p?Q(p):W(),trace:d?{trace_id:d.traceId,span_id:d.spanId}:a.getTraceContext(),context:null!=u?u:{}},type:q.EXCEPTION};(null==(l=null!=l?l:e.stack?null==he?void 0:he(e).frames:void 0)?void 0:l.length)&&(h.payload.stacktrace={frames:l});const f={type:h.payload.type,value:h.payload.value,stackTrace:h.payload.stacktrace,context:h.payload.context};o||!n.dedupe||J(s)||!de(f,s)?(s=f,t.debug("Pushing exception\n",h),i.execute(h)):t.debug("Skipping error push because it is the same as the last one\n",h.payload)}}}(0,t,n,r,i,a)),function(e,t,n,r,i){let a,o,s;t.debug("Initializing meta API");const l=e=>{o&&r.remove(o),o={user:e},r.add(o)},c=e=>{a&&r.remove(a),a={session:e},r.add(a)};return{setUser:l,resetUser:l,setSession:c,resetSession:c,getSession:()=>r.value.session,setView:e=>{var t;if((null===(t=null==s?void 0:s.view)||void 0===t?void 0:t.name)===(null==e?void 0:e.name))return;const n=s;s={view:e},r.add(s),n&&r.remove(n)},getView:()=>r.value.view}}(0,t,0,r)),function(e,t,n,r,i,a){var o;t.debug("Initializing logs API");let s=null;const l=null!==(o=n.logArgsSerializer)&&void 0!==o?o:ye;return{pushLog:(e,{context:o,level:c,skipDedupe:u,spanContext:d,timestampOverwriteMs:p}={})=>{try{const h={type:q.LOG,payload:{message:l(e),level:null!=c?c:me,context:null!=o?o:{},timestamp:p?Q(p):W(),trace:d?{trace_id:d.traceId,span_id:d.spanId}:a.getTraceContext()},meta:r.value},f={message:h.payload.message,level:h.payload.level,context:h.payload.context};if(!u&&n.dedupe&&!J(s)&&de(f,s))return void t.debug("Skipping log push because it is the same as the last one\n",h.payload);s=f,t.debug("Pushing log\n",h),i.execute(h)}catch(e){t.error("Error pushing log\n",e)}}}}(0,t,n,r,i,a)),function(e,t,n,r,i,a){t.debug("Initializing measurements API");let o=null;return{pushMeasurement:(e,{skipDedupe:s,context:l,spanContext:c,timestampOverwriteMs:u}={})=>{try{const d={type:q.MEASUREMENT,payload:Object.assign(Object.assign({},e),{trace:c?{trace_id:c.traceId,span_id:c.spanId}:a.getTraceContext(),timestamp:u?Q(u):W(),context:null!=l?l:{}}),meta:r.value},p={type:d.payload.type,values:d.payload.values,context:d.payload.context};if(!s&&n.dedupe&&!J(o)&&de(p,o))return void t.debug("Skipping measurement push because it is the same as the last one\n",d.payload);o=p,t.debug("Pushing measurement\n",d),i.execute(d)}catch(e){t.error("Error pushing measurement\n",e)}}}}(0,t,n,r,i,a)),function(e,t,n,r,i,a){let o=null;return{pushEvent:(e,s,l,{skipDedupe:c,spanContext:u,timestampOverwriteMs:d}={})=>{try{const p={meta:r.value,payload:{name:e,domain:null!=l?l:n.eventDomain,attributes:s,timestamp:d?Q(d):W(),trace:u?{trace_id:u.traceId,span_id:u.spanId}:a.getTraceContext()},type:q.EVENT},h={name:p.payload.name,attributes:p.payload.attributes,domain:p.payload.domain};if(!c&&n.dedupe&&!J(o)&&de(h,o))return void t.debug("Skipping event push because it is the same as the last one\n",p.payload);o=h,t.debug("Pushing event\n",p),i.execute(p)}catch(e){t.error("Error pushing event",e)}}}}(0,t,n,r,i,a))}(0,n,e,r,i),o=function(e,t,n,r,i,a){t.debug("Initializing instrumentations");const o=[];return{add:(...s)=>{t.debug("Adding instrumentations"),s.forEach((s=>{t.debug(`Adding "${s.name}" instrumentation`),o.some((e=>e.name===s.name))?t.warn(`Instrumentation ${s.name} is already added`):(s.unpatchedConsole=e,s.internalLogger=t,s.config=n,s.metas=r,s.transports=i,s.api=a,o.push(s),s.initialize())}))},get instrumentations(){return[...o]},remove:(...e)=>{t.debug("Removing instrumentations"),e.forEach((e=>{var n,r;t.debug(`Removing "${e.name}" instrumentation`);const i=o.reduce(((t,n,r)=>null===t&&n.name===e.name?r:null),null);i?(null===(r=(n=o[i]).destroy)||void 0===r||r.call(n),o.splice(i,1)):t.warn(`Instrumentation "${e.name}" is not added`)}))}}}(t,n,e,r,i,a),s=Ae(t,n,e,r,i,a,o);return function(e){var t,n;const r={sdk:{version:Ce},app:{bundleId:e.config.app.name&&(i=e.config.app.name,null==Te?void 0:Te[`__faroBundleId_${i}`])}};var i;const a=null===(t=e.config.sessionTracking)||void 0===t?void 0:t.session;a&&e.api.setSession(a),e.config.app&&(r.app=Object.assign(Object.assign({},e.config.app),r.app)),e.config.user&&(r.user=e.config.user),e.config.view&&(r.view=e.config.view),e.metas.add(r,...null!==(n=e.config.metas)&&void 0!==n?n:[])}(s),function(e){e.transports.add(...e.config.transports),e.transports.addBeforeSendHooks(e.config.beforeSend),e.transports.addIgnoreErrorsPatterns(e.config.ignoreErrors)}(s),function(e){e.instrumentations.add(...e.config.instrumentations)}(s),s}const Le={enabled:!0,sendTimeout:250,itemLimit:50},Me="\n",Fe="eval",$e="?",Be="@",Ve=/^\s*at (?:(.*\).*?|.*?) ?\((?:address at )?)?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,ze=/\((\S*)(?::(\d+))(?::(\d+))\)/,Ue="eval",qe="address at ",He=qe.length,Ge=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|safari-extension|safari-web-extension|capacitor)?:\/.*?|\[native code]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,We=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Qe=" > eval",Ke="safari-extension",Ye="safari-web-extension",Xe=/Minified React error #\d+;/i;function Je(e,t,n,r){const i={filename:e||document.location.href,function:t||$e};return void 0!==n&&(i.lineno=n),void 0!==r&&(i.colno=r),i}function Ze(e,t){const n=null==e?void 0:e.includes(Ke),r=!n&&(null==e?void 0:e.includes(Ye));return n||r?[(null==e?void 0:e.includes(Be))?e.split(Be)[0]:e,n?`${Ke}:${t}`:`${Ye}:${t}`]:[e,t]}function et(e){let t=[];e.stacktrace?t=e.stacktrace.split(Me).filter(((e,t)=>t%2==0)):e.stack&&(t=e.stack.split(Me));const n=t.reduce(((t,n,r)=>{let i,a,o,s,l;if(i=Ve.exec(n)){if(a=i[1],o=i[2],s=i[3],l=i[4],null==o?void 0:o.startsWith(Ue)){const e=ze.exec(o);e&&(o=e[1],s=e[2],l=e[3])}o=(null==o?void 0:o.startsWith(qe))?o.substring(He):o,[a,o]=Ze(a,o)}else if(i=Ge.exec(n)){if(a=i[1],o=i[3],s=i[4],l=i[5],o&&o.includes(Qe)){const e=We.exec(o);e&&(a=a||Fe,o=e[1],s=e[2])}else 0===r&&!l&&ee(e.columnNumber)&&(l=String(e.columnNumber+1));[a,o]=Ze(a,o)}return(o||a)&&t.push(Je(o,a,s?Number(s):void 0,l?Number(l):void 0)),t}),[]);return Xe.test(e.message)?n.slice(1):n}function tt(e){return{frames:et(e)}}const nt="com.grafana.faro.session",rt=144e5,it=9e5,at={enabled:!0,persistent:!1,maxSessionPersistenceTime:it};var ot=__webpack_require__(6660);const st="unknown",lt=[()=>{const e=new ot.UAParser,{name:t,version:n}=e.getBrowser(),{name:r,version:i}=e.getOS(),a=e.getUA(),o=navigator.language,s=navigator.userAgent.includes("Mobi"),l=function(){if(t&&n)return"userAgentData"in navigator&&navigator.userAgentData?navigator.userAgentData.brands:void 0}();return{browser:{name:null!=t?t:st,version:null!=n?n:st,os:`${null!=r?r:st} ${null!=i?i:st}`,userAgent:null!=a?a:st,language:null!=o?o:st,mobile:s,brands:null!=l?l:st,viewportWidth:`${window.innerWidth}`,viewportHeight:`${window.innerHeight}`}}},()=>({page:{url:location.href}})],ct=()=>{const e=window.k6;return{k6:Object.assign({isK6Browser:!0},(null==e?void 0:e.testRunId)&&{testRunId:null==e?void 0:e.testRunId})}};class ut{constructor(){this.unpatchedConsole=Ee,this.internalLogger=we,this.config={},this.metas={}}logDebug(...e){this.internalLogger.debug(`${this.name}\n`,...e)}logInfo(...e){this.internalLogger.info(`${this.name}\n`,...e)}logWarn(...e){this.internalLogger.warn(`${this.name}\n`,...e)}logError(...e){this.internalLogger.error(`${this.name}\n`,...e)}}class dt extends ut{isBatched(){return!1}getIgnoreUrls(){return[]}}function pt(e,t){var n,r;if(void 0===t)return e;if(void 0===e)return{resourceSpans:t};const i=null===(n=e.resourceSpans)||void 0===n?void 0:n[0];if(void 0===i)return e;const a=(null==i?void 0:i.scopeSpans)||[],o=(null===(r=null==t?void 0:t[0])||void 0===r?void 0:r.scopeSpans)||[];return Object.assign(Object.assign({},e),{resourceSpans:[Object.assign(Object.assign({},i),{scopeSpans:[...a,...o]})]})}function ht(e,t){let n,r=!1;const i=()=>{null!=n?(e(...n),n=null,setTimeout(i,t)):r=!1};return(...a)=>{r?n=a:(e(...a),r=!0,setTimeout(i,t))}}const ft={session:"sessionStorage",local:"localStorage"};function mt(e){var t;try{let t;t=window[e];const n="__faro_storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(n){return null===(t=Pe.internalLogger)||void 0===t||t.info(`Web storage of type ${e} is not available. Reason: ${n}`),!1}}function gt(e,t){return St(t)?window[t].getItem(e):null}function yt(e,t,n){if(St(n))try{window[n].setItem(e,t)}catch(e){}}function bt(e,t){St(t)&&window[t].removeItem(e)}const vt=mt(ft.local),wt=mt(ft.session);function St(e){return e===ft.local?vt:e===ft.session&&wt}function Et(){var e,t,n;const r=Pe.config.sessionTracking;let i=null!==(n=null!==(t=null===(e=null==r?void 0:r.sampler)||void 0===e?void 0:e.call(r,{metas:Pe.metas.value}))&&void 0!==t?t:null==r?void 0:r.samplingRate)&&void 0!==n?n:1;return"number"!=typeof i&&(i=0),Math.random()<i}const xt="abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ0123456789";function _t(e=10){return Array.from(Array(e)).map((()=>xt[Math.floor(Math.random()*xt.length)])).join("")}function Ot({sessionId:e,started:t,lastActivity:n,isSampled:r=!0}={}){var i,a;const o=G(),s=null===(a=null===(i=Pe.config)||void 0===i?void 0:i.sessionTracking)||void 0===a?void 0:a.generateSessionId;return null==e&&(e="function"==typeof s?s():_t()),{sessionId:e,lastActivity:null!=n?n:o,started:null!=t?t:o,isSampled:r}}function Tt(e){if(null==e)return!1;const t=G();return t-e.started<rt&&t-e.lastActivity<it}function Ct({fetchUserSession:e,storeUserSession:t}){return function({forceSessionExtend:n}={forceSessionExtend:!1}){var r,i,a;if(!e||!t)return;const o=Pe.config.sessionTracking,s=null==o?void 0:o.persistent;if(s&&!vt||!s&&!wt)return;const l=e();if(!1===n&&Tt(l))t(Object.assign(Object.assign({},l),{lastActivity:G()}));else{let e=kt(Ot({isSampled:Et()}),l);t(e),null===(r=Pe.api)||void 0===r||r.setSession(e.sessionMeta),null===(i=null==o?void 0:o.onSessionChange)||void 0===i||i.call(o,null!==(a=null==l?void 0:l.sessionMeta)&&void 0!==a?a:null,e.sessionMeta)}}}function kt(e,t){var n,r,i,a;return Object.assign(Object.assign({},e),{sessionMeta:{id:e.sessionId,attributes:Object.assign(Object.assign(Object.assign(Object.assign({},null===(r=null===(n=Pe.config.sessionTracking)||void 0===n?void 0:n.session)||void 0===r?void 0:r.attributes),null!==(a=null===(i=Pe.metas.value.session)||void 0===i?void 0:i.attributes)&&void 0!==a?a:{}),null!=t?{previousSession:t.sessionId}:{}),{isSampled:e.isSampled.toString()})}})}class Pt{constructor(){this.updateSession=ht((()=>this.updateUserSession()),1e3),this.updateUserSession=Ct({fetchUserSession:Pt.fetchUserSession,storeUserSession:Pt.storeUserSession}),this.init()}static removeUserSession(){bt(nt,Pt.storageTypeLocal)}static storeUserSession(e){yt(nt,JSON.stringify(e),Pt.storageTypeLocal)}static fetchUserSession(){const e=gt(nt,Pt.storageTypeLocal);return e?JSON.parse(e):null}init(){document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&this.updateSession()})),Pe.metas.addListener((function(e){const t=e.session,n=Pt.fetchUserSession();if(t&&t.id!==(null==n?void 0:n.sessionId)){const e=kt(Ot({sessionId:t.id,isSampled:Et()}),n);Pt.storeUserSession(e),Pe.api.setSession(e.sessionMeta)}}))}}Pt.storageTypeLocal=ft.local;class At{constructor(){this.updateSession=ht((()=>this.updateUserSession()),1e3),this.updateUserSession=Ct({fetchUserSession:At.fetchUserSession,storeUserSession:At.storeUserSession}),this.init()}static removeUserSession(){bt(nt,At.storageTypeSession)}static storeUserSession(e){yt(nt,JSON.stringify(e),At.storageTypeSession)}static fetchUserSession(){const e=gt(nt,At.storageTypeSession);return e?JSON.parse(e):null}init(){document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&this.updateSession()})),Pe.metas.addListener((function(e){const t=e.session,n=At.fetchUserSession();if(t&&t.id!==(null==n?void 0:n.sessionId)){const e=kt(Ot({sessionId:t.id,isSampled:Et()}),n);At.storeUserSession(e),Pe.api.setSession(e.sessionMeta)}}))}}function Rt(e){return(null==e?void 0:e.persistent)?Pt:At}At.storageTypeSession=ft.session;var Dt=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))};class jt extends dt{constructor(e){var t,n,r,i;super(),this.options=e,this.name="@grafana/faro-web-sdk:transport-fetch",this.version=Ce,this.disabledUntil=new Date,this.rateLimitBackoffMs=null!==(t=e.defaultRateLimitBackoffMs)&&void 0!==t?t:5e3,this.getNow=null!==(n=e.getNow)&&void 0!==n?n:()=>Date.now(),this.promiseBuffer=function(e){const{size:t,concurrency:n}=e,r=[];let i=0;const a=()=>{if(i<n&&r.length){const{producer:e,resolve:t,reject:n}=r.shift();i++,e().then((e=>{i--,a(),t(e)}),(e=>{i--,a(),n(e)}))}};return{add:e=>{if(r.length+i>=t)throw new Error("Task buffer full");return new Promise(((t,n)=>{r.push({producer:e,resolve:t,reject:n}),a()}))}}}({size:null!==(r=e.bufferSize)&&void 0!==r?r:30,concurrency:null!==(i=e.concurrency)&&void 0!==i?i:5})}send(e){return Dt(this,void 0,void 0,(function*(){try{if(this.disabledUntil>new Date(this.getNow()))return this.logWarn(`Dropping transport item due to too many requests. Backoff until ${this.disabledUntil}`),Promise.resolve();yield this.promiseBuffer.add((()=>{const t=JSON.stringify(function(e){let t={meta:{}};return void 0!==e[0]&&(t.meta=e[0].meta),e.forEach((e=>{switch(e.type){case q.LOG:case q.EVENT:case q.EXCEPTION:case q.MEASUREMENT:const n=H[e.type],r=t[n];t=Object.assign(Object.assign({},t),{[n]:void 0===r?[e.payload]:[...r,e.payload]});break;case q.TRACE:t=Object.assign(Object.assign({},t),{traces:pt(t.traces,e.payload.resourceSpans)})}})),t}(e)),{url:n,requestOptions:r,apiKey:i}=this.options,a=null!=r?r:{},{headers:o}=a,s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(a,["headers"]);let l;const c=this.metas.value.session;return null!=c&&(l=c.id),fetch(n,Object.assign({method:"POST",headers:Object.assign(Object.assign(Object.assign({"Content-Type":"application/json"},null!=o?o:{}),i?{"x-api-key":i}:{}),l?{"x-faro-session-id":l}:{}),body:t,keepalive:t.length<=6e4},null!=s?s:{})).then((e=>Dt(this,void 0,void 0,(function*(){return 202===e.status&&"invalid"===e.headers.get("X-Faro-Session-Status")&&this.extendFaroSession(this.config,this.logDebug),429===e.status&&(this.disabledUntil=this.getRetryAfterDate(e),this.logWarn(`Too many requests, backing off until ${this.disabledUntil}`)),e.text().catch(be),e})))).catch((e=>{this.logError("Failed sending payload to the receiver\n",JSON.parse(t),e)}))}))}catch(e){this.logError(e)}}))}getIgnoreUrls(){var e;return[this.options.url].concat(null!==(e=this.config.ignoreUrls)&&void 0!==e?e:[])}isBatched(){return!0}getRetryAfterDate(e){const t=this.getNow(),n=e.headers.get("Retry-After");if(n){const e=Number(n);if(!isNaN(e))return new Date(1e3*e+t);const r=Date.parse(n);if(!isNaN(r))return new Date(r)}return new Date(t+this.rateLimitBackoffMs)}extendFaroSession(e,t){const n="Session expired",r=e.sessionTracking;if(null==r?void 0:r.enabled){const{fetchUserSession:e,storeUserSession:i}=Rt(r);Ct({fetchUserSession:e,storeUserSession:i})({forceSessionExtend:!0}),t(`${n} created new session.`)}else t(`${n}.`)}}class It extends ut{constructor(){super(...arguments),this.api={},this.transports={}}}const Nt="DOMError",Lt="DOMException",Mt="Non-Error exception captured with keys:",Ft=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;function $t(e){let t,n,r,i,a=[];if(le(e)&&e.error)t=e.error.message,n=e.error.name,a=et(e.error);else if((r=ce(e))||ue(e)){const{name:i,message:a}=e;n=null!=i?i:r?Nt:Lt,t=a?`${n}: ${a}`:n}else se(e)?(t=e.message,a=et(e)):(te(e)||(i=ae(e)))&&(n=i?e.constructor.name:void 0,t=`${Mt} ${Object.keys(e)}`);return[t,n,a]}class Bt extends It{constructor(){super(...arguments),this.name="@grafana/faro-web-sdk:instrumentation-errors",this.version=Ce}initialize(){var e;this.logDebug("Initializing"),function(e){const t=window.onerror;window.onerror=(...n)=>{try{const[t,r,i,a,o]=n;let s,l,c=[];const u=Z(t),d=Je(r,"?",i,a);o||!u?([s,l,c]=$t(null!=o?o:t),0===c.length&&(c=[d])):u&&([s,l]=function(e){var t,n;const r=e.match(Ft),i=null!==(t=null==r?void 0:r[1])&&void 0!==t?t:pe;return[null!==(n=null==r?void 0:r[2])&&void 0!==n?n:e,i]}(t),c=[d]),s&&e.pushError(new Error(s),{type:l,stackFrames:c})}finally{null==t||t.apply(window,n)}}}(this.api),e=this.api,window.addEventListener("unhandledrejection",(t=>{var n,r;let i,a,o=t;o.reason?o=t.reason:(null===(n=t.detail)||void 0===n?void 0:n.reason)&&(o=null===(r=t.detail)||void 0===r?void 0:r.reason);let s=[];(e=>!te(e)&&!ne(e))(o)?(i=`Non-Error promise rejection captured with value: ${String(o)}`,a="UnhandledRejection"):[i,a,s]=$t(o),i&&e.pushError(new Error(i),{type:a,stackFrames:s})}))}}var Vt,zt,Ut,qt,Ht,Gt=-1,Wt=function(e){addEventListener("pageshow",(function(t){t.persisted&&(Gt=t.timeStamp,e(t))}),!0)},Qt=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},Kt=function(){var e=Qt();return e&&e.activationStart||0},Yt=function(e,t){var n=Qt(),r="navigate";return Gt>=0?r="back-forward-cache":n&&(document.prerendering||Kt()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},Xt=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},Jt=function(e,t,n,r){var i,a;return function(o){t.value>=0&&(o||r)&&((a=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=a,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},Zt=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},en=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},tn=function(e){var t=!1;return function(){t||(e(),t=!0)}},nn=-1,rn=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},an=function(e){"hidden"===document.visibilityState&&nn>-1&&(nn="visibilitychange"===e.type?e.timeStamp:0,sn())},on=function(){addEventListener("visibilitychange",an,!0),addEventListener("prerenderingchange",an,!0)},sn=function(){removeEventListener("visibilitychange",an,!0),removeEventListener("prerenderingchange",an,!0)},ln=function(){return nn<0&&(nn=rn(),on(),Wt((function(){setTimeout((function(){nn=rn(),on()}),0)}))),{get firstHiddenTime(){return nn}}},cn=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},un=[1800,3e3],dn=function(e,t){t=t||{},cn((function(){var n,r=ln(),i=Yt("FCP"),a=Xt("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(a.disconnect(),e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-Kt(),0),i.entries.push(e),n(!0)))}))}));a&&(n=Jt(e,i,un,t.reportAllChanges),Wt((function(r){i=Yt("FCP"),n=Jt(e,i,un,t.reportAllChanges),Zt((function(){i.value=performance.now()-r.timeStamp,n(!0)}))})))}))},pn=[.1,.25],hn=0,fn=1/0,mn=0,gn=function(e){e.forEach((function(e){e.interactionId&&(fn=Math.min(fn,e.interactionId),mn=Math.max(mn,e.interactionId),hn=mn?(mn-fn)/7+1:0)}))},yn=function(){"interactionCount"in performance||Vt||(Vt=Xt("event",gn,{type:"event",buffered:!0,durationThreshold:0}))},bn=[],vn=new Map,wn=0,Sn=function(){return(Vt?hn:performance.interactionCount||0)-wn},En=[],xn=function(e){if(En.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=bn[bn.length-1],n=vn.get(e.interactionId);if(n||bn.length<10||e.duration>t.latency){if(n)e.duration>n.latency?(n.entries=[e],n.latency=e.duration):e.duration===n.latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};vn.set(r.id,r),bn.push(r)}bn.sort((function(e,t){return t.latency-e.latency})),bn.length>10&&bn.splice(10).forEach((function(e){return vn.delete(e.id)}))}}},_n=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=tn(e),"hidden"===document.visibilityState?e():(n=t(e),en(e)),n},On=[200,500],Tn=[2500,4e3],Cn={},kn=[800,1800],Pn=function e(t){document.prerendering?cn((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},An={passive:!0,capture:!0},Rn=new Date,Dn=function(e,t){zt||(zt=t,Ut=e,qt=new Date,Nn(removeEventListener),jn())},jn=function(){if(Ut>=0&&Ut<qt-Rn){var e={entryType:"first-input",name:zt.type,target:zt.target,cancelable:zt.cancelable,startTime:zt.timeStamp,processingStart:zt.timeStamp+Ut};Ht.forEach((function(t){t(e)})),Ht=[]}},In=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){Dn(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,An),removeEventListener("pointercancel",r,An)};addEventListener("pointerup",n,An),addEventListener("pointercancel",r,An)}(t,e):Dn(t,e)}},Nn=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,In,An)}))},Ln=[100,300];class Mn{constructor(e){this.pushMeasurement=e}initialize(){Object.entries(Mn.mapping).forEach((([e,t])=>{t((t=>{this.pushMeasurement({type:"web-vitals",values:{[e]:t.value}})}))}))}}Mn.mapping={cls:function(e,t){t=t||{},dn(tn((function(){var n,r=Yt("CLS",0),i=0,a=[],o=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=a[0],n=a[a.length-1];i&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,a.push(e)):(i=e.value,a=[e])}})),i>r.value&&(r.value=i,r.entries=a,n())},s=Xt("layout-shift",o);s&&(n=Jt(e,r,pn,t.reportAllChanges),en((function(){o(s.takeRecords()),n(!0)})),Wt((function(){i=0,r=Yt("CLS",0),n=Jt(e,r,pn,t.reportAllChanges),Zt((function(){return n()}))})),setTimeout(n,0))})))},fcp:dn,fid:function(e,t){t=t||{},cn((function(){var n,r=ln(),i=Yt("FID"),a=function(e){e.startTime<r.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},o=function(e){e.forEach(a)},s=Xt("first-input",o);n=Jt(e,i,Ln,t.reportAllChanges),s&&(en(tn((function(){o(s.takeRecords()),s.disconnect()}))),Wt((function(){var r;i=Yt("FID"),n=Jt(e,i,Ln,t.reportAllChanges),Ht=[],Ut=-1,zt=null,Nn(addEventListener),r=a,Ht.push(r),jn()})))}))},inp:function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},cn((function(){var n;yn();var r,i=Yt("INP"),a=function(e){_n((function(){e.forEach(xn);var t,n=(t=Math.min(bn.length-1,Math.floor(Sn()/50)),bn[t]);n&&n.latency!==i.value&&(i.value=n.latency,i.entries=n.entries,r())}))},o=Xt("event",a,{durationThreshold:null!==(n=t.durationThreshold)&&void 0!==n?n:40});r=Jt(e,i,On,t.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),en((function(){a(o.takeRecords()),r(!0)})),Wt((function(){wn=0,bn.length=0,vn.clear(),i=Yt("INP"),r=Jt(e,i,On,t.reportAllChanges)})))})))},lcp:function(e,t){t=t||{},cn((function(){var n,r=ln(),i=Yt("LCP"),a=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-Kt(),0),i.entries=[e],n())}))},o=Xt("largest-contentful-paint",a);if(o){n=Jt(e,i,Tn,t.reportAllChanges);var s=tn((function(){Cn[i.id]||(a(o.takeRecords()),o.disconnect(),Cn[i.id]=!0,n(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return _n(s)}),!0)})),en(s),Wt((function(r){i=Yt("LCP"),n=Jt(e,i,Tn,t.reportAllChanges),Zt((function(){i.value=performance.now()-r.timeStamp,Cn[i.id]=!0,n(!0)}))}))}}))},ttfb:function(e,t){t=t||{};var n=Yt("TTFB"),r=Jt(e,n,kn,t.reportAllChanges);Pn((function(){var i=Qt();i&&(n.value=Math.max(i.responseStart-Kt(),0),n.entries=[i],r(!0),Wt((function(){n=Yt("TTFB",0),(r=Jt(e,n,kn,t.reportAllChanges))(!0)})))}))}};var Fn,$n,Bn,Vn=function(){var e=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},zn=function(e){if("loading"===document.readyState)return"loading";var t=Vn();if(t){if(e<t.domInteractive)return"loading";if(0===t.domContentLoadedEventStart||e<t.domContentLoadedEventStart)return"dom-interactive";if(0===t.domComplete||e<t.domComplete)return"dom-content-loaded"}return"complete"},Un=function(e){var t=e.nodeName;return 1===e.nodeType?t.toLowerCase():t.toUpperCase().replace(/^#/,"")},qn=function(e,t){var n="";try{for(;e&&9!==e.nodeType;){var r=e,i=r.id?"#"+r.id:Un(r)+(r.classList&&r.classList.value&&r.classList.value.trim()&&r.classList.value.trim().length?"."+r.classList.value.trim().replace(/\s+/g,"."):"");if(n.length+i.length>(t||100)-1)return n||i;if(n=n?i+">"+n:i,r.id)break;e=r.parentNode}}catch(e){}return n},Hn=-1,Gn=function(){return Hn},Wn=function(e){addEventListener("pageshow",(function(t){t.persisted&&(Hn=t.timeStamp,e(t))}),!0)},Qn=function(){var e=Vn();return e&&e.activationStart||0},Kn=function(e,t){var n=Vn(),r="navigate";return Gn()>=0?r="back-forward-cache":n&&(document.prerendering||Qn()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:e,value:void 0===t?-1:t,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},Yn=function(e,t,n){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var r=new PerformanceObserver((function(e){Promise.resolve().then((function(){t(e.getEntries())}))}));return r.observe(Object.assign({type:e,buffered:!0},n||{})),r}}catch(e){}},Xn=function(e,t,n,r){var i,a;return function(o){t.value>=0&&(o||r)&&((a=t.value-(i||0))||void 0===i)&&(i=t.value,t.delta=a,t.rating=function(e,t){return e>t[1]?"poor":e>t[0]?"needs-improvement":"good"}(t.value,n),e(t))}},Jn=function(e){requestAnimationFrame((function(){return requestAnimationFrame((function(){return e()}))}))},Zn=function(e){document.addEventListener("visibilitychange",(function(){"hidden"===document.visibilityState&&e()}))},er=function(e){var t=!1;return function(){t||(e(),t=!0)}},tr=-1,nr=function(){return"hidden"!==document.visibilityState||document.prerendering?1/0:0},rr=function(e){"hidden"===document.visibilityState&&tr>-1&&(tr="visibilitychange"===e.type?e.timeStamp:0,ar())},ir=function(){addEventListener("visibilitychange",rr,!0),addEventListener("prerenderingchange",rr,!0)},ar=function(){removeEventListener("visibilitychange",rr,!0),removeEventListener("prerenderingchange",rr,!0)},or=function(){return tr<0&&(tr=nr(),ir(),Wn((function(){setTimeout((function(){tr=nr(),ir()}),0)}))),{get firstHiddenTime(){return tr}}},sr=function(e){document.prerendering?addEventListener("prerenderingchange",(function(){return e()}),!0):e()},lr=[1800,3e3],cr=function(e,t){t=t||{},sr((function(){var n,r=or(),i=Kn("FCP"),a=Yn("paint",(function(e){e.forEach((function(e){"first-contentful-paint"===e.name&&(a.disconnect(),e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-Qn(),0),i.entries.push(e),n(!0)))}))}));a&&(n=Xn(e,i,lr,t.reportAllChanges),Wn((function(r){i=Kn("FCP"),n=Xn(e,i,lr,t.reportAllChanges),Jn((function(){i.value=performance.now()-r.timeStamp,n(!0)}))})))}))},ur=[.1,.25],dr=0,pr=1/0,hr=0,fr=function(e){e.forEach((function(e){e.interactionId&&(pr=Math.min(pr,e.interactionId),hr=Math.max(hr,e.interactionId),dr=hr?(hr-pr)/7+1:0)}))},mr=[],gr=new Map,yr=0,br=[],vr=function(e){if(br.forEach((function(t){return t(e)})),e.interactionId||"first-input"===e.entryType){var t=mr[mr.length-1],n=gr.get(e.interactionId);if(n||mr.length<10||e.duration>t.latency){if(n)e.duration>n.latency?(n.entries=[e],n.latency=e.duration):e.duration===n.latency&&e.startTime===n.entries[0].startTime&&n.entries.push(e);else{var r={id:e.interactionId,latency:e.duration,entries:[e]};gr.set(r.id,r),mr.push(r)}mr.sort((function(e,t){return t.latency-e.latency})),mr.length>10&&mr.splice(10).forEach((function(e){return gr.delete(e.id)}))}}},wr=function(e){var t=self.requestIdleCallback||self.setTimeout,n=-1;return e=er(e),"hidden"===document.visibilityState?e():(n=t(e),Zn(e)),n},Sr=[200,500],Er=[],xr=[],_r=new WeakMap,Or=new Map,Tr=-1,Cr=function(e){Er=Er.concat(e),kr()},kr=function(){Tr<0&&(Tr=wr(Pr))},Pr=function(){Or.size>10&&Or.forEach((function(e,t){gr.has(t)||Or.delete(t)}));var e=mr.map((function(e){return _r.get(e.entries[0])})),t=xr.length-50;xr=xr.filter((function(n,r){return r>=t||e.includes(n)}));for(var n=new Set,r=0;r<xr.length;r++){var i=xr[r];Ir(i.startTime,i.processingEnd).forEach((function(e){n.add(e)}))}for(var a=0;a<50;a++){var o=Er[Er.length-1-a];if(!o||o.startTime<Bn)break;n.add(o)}Er=Array.from(n),Tr=-1};br.push((function(e){e.interactionId&&e.target&&!Or.has(e.interactionId)&&Or.set(e.interactionId,e.target)}),(function(e){var t,n=e.startTime+e.duration;Bn=Math.max(Bn,e.processingEnd);for(var r=xr.length-1;r>=0;r--){var i=xr[r];if(Math.abs(n-i.renderTime)<=8){(t=i).startTime=Math.min(e.startTime,t.startTime),t.processingStart=Math.min(e.processingStart,t.processingStart),t.processingEnd=Math.max(e.processingEnd,t.processingEnd),t.entries.push(e);break}}t||(t={startTime:e.startTime,processingStart:e.processingStart,processingEnd:e.processingEnd,renderTime:n,entries:[e]},xr.push(t)),(e.interactionId||"first-input"===e.entryType)&&_r.set(e,t),kr()}));var Ar,Rr,Dr,jr,Ir=function(e,t){for(var n,r=[],i=0;n=Er[i];i++)if(!(n.startTime+n.duration<e)){if(n.startTime>t)break;r.push(n)}return r},Nr=[2500,4e3],Lr={},Mr=[800,1800],Fr=function e(t){document.prerendering?sr((function(){return e(t)})):"complete"!==document.readyState?addEventListener("load",(function(){return e(t)}),!0):setTimeout(t,0)},$r=function(e,t){t=t||{};var n=Kn("TTFB"),r=Xn(e,n,Mr,t.reportAllChanges);Fr((function(){var i=Vn();i&&(n.value=Math.max(i.responseStart-Qn(),0),n.entries=[i],r(!0),Wn((function(){n=Kn("TTFB",0),(r=Xn(e,n,Mr,t.reportAllChanges))(!0)})))}))},Br={passive:!0,capture:!0},Vr=new Date,zr=function(e,t){Ar||(Ar=t,Rr=e,Dr=new Date,Hr(removeEventListener),Ur())},Ur=function(){if(Rr>=0&&Rr<Dr-Vr){var e={entryType:"first-input",name:Ar.type,target:Ar.target,cancelable:Ar.cancelable,startTime:Ar.timeStamp,processingStart:Ar.timeStamp+Rr};jr.forEach((function(t){t(e)})),jr=[]}},qr=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){zr(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,Br),removeEventListener("pointercancel",r,Br)};addEventListener("pointerup",n,Br),addEventListener("pointercancel",r,Br)}(t,e):zr(t,e)}},Hr=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,qr,Br)}))},Gr=[100,300];const Wr="com.grafana.faro.lastNavigationId",Qr="load_state",Kr="time_to_first_byte";class Yr{constructor(e){this.corePushMeasurement=e}initialize(){this.measureCLS(),this.measureFCP(),this.measureFID(),this.measureINP(),this.measureLCP(),this.measureTTFB()}measureCLS(){!function(e,t){!function(e,t){t=t||{},cr(er((function(){var n,r=Kn("CLS",0),i=0,a=[],o=function(e){e.forEach((function(e){if(!e.hadRecentInput){var t=a[0],n=a[a.length-1];i&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(i+=e.value,a.push(e)):(i=e.value,a=[e])}})),i>r.value&&(r.value=i,r.entries=a,n())},s=Yn("layout-shift",o);s&&(n=Xn(e,r,ur,t.reportAllChanges),Zn((function(){o(s.takeRecords()),n(!0)})),Wn((function(){i=0,r=Kn("CLS",0),n=Xn(e,r,ur,t.reportAllChanges),Jn((function(){return n()}))})),setTimeout(n,0))})))}((function(t){var n=function(e){var t,n={};if(e.entries.length){var r=e.entries.reduce((function(e,t){return e&&e.value>t.value?e:t}));if(r&&r.sources&&r.sources.length){var i=(t=r.sources).find((function(e){return e.node&&1===e.node.nodeType}))||t[0];i&&(n={largestShiftTarget:qn(i.node),largestShiftTime:r.startTime,largestShiftValue:r.value,largestShiftSource:i,largestShiftEntry:r,loadState:zn(r.startTime)})}}return Object.assign(e,{attribution:n})}(t);e(n)}),void 0)}((e=>{const{loadState:t,largestShiftValue:n,largestShiftTime:r,largestShiftTarget:i}=e.attribution,a=this.buildInitialValues(e);this.addIfPresent(a,"largest_shift_value",n),this.addIfPresent(a,"largest_shift_time",r);const o=this.buildInitialContext(e);this.addIfPresent(o,Qr,t),this.addIfPresent(o,"largest_shift_target",i),this.pushMeasurement(a,o)}))}measureFCP(){!function(e,t){cr((function(t){var n=function(e){var t={timeToFirstByte:0,firstByteToFCP:e.value,loadState:zn(Gn())};if(e.entries.length){var n=Vn(),r=e.entries[e.entries.length-1];if(n){var i=n.activationStart||0,a=Math.max(0,n.responseStart-i);t={timeToFirstByte:a,firstByteToFCP:e.value-a,loadState:zn(e.entries[0].startTime),navigationEntry:n,fcpEntry:r}}}return Object.assign(e,{attribution:t})}(t);e(n)}),void 0)}((e=>{const{firstByteToFCP:t,timeToFirstByte:n,loadState:r}=e.attribution,i=this.buildInitialValues(e);this.addIfPresent(i,"first_byte_to_fcp",t),this.addIfPresent(i,Kr,n);const a=this.buildInitialContext(e);this.addIfPresent(a,Qr,r),this.pushMeasurement(i,a)}))}measureFID(){!function(e,t){!function(e,t){t=t||{},sr((function(){var n,r=or(),i=Kn("FID"),a=function(e){e.startTime<r.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},o=function(e){e.forEach(a)},s=Yn("first-input",o);n=Xn(e,i,Gr,t.reportAllChanges),s&&(Zn(er((function(){o(s.takeRecords()),s.disconnect()}))),Wn((function(){var r;i=Kn("FID"),n=Xn(e,i,Gr,t.reportAllChanges),jr=[],Rr=-1,Ar=null,Hr(addEventListener),r=a,jr.push(r),Ur()})))}))}((function(t){var n=function(e){var t=e.entries[0],n={eventTarget:qn(t.target),eventType:t.name,eventTime:t.startTime,eventEntry:t,loadState:zn(t.startTime)};return Object.assign(e,{attribution:n})}(t);e(n)}),t)}((e=>{const{eventTime:t,eventTarget:n,eventType:r,loadState:i}=e.attribution,a=this.buildInitialValues(e);this.addIfPresent(a,"event_time",t);const o=this.buildInitialContext(e);this.addIfPresent(o,"event_target",n),this.addIfPresent(o,"event_type",r),this.addIfPresent(o,Qr,i),this.pushMeasurement(a,o)}))}measureINP(){!function(e,t){$n||($n=Yn("long-animation-frame",Cr)),function(e,t){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(t=t||{},sr((function(){var n;"interactionCount"in performance||Fn||(Fn=Yn("event",fr,{type:"event",buffered:!0,durationThreshold:0}));var r,i=Kn("INP"),a=function(e){wr((function(){e.forEach(vr);var t,n=(t=Math.min(mr.length-1,Math.floor(((Fn?dr:performance.interactionCount||0)-yr)/50)),mr[t]);n&&n.latency!==i.value&&(i.value=n.latency,i.entries=n.entries,r())}))},o=Yn("event",a,{durationThreshold:null!==(n=t.durationThreshold)&&void 0!==n?n:40});r=Xn(e,i,Sr,t.reportAllChanges),o&&(o.observe({type:"first-input",buffered:!0}),Zn((function(){a(o.takeRecords()),r(!0)})),Wn((function(){yr=0,mr.length=0,gr.clear(),i=Kn("INP"),r=Xn(e,i,Sr,t.reportAllChanges)})))})))}((function(t){var n=function(e){var t=e.entries[0],n=_r.get(t),r=t.processingStart,i=n.processingEnd,a=n.entries.sort((function(e,t){return e.processingStart-t.processingStart})),o=Ir(t.startTime,i),s=e.entries.find((function(e){return e.target})),l=s&&s.target||Or.get(t.interactionId),c=[t.startTime+t.duration,i].concat(o.map((function(e){return e.startTime+e.duration}))),u=Math.max.apply(Math,c),d={interactionTarget:qn(l),interactionTargetElement:l,interactionType:t.name.startsWith("key")?"keyboard":"pointer",interactionTime:t.startTime,nextPaintTime:u,processedEventEntries:a,longAnimationFrameEntries:o,inputDelay:r-t.startTime,processingDuration:i-r,presentationDelay:Math.max(u-i,0),loadState:zn(t.startTime)};return Object.assign(e,{attribution:d})}(t);e(n)}),void 0)}((e=>{const{interactionTime:t,presentationDelay:n,inputDelay:r,processingDuration:i,nextPaintTime:a,loadState:o,interactionTarget:s,interactionType:l}=e.attribution,c=this.buildInitialValues(e);this.addIfPresent(c,"interaction_time",t),this.addIfPresent(c,"presentation_delay",n),this.addIfPresent(c,"input_delay",r),this.addIfPresent(c,"processing_duration",i),this.addIfPresent(c,"next_paint_time",a);const u=this.buildInitialContext(e);this.addIfPresent(u,Qr,o),this.addIfPresent(u,"interaction_target",s),this.addIfPresent(u,"interaction_type",l),this.pushMeasurement(c,u)}))}measureLCP(){!function(e,t){!function(e,t){t=t||{},sr((function(){var n,r=or(),i=Kn("LCP"),a=function(e){t.reportAllChanges||(e=e.slice(-1)),e.forEach((function(e){e.startTime<r.firstHiddenTime&&(i.value=Math.max(e.startTime-Qn(),0),i.entries=[e],n())}))},o=Yn("largest-contentful-paint",a);if(o){n=Xn(e,i,Nr,t.reportAllChanges);var s=er((function(){Lr[i.id]||(a(o.takeRecords()),o.disconnect(),Lr[i.id]=!0,n(!0))}));["keydown","click"].forEach((function(e){addEventListener(e,(function(){return wr(s)}),!0)})),Zn(s),Wn((function(r){i=Kn("LCP"),n=Xn(e,i,Nr,t.reportAllChanges),Jn((function(){i.value=performance.now()-r.timeStamp,Lr[i.id]=!0,n(!0)}))}))}}))}((function(t){var n=function(e){var t={timeToFirstByte:0,resourceLoadDelay:0,resourceLoadDuration:0,elementRenderDelay:e.value};if(e.entries.length){var n=Vn();if(n){var r=n.activationStart||0,i=e.entries[e.entries.length-1],a=i.url&&performance.getEntriesByType("resource").filter((function(e){return e.name===i.url}))[0],o=Math.max(0,n.responseStart-r),s=Math.max(o,a?(a.requestStart||a.startTime)-r:0),l=Math.max(s,a?a.responseEnd-r:0),c=Math.max(l,i.startTime-r);t={element:qn(i.element),timeToFirstByte:o,resourceLoadDelay:s-o,resourceLoadDuration:l-s,elementRenderDelay:c-l,navigationEntry:n,lcpEntry:i},i.url&&(t.url=i.url),a&&(t.lcpResourceEntry=a)}}return Object.assign(e,{attribution:t})}(t);e(n)}),void 0)}((e=>{const{elementRenderDelay:t,resourceLoadDelay:n,resourceLoadDuration:r,timeToFirstByte:i,element:a}=e.attribution,o=this.buildInitialValues(e);this.addIfPresent(o,"element_render_delay",t),this.addIfPresent(o,"resource_load_delay",n),this.addIfPresent(o,"resource_load_duration",r),this.addIfPresent(o,Kr,i);const s=this.buildInitialContext(e);this.addIfPresent(s,"element",a),this.pushMeasurement(o,s)}))}measureTTFB(){!function(e,t){$r((function(t){var n=function(e){var t={waitingDuration:0,cacheDuration:0,dnsDuration:0,connectionDuration:0,requestDuration:0};if(e.entries.length){var n=e.entries[0],r=n.activationStart||0,i=Math.max((n.workerStart||n.fetchStart)-r,0),a=Math.max(n.domainLookupStart-r,0),o=Math.max(n.connectStart-r,0),s=Math.max(n.connectEnd-r,0);t={waitingDuration:i,cacheDuration:a-i,dnsDuration:o-a,connectionDuration:s-o,requestDuration:e.value-s,navigationEntry:n}}return Object.assign(e,{attribution:t})}(t);e(n)}),void 0)}((e=>{const{dnsDuration:t,connectionDuration:n,requestDuration:r,waitingDuration:i,cacheDuration:a}=e.attribution,o=this.buildInitialValues(e);this.addIfPresent(o,"dns_duration",t),this.addIfPresent(o,"connection_duration",n),this.addIfPresent(o,"request_duration",r),this.addIfPresent(o,"waiting_duration",i),this.addIfPresent(o,"cache_duration",a);const s=this.buildInitialContext(e);this.pushMeasurement(o,s)}))}buildInitialValues(e){const t=e.name.toLowerCase();return{[t]:e.value,delta:e.delta}}buildInitialContext(e){var t;const n=null!==(t=gt(Wr,ft.session))&&void 0!==t?t:st;return{id:e.id,rating:e.rating,navigation_type:e.navigationType,navigation_entry_id:n}}pushMeasurement(e,t){this.corePushMeasurement({type:"web-vitals",values:e},{context:t})}addIfPresent(e,t,n){n&&(e[t]=n)}}class Xr extends It{constructor(){super(...arguments),this.name="@grafana/faro-web-sdk:instrumentation-web-vitals",this.version=Ce}initialize(){this.logDebug("Initializing"),this.intializeWebVitalsInstrumentation().initialize()}intializeWebVitalsInstrumentation(){return this.config.trackWebVitalsAttribution?new Yr(this.api.pushMeasurement):new Mn(this.api.pushMeasurement)}}const Jr="session_start",Zr="session_resume";class ei extends It{constructor(){super(...arguments),this.name="@grafana/faro-web-sdk:instrumentation-session",this.version=Ce}sendSessionStartEvent(e){var t,n;const r=e.session;if(r&&r.id!==(null===(t=this.notifiedSession)||void 0===t?void 0:t.id)){if(this.notifiedSession&&this.notifiedSession.id===(null===(n=r.attributes)||void 0===n?void 0:n.previousSession))return this.api.pushEvent("session_extend",{},void 0,{skipDedupe:!0}),void(this.notifiedSession=r);this.notifiedSession=r,this.api.pushEvent(Jr,{},void 0,{skipDedupe:!0})}}createInitialSession(e,t){var n,r,i,a,o;let s,l,c=e.fetchUserSession();if(t.persistent&&t.maxSessionPersistenceTime&&c){const e=G();c.lastActivity<e-t.maxSessionPersistenceTime&&(Pt.removeUserSession(),c=null)}if(Tt(c)){const e=null==c?void 0:c.sessionId;l=Ot({sessionId:e,isSampled:c.isSampled||!1,started:null==c?void 0:c.started}),l.sessionMeta={id:e,attributes:Object.assign(Object.assign(Object.assign({},null===(n=t.session)||void 0===n?void 0:n.attributes),null===(r=null==c?void 0:c.sessionMeta)||void 0===r?void 0:r.attributes),{isSampled:l.isSampled.toString()})},s=Zr}else{const e=null!==(a=null===(i=t.session)||void 0===i?void 0:i.id)&&void 0!==a?a:function(e){var t,n,r,i;return{id:null!==(i=null===(r=null===(n=null===(t=Pe.config)||void 0===t?void 0:t.sessionTracking)||void 0===n?void 0:n.generateSessionId)||void 0===r?void 0:r.call(n))&&void 0!==i?i:_t(),attributes:void 0}}().id;l=Ot({sessionId:e,isSampled:Et()}),l.sessionMeta={id:e,attributes:Object.assign({isSampled:l.isSampled.toString()},null===(o=t.session)||void 0===o?void 0:o.attributes)},s=Jr}return{initialSession:l,lifecycleType:s}}registerBeforeSendHook(e){var t;const{updateSession:n}=new e;null===(t=this.transports)||void 0===t||t.addBeforeSendHooks((e=>{var t,r,i;n();const a=null===(t=e.meta.session)||void 0===t?void 0:t.attributes;if(a&&"true"===(null==a?void 0:a.isSampled)){let t=JSON.parse(JSON.stringify(e));const n=null===(r=t.meta.session)||void 0===r?void 0:r.attributes;return null==n||delete n.isSampled,0===Object.keys(null!=n?n:{}).length&&(null===(i=t.meta.session)||void 0===i||delete i.attributes),t}return null}))}initialize(){this.logDebug("init session instrumentation");const e=this.config.sessionTracking;if(null==e?void 0:e.enabled){const t=Rt(e);this.registerBeforeSendHook(t);const{initialSession:n,lifecycleType:r}=this.createInitialSession(t,e);t.storeUserSession(n);const i=n.sessionMeta;this.notifiedSession=i,this.api.setSession(i),r===Jr&&this.api.pushEvent(Jr,{},void 0,{skipDedupe:!0}),r===Zr&&this.api.pushEvent(Zr,{},void 0,{skipDedupe:!0})}this.metas.addListener(this.sendSessionStartEvent.bind(this))}}class ti extends It{constructor(){super(...arguments),this.name="@grafana/faro-web-sdk:instrumentation-view",this.version=Ce}sendViewChangedEvent(e){var t,n,r,i;const a=e.view;a&&a.name!==(null===(t=this.notifiedView)||void 0===t?void 0:t.name)&&(this.api.pushEvent("view_changed",{fromView:null!==(r=null===(n=this.notifiedView)||void 0===n?void 0:n.name)&&void 0!==r?r:st,toView:null!==(i=a.name)&&void 0!==i?i:st},void 0,{skipDedupe:!0}),this.notifiedView=a)}initialize(){this.metas.addListener(this.sendViewChangedEvent.bind(this))}}const ni=/^00-[a-f0-9]{32}-[a-f0-9]{16}-[0-9]{1,2}$/;function ri(e=[]){for(const t of e)if("traceparent"===t.name){if(!ni.test(t.description))continue;const[,e,n]=t.description.split("-");if(null!=e&&null!=n)return{traceId:e,spanId:n};break}}function ii(e=[],t){return e.some((e=>e&&null!=t.match(e)))}function ai(e,t={}){for(const[n,r]of Object.entries(t)){const t=e[n];return null!=t&&(re(r)?r.includes(t):t===r)}return!0}function oi(e){const{connectEnd:t,connectStart:n,decodedBodySize:r,domainLookupEnd:i,domainLookupStart:a,duration:o,encodedBodySize:s,fetchStart:l,initiatorType:c,name:u,nextHopProtocol:d,redirectEnd:p,redirectStart:h,renderBlockingStatus:f,requestStart:m,responseEnd:g,responseStart:y,responseStatus:b,secureConnectionStart:v,transferSize:w,workerStart:S}=e;return{name:u,duration:si(o),tcpHandshakeTime:si(t-n),dnsLookupTime:si(i-a),tlsNegotiationTime:si(m-v),responseStatus:si(b),redirectTime:si(p-h),requestTime:si(y-m),responseTime:si(g-y),fetchTime:si(g-l),serviceWorkerTime:si(l-S),decodedBodySize:si(r),encodedBodySize:si(s),cacheHitStatus:function(){let e="fullLoad";return 0===w?r>0&&(e="cache"):null!=b?304===b&&(e="conditionalFetch"):s>0&&w<s&&(e="conditionalFetch"),e}(),renderBlockingStatus:si(f),protocol:d,initiatorType:c}}function si(e){return null==e?st:"number"==typeof e?Math.round(e).toString():e.toString()}const li={initiatorType:["xmlhttprequest","fetch"]};class ci extends It{constructor(){super(...arguments),this.name="@grafana/faro-web-sdk:instrumentation-performance",this.version=Ce}initialize(){"PerformanceObserver"in window?function(e){if("complete"===document.readyState)e();else{const t=()=>{"complete"===document.readyState&&(e(),document.removeEventListener("readystatechange",t))};document.addEventListener("readystatechange",t)}}((()=>function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((r=r.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){const e=this.api.pushEvent,t=this.getIgnoreUrls(),{faroNavigationId:n}=yield function(e,t){let n;const r=new Promise((e=>{n=e})),i=new PerformanceObserver((r=>{var i;const[a]=r.getEntries();if(null==a||ii(t,a.name))return;const o=a.toJSON();let s=ri(null==o?void 0:o.serverTiming);const l=null!==(i=gt(Wr,ft.session))&&void 0!==i?i:st,c=Object.assign(Object.assign({},function(e){const{activationStart:t,domComplete:n,domContentLoadedEventEnd:r,domContentLoadedEventStart:i,domInteractive:a,fetchStart:o,loadEventEnd:s,loadEventStart:l,responseStart:c,type:u}=e,d=function(){var e;return null!=(null===(e=performance.timing)||void 0===e?void 0:e.domLoading)?performance.timing.domLoading-performance.timeOrigin:null}();return Object.assign({visibilityState:document.visibilityState,pageLoadTime:si(n-o),documentParsingTime:si(d?a-d:null),domProcessingTime:si(n-a),domContentLoadHandlerTime:si(r-i),onLoadTime:si(s-l),ttfb:si(Math.max(c-(null!=t?t:0),0)),type:u},oi(e))}(o)),{faroNavigationId:_t(),faroPreviousNavigationId:l});yt(Wr,c.faroNavigationId,ft.session),e("faro.performance.navigation",c,void 0,{spanContext:s,timestampOverwriteMs:performance.timeOrigin+o.startTime}),n(c)}));return i.observe({type:"navigation",buffered:!0}),r}(e,t);null!=n&&function(e,t,n){const r=Pe.config.trackResources;new PerformanceObserver((i=>{const a=i.getEntries();for(const i of a){if(ii(n,i.name))return;const a=i.toJSON();let o=ri(null==a?void 0:a.serverTiming);if(null==r&&ai(a,li)||r){const n=Object.assign(Object.assign({},oi(a)),{faroNavigationId:e,faroResourceId:_t()});t("faro.performance.resource",n,void 0,{spanContext:o,timestampOverwriteMs:performance.timeOrigin+a.startTime})}}})).observe({type:"resource",buffered:!0})}(n,e,t)})))):this.logDebug("performance observer not supported. Disable performance instrumentation.")}getIgnoreUrls(){var e;return null===(e=this.transports.transports)||void 0===e?void 0:e.flatMap((e=>e.getIgnoreUrls()))}}class ui extends It{constructor(e={}){super(),this.options=e,this.name="@grafana/faro-web-sdk:instrumentation-console",this.version=Ce}initialize(){this.logDebug("Initializing\n",this.options),ge.filter((e=>{var t;return!(null!==(t=this.options.disabledLevels)&&void 0!==t?t:ui.defaultDisabledLevels).includes(e)})).forEach((e=>{console[e]=(...t)=>{try{this.api.pushLog(t,{level:e})}catch(e){this.logError(e)}finally{this.unpatchedConsole[e](...t)}}}))}}function di(e={}){const t=[new Bt,new Xr,new ei,new ti];return!1!==e.enablePerformanceInstrumentation&&t.unshift(new ci),!1!==e.captureConsole&&t.push(new ui({disabledLevels:e.captureConsoleDisabledLevels})),t}ui.defaultDisabledLevels=[fe.DEBUG,fe.TRACE,fe.LOG];const pi=JSON.parse('{"id":"grafana-pyroscope-app","mK":[{"type":"page","name":"Explore profiles","path":"/a/%PLUGIN_ID%/profiles-explorer","role":"Viewer","addToNav":true,"defaultNav":false},{"type":"page","name":"Ad hoc view","path":"/a/%PLUGIN_ID%/ad-hoc","role":"Viewer","addToNav":true,"defaultNav":false}]}'),hi=pi.id,fi=`/a/${hi}`;var mi;!function(e){e.PROFILES_EXPLORER_VIEW="/profiles-explorer",e.ADHOC_VIEW="/ad-hoc",e.SETTINGS="/settings"}(mi||(mi={}));const gi="31687553b4ab2a3bc72f9f7d8077c7bb20d6fbe3",yi=[{regExp:/localhost/,environment:"local"},{regExp:/grafana-dev\.net/,environment:"dev"},{regExp:/grafana-ops\.net/,environment:"ops"},{regExp:/grafana\.net/,environment:"prod"}];function bi(){var e,t;if(!(null===(t=window)||void 0===t||null===(e=t.location)||void 0===e?void 0:e.host))return null;const n=yi.find((({regExp:e})=>e.test(window.location.host)));return n?n.environment:null}const vi=new Map([["dev",{environment:"dev",appName:"grafana-pyroscope-dev",faroUrl:"https://faro-collector-ops-eu-south-0.grafana-ops.net/collect/48e03a2647389f2f6494af7f975b4084"}],["ops",{environment:"ops",appName:"grafana-pyroscope-ops",faroUrl:"https://faro-collector-ops-eu-south-0.grafana-ops.net/collect/b5cfd5eeb412cf5e74bd828b4ddd17ff"}],["prod",{environment:"prod",appName:"grafana-pyroscope-prod",faroUrl:"https://faro-collector-ops-eu-south-0.grafana-ops.net/collect/6cbe17b3af4b72ce5936bf4d15a5c393"}]]);let wi=null;const Si=()=>wi;var Ei=__webpack_require__(5959),xi=__webpack_require__.n(Ei),_i=__webpack_require__(2540),Oi=Ei.createContext(void 0),Ti=e=>{const t=Ei.useContext(Oi);if(e)return e;if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Ci=({client:e,children:t})=>(Ei.useEffect((()=>(e.mount(),()=>{e.unmount()})),[e]),(0,_i.jsx)(Oi.Provider,{value:e,children:t}));function ki(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pi(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function Ai(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Ri=new WeakMap,Di=new WeakSet;function ji(e,t){"prod"!==function(e,t){return t.get?t.get.call(e):t.value}(this,Pi(this,Ri,"get"))&&console[e](...t)}const Ii=new class{trace(){var e;Ai(this,Di,ji).call(this,"trace",[]),null===(e=Si())||void 0===e||e.api.pushLog([],{level:fe.TRACE})}debug(...e){var t;Ai(this,Di,ji).call(this,"debug",e),null===(t=Si())||void 0===t||t.api.pushLog(e,{level:fe.DEBUG})}info(...e){var t;Ai(this,Di,ji).call(this,"info",e),null===(t=Si())||void 0===t||t.api.pushLog(e,{level:fe.INFO})}log(...e){var t;Ai(this,Di,ji).call(this,"log",e),null===(t=Si())||void 0===t||t.api.pushLog(e,{level:fe.LOG})}warn(...e){var t;Ai(this,Di,ji).call(this,"warn",e),null===(t=Si())||void 0===t||t.api.pushLog(e,{level:fe.WARN})}error(e,t){var n;Ai(this,Di,ji).call(this,"error",[e]),t&&Ai(this,Di,ji).call(this,"error",["Error context",t]),null===(n=Si())||void 0===n||n.api.pushError(e,{context:t})}constructor(){var e;ki(this,e=Di),e.add(this),function(e,t,n){ki(e,t),t.set(e,{writable:!0,value:void 0})}(this,Ri),function(e,t,n){(function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}})(e,Pi(e,t,"set"),n)}(this,Ri,bi())}};function Ni(e,t){var n=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t);return function(e,t){return t.get?t.get.call(e):t.value}(e,n)}var Li=new WeakMap;const Mi=new class{has(e){return Ni(this,Li).hasOwnProperty(e)}get(e){if(!this.has(e))return null;try{return JSON.parse(Ni(this,Li).getItem(e))}catch(t){return Ii.error(t,{info:`Error parsing JSON for storage item "${e}"!`}),null}}set(e,t){try{Ni(this,Li).setItem(e,JSON.stringify(t))}catch(t){Ii.error(t,{info:`Error setting storage item "${e}"!`})}}constructor(){var e,t,n;(function(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)})(this,Li,{writable:!0,value:window.localStorage}),e=this,t="KEYS",n={SETTINGS:`${pi.id}.userSettings`,GITHUB_INTEGRATION:`${pi.id}.gitHubIntegration`,PROFILES_EXPLORER:`${pi.id}.profilesExplorer`},t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}},Fi=()=>{};function $i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Bi extends Error{constructor(e,t){let n=`HTTP ${e.status} (${e.statusText||"?"})`;(null==t?void 0:t.message)&&(n=`${n}  ${t.message}`),super(n),$i(this,"response",void 0),$i(this,"reason",void 0),this.response=e}}function Vi(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function zi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ui(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){zi(e,t,n[t])}))}return e}class qi{fetch(e,t){var n,r=this;return(n=function*(){r.abortController=new AbortController;const{signal:n}=r.abortController,i=`${r.baseUrl}${e}`,a=Ui({},r.defaultHeaders,null==t?void 0:t.headers),o=(s=Ui({signal:n},t),l=null!=(l={headers:a})?l:{},Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(l)).forEach((function(e){Object.defineProperty(s,e,Object.getOwnPropertyDescriptor(l,e))})),s);var s,l;let c;try{if(c=yield fetch(i,o),!c.ok)throw new Bi(c,yield c.json().catch(Fi))}catch(e){var u;throw r.isAbortError(e)&&(e.reason=(null==t||null===(u=t.signal)||void 0===u?void 0:u.reason)||n.reason),e}finally{r.abortController=null}return c},function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){Vi(a,r,i,o,s,"next",e)}function s(e){Vi(a,r,i,o,s,"throw",e)}o(void 0)}))})()}abort(e){this.abortController&&this.abortController.abort(e)}isAbortError(e){return e instanceof DOMException&&"AbortError"===e.name}constructor(e,t={}){zi(this,"baseUrl",""),zi(this,"defaultHeaders",{}),zi(this,"abortController",null),this.baseUrl=e,this.defaultHeaders=Object.freeze(t)}}class Hi extends qi{static getPyroscopeDataSources(){return Object.values(n.config.datasources).filter((e=>"grafana-pyroscope-datasource"===e.type))}static selectDefaultDataSource(){var e;const t=Hi.getPyroscopeDataSources(),n=new URL(window.location.href).searchParams.get("var-dataSource"),r=null===(e=Mi.get(Mi.KEYS.PROFILES_EXPLORER))||void 0===e?void 0:e.dataSource;return t.find((e=>e.uid===n))||t.find((e=>e.uid===r))||t.find((e=>e.jsonData.overridesDefault))||t.find((e=>e.isDefault))||t[0]||(Ii.warn("Cannot find any Pyroscope data source! Please add and configure a Pyroscope data source to your Grafana instance."),{uid:"no-data-source-configured"})}static getBaseUrl(){const e=Hi.selectDefaultDataSource();let t=n.config.appSubUrl||"";return"/"!==t.at(-1)&&(t+="/"),`${t}api/datasources/proxy/uid/${e.uid}`}constructor(){var e,t;super(Hi.getBaseUrl().toString(),{"content-type":"application/json","X-Grafana-Org-Id":String((null===(t=n.config.bootData)||void 0===t||null===(e=t.user)||void 0===e?void 0:e.orgId)||"")})}}var Gi=class extends T{constructor(e,t){super(),this.options=t,this.#x=e,this.#_=null,this.bindMethods(),this.setOptions(t)}#x;#O=void 0;#T=void 0;#C=void 0;#k;#P;#_;#A;#R;#D;#j;#I;#N;#L=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#O.addObserver(this),Wi(this.#O,this.options)?this.#M():this.updateResult(),this.#F())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Qi(this.#O,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Qi(this.#O,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#$(),this.#B(),this.#O.removeObserver(this)}setOptions(e,t){const n=this.options,r=this.#O;if(this.options=this.#x.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof c(this.options.enabled,this.#O))throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#V(),this.#O.setOptions(this.options),n._defaulted&&!g(this.options,n)&&this.#x.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#O,observer:this});const i=this.hasListeners();i&&Ki(this.#O,r,this.options,n)&&this.#M(),this.updateResult(t),!i||this.#O===r&&c(this.options.enabled,this.#O)===c(n.enabled,this.#O)&&l(this.options.staleTime,this.#O)===l(n.staleTime,this.#O)||this.#z();const a=this.#U();!i||this.#O===r&&c(this.options.enabled,this.#O)===c(n.enabled,this.#O)&&a===this.#N||this.#q(a)}getOptimisticResult(e){const t=this.#x.getQueryCache().build(this.#x,e),n=this.createResult(t,e);return r=n,!g(this.getCurrentResult(),r)&&(this.#C=n,this.#P=this.options,this.#k=this.#O.state),n;var r}getCurrentResult(){return this.#C}trackResult(e,t){const n={};return Object.keys(e).forEach((r=>{Object.defineProperty(n,r,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(r),t?.(r),e[r])})})),n}trackProp(e){this.#L.add(e)}getCurrentQuery(){return this.#O}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#x.defaultQueryOptions(e),n=this.#x.getQueryCache().build(this.#x,t);return n.isFetchingOptimistic=!0,n.fetch().then((()=>this.createResult(n,t)))}fetch(e){return this.#M({...e,cancelRefetch:e.cancelRefetch??!0}).then((()=>(this.updateResult(),this.#C)))}#M(e){this.#V();let t=this.#O.fetch(this.options,e);return e?.throwOnError||(t=t.catch(a)),t}#z(){this.#$();const e=l(this.options.staleTime,this.#O);if(i||this.#C.isStale||!o(e))return;const t=s(this.#C.dataUpdatedAt,e)+1;this.#j=setTimeout((()=>{this.#C.isStale||this.updateResult()}),t)}#U(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#O):this.options.refetchInterval)??!1}#q(e){this.#B(),this.#N=e,!i&&!1!==c(this.options.enabled,this.#O)&&o(this.#N)&&0!==this.#N&&(this.#I=setInterval((()=>{(this.options.refetchIntervalInBackground||C.isFocused())&&this.#M()}),this.#N))}#F(){this.#z(),this.#q(this.#U())}#$(){this.#j&&(clearTimeout(this.#j),this.#j=void 0)}#B(){this.#I&&(clearInterval(this.#I),this.#I=void 0)}createResult(e,t){const n=this.#O,r=this.options,i=this.#C,a=this.#k,o=this.#P,s=e!==n?e.state:this.#T,{state:l}=e;let c,u={...l},d=!1;if(t._optimisticResults){const i=this.hasListeners(),a=!i&&Wi(e,t),o=i&&Ki(e,n,t,r);(a||o)&&(u={...u,...L(l.data,e.options)}),"isRestoring"===t._optimisticResults&&(u.fetchStatus="idle")}let{error:p,errorUpdatedAt:h,status:f}=u;if(t.select&&void 0!==u.data)if(i&&u.data===a?.data&&t.select===this.#A)c=this.#R;else try{this.#A=t.select,c=t.select(u.data),c=w(i?.data,c,t),this.#R=c,this.#_=null}catch(e){this.#_=e}else c=u.data;if(void 0!==t.placeholderData&&void 0===c&&"pending"===f){let e;if(i?.isPlaceholderData&&t.placeholderData===o?.placeholderData)e=i.data;else if(e="function"==typeof t.placeholderData?t.placeholderData(this.#D?.state.data,this.#D):t.placeholderData,t.select&&void 0!==e)try{e=t.select(e),this.#_=null}catch(e){this.#_=e}void 0!==e&&(f="success",c=w(i?.data,e,t),d=!0)}this.#_&&(p=this.#_,c=this.#R,h=Date.now(),f="error");const m="fetching"===u.fetchStatus,g="pending"===f,y="error"===f,b=g&&m,v=void 0!==c;return{status:f,fetchStatus:u.fetchStatus,isPending:g,isSuccess:"success"===f,isError:y,isInitialLoading:b,isLoading:b,data:c,dataUpdatedAt:u.dataUpdatedAt,error:p,errorUpdatedAt:h,failureCount:u.fetchFailureCount,failureReason:u.fetchFailureReason,errorUpdateCount:u.errorUpdateCount,isFetched:u.dataUpdateCount>0||u.errorUpdateCount>0,isFetchedAfterMount:u.dataUpdateCount>s.dataUpdateCount||u.errorUpdateCount>s.errorUpdateCount,isFetching:m,isRefetching:m&&!g,isLoadingError:y&&!v,isPaused:"paused"===u.fetchStatus,isPlaceholderData:d,isRefetchError:y&&v,isStale:Yi(e,t),refetch:this.refetch}}updateResult(e){const t=this.#C,n=this.createResult(this.#O,this.options);if(this.#k=this.#O.state,this.#P=this.options,void 0!==this.#k.data&&(this.#D=this.#O),g(n,t))return;this.#C=n;const r={};!1!==e?.listeners&&(()=>{if(!t)return!0;const{notifyOnChangeProps:e}=this.options,n="function"==typeof e?e():e;if("all"===n||!n&&!this.#L.size)return!0;const r=new Set(n??this.#L);return this.options.throwOnError&&r.add("error"),Object.keys(this.#C).some((e=>{const n=e;return this.#C[n]!==t[n]&&r.has(n)}))})()&&(r.listeners=!0),this.#H({...r,...e})}#V(){const e=this.#x.getQueryCache().build(this.#x,this.options);if(e===this.#O)return;const t=this.#O;this.#O=e,this.#T=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#F()}#H(e){O.batch((()=>{e.listeners&&this.listeners.forEach((e=>{e(this.#C)})),this.#x.getQueryCache().notify({query:this.#O,type:"observerResultsUpdated"})}))}};function Wi(e,t){return function(e,t){return!1!==c(t.enabled,e)&&void 0===e.state.data&&!("error"===e.state.status&&!1===t.retryOnMount)}(e,t)||void 0!==e.state.data&&Qi(e,t,t.refetchOnMount)}function Qi(e,t,n){if(!1!==c(t.enabled,e)){const r="function"==typeof n?n(e):n;return"always"===r||!1!==r&&Yi(e,t)}return!1}function Ki(e,t,n,r){return(e!==t||!1===c(r.enabled,e))&&(!n.suspense||"error"!==e.state.status)&&Yi(e,n)}function Yi(e,t){return!1!==c(t.enabled,e)&&e.isStaleByTime(l(t.staleTime,e))}var Xi=Ei.createContext(function(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}()),Ji=()=>Ei.useContext(Xi),Zi=Ei.createContext(!1),ea=()=>Ei.useContext(Zi);function ta(e,t){return"function"==typeof e?e(...t):!!e}function na(){}Zi.Provider;var ra=(e,t)=>{(e.suspense||e.throwOnError)&&(t.isReset()||(e.retryOnMount=!1))},ia=e=>{Ei.useEffect((()=>{e.clearReset()}),[e])},aa=({result:e,errorResetBoundary:t,throwOnError:n,query:r})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&ta(n,[e.error,r]),oa=e=>{e.suspense&&"number"!=typeof e.staleTime&&(e.staleTime=1e3)},sa=(e,t)=>e?.suspense&&t.isPending,la=(e,t,n)=>t.fetchOptimistic(e).catch((()=>{n.clearReset()}));function ca(e,t){return function(e,t,n){const r=Ti(n),i=ea(),a=Ji(),o=r.defaultQueryOptions(e);r.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=i?"isRestoring":"optimistic",oa(o),ra(o,a),ia(a);const[s]=Ei.useState((()=>new t(r,o))),l=s.getOptimisticResult(o);if(Ei.useSyncExternalStore(Ei.useCallback((e=>{const t=i?()=>{}:s.subscribe(O.batchCalls(e));return s.updateResult(),t}),[s,i]),(()=>s.getCurrentResult()),(()=>s.getCurrentResult())),Ei.useEffect((()=>{s.setOptions(o,{listeners:!1})}),[o,s]),sa(o,l))throw la(o,s,a);if(aa({result:l,errorResetBoundary:a,throwOnError:o.throwOnError,query:r.getQueryCache().get(o.queryHash)}))throw l.error;return r.getDefaultOptions().queries?._experimental_afterQuery?.(o,l),o.notifyOnChangeProps?l:s.trackResult(l)}(e,Gi,t)}function ua(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}const da=new class extends Hi{get(){var e,t=this;return(e=function*(){const e=yield t.fetch("/querier.v1.QuerierService/GetProfileStats",{method:"POST",body:JSON.stringify({})}),n=yield e.json();return{hasIngestedData:n.dataIngested,oldestProfileTime:Number(n.oldestProfileTime),newestProfileTime:Number(n.newestProfileTime)}},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){ua(a,r,i,o,s,"next",e)}function s(e){ua(a,r,i,o,s,"throw",e)}o(void 0)}))})()}};const pa=e=>({row:(0,t.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start"}),headerColumn:(0,t.css)({display:"flex",flexDirection:"column",minWidth:"120px",alignItems:"start"}),column:(0,t.css)({display:"flex",flexDirection:"column",minWidth:"120px",alignItems:"end"}),tooltip:(0,t.css)({display:"flex",color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize}),contentWithIcon:(0,t.css)({display:"none",[`@media ${r.styleMixins.mediaUp(e.v1.breakpoints.sm)}`]:{display:"block"}})}),ha=t=>(0,e.formattedValueToString)((0,e.getValueFormat)("decbytes")(t)),fa=t=>(0,e.formattedValueToString)((0,e.getValueFormat)("short")(t));function ma(e){const t=(0,r.useStyles2)(pa),{data:n}=e,i=ha(n.queryImpact.totalBytesInTimeRange),a=(0,Ei.useMemo)((()=>xi().createElement("div",{"data-testid":"queryAnalysis-popup"},xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Data in time range"),xi().createElement("div",{className:t.column},i),xi().createElement("div",{className:t.column},"")),void 0!==n.queryImpact.totalQueriedSeries&&xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Series in query"),xi().createElement("div",{className:t.column},fa(n.queryImpact.totalQueriedSeries)),xi().createElement("div",{className:t.column},"")),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Deduplication"),xi().createElement("div",{className:t.column},n.queryImpact.deduplicationNeeded?"yes":"no"),xi().createElement("div",{className:t.column},"")),xi().createElement(r.Divider,null),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},""),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},xi().createElement("strong",null,e.componentType))))),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Replicas"),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},e.componentCount||"/")))),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Blocks"),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},fa(e.blockCount)||"/")))),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Series"),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},fa(e.seriesCount)||"/")))),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Profiles"),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},fa(e.profileCount)||"/")))),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Samples"),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},fa(e.sampleCount)||"/")))),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},""),xi().createElement("div",{className:t.column},""),xi().createElement("div",{className:t.column},"")),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Index Store"),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},ha(e.indexBytes)||"/")))),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Profiles Store"),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},ha(e.profileBytes)||"/")))),xi().createElement("div",{className:t.row},xi().createElement("div",{className:t.headerColumn},"Symbols Store"),n.queryScopes.map(((e,n)=>xi().createElement("div",{key:n,className:t.column},ha(e.symbolBytes)||"/")))))),[n,t,i]);return xi().createElement(xi().Fragment,null,void 0!==n.queryImpact.totalBytesInTimeRange?xi().createElement(r.Toggletip,{content:a,fitContent:!0},xi().createElement("div",{className:t.tooltip,"data-testid":"queryAnalysis-tooltip"},xi().createElement("span",{className:t.contentWithIcon},"Stored data in time range: ",i),"",xi().createElement(r.IconButton,{name:"database","aria-label":"Query info"}))):null)}var ga,ya,ba,va,wa=__webpack_require__(2688),Sa=__webpack_require__.n(wa),Ea=__webpack_require__(9406),xa=__webpack_require__.n(Ea),_a=__webpack_require__(7383),Oa=__webpack_require__.n(_a),Ta=__webpack_require__(1664),Ca=__webpack_require__.n(Ta),ka="bodyAttributes",Pa="htmlAttributes",Aa={BASE:"base",BODY:"body",HEAD:"head",HTML:"html",LINK:"link",META:"meta",NOSCRIPT:"noscript",SCRIPT:"script",STYLE:"style",TITLE:"title"},Ra=(Object.keys(Aa).map((function(e){return Aa[e]})),"charset"),Da="cssText",ja="href",Ia="innerHTML",Na="itemprop",La="rel",Ma={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},Fa=Object.keys(Ma).reduce((function(e,t){return e[Ma[t]]=t,e}),{}),$a=[Aa.NOSCRIPT,Aa.SCRIPT,Aa.STYLE],Ba="data-react-helmet",Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},za=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ua=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qa=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},Ha=function(e){return!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")},Ga=function(e){var t=Xa(e,Aa.TITLE),n=Xa(e,"titleTemplate");if(n&&t)return n.replace(/%s/g,(function(){return Array.isArray(t)?t.join(""):t}));var r=Xa(e,"defaultTitle");return t||r||void 0},Wa=function(e){return Xa(e,"onChangeClientState")||function(){}},Qa=function(e,t){return t.filter((function(t){return void 0!==t[e]})).map((function(t){return t[e]})).reduce((function(e,t){return Ua({},e,t)}),{})},Ka=function(e,t){return t.filter((function(e){return void 0!==e[Aa.BASE]})).map((function(e){return e[Aa.BASE]})).reverse().reduce((function(t,n){if(!t.length)for(var r=Object.keys(n),i=0;i<r.length;i++){var a=r[i].toLowerCase();if(-1!==e.indexOf(a)&&n[a])return t.concat(n)}return t}),[])},Ya=function(e,t,n){var r={};return n.filter((function(t){return!!Array.isArray(t[e])||(void 0!==t[e]&&no("Helmet: "+e+' should be of type "Array". Instead found type "'+Va(t[e])+'"'),!1)})).map((function(t){return t[e]})).reverse().reduce((function(e,n){var i={};n.filter((function(e){for(var n=void 0,a=Object.keys(e),o=0;o<a.length;o++){var s=a[o],l=s.toLowerCase();-1===t.indexOf(l)||n===La&&"canonical"===e[n].toLowerCase()||l===La&&"stylesheet"===e[l].toLowerCase()||(n=l),-1===t.indexOf(s)||s!==Ia&&s!==Da&&s!==Na||(n=s)}if(!n||!e[n])return!1;var c=e[n].toLowerCase();return r[n]||(r[n]={}),i[n]||(i[n]={}),!r[n][c]&&(i[n][c]=!0,!0)})).reverse().forEach((function(t){return e.push(t)}));for(var a=Object.keys(i),o=0;o<a.length;o++){var s=a[o],l=Ca()({},r[s],i[s]);r[s]=l}return e}),[]).reverse()},Xa=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.hasOwnProperty(t))return r[t]}return null},Ja=(ga=Date.now(),function(e){var t=Date.now();t-ga>16?(ga=t,e(t)):setTimeout((function(){Ja(e)}),0)}),Za=function(e){return clearTimeout(e)},eo="undefined"!=typeof window?window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||Ja:__webpack_require__.g.requestAnimationFrame||Ja,to="undefined"!=typeof window?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||Za:__webpack_require__.g.cancelAnimationFrame||Za,no=function(e){return console&&"function"==typeof console.warn&&console.warn(e)},ro=null,io=function(e,t){var n=e.baseTag,r=e.bodyAttributes,i=e.htmlAttributes,a=e.linkTags,o=e.metaTags,s=e.noscriptTags,l=e.onChangeClientState,c=e.scriptTags,u=e.styleTags,d=e.title,p=e.titleAttributes;so(Aa.BODY,r),so(Aa.HTML,i),oo(d,p);var h={baseTag:lo(Aa.BASE,n),linkTags:lo(Aa.LINK,a),metaTags:lo(Aa.META,o),noscriptTags:lo(Aa.NOSCRIPT,s),scriptTags:lo(Aa.SCRIPT,c),styleTags:lo(Aa.STYLE,u)},f={},m={};Object.keys(h).forEach((function(e){var t=h[e],n=t.newTags,r=t.oldTags;n.length&&(f[e]=n),r.length&&(m[e]=h[e].oldTags)})),t&&t(),l(e,f,m)},ao=function(e){return Array.isArray(e)?e.join(""):e},oo=function(e,t){void 0!==e&&document.title!==e&&(document.title=ao(e)),so(Aa.TITLE,t)},so=function(e,t){var n=document.getElementsByTagName(e)[0];if(n){for(var r=n.getAttribute(Ba),i=r?r.split(","):[],a=[].concat(i),o=Object.keys(t),s=0;s<o.length;s++){var l=o[s],c=t[l]||"";n.getAttribute(l)!==c&&n.setAttribute(l,c),-1===i.indexOf(l)&&i.push(l);var u=a.indexOf(l);-1!==u&&a.splice(u,1)}for(var d=a.length-1;d>=0;d--)n.removeAttribute(a[d]);i.length===a.length?n.removeAttribute(Ba):n.getAttribute(Ba)!==o.join(",")&&n.setAttribute(Ba,o.join(","))}},lo=function(e,t){var n=document.head||document.querySelector(Aa.HEAD),r=n.querySelectorAll(e+"["+Ba+"]"),i=Array.prototype.slice.call(r),a=[],o=void 0;return t&&t.length&&t.forEach((function(t){var n=document.createElement(e);for(var r in t)if(t.hasOwnProperty(r))if(r===Ia)n.innerHTML=t.innerHTML;else if(r===Da)n.styleSheet?n.styleSheet.cssText=t.cssText:n.appendChild(document.createTextNode(t.cssText));else{var s=void 0===t[r]?"":t[r];n.setAttribute(r,s)}n.setAttribute(Ba,"true"),i.some((function(e,t){return o=t,n.isEqualNode(e)}))?i.splice(o,1):a.push(n)})),i.forEach((function(e){return e.parentNode.removeChild(e)})),a.forEach((function(e){return n.appendChild(e)})),{oldTags:i,newTags:a}},co=function(e){return Object.keys(e).reduce((function(t,n){var r=void 0!==e[n]?n+'="'+e[n]+'"':""+n;return t?t+" "+r:r}),"")},uo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce((function(t,n){return t[Ma[n]||n]=e[n],t}),t)},po=function(e,t,n){switch(e){case Aa.TITLE:return{toComponent:function(){return e=t.title,n=t.titleAttributes,(r={key:e})[Ba]=!0,i=uo(n,r),[xi().createElement(Aa.TITLE,i,e)];var e,n,r,i},toString:function(){return function(e,t,n,r){var i=co(n),a=ao(t);return i?"<"+e+" "+Ba+'="true" '+i+">"+Ha(a,r)+"</"+e+">":"<"+e+" "+Ba+'="true">'+Ha(a,r)+"</"+e+">"}(e,t.title,t.titleAttributes,n)}};case ka:case Pa:return{toComponent:function(){return uo(t)},toString:function(){return co(t)}};default:return{toComponent:function(){return function(e,t){return t.map((function(t,n){var r,i=((r={key:n})[Ba]=!0,r);return Object.keys(t).forEach((function(e){var n=Ma[e]||e;if(n===Ia||n===Da){var r=t.innerHTML||t.cssText;i.dangerouslySetInnerHTML={__html:r}}else i[n]=t[e]})),xi().createElement(e,i)}))}(e,t)},toString:function(){return function(e,t,n){return t.reduce((function(t,r){var i=Object.keys(r).filter((function(e){return!(e===Ia||e===Da)})).reduce((function(e,t){var i=void 0===r[t]?t:t+'="'+Ha(r[t],n)+'"';return e?e+" "+i:i}),""),a=r.innerHTML||r.cssText||"",o=-1===$a.indexOf(e);return t+"<"+e+" "+Ba+'="true" '+i+(o?"/>":">"+a+"</"+e+">")}),"")}(e,t,n)}}}},ho=function(e){var t=e.baseTag,n=e.bodyAttributes,r=e.encode,i=e.htmlAttributes,a=e.linkTags,o=e.metaTags,s=e.noscriptTags,l=e.scriptTags,c=e.styleTags,u=e.title,d=void 0===u?"":u,p=e.titleAttributes;return{base:po(Aa.BASE,t,r),bodyAttributes:po(ka,n,r),htmlAttributes:po(Pa,i,r),link:po(Aa.LINK,a,r),meta:po(Aa.META,o,r),noscript:po(Aa.NOSCRIPT,s,r),script:po(Aa.SCRIPT,l,r),style:po(Aa.STYLE,c,r),title:po(Aa.TITLE,{title:d,titleAttributes:p},r)}},fo=xa()((function(e){return{baseTag:Ka([ja,"target"],e),bodyAttributes:Qa(ka,e),defer:Xa(e,"defer"),encode:Xa(e,"encodeSpecialCharacters"),htmlAttributes:Qa(Pa,e),linkTags:Ya(Aa.LINK,[La,ja],e),metaTags:Ya(Aa.META,["name",Ra,"http-equiv","property",Na],e),noscriptTags:Ya(Aa.NOSCRIPT,[Ia],e),onChangeClientState:Wa(e),scriptTags:Ya(Aa.SCRIPT,["src",Ia],e),styleTags:Ya(Aa.STYLE,[Da],e),title:Ga(e),titleAttributes:Qa("titleAttributes",e)}}),(function(e){ro&&to(ro),e.defer?ro=eo((function(){io(e,(function(){ro=null}))})):(io(e),ro=null)}),ho)((function(){return null})),mo=(ya=fo,va=ba=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.shouldComponentUpdate=function(e){return!Oa()(this.props,e)},t.prototype.mapNestedChildrenToProps=function(e,t){if(!t)return null;switch(e.type){case Aa.SCRIPT:case Aa.NOSCRIPT:return{innerHTML:t};case Aa.STYLE:return{cssText:t}}throw new Error("<"+e.type+" /> elements are self-closing and can not contain children. Refer to our API for more information.")},t.prototype.flattenArrayTypeChildren=function(e){var t,n=e.child,r=e.arrayTypeChildren,i=e.newChildProps,a=e.nestedChildren;return Ua({},r,((t={})[n.type]=[].concat(r[n.type]||[],[Ua({},i,this.mapNestedChildrenToProps(n,a))]),t))},t.prototype.mapObjectTypeChildren=function(e){var t,n,r=e.child,i=e.newProps,a=e.newChildProps,o=e.nestedChildren;switch(r.type){case Aa.TITLE:return Ua({},i,((t={})[r.type]=o,t.titleAttributes=Ua({},a),t));case Aa.BODY:return Ua({},i,{bodyAttributes:Ua({},a)});case Aa.HTML:return Ua({},i,{htmlAttributes:Ua({},a)})}return Ua({},i,((n={})[r.type]=Ua({},a),n))},t.prototype.mapArrayTypeChildrenToProps=function(e,t){var n=Ua({},t);return Object.keys(e).forEach((function(t){var r;n=Ua({},n,((r={})[t]=e[t],r))})),n},t.prototype.warnOnInvalidChildren=function(e,t){return!0},t.prototype.mapChildrenToProps=function(e,t){var n=this,r={};return xi().Children.forEach(e,(function(e){if(e&&e.props){var i=e.props,a=i.children,o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).reduce((function(t,n){return t[Fa[n]||n]=e[n],t}),t)}(qa(i,["children"]));switch(n.warnOnInvalidChildren(e,a),e.type){case Aa.LINK:case Aa.META:case Aa.NOSCRIPT:case Aa.SCRIPT:case Aa.STYLE:r=n.flattenArrayTypeChildren({child:e,arrayTypeChildren:r,newChildProps:o,nestedChildren:a});break;default:t=n.mapObjectTypeChildren({child:e,newProps:t,newChildProps:o,nestedChildren:a})}}})),t=this.mapArrayTypeChildrenToProps(r,t)},t.prototype.render=function(){var e=this.props,t=e.children,n=qa(e,["children"]),r=Ua({},n);return t&&(r=this.mapChildrenToProps(t,r)),xi().createElement(ya,r)},za(t,null,[{key:"canUseDOM",set:function(e){ya.canUseDOM=e}}]),t}(xi().Component),ba.propTypes={base:Sa().object,bodyAttributes:Sa().object,children:Sa().oneOfType([Sa().arrayOf(Sa().node),Sa().node]),defaultTitle:Sa().string,defer:Sa().bool,encodeSpecialCharacters:Sa().bool,htmlAttributes:Sa().object,link:Sa().arrayOf(Sa().object),meta:Sa().arrayOf(Sa().object),noscript:Sa().arrayOf(Sa().object),onChangeClientState:Sa().func,script:Sa().arrayOf(Sa().object),style:Sa().arrayOf(Sa().object),title:Sa().string,titleAttributes:Sa().object,titleTemplate:Sa().string},ba.defaultProps={defer:!0,encodeSpecialCharacters:!0},ba.peek=ya.peek,ba.rewind=function(){var e=ya.rewind();return e||(e=ho({baseTag:[],bodyAttributes:{},encodeSpecialCharacters:!0,htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}})),e},va);mo.renderStatic=mo.rewind;const go=gi,yo=`https://github.com/grafana/explore-profiles/commit/${go}`,{buildInfo:bo}=n.config;function vo(){const t=(0,r.useStyles2)(Eo),{meta:{info:{version:n,updated:i}}}=(0,e.usePluginContext)();return xi().createElement("div",{className:t.menuHeader},xi().createElement("h5",null," Explore profiles v",n),xi().createElement("div",{className:t.subTitle},"Last update: ",i))}function wo(){const e="dev"===go,t=e?go:go.slice(0,8);return xi().createElement(r.Menu,{header:xi().createElement(vo,null)},xi().createElement(r.Menu.Item,{label:`Commit SHA: ${t}`,icon:"github",onClick:()=>window.open(yo),disabled:e}),xi().createElement(r.Menu.Item,{label:"Changelog",icon:"list-ul",onClick:()=>window.open("https://github.com/grafana/explore-profiles/blob/main/CHANGELOG.md")}),xi().createElement(r.Menu.Item,{label:"Contribute",icon:"external-link-alt",onClick:()=>window.open("https://github.com/grafana/explore-profiles/blob/main/docs/CONTRIBUTING.md")}),xi().createElement(r.Menu.Item,{label:"Documentation",icon:"document-info",onClick:()=>window.open("https://grafana.com/docs/grafana/latest/explore/simplified-exploration/profiles")}),xi().createElement(r.Menu.Item,{label:"Report an issue",icon:"bug",onClick:()=>window.open("https://github.com/grafana/explore-profiles/issues/new?template=bug_report.md")}),xi().createElement(r.Menu.Divider,null),xi().createElement(r.Menu.Item,{label:`Grafana ${bo.edition} v${bo.version} (${bo.env})`,icon:"github",onClick:()=>window.open(`https://github.com/grafana/grafana/commit/${bo.commit}`)}))}function So(){return xi().createElement(r.Dropdown,{overlay:()=>xi().createElement(wo,null),placement:"bottom-end"},xi().createElement(r.IconButton,{name:"info-circle","aria-label":"Plugin info",title:"Plugin info"}))}const Eo=e=>({menuHeader:t.css`
    padding: ${e.spacing(.5,1)};
    white-space: nowrap;
  `,subTitle:t.css`
    color: ${e.colors.text.secondary};
    font-size: ${e.typography.bodySmall.fontSize};
  `});function xo({size:e}){const n=(0,r.useStyles2)(Oo);return xi().createElement("img",{className:(0,t.cx)(n.logo,e),src:"public/plugins/grafana-pyroscope-app/img/logo.svg"})}const _o=xi().memo(xo),Oo=()=>({logo:t.css`
    &.small {
      width: 16px;
      height: 16px;
      margin-right: 4px;
      position: relative;
      top: -2px;
    }

    &.large {
      width: 40px;
      height: 40px;
    }
  `});function To({title:e,queryAnalysis:t}){const n=(0,r.useStyles2)(Co),i="string"==typeof e?`${e} | Pyroscope`:"Pyroscope";return xi().createElement(xi().Fragment,null,xi().createElement(mo,null,xi().createElement("title",null,i)),xi().createElement("div",{className:n.titleContainer},xi().createElement(r.Stack,{justifyContent:"space-between"},xi().createElement("div",null,xi().createElement(_o,{size:"large"}),xi().createElement("h1",{className:n.title,"data-testid":"page-title"},e)),xi().createElement("div",{className:n.infoArea},xi().createElement(So,null),t?xi().createElement(ma,{data:t}):null))))}const Co=e=>({titleContainer:t.css`
    height: ${e.spacing(5)};
    line-height: ${e.spacing(5)};
    margin-bottom: ${e.spacing(3)};
  `,title:t.css`
    font-size: ${e.typography.h2.fontSize};
    display: inline-block;
    margin: 0;
    position: relative;
    top: 10px;
    left: ${e.spacing(1)};
  `,infoArea:t.css`
    align-self: end;
    margin-bottom: 0;
    line-height: 20px;
    text-align: right;
  `}),ko=(0,Ei.memo)(To);function Po(){return xi().createElement(n.PluginPage,{layout:e.PageLayoutType.Canvas},xi().createElement(ko,{title:xi().createElement("span",null,"Loading... ",xi().createElement(r.Icon,{name:"fa fa-spinner"}))}))}const Ao=e=>({link:t.css`
    color: ${e.colors.text.link};
    &:hover {
      text-decoration: underline;
    }
  `});function Ro({href:e,children:t}){const n=(0,r.useStyles2)(Ao);return xi().createElement("a",{className:n.link,href:e,target:"_blank",rel:"noreferrer"},t," ",xi().createElement(r.Icon,{name:"external-link-alt"}))}function Do(){return xi().createElement(n.PluginPage,{layout:e.PageLayoutType.Canvas},xi().createElement(ko,{title:"Explore Profiles"}),xi().createElement(r.Alert,{severity:"error",title:"Missing Pyroscope data source!"},"This plugin requires a Pyroscope data source. Please"," ",xi().createElement(Ro,{href:"/connections/datasources/new"},"add and configure a Pyroscope data source")," to your Grafana instance."))}const jo="public/plugins/grafana-pyroscope-app/img/61b4cf746a6f58780f27.png",Io="public/plugins/grafana-pyroscope-app/img/0324b23e949528cbda73.png",No="public/plugins/grafana-pyroscope-app/img/3e820d7b934ac6c337fc.png",Lo="public/plugins/grafana-pyroscope-app/img/9c9cdd5175734d579007.png",Mo="public/plugins/grafana-pyroscope-app/img/bafee50693eb02088442.png";const Fo=e=>({onboardingRow:t.css`
    background: ${e.colors.background.secondary};
    display: flex;
    margin-top: 16px;
    gap: 20px;
    padding: 20px;
    margin-bottom: 2.5rem;
  `,onboardingParagraph:t.css`
    padding: 20px 64px;
    text-align: center;
    line-height: 2;
    flex: 1;
    margin: 0;
  `,onboardingPanel:t.css`
    flex: 1;
    display: flex;
    flex-flow: column wrap;
    -webkit-box-align: center;
    align-items: center;
    margin-top: 16px;
    text-align: center;
  `,onboardingPanelHeader:t.css`
    line-height: 1.5;
    margin-bottom: 1em;
  `,onboardingPanelImage:t.css`
    width: 5rem;
    margin-bottom: 1em;
  `,hero:t.css`
    display: flex;
    flex-direction: row;
  `,heroTitles:t.css`
    flex: 1;
  `,heroImage:t.css`
    width: 40%;
    margin-left: 16px;
    margin-top: 16px;
    margin-bottom: 16px;
    border-radius: 3px;
  `,onboardingPanelNumber:t.css`
    color: rgb(236, 109, 19);
    text-align: center;
    display: grid;
    place-items: center;
    background-image: linear-gradient(135deg, currentcolor, 75%, rgb(204, 204, 220));
    border-radius: 100%;
    font-size: 2.5rem;
    line-height: 5rem;
    height: 5rem;
    width: 5rem;
    margin-bottom: 1em;
  `,color2:t.css`
    color: rgb(190, 85, 190);
  `,color3:t.css`
    color: rgb(126, 108, 218);
  `,onboardingPanelNumberSpan:t.css`
    color: rgb(220, 220, 220);
  `,onboardingPanelDescription:t.css`
    text-align: justify;
    text-align: center;
    line-height: 1.66;
    margin-top: 0;
  `,title:t.css`
    margin-bottom: 0.5em;
    line-height: 1.5;
  `,subtitle:t.css`
    margin-bottom: 1em;
    line-height: 1.5;
    font-size: 1.25rem;
  `});function $o(){const e=(0,r.useStyles2)(Fo),{data:n}=function(){const{instances:e}=function(){const{isFetching:e,error:t,data:n}=ca({queryKey:["instances"],queryFn:()=>fetch("/api/plugin-proxy/cloud-home-app/grafanacom-api/instances").then((e=>e.json()))});return{isFetching:e,error:t,instances:n}}(),[t,n]=(0,Ei.useState)("https://grafana.com/auth/sign-in/"),r=/grafana(-dev|-ops)?\.net/.test(window.location.host);if(e&&e.orgSlug&&e.hpInstanceId){const r=`https://grafana.com/orgs/${e.orgSlug}/hosted-profiles/${e.hpInstanceId}`;t!==r&&n(r)}return{data:{settingsUrl:t,isCloud:r},actions:{}}}();return xi().createElement("div",{"data-testid":"onboarding-modal"},xi().createElement("div",{className:e.hero,"data-testid":"hero"},xi().createElement("div",{className:e.heroTitles},xi().createElement("h1",{className:e.title},"Welcome to ",n.isCloud?"Grafana Cloud Profiles":"Explore Profiles"),xi().createElement("h2",{className:e.subtitle},"Optimize infrastructure spend, simplify debugging, and enhance application performance")),xi().createElement("img",{src:n.isCloud?No:Io,className:e.heroImage})),xi().createElement("div",{"data-testid":"what-you-can-do"},xi().createElement("h3",null,"What You Can Do"),xi().createElement("div",{className:e.onboardingRow},xi().createElement("div",{className:e.onboardingPanel},xi().createElement("img",{className:e.onboardingPanelImage,src:Lo}),xi().createElement("h3",{className:e.onboardingPanelHeader},"Reduce Costs"),xi().createElement("p",{className:e.onboardingPanelDescription},"Spot CPU spikes, memory leaks, and other inefficiencies with code-level visibility into resource usage. Teams can then optimize their code and lower infrastructure costs.")),xi().createElement("div",{className:e.onboardingPanel},xi().createElement("img",{className:e.onboardingPanelImage,src:jo}),xi().createElement("h3",{className:e.onboardingPanelHeader},"Decrease Latency"),xi().createElement("p",{className:e.onboardingPanelDescription},"Maintain high speed and efficiency and improve application performance. In a competitive digital world, decreasing latency translates to increasing revenue.")),xi().createElement("div",{className:e.onboardingPanel},xi().createElement("img",{className:e.onboardingPanelImage,src:Mo}),xi().createElement("h3",{className:e.onboardingPanelHeader},"Resolve Incidents Faster"),xi().createElement("p",{className:e.onboardingPanelDescription},"Cut down the mean time to resolution (MTTR) by correlating continuous profiling data with metrics, logs, and traces to quickly identify the root cause of any issue.")))),xi().createElement("div",{"data-testid":"how-to-get-started"},xi().createElement("h3",null,"How to Get Started"),xi().createElement("div",{className:e.onboardingRow},n.isCloud?xi().createElement(xi().Fragment,null,xi().createElement("div",{className:e.onboardingPanel},xi().createElement("div",{className:e.onboardingPanelNumber},xi().createElement("span",{className:e.onboardingPanelNumberSpan},"1")),xi().createElement("h3",{className:e.onboardingPanelHeader},"Add Profiling to Your Application"),xi().createElement("p",{className:e.onboardingPanelDescription},"Use"," ",xi().createElement(Ro,{href:"https://grafana.com/docs/pyroscope/latest/configure-client/grafana-alloy/"},"Grafana Alloy")," ","or"," ",xi().createElement(Ro,{href:"https://grafana.com/docs/pyroscope/next/configure-client/language-sdks/"},"Pyroscope SDKs")," ","to push profiles from your applications to Grafana Cloud.")),xi().createElement("div",{className:e.onboardingPanel},xi().createElement("div",{className:(0,t.cx)(e.onboardingPanelNumber,e.color2)},xi().createElement("span",{className:e.onboardingPanelNumberSpan},"2")),xi().createElement("h3",{className:e.onboardingPanelHeader},"Configure Your Applications"),xi().createElement("p",{className:e.onboardingPanelDescription},"Go to ",xi().createElement(Ro,{href:n.settingsUrl},"Grafana Cloud Stack settings")," to find your Grafana Cloud Credentials.")),xi().createElement("div",{className:e.onboardingPanel},xi().createElement("div",{className:(0,t.cx)(e.onboardingPanelNumber,e.color3)},xi().createElement("span",{className:e.onboardingPanelNumberSpan},"3")),xi().createElement("h3",{className:e.onboardingPanelHeader},"Start Getting Performance Insights"),xi().createElement("p",{className:e.onboardingPanelDescription},"Once you're done with initial setup, refresh this page to see your profiling data."))):xi().createElement(xi().Fragment,null,xi().createElement("div",{className:e.onboardingPanel},xi().createElement("div",{className:e.onboardingPanelNumber},xi().createElement("span",{className:e.onboardingPanelNumberSpan},"1")),xi().createElement("h3",{className:e.onboardingPanelHeader},"Set Up Your Pyroscope Server"),xi().createElement("p",{className:e.onboardingPanelDescription},"Install ",xi().createElement(Ro,{href:"https://grafana.com/docs/pyroscope/latest/"},"Pyroscope Server")," on your infrastructure. Or if you want to use a hosted service, go to"," ",xi().createElement(Ro,{href:n.settingsUrl},"Grafana Cloud Stack settings")," to find your Grafana Cloud Credentials.")),xi().createElement("div",{className:e.onboardingPanel},xi().createElement("div",{className:(0,t.cx)(e.onboardingPanelNumber,e.color2)},xi().createElement("span",{className:e.onboardingPanelNumberSpan},"2")),xi().createElement("h3",{className:e.onboardingPanelHeader},"Configure Grafana"),xi().createElement("p",{className:e.onboardingPanelDescription},"Add a new ",xi().createElement(Ro,{href:"/connections/datasources/new"},"Pyroscope datasource"),". Use your Pyroscope server URL and appropriate security credentials if you use Grafana Cloud Profiles.")),xi().createElement("div",{className:e.onboardingPanel},xi().createElement("div",{className:(0,t.cx)(e.onboardingPanelNumber,e.color3)},xi().createElement("span",{className:e.onboardingPanelNumberSpan},"3")),xi().createElement("h3",{className:e.onboardingPanelHeader},"Add Profiling to Your Application"),xi().createElement("p",{className:e.onboardingPanelDescription},"Use"," ",xi().createElement(Ro,{href:"https://grafana.com/docs/pyroscope/latest/configure-client/grafana-alloy/"},"Grafana Alloy")," ","or"," ",xi().createElement(Ro,{href:"https://grafana.com/docs/pyroscope/next/configure-client/language-sdks/"},"Pyroscope SDKs")," ","to push profiles from your applications to Grafana Cloud."))))),n.isCloud&&xi().createElement("div",{"data-testid":"how-billing-works"},xi().createElement("h3",null,"How Billing Works"),xi().createElement("div",{className:e.onboardingRow},xi().createElement("p",{className:e.onboardingParagraph},"Usage of Grafana Cloud Profiles is subject to"," ",xi().createElement(Ro,{href:"https://grafana.com/pricing/"},"Grafana Cloud Pricing")," for Profiles.",xi().createElement("br",null),"For additional information, read the announcement",xi().createElement(Ro,{href:"https://grafana.com/blog/2023/08/09/grafana-cloud-profiles-for-continuous-profiling/"},"blog post"),"."))))}const Bo=e=>({onboardingPage:t.css`
    padding: 16px;
    margin: 64px;
    position: relative;
    background-color: ${e.colors.background.primary};
  `,closeButton:t.css`
    position: absolute;
    top: -30px;
    opacity: 0.8;
    right: -32px;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    line-height: 40px;
    display: block;
    padding: 0;
    margin: 0;
    font-size: 22px;
  `}),Vo={text:"Onboarding"};function zo({onCloseModal:t}){const i=(0,r.useStyles2)(Bo);return xi().createElement(n.PluginPage,{pageNav:Vo,layout:e.PageLayoutType.Custom},xi().createElement("div",{className:i.onboardingPage},xi().createElement("button",{className:i.closeButton,onClick:t,title:"Close","data-testid":"close-onboarding-modal"},""),xi().createElement($o,null)))}function Uo({children:e}){const{data:t,actions:n}=function(){const[e,t]=(0,Ei.useState)(!1),n=Hi.getPyroscopeDataSources().length,{isFetching:r,error:i,stats:a}=function({enabled:e}){const{isFetching:t,error:n,data:r,refetch:i}=ca({enabled:e,placeholderData:()=>({hasIngestedData:!0,oldestProfileTime:0,newestProfileTime:0}),queryKey:["tenant-stats"],queryFn:()=>(da.abort(),da.get())});return{isFetching:t,error:da.isAbortError(n)?null:n,stats:r,refetch:i}}({enabled:n>0}),o=!r&&!(null==a?void 0:a.hasIngestedData);return{data:{shouldShowLoadingPage:!i&&r,shouldShowOnboardingPage:(i||!n||o)&&!e,shouldShowNoDataSourceBanner:!n},actions:{closeModal(){t(!0)}}}}();return t.shouldShowLoadingPage?xi().createElement(Po,null):t.shouldShowOnboardingPage?xi().createElement(zo,{onCloseModal:n.closeModal}):t.shouldShowNoDataSourceBanner?xi().createElement(Do,null):xi().createElement(xi().Fragment,null,e)}function qo(e){return`${fi}/${e}`.replace(/\/{2,}/g,"/")}var Ho=__webpack_require__(3806);const Go=e=>({container:t.css`
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: ${e.spacing(1)};
    width: 100%;
  `,column:t.css`
    width: 50%;
  `});function Wo({left:e,right:t}){const n=(0,r.useStyles2)(Go);return xi().createElement("div",{className:n.container},xi().createElement("div",{className:n.column},e),xi().createElement("div",{className:n.column},t))}function Qo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ko(t,r){const i=r.reduce(((e,t,n)=>{return r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Qo(e,t,n[t])}))}return e}({},e),i=null!=(i={[`info${n+1}`]:t})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(i)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})),r;var r,i}),{handheldBy:"displayError"});Ii.error(t,i),(0,n.getAppEvents)().publish({type:e.AppEvents.alertError.name,payload:r})}function Yo(t){Ii.warn(t),(0,n.getAppEvents)().publish({type:e.AppEvents.alertWarning.name,payload:t})}function Xo(t){(0,n.getAppEvents)().publish({type:e.AppEvents.alertSuccess.name,payload:t})}function Jo(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function Zo(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){Jo(a,r,i,o,s,"next",e)}function s(e){Jo(a,r,i,o,s,"throw",e)}o(void 0)}))}}const es=new class extends Hi{get(e,t){var n=this;return Zo((function*(){const r=yield n.fetch("/adhocprofiles.v1.AdHocProfileService/Get",{method:"POST",body:JSON.stringify({id:e,profile_type:t})}),i=yield r.json();return{id:i.id,name:i.name,profileTypes:i.profileTypes,profile:JSON.parse(i.flamebearerProfile)}}))()}uploadSingle(e){var t=this;return Zo((function*(){const n=yield t._readProfileFile(e),r=yield t.fetch("/adhocprofiles.v1.AdHocProfileService/Upload",{method:"POST",body:JSON.stringify({name:e.name,profile:n})}),i=yield r.json();return{id:i.id,name:e.name,profileTypes:i.profileTypes,profile:JSON.parse(i.flamebearerProfile)}}))()}uploadDiff(){return Zo((function*(){return{id:"?",name:"??",profileTypes:[],profile:null}}))()}_readProfileFile(e){return Zo((function*(){return new Promise(((t,n)=>{const r=new FileReader;r.addEventListener("load",(()=>{try{t(function(e){const[,t]=e.split(";base64,");if(!t)throw new Error("No content after stripping the base64 prefix.");if(e===t)throw new Error("No base64 prefix?!");return t}(r.result))}catch(e){n(e)}})),r.addEventListener("error",(()=>{n(new Error(`Error while reading file "${e.name}"!`))})),r.readAsDataURL(e)}))}))()}};function ts(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function ns(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){ts(a,r,i,o,s,"next",e)}function s(e){ts(a,r,i,o,s,"throw",e)}o(void 0)}))}}function rs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function is(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){rs(e,t,n[t])}))}return e}function as(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const os={id:"",name:"",profileTypes:[],profile:null};function ss(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ls(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ss(e,t,n[t])}))}return e}const cs={accept:{"application/gzip":[".gz"],"application/json":[".json"],"application/proto":[".pb",".pprof"]},multiple:!1,onError(e){Ko(e,["Error while uploading file!",e.toString()])}};function us({onFileDropped:e,onFileRemove:t}){const n=(0,Ei.useCallback)((function(t){e(t[0])}),[e]);return xi().createElement(r.FileDropzone,{options:(i=ls({},cs),a={onDropAccepted:n},a=null!=a?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i),onFileRemove:t});var i,a}const ds=new Intl.Collator("en",{numeric:!0,sensitivity:"base"}).compare,ps=1/0,hs=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),fs="eexxaacctt",ms=(e,t,n)=>e.replace("A-Z",t).replace("a-z",n),gs={unicode:!1,alpha:null,interSplit:"[^A-Za-z\\d']+",intraSplit:"[a-z][A-Z]",intraBound:"[A-Za-z]\\d|\\d[A-Za-z]|[a-z][A-Z]",interLft:0,interRgt:0,interChars:".",interIns:ps,intraChars:"[a-z\\d']",intraIns:null,intraContr:"'[a-z]{1,2}\\b",intraMode:0,intraSlice:[1,ps],intraSub:null,intraTrn:null,intraDel:null,intraFilt:(e,t,n)=>!0,sort:(e,t,n)=>{let{idx:r,chars:i,terms:a,interLft2:o,interLft1:s,start:l,intraIns:c,interIns:u}=e;return r.map(((e,t)=>t)).sort(((e,n)=>i[n]-i[e]||c[e]-c[n]||a[n]+o[n]+.5*s[n]-(a[e]+o[e]+.5*s[e])||u[e]-u[n]||l[e]-l[n]||ds(t[r[e]],t[r[n]])))}},ys=(e,t)=>0==t?"":1==t?e+"??":t==ps?e+"*?":e+`{0,${t}}?`,bs="(?:\\b|_)";function vs(e){e=Object.assign({},gs,e);let{unicode:t,interLft:n,interRgt:r,intraMode:i,intraSlice:a,intraIns:o,intraSub:s,intraTrn:l,intraDel:c,intraContr:u,intraSplit:d,interSplit:p,intraBound:h,intraChars:f}=e;o??=i,s??=i,l??=i,c??=i;let m=e.letters??e.alpha;if(null!=m){let e=m.toLocaleUpperCase(),t=m.toLocaleLowerCase();p=ms(p,e,t),d=ms(d,e,t),h=ms(h,e,t),f=ms(f,e,t),u=ms(u,e,t)}let g=t?"u":"";const y='".+?"',b=new RegExp(y,"gi"+g),v=new RegExp(`(?:\\s+|^)-(?:${f}+|${y})`,"gi"+g);let{intraRules:w}=e;null==w&&(w=e=>{let t=gs.intraSlice,n=0,r=0,i=0,u=0;if(/[^\d]/.test(e)){let d=e.length;d<=4?d>=3&&(i=Math.min(l,1),4==d&&(n=Math.min(o,1))):(t=a,n=o,r=s,i=l,u=c)}return{intraSlice:t,intraIns:n,intraSub:r,intraTrn:i,intraDel:u}});let S=!!d,E=new RegExp(d,"g"+g),x=new RegExp(p,"g"+g),_=new RegExp("^"+p+"|"+p+"$","g"+g),O=new RegExp(u,"gi"+g);const T=e=>{let t=[];e=e.replace(b,(e=>(t.push(e),fs))),e=e.replace(_,"").toLocaleLowerCase(),S&&(e=e.replace(E,(e=>e[0]+" "+e[1])));let n=0;return e.split(x).filter((e=>""!=e)).map((e=>e===fs?t[n++]:e))},C=/[^\d]+|\d+/g,k=(t,a=0,s=!1)=>{let l=T(t);if(0==l.length)return[];let c,u=Array(l.length).fill("");if(l=l.map(((e,t)=>e.replace(O,(e=>(u[t]=e,""))))),1==i)c=l.map(((e,t)=>{if('"'===e[0])return hs(e.slice(1,-1));let n="";for(let r of e.matchAll(C)){let e=r[0],{intraSlice:i,intraIns:a,intraSub:o,intraTrn:s,intraDel:l}=w(e);if(a+o+s+l==0)n+=e+u[t];else{let[r,c]=i,d=e.slice(0,r),p=e.slice(c),h=e.slice(r,c);1==a&&1==d.length&&d!=h[0]&&(d+="(?!"+d+")");let m=h.length,g=[e];if(o)for(let e=0;e<m;e++)g.push(d+h.slice(0,e)+f+h.slice(e+1)+p);if(s)for(let e=0;e<m-1;e++)h[e]!=h[e+1]&&g.push(d+h.slice(0,e)+h[e+1]+h[e]+h.slice(e+2)+p);if(l)for(let e=0;e<m;e++)g.push(d+h.slice(0,e+1)+"?"+h.slice(e+1)+p);if(a){let e=ys(f,1);for(let t=0;t<m;t++)g.push(d+h.slice(0,t)+e+h.slice(t)+p)}n+="(?:"+g.join("|")+")"+u[t]}}return n}));else{let e=ys(f,o);2==a&&o>0&&(e=")("+e+")("),c=l.map(((t,n)=>'"'===t[0]?hs(t.slice(1,-1)):t.split("").map(((e,t,n)=>(1==o&&0==t&&n.length>1&&e!=n[t+1]&&(e+="(?!"+e+")"),e))).join(e)+u[n]))}let d=2==n?bs:"",p=2==r?bs:"",h=p+ys(e.interChars,e.interIns)+d;return a>0?s?c=d+"("+c.join(")"+p+"|"+d+"(")+")"+p:(c="("+c.join(")("+h+")(")+")",c="(.??"+d+")"+c+"("+p+".*)"):(c=c.join(h),c=d+c+p),[new RegExp(c,"i"+g),l,u]},P=(e,t,n)=>{let[r]=k(t);if(null==r)return null;let i=[];if(null!=n)for(let t=0;t<n.length;t++){let a=n[t];r.test(e[a])&&i.push(a)}else for(let t=0;t<e.length;t++)r.test(e[t])&&i.push(t);return i};let A=!!h,R=new RegExp(p,g),D=new RegExp(h,g);const j=(t,i,a)=>{let[o,s,l]=k(a,1),[c]=k(a,2),u=s.length,d=t.length,p=Array(d).fill(0),h={idx:Array(d),start:p.slice(),chars:p.slice(),terms:p.slice(),interIns:p.slice(),intraIns:p.slice(),interLft2:p.slice(),interRgt2:p.slice(),interLft1:p.slice(),interRgt1:p.slice(),ranges:Array(d)},f=1==n||1==r,m=0;for(let a=0;a<t.length;a++){let d=i[t[a]],p=d.match(o),y=p.index+p[1].length,b=y,v=!1,w=0,S=0,E=0,x=0,_=0,O=0,T=0,C=0,k=[];for(let t=0,i=2;t<u;t++,i+=2){let a=p[i].toLocaleLowerCase(),o=s[t],c='"'==o[0]?o.slice(1,-1):o+l[t],h=c.length,m=a.length,P=a==c;if(!P&&p[i+1].length>=h){let e=p[i+1].toLocaleLowerCase().indexOf(c);e>-1&&(k.push(b,m,e,h),b+=I(p,i,e,h),a=c,m=h,P=!0,0==t&&(y=b))}if(f||P){let e=b-1,o=b+m,s=!1,l=!1;if(-1==e||R.test(d[e]))P&&w++,s=!0;else{if(2==n){v=!0;break}if(A&&D.test(d[e]+d[e+1]))P&&S++,s=!0;else if(1==n){let e=p[i+1],n=b+m;if(e.length>=h){let r,o=0,l=!1,u=new RegExp(c,"ig"+g);for(;r=u.exec(e);){o=r.index;let e=n+o,t=e-1;if(-1==t||R.test(d[t])){w++,l=!0;break}if(D.test(d[t]+d[e])){S++,l=!0;break}}l&&(s=!0,k.push(b,m,o,h),b+=I(p,i,o,h),a=c,m=h,P=!0,0==t&&(y=b))}if(!s){v=!0;break}}}if(o==d.length||R.test(d[o]))P&&E++,l=!0;else{if(2==r){v=!0;break}if(A&&D.test(d[o-1]+d[o]))P&&x++,l=!0;else if(1==r){v=!0;break}}P&&(_+=h,s&&l&&O++)}if(m>h&&(C+=m-h),t>0&&(T+=p[i-1].length),!e.intraFilt(c,a,b)){v=!0;break}t<u-1&&(b+=m+p[i+1].length)}if(!v){h.idx[m]=t[a],h.interLft2[m]=w,h.interLft1[m]=S,h.interRgt2[m]=E,h.interRgt1[m]=x,h.chars[m]=_,h.terms[m]=O,h.interIns[m]=T,h.intraIns[m]=C,h.start[m]=y;let e=d.match(c),n=e.index+e[1].length,r=k.length,i=r>0?0:1/0,o=r-4;for(let t=2;t<e.length;){let r=e[t].length;if(i<=o&&k[i]==n){let r=k[i+1],a=k[i+2],o=k[i+3],s=t,l="";for(let t=0;t<r;s++)l+=e[s],t+=e[s].length;e.splice(t,s-t,l),n+=I(e,t,a,o),i+=4}else n+=r,t++}n=e.index+e[1].length;let s=h.ranges[m]=[],l=n,u=n;for(let t=2;t<e.length;t++){let r=e[t].length;n+=r,t%2==0?u=n:r>0&&(s.push(l,u),l=u=n)}u>l&&s.push(l,u),m++}}if(m<t.length)for(let e in h)h[e]=h[e].slice(0,m);return h},I=(e,t,n,r)=>{let i=e[t]+e[t+1].slice(0,n);return e[t-1]+=i,e[t]=e[t+1].slice(n,n+r),e[t+1]=e[t+1].slice(n+r),i.length};return{search:(...t)=>{let n=((t,n,r,i=1e3,a)=>{r=r?!0===r?5:r:0;let o=null,s=null,l=[];n=n.replace(v,(e=>{let t=e.trim().slice(1);return'"'===t[0]&&(t=hs(t.slice(1,-1))),l.push(t),""}));let c,u=T(n);if(l.length>0){if(c=new RegExp(l.join("|"),"i"+g),0==u.length){let e=[];for(let n=0;n<t.length;n++)c.test(t[n])||e.push(n);return[e,null,null]}}else if(0==u.length)return[null,null,null];if(r>0){let e=T(n);if(e.length>1){let n=e.slice().sort(((e,t)=>t.length-e.length));for(let e=0;e<n.length;e++){if(0==a?.length)return[[],null,null];a=P(t,n[e],a)}if(e.length>r)return[a,null,null];o=Ss(e).map((e=>e.join(" "))),s=[];let i=new Set;for(let e=0;e<o.length;e++)if(i.size<a.length){let n=a.filter((e=>!i.has(e))),r=P(t,o[e],n);for(let e=0;e<r.length;e++)i.add(r[e]);s.push(r)}else s.push([])}}null==o&&(o=[n],s=[a?.length>0?a:P(t,n)]);let d=null,p=null;if(l.length>0&&(s=s.map((e=>e.filter((e=>!c.test(t[e])))))),s.reduce(((e,t)=>e+t.length),0)<=i){d={},p=[];for(let n=0;n<s.length;n++){let r=s[n];if(null==r||0==r.length)continue;let i=o[n],a=j(r,t,i),l=e.sort(a,t,i);if(n>0)for(let e=0;e<l.length;e++)l[e]+=p.length;for(let e in a)d[e]=(d[e]??[]).concat(a[e]);p=p.concat(l)}}return[[].concat(...s),d,p]})(...t);return n},split:T,filter:P,info:j,sort:e.sort}}const ws=(()=>{let e={A:"",a:"",E:"",e:"",I:"",i:"",O:"",o:"",U:"",u:"",C:"",c:"",L:"",l:"",N:"",n:"",S:"",s:"",Z:"",z:""},t=new Map,n="";for(let r in e)e[r].split("").forEach((e=>{n+=e,t.set(e,r)}));let r=new RegExp(`[${n}]`,"g"),i=e=>t.get(e);return e=>{if("string"==typeof e)return e.replace(r,i);let t=Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].replace(r,i);return t}})();function Ss(e){let t,n,r=(e=e.slice()).length,i=[e.slice()],a=new Array(r).fill(0),o=1;for(;o<r;)a[o]<o?(t=o%2&&a[o],n=e[o],e[o]=e[t],e[t]=n,++a[o],o=1,i.push(e.slice())):(a[o]=0,++o);return i}const Es=(e,t)=>t?`<mark>${e}</mark>`:e,xs=(e,t)=>e+t;vs.latinize=ws,vs.permute=e=>{let t=Ss([...Array(e.length).keys()]).sort(((e,t)=>{for(let n=0;n<e.length;n++)if(e[n]!=t[n])return e[n]-t[n];return 0}));return t.map((t=>t.map((t=>e[t]))))},vs.highlight=function(e,t,n=Es,r="",i=xs){r=i(r,n(e.substring(0,t[0]),!1))??r;for(let a=0;a<t.length;a+=2){let o=t[a],s=t[a+1];r=i(r,n(e.substring(o,s),!0))??r,a<t.length-3&&(r=i(r,n(e.substring(t[a+1],t[a+2]),!1))??r)}return i(r,n(e.substring(t[t.length-1]),!1))??r};var _s=function(){},Os="undefined"!=typeof window;const Ts=Os?Ei.useLayoutEffect:Ei.useEffect;var Cs={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const ks=Os&&void 0!==window.ResizeObserver?function(){var e=(0,Ei.useState)(null),t=e[0],n=e[1],r=(0,Ei.useState)(Cs),i=r[0],a=r[1],o=(0,Ei.useMemo)((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,r=t.y,i=t.width,o=t.height,s=t.top,l=t.left,c=t.bottom,u=t.right;a({x:n,y:r,width:i,height:o,top:s,left:l,bottom:c,right:u})}}))}),[]);return Ts((function(){if(t)return o.observe(t),function(){o.disconnect()}}),[t]),[n,i]}:function(){return[_s,Cs]},Ps=22*window.devicePixelRatio,As=10*window.devicePixelRatio,Rs=.5*window.devicePixelRatio,Ds=20*window.devicePixelRatio,js=.5*window.devicePixelRatio,Is=4*window.devicePixelRatio,Ns=3*window.devicePixelRatio,Ls=3*window.devicePixelRatio,Ms=4*window.devicePixelRatio,Fs=2*window.devicePixelRatio,$s=({data:e,itemData:t,onMenuItemClick:n,onItemFocus:i,onSandwich:a,collapseConfig:o,onExpandGroup:s,onCollapseGroup:l,onExpandAllGroups:c,onCollapseAllGroups:u,getExtraContextMenuButtons:d,collapsing:p,allGroupsExpanded:h,allGroupsCollapsed:f,selectedView:m,search:g})=>(0,_i.jsx)("div",{"data-testid":"contextMenu",children:(0,_i.jsx)(r.ContextMenu,{renderMenuItems:function(){const y=(null==d?void 0:d(t,e.data,{selectedView:m,isDiff:e.isDiffFlamegraph(),search:g,collapseConfig:o}))||[];return(0,_i.jsxs)(_i.Fragment,{children:[(0,_i.jsx)(r.MenuItem,{label:"Focus block",icon:"eye",onClick:()=>{i(),n()}}),(0,_i.jsx)(r.MenuItem,{label:"Copy function name",icon:"copy",onClick:()=>{navigator.clipboard.writeText(t.label).then((()=>{n()}))}}),(0,_i.jsx)(r.MenuItem,{label:"Sandwich view",icon:"gf-show-context",onClick:()=>{a(),n()}}),y.map((({label:e,icon:t,onClick:n})=>(0,_i.jsx)(r.MenuItem,{label:e,icon:t,onClick:()=>n()},e))),p&&(0,_i.jsxs)(r.MenuGroup,{label:"Grouping",children:[o?o.collapsed?(0,_i.jsx)(r.MenuItem,{label:"Expand group",icon:"angle-double-down",onClick:()=>{s(),n()}}):(0,_i.jsx)(r.MenuItem,{label:"Collapse group",icon:"angle-double-up",onClick:()=>{l(),n()}}):null,!h&&(0,_i.jsx)(r.MenuItem,{label:"Expand all groups",icon:"angle-double-down",onClick:()=>{c(),n()}}),!f&&(0,_i.jsx)(r.MenuItem,{label:"Collapse all groups",icon:"angle-double-up",onClick:()=>{u(),n()}})]})]})},x:t.posX+10,y:t.posY,focusOnOpen:!1})}),Bs=({data:e,item:t,totalTicks:n,position:i,collapseConfig:a})=>{const o=(0,r.useStyles2)(qs);if(!t||!i)return null;let s;if(e.isDiffFlamegraph()){const i=zs(e,t,n);s=(0,_i.jsx)(r.InteractiveTable,{className:o.tooltipTable,columns:[{id:"label",header:""},{id:"baseline",header:"Baseline"},{id:"comparison",header:"Comparison"},{id:"diff",header:"Diff"}],data:i,getRowId:e=>e.rowId})}else{const r=Vs(e,t,n);s=(0,_i.jsxs)("p",{className:o.lastParagraph,children:[r.unitTitle,(0,_i.jsx)("br",{}),"Total: ",(0,_i.jsx)("b",{children:r.unitValue})," (",r.percentValue,"%)",(0,_i.jsx)("br",{}),"Self: ",(0,_i.jsx)("b",{children:r.unitSelf})," (",r.percentSelf,"%)",(0,_i.jsx)("br",{}),"Samples: ",(0,_i.jsx)("b",{children:r.samples})]})}return(0,_i.jsx)(r.Portal,{children:(0,_i.jsx)(r.VizTooltipContainer,{className:o.tooltipContainer,position:i,offset:{x:15,y:0},children:(0,_i.jsxs)("div",{className:o.tooltipContent,children:[(0,_i.jsxs)("p",{className:o.tooltipName,children:[e.getLabel(t.itemIndexes[0]),a&&a.collapsed?(0,_i.jsxs)("span",{children:[(0,_i.jsx)("br",{}),"and ",a.items.length," similar items"]}):""]}),s]})})})},Vs=(e,t,n)=>{const r=e.valueDisplayProcessor(t.value),i=e.getSelfDisplay(t.itemIndexes),a=Math.round(r.numeric/n*1e4)/100,o=Math.round(i.numeric/n*1e4)/100;let s=r.text+r.suffix,l=i.text+i.suffix;const c=e.getUnitTitle();return"Count"===c&&(r.suffix||(s=r.text),i.suffix||(l=i.text)),{percentValue:a,percentSelf:o,unitTitle:c,unitValue:s,unitSelf:l,samples:r.numeric.toLocaleString()}},zs=(t,n,r)=>{const i=t.getLevels()[0][0].valueRight,a=r-i,o=n.value-n.valueRight,s=Math.round(1e4*o/a)/100,l=Math.round(1e4*n.valueRight/i)/100,c=(l-s)/s*100,u=Us(t,t.valueDisplayProcessor(o)),d=Us(t,t.valueDisplayProcessor(n.valueRight)),p=(0,e.getValueFormat)("short");return[{rowId:"1",label:"% of total",baseline:s+"%",comparison:l+"%",diff:p(c).text+"%"},{rowId:"2",label:"Value",baseline:u,comparison:d,diff:Us(t,t.valueDisplayProcessor(n.valueRight-o))},{rowId:"3",label:"Samples",baseline:p(o).text,comparison:p(n.valueRight).text,diff:p(n.valueRight-o).text}]};function Us(e,t){let n=t.text+t.suffix;return"Count"===e.getUnitTitle()&&(t.suffix||(n=t.text)),n}const qs=e=>({tooltipContainer:(0,t.css)({title:"tooltipContainer",overflow:"hidden"}),tooltipContent:(0,t.css)({title:"tooltipContent",fontSize:e.typography.bodySmall.fontSize,width:"100%"}),tooltipName:(0,t.css)({title:"tooltipName",marginTop:0,wordBreak:"break-all"}),lastParagraph:(0,t.css)({title:"lastParagraph",marginBottom:0}),name:(0,t.css)({title:"name",marginBottom:"10px"}),tooltipTable:(0,t.css)({title:"tooltipTable",maxWidth:"400px"})});function Hs(e){return Hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hs(e)}var Gs=/^\s+/,Ws=/\s+$/;function Qs(e,t){if(t=t||{},(e=e||"")instanceof Qs)return e;if(!(this instanceof Qs))return new Qs(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,r=null,i=null,a=null,o=!1,s=!1;return"string"==typeof e&&(e=function(e){e=e.replace(Gs,"").replace(Ws,"").toLowerCase();var t,n=!1;if(dl[e])e=dl[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=_l.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=_l.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=_l.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=_l.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=_l.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=_l.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=_l.hex8.exec(e))?{r:gl(t[1]),g:gl(t[2]),b:gl(t[3]),a:wl(t[4]),format:n?"name":"hex8"}:(t=_l.hex6.exec(e))?{r:gl(t[1]),g:gl(t[2]),b:gl(t[3]),format:n?"name":"hex"}:(t=_l.hex4.exec(e))?{r:gl(t[1]+""+t[1]),g:gl(t[2]+""+t[2]),b:gl(t[3]+""+t[3]),a:wl(t[4]+""+t[4]),format:n?"name":"hex8"}:!!(t=_l.hex3.exec(e))&&{r:gl(t[1]+""+t[1]),g:gl(t[2]+""+t[2]),b:gl(t[3]+""+t[3]),format:n?"name":"hex"}}(e)),"object"==Hs(e)&&(Ol(e.r)&&Ol(e.g)&&Ol(e.b)?(t=function(e,t,n){return{r:255*fl(e,255),g:255*fl(t,255),b:255*fl(n,255)}}(e.r,e.g,e.b),o=!0,s="%"===String(e.r).substr(-1)?"prgb":"rgb"):Ol(e.h)&&Ol(e.s)&&Ol(e.v)?(r=bl(e.s),i=bl(e.v),t=function(e,t,n){e=6*fl(e,360),t=fl(t,100),n=fl(n,100);var r=Math.floor(e),i=e-r,a=n*(1-t),o=n*(1-i*t),s=n*(1-(1-i)*t),l=r%6;return{r:255*[n,o,a,a,s,n][l],g:255*[s,n,n,o,a,a][l],b:255*[a,a,s,n,n,o][l]}}(e.h,r,i),o=!0,s="hsv"):Ol(e.h)&&Ol(e.s)&&Ol(e.l)&&(r=bl(e.s),a=bl(e.l),t=function(e,t,n){var r,i,a;function o(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}if(e=fl(e,360),t=fl(t,100),n=fl(n,100),0===t)r=i=a=n;else{var s=n<.5?n*(1+t):n+t-n*t,l=2*n-s;r=o(l,s,e+1/3),i=o(l,s,e),a=o(l,s,e-1/3)}return{r:255*r,g:255*i,b:255*a}}(e.h,r,a),o=!0,s="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=hl(n),{ok:o,format:e.format||s,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=Math.round(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=n.ok}function Ks(e,t,n){e=fl(e,255),t=fl(t,255),n=fl(n,255);var r,i,a=Math.max(e,t,n),o=Math.min(e,t,n),s=(a+o)/2;if(a==o)r=i=0;else{var l=a-o;switch(i=s>.5?l/(2-a-o):l/(a+o),a){case e:r=(t-n)/l+(t<n?6:0);break;case t:r=(n-e)/l+2;break;case n:r=(e-t)/l+4}r/=6}return{h:r,s:i,l:s}}function Ys(e,t,n){e=fl(e,255),t=fl(t,255),n=fl(n,255);var r,i,a=Math.max(e,t,n),o=Math.min(e,t,n),s=a,l=a-o;if(i=0===a?0:l/a,a==o)r=0;else{switch(a){case e:r=(t-n)/l+(t<n?6:0);break;case t:r=(n-e)/l+2;break;case n:r=(e-t)/l+4}r/=6}return{h:r,s:i,v:s}}function Xs(e,t,n,r){var i=[yl(Math.round(e).toString(16)),yl(Math.round(t).toString(16)),yl(Math.round(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function Js(e,t,n,r){return[yl(vl(r)),yl(Math.round(e).toString(16)),yl(Math.round(t).toString(16)),yl(Math.round(n).toString(16))].join("")}function Zs(e,t){t=0===t?0:t||10;var n=Qs(e).toHsl();return n.s-=t/100,n.s=ml(n.s),Qs(n)}function el(e,t){t=0===t?0:t||10;var n=Qs(e).toHsl();return n.s+=t/100,n.s=ml(n.s),Qs(n)}function tl(e){return Qs(e).desaturate(100)}function nl(e,t){t=0===t?0:t||10;var n=Qs(e).toHsl();return n.l+=t/100,n.l=ml(n.l),Qs(n)}function rl(e,t){t=0===t?0:t||10;var n=Qs(e).toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-t/100*255))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-t/100*255))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-t/100*255))),Qs(n)}function il(e,t){t=0===t?0:t||10;var n=Qs(e).toHsl();return n.l-=t/100,n.l=ml(n.l),Qs(n)}function al(e,t){var n=Qs(e).toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,Qs(n)}function ol(e){var t=Qs(e).toHsl();return t.h=(t.h+180)%360,Qs(t)}function sl(e,t){if(isNaN(t)||t<=0)throw new Error("Argument to polyad must be a positive number");for(var n=Qs(e).toHsl(),r=[Qs(e)],i=360/t,a=1;a<t;a++)r.push(Qs({h:(n.h+a*i)%360,s:n.s,l:n.l}));return r}function ll(e){var t=Qs(e).toHsl(),n=t.h;return[Qs(e),Qs({h:(n+72)%360,s:t.s,l:t.l}),Qs({h:(n+216)%360,s:t.s,l:t.l})]}function cl(e,t,n){t=t||6,n=n||30;var r=Qs(e).toHsl(),i=360/n,a=[Qs(e)];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,a.push(Qs(r));return a}function ul(e,t){t=t||6;for(var n=Qs(e).toHsv(),r=n.h,i=n.s,a=n.v,o=[],s=1/t;t--;)o.push(Qs({h:r,s:i,v:a})),a=(a+s)%1;return o}Qs.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,r=this.toRgb();return e=r.r/255,t=r.g/255,n=r.b/255,.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(e){return this._a=hl(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=Ys(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=Ys(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+r+"%)":"hsva("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=Ks(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=Ks(this._r,this._g,this._b),t=Math.round(360*e.h),n=Math.round(100*e.s),r=Math.round(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+r+"%)":"hsla("+t+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return Xs(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,n,r,i){var a=[yl(Math.round(e).toString(16)),yl(Math.round(t).toString(16)),yl(Math.round(n).toString(16)),yl(vl(r))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*fl(this._r,255))+"%",g:Math.round(100*fl(this._g,255))+"%",b:Math.round(100*fl(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+Math.round(100*fl(this._r,255))+"%, "+Math.round(100*fl(this._g,255))+"%, "+Math.round(100*fl(this._b,255))+"%)":"rgba("+Math.round(100*fl(this._r,255))+"%, "+Math.round(100*fl(this._g,255))+"%, "+Math.round(100*fl(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(pl[Xs(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+Js(this._r,this._g,this._b,this._a),n=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var i=Qs(e);n="#"+Js(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,r=this._a<1&&this._a>=0;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return Qs(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(nl,arguments)},brighten:function(){return this._applyModification(rl,arguments)},darken:function(){return this._applyModification(il,arguments)},desaturate:function(){return this._applyModification(Zs,arguments)},saturate:function(){return this._applyModification(el,arguments)},greyscale:function(){return this._applyModification(tl,arguments)},spin:function(){return this._applyModification(al,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(cl,arguments)},complement:function(){return this._applyCombination(ol,arguments)},monochromatic:function(){return this._applyCombination(ul,arguments)},splitcomplement:function(){return this._applyCombination(ll,arguments)},triad:function(){return this._applyCombination(sl,[3])},tetrad:function(){return this._applyCombination(sl,[4])}},Qs.fromRatio=function(e,t){if("object"==Hs(e)){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]="a"===r?e[r]:bl(e[r]));e=n}return Qs(e,t)},Qs.equals=function(e,t){return!(!e||!t)&&Qs(e).toRgbString()==Qs(t).toRgbString()},Qs.random=function(){return Qs.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},Qs.mix=function(e,t,n){n=0===n?0:n||50;var r=Qs(e).toRgb(),i=Qs(t).toRgb(),a=n/100;return Qs({r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a})},Qs.readability=function(e,t){var n=Qs(e),r=Qs(t);return(Math.max(n.getLuminance(),r.getLuminance())+.05)/(Math.min(n.getLuminance(),r.getLuminance())+.05)},Qs.isReadable=function(e,t,n){var r,i,a,o,s,l=Qs.readability(e,t);switch(i=!1,(a=n,"AA"!==(o=((a=a||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==o&&(o="AA"),"small"!==(s=(a.size||"small").toLowerCase())&&"large"!==s&&(s="small"),r={level:o,size:s}).level+r.size){case"AAsmall":case"AAAlarge":i=l>=4.5;break;case"AAlarge":i=l>=3;break;case"AAAsmall":i=l>=7}return i},Qs.mostReadable=function(e,t,n){var r,i,a,o,s=null,l=0;i=(n=n||{}).includeFallbackColors,a=n.level,o=n.size;for(var c=0;c<t.length;c++)(r=Qs.readability(e,t[c]))>l&&(l=r,s=Qs(t[c]));return Qs.isReadable(e,s,{level:a,size:o})||!i?s:(n.includeFallbackColors=!1,Qs.mostReadable(e,["#fff","#000"],n))};var dl=Qs.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},pl=Qs.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(dl);function hl(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function fl(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=Math.min(t,Math.max(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function ml(e){return Math.min(1,Math.max(0,e))}function gl(e){return parseInt(e,16)}function yl(e){return 1==e.length?"0"+e:""+e}function bl(e){return e<=1&&(e=100*e+"%"),e}function vl(e){return Math.round(255*parseFloat(e)).toString(16)}function wl(e){return gl(e)/255}var Sl,El,xl,_l=(El="[\\s|\\(]+("+(Sl="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+Sl+")[,|\\s]+("+Sl+")\\s*\\)?",xl="[\\s|\\(]+("+Sl+")[,|\\s]+("+Sl+")[,|\\s]+("+Sl+")[,|\\s]+("+Sl+")\\s*\\)?",{CSS_UNIT:new RegExp(Sl),rgb:new RegExp("rgb"+El),rgba:new RegExp("rgba"+xl),hsl:new RegExp("hsl"+El),hsla:new RegExp("hsla"+xl),hsv:new RegExp("hsv"+El),hsva:new RegExp("hsva"+xl),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function Ol(e){return!!_l.CSS_UNIT.exec(e)}var Tl=(e=>(e.Bytes="bytes",e.Short="short",e.Nanoseconds="ns",e))(Tl||{}),Cl=(e=>(e.TopTable="topTable",e.FlameGraph="flameGraph",e.Both="both",e))(Cl||{}),kl=(e=>(e.ValueBased="valueBased",e.PackageBased="packageBased",e))(kl||{}),Pl=(e=>(e.Default="default",e.DiffColorBlind="diffColorBlind",e))(Pl||{}),Al=__webpack_require__(4201);const Rl=[Qs({h:24,s:69,l:60}),Qs({h:34,s:65,l:65}),Qs({h:194,s:52,l:61}),Qs({h:163,s:45,l:55}),Qs({h:211,s:48,l:60}),Qs({h:246,s:40,l:65}),Qs({h:305,s:63,l:79}),Qs({h:47,s:100,l:73}),Qs({r:183,g:219,b:171}),Qs({r:244,g:213,b:152}),Qs({r:78,g:146,b:249}),Qs({r:249,g:186,b:143}),Qs({r:242,g:145,b:145}),Qs({r:130,g:181,b:216}),Qs({r:229,g:168,b:226}),Qs({r:174,g:162,b:224}),Qs({r:154,g:196,b:138}),Qs({r:242,g:201,b:109}),Qs({r:101,g:197,b:219}),Qs({r:249,g:147,b:78}),Qs({r:234,g:100,b:96}),Qs({r:81,g:149,b:206}),Qs({r:214,g:131,b:206}),Qs({r:128,g:110,b:183})],Dl=`linear-gradient(90deg, ${Il(1,100,0,1)} 0%, ${Il(100,100,0,1)} 100%)`,jl=`linear-gradient(90deg, ${Rl[0]} 0%, ${Rl[2]} 30%, ${Rl[6]} 50%, ${Rl[7]} 70%, ${Rl[8]} 100%)`;function Il(e,t,n,r){const i=Math.min(1,e/t/(r-n));return Qs({h:50-50*i,s:100,l:65+7*i})}const Nl=["rgb(0, 170, 0)","rgb(148, 142, 142)","rgb(200, 0, 0)"],Ll=`linear-gradient(90deg, ${Nl[0]} 0%, ${Nl[1]} 50%, ${Nl[2]} 100%)`,Ml=["rgb(26, 133, 255)","rgb(148, 142, 142)","rgb(220, 50, 32)"],Fl=`linear-gradient(90deg, ${Ml[0]} 0%, ${Ml[1]} 50%, ${Ml[2]} 100%)`,$l=[["phpspy",new RegExp("^(?<packageName>([^\\/]*\\/)*)(?<filename>.*\\.php+)(?<line_info>.*)$")],["pyspy",new RegExp("^(?<packageName>([^\\/]*\\/)*)(?<filename>.*\\.py+)(?<line_info>.*)$")],["rbspy",new RegExp("^(?<packageName>([^\\/]*\\/)*)(?<filename>.*\\.rb+)(?<line_info>.*)$")],["nodespy",new RegExp("^(\\.\\/node_modules\\/)?(?<packageName>[^/]*)(?<filename>.*\\.?(jsx?|tsx?)?):(?<functionName>.*):(?<line_info>.*)$")],["gospy",new RegExp("^(?<packageName>.*?\\/.*?\\.|.*?\\.|.+)(?<functionName>.*)$")],["javaspy",new RegExp("^(?<packageName>.+\\/)(?<filename>.+\\.)(?<functionName>.+)$")],["dotnetspy",new RegExp("^(?<packageName>.+)\\.(.+)\\.(.+)\\(.*\\)$")],["tracing",new RegExp("^(?<packageName>.+?):.*$")],["pyroscope-rs",new RegExp("^(?<packageName>[^::]+)")],["ebpfspy",new RegExp("^(?<packageName>.+)$")],["unknown",new RegExp("^(?<packageName>.+)$")]];function Bl(e){const{canvasRef:t,data:n,root:i,depth:a,direction:o,wrapperWidth:s,rangeMin:l,rangeMax:c,matchedLabels:u,textAlign:d,totalViewTicks:p,totalColorTicks:h,totalTicksRight:f,colorScheme:m,focusedItemData:g,collapsedMap:y}=e,b=function(e,t,n){const[r,i]=(0,Ei.useState)();return(0,Ei.useEffect)((()=>{if(!n||!e.current)return;const r=e.current.getContext("2d"),a=Ps*n;e.current.width=Math.round(t*window.devicePixelRatio),e.current.height=Math.round(a),e.current.style.width=`${t}px`,e.current.style.height=a/window.devicePixelRatio+"px",r.textBaseline="middle",r.font=12*window.devicePixelRatio+"px monospace",r.strokeStyle="white",i(r)}),[e,i,t,n]),r}(t,s,a),v=(0,r.useTheme2)(),w=(0,Ei.useMemo)((()=>{const e=Qs(v.colors.background.secondary);return v.isLight?e.darken(10).toHexString():e.lighten(10).toHexString()}),[v]),S=function(e,t,n,r,i,a,o,s,l){return(0,Ei.useCallback)((function(c,u,d){if(d&&!s)return i;const p=void 0===c.valueRight||n!==Pl.Default&&n!==Pl.DiffColorBlind?n===kl.ValueBased?Il(c.value,e,a,o):function(e,t){const n=function(e){var t;for(const[n,r]of $l){const n=e.match(r);if(n)return(null==(t=n.groups)?void 0:t.packageName)||""}}(e),r=function(e,t=0){let n,r,i,a,o,s,l,c;for(n=3&e.length,r=e.length-n,i=t,o=3432918353,s=461845907,c=0;c<r;)l=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295,i^=l,i=i<<13|i>>>19,a=5*(65535&i)+((5*(i>>>16)&65535)<<16)&4294967295,i=27492+(65535&a)+((58964+(a>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(c+2))<<16;case 2:l^=(255&e.charCodeAt(c+1))<<8;case 1:l^=255&e.charCodeAt(c);default:l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(65535&l)*s+(((l>>>16)*s&65535)<<16)&4294967295,i^=l}return i^=e.length,i^=i>>>16,i=2246822507*(65535&i)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(65535&i)+((3266489909*(i>>>16)&65535)<<16)&4294967295,i^=i>>>16,i>>>0}(n||"",0),i=r%Rl.length;let a=Rl[i].clone();return t.isLight&&(a=a.brighten(15)),a}(u,r):function(e,t,n,r,i){const a=i===Pl.Default?Nl:Ml,o=(0,Al.scaleLinear)().domain([-100,0,100]).range(a),s=e-t,l=n-r;if(0===r||0===l)return Qs(o(0));const c=Math.round(1e4*s/l)/100;return Qs(o((Math.round(1e4*t/r)/100-c)/c*100))}(c.value,c.valueRight,e,t,n);return s?s.has(u)?p.toHslString():i:c.level>l-1?p.toHslString():p.lighten(15).toHslString()}),[e,t,n,r,a,o,s,l,i])}(h,f,m,v,w,l,c,u,g?g.item.level:0),E=function(e,t,n,r,i){return(0,Ei.useMemo)((()=>{if(!e)return()=>{};return(a,o,s,l,c,u)=>{e.beginPath(),e.rect(o+js,s,l,c),e.fillStyle=n(a,u,!1),e.stroke(),e.fill();const d=i.get(a);let p=u;d&&d.collapsed&&(p=`(${d.items.length}) `+u),l>=Ds&&(d?(Vl(e,t,p,a,l,"left"===r?o+Ms+Fs:o,s,r),function(e,t,n,r,i,a){const o=t+Ms;e.beginPath(),e.rect(t,n,o-t+Ns+Ls,r),e.fill(),e.beginPath(),a.collapsed?e.rect(o,n+r/4,Ns,r/2):a.items[0]===i?e.rect(o,n+r/2,Ns,r/2):a.items[a.items.length-1]===i?e.rect(o,n,Ns,r/2):e.rect(o,n,Ns,r),e.fillStyle="#666",e.fill()}(e,o,s,c,a,d)):Vl(e,t,p,a,l,o,s,r))}}),[e,n,r,t,i])}(b,n,S,d,y);(0,Ei.useEffect)((()=>{if(!b)return;b.clearRect(0,0,b.canvas.width,b.canvas.height);const e=new Path2D;!function(e,t,n,r,i,a,o,s,l){const c=[];c.push({item:e,levelOffset:0});const u=o*window.devicePixelRatio/r/(a-i);let d;for(;c.length>0;){const{item:e,levelOffset:a}=c.shift();let o=e.value;const p=o*u<=As,h=o*u-(p?0:2*js),f=Ps;if(h<Rs)continue;let m=0,g=!1;const y=s.get(e),b=y&&y.collapsed;b&&d===y.items[0]?(m="children"===t?-1:1,g=!0):d=void 0,g||(b&&(d=e),l(e,zl(e.start,r,i,u),(e.level+a)*Ps,h,f,n.getLabel(e.itemIndexes[0]),p));const v="children"===t?e.children:e.parents;v&&c.unshift(...v.map((e=>({item:e,levelOffset:a+m}))))}}(i,o,n,p,l,c,s,y,((t,n,r,i,a,o,s)=>{s?e.rect(n,r,i,a):E(t,n,r,i,a,o)})),b.fillStyle=w,b.fill(e)}),[b,n,i,s,l,c,p,o,E,y,w])}function Vl(e,t,n,r,i,a,o,s){e.save(),e.clip(),e.fillStyle="#222";const l=t.valueDisplayProcessor(r.value),c=l.suffix?l.text+l.suffix:l.text,u=e.measureText(n),d=i-Is;let p=`${n} (${c})`,h=Math.max(a,0)+Is;u.width>d&&(e.textAlign=s,"right"===s&&(p=n,h=a+i-Is)),e.fillText(p,h,o+Ps/2+2),e.restore()}function zl(e,t,n,r){return(e-t*n)*r}const Ul=({data:e,rangeMin:t,rangeMax:n,matchedLabels:r,setRangeMin:i,setRangeMax:a,onItemFocused:o,focusedItemData:s,textAlign:l,onSandwich:c,colorScheme:u,totalProfileTicks:d,totalProfileTicksRight:p,totalViewTicks:h,root:f,direction:m,depth:g,showFlameGraphOnly:y,collapsedMap:b,setCollapsedMap:v,collapsing:w,getExtraContextMenuButtons:S,selectedView:E,search:x})=>{const _=ql(),[O,{width:T}]=ks(),C=(0,Ei.useRef)(null),[k,P]=(0,Ei.useState)(),[A,R]=(0,Ei.useState)();Bl({canvasRef:C,colorScheme:u,data:e,focusedItemData:s,root:f,direction:m,depth:g,rangeMax:n,rangeMin:t,matchedLabels:r,textAlign:l,totalViewTicks:h,totalColorTicks:e.isDiffFlamegraph()?d:h,totalTicksRight:p,wrapperWidth:T,collapsedMap:b});const D=(0,Ei.useCallback)((r=>{P(void 0);const i=C.current.clientWidth/h/(n-t),a=Hl({x:r.nativeEvent.offsetX,y:r.nativeEvent.offsetY},f,m,g,i,h,t,b);R(a?{posY:r.clientY,posX:r.clientX,item:a,label:e.getLabel(a.itemIndexes[0])}:void 0)}),[e,t,n,h,f,m,g,b]),[j,I]=(0,Ei.useState)(),N=(0,Ei.useCallback)((e=>{if(void 0===A){P(void 0),I(void 0);const r=C.current.clientWidth/h/(n-t),i=Hl({x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY},f,m,g,r,h,t,b);i&&(I({x:e.clientX,y:e.clientY}),P(i))}}),[t,n,h,A,I,f,m,g,b]),L=(0,Ei.useCallback)((()=>{P(void 0)}),[]);return(0,Ei.useEffect)((()=>{const e=e=>{var t;e.target instanceof HTMLElement&&"flameGraphCanvasContainer_clickOutsideCheck"!==(null==(t=e.target.parentElement)?void 0:t.id)&&R(void 0)};return window.addEventListener("click",e),()=>window.removeEventListener("click",e)}),[R]),(0,_i.jsxs)("div",{className:_.graph,children:[(0,_i.jsx)("div",{className:_.canvasWrapper,id:"flameGraphCanvasContainer_clickOutsideCheck",ref:O,children:(0,_i.jsx)("canvas",{ref:C,"data-testid":"flameGraph",onClick:D,onMouseMove:N,onMouseLeave:L})}),(0,_i.jsx)(Bs,{position:j,item:k,data:e,totalTicks:h,collapseConfig:k?b.get(k):void 0}),!y&&A&&(0,_i.jsx)($s,{data:e,itemData:A,collapsing:w,collapseConfig:b.get(A.item),onMenuItemClick:()=>{R(void 0)},onItemFocus:()=>{i(A.item.start/h),a((A.item.start+A.item.value)/h),o(A)},onSandwich:()=>{c(e.getLabel(A.item.itemIndexes[0]))},onExpandGroup:()=>{v(b.setCollapsedStatus(A.item,!1))},onCollapseGroup:()=>{v(b.setCollapsedStatus(A.item,!0))},onExpandAllGroups:()=>{v(b.setAllCollapsedStatus(!1))},onCollapseAllGroups:()=>{v(b.setAllCollapsedStatus(!0))},allGroupsCollapsed:Array.from(b.values()).every((e=>e.collapsed)),allGroupsExpanded:Array.from(b.values()).every((e=>!e.collapsed)),getExtraContextMenuButtons:S,selectedView:E,search:x})]})},ql=()=>({graph:(0,t.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),canvasContainer:(0,t.css)({label:"canvasContainer",display:"flex"}),canvasWrapper:(0,t.css)({label:"canvasWrapper",cursor:"pointer",flex:1,overflow:"hidden"}),sandwichMarker:(0,t.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerIcon:(0,t.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})}),Hl=(e,t,n,r,i,a,o,s)=>{let l=t,c="children"===n?0:r-1;const u=Math.floor(e.y/(Ps/window.devicePixelRatio));let d;for(;l;){const t=l;if(l=void 0,c===u){d=t;break}const r="children"===n?t.children:t.parents||[];for(const t of r){const r=zl(t.start,a,o,i),u=zl(t.start+t.value,a,o,i);if(r<=e.x&&e.x<u){l=t;const e=s.get(t);e&&e.collapsed&&e.items[0]!==t||(c+="children"===n?1:-1);break}}}return d},Gl=(0,Ei.memo)((({data:t,focusedItem:n,totalTicks:i,sandwichedLabel:a,onFocusPillClick:o,onSandwichPillClick:s})=>{const l=(0,r.useStyles2)(Wl),c=[],u=(0,e.getValueFormat)("short")(i),d=t.valueDisplayProcessor(i);let p=d.text+d.suffix;const h=t.getUnitTitle();if("Count"===h&&(d.suffix||(p=d.text)),c.push((0,_i.jsxs)("div",{className:l.metadataPill,children:[p," | ",u.text,u.suffix," samples (",h,")"]},"default")),a&&c.push((0,_i.jsxs)("span",{children:[(0,_i.jsx)(r.Icon,{size:"sm",name:"angle-right"}),(0,_i.jsxs)("div",{className:l.metadataPill,children:[(0,_i.jsx)(r.Icon,{size:"sm",name:"gf-show-context"})," ",(0,_i.jsx)("span",{className:l.metadataPillName,children:a.substring(a.lastIndexOf("/")+1)}),(0,_i.jsx)(r.IconButton,{className:l.pillCloseButton,name:"times",size:"sm",onClick:s,tooltip:"Remove sandwich view","aria-label":"Remove sandwich view"})]})]},"sandwich")),n){const e=Math.round(n.item.value/i*1e4)/100;c.push((0,_i.jsxs)("span",{children:[(0,_i.jsx)(r.Icon,{size:"sm",name:"angle-right"}),(0,_i.jsxs)("div",{className:l.metadataPill,children:[(0,_i.jsx)(r.Icon,{size:"sm",name:"eye"})," ",e,"% of total",(0,_i.jsx)(r.IconButton,{className:l.pillCloseButton,name:"times",size:"sm",onClick:o,tooltip:"Remove focus","aria-label":"Remove focus"})]})]},"focus"))}return(0,_i.jsx)("div",{className:l.metadata,children:c})}));Gl.displayName="FlameGraphMetadata";const Wl=e=>({metadataPill:(0,t.css)({label:"metadataPill",display:"inline-flex",alignItems:"center",background:e.colors.background.secondary,borderRadius:e.shape.borderRadius(8),padding:e.spacing(.5,1),fontSize:e.typography.bodySmall.fontSize,fontWeight:e.typography.fontWeightMedium,lineHeight:e.typography.bodySmall.lineHeight,color:e.colors.text.secondary}),pillCloseButton:(0,t.css)({label:"pillCloseButton",verticalAlign:"text-bottom",margin:e.spacing(0,.5)}),metadata:(0,t.css)({margin:"8px 0",textAlign:"center"}),metadataPillName:(0,t.css)({label:"metadataPillName",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginLeft:e.spacing(.5)})});var Ql=Object.defineProperty,Kl=Object.defineProperties,Yl=Object.getOwnPropertyDescriptors,Xl=Object.getOwnPropertySymbols,Jl=Object.prototype.hasOwnProperty,Zl=Object.prototype.propertyIsEnumerable,ec=(e,t,n)=>t in e?Ql(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,tc=(e,t)=>{for(var n in t||(t={}))Jl.call(t,n)&&ec(e,n,t[n]);if(Xl)for(var n of Xl(t))Zl.call(t,n)&&ec(e,n,t[n]);return e},nc=(e,t)=>Kl(e,Yl(t));const rc=({data:e,rangeMin:n,rangeMax:i,matchedLabels:a,setRangeMin:o,setRangeMax:s,onItemFocused:l,focusedItemData:c,textAlign:u,onSandwich:d,sandwichItem:p,onFocusPillClick:h,onSandwichPillClick:f,colorScheme:m,showFlameGraphOnly:g,getExtraContextMenuButtons:y,collapsing:b,selectedView:v,search:w,collapsedMap:S,setCollapsedMap:E})=>{const x=ic(),[_,O]=(0,Ei.useState)(),[T,C]=(0,Ei.useState)(),[k,P]=(0,Ei.useState)(0),[A,R]=(0,Ei.useState)(),[D,j]=(0,Ei.useState)(0);if((0,Ei.useEffect)((()=>{var t,n,r;if(e){let i,a=e.getLevels(),o=a.length?a[0][0].value:0,s=a.length?a[0][0].valueRight:void 0,l=o;if(p){const[o,s]=e.getSandwichLevels(p);a=s,i=o,l=null!=(r=null==(n=null==(t=s[0])?void 0:t[0])?void 0:n.value)?r:0}O(a),C(i),P(o),R(s),j(l)}}),[e,p]),!_)return null;const I={data:e,rangeMin:n,rangeMax:i,matchedLabels:a,setRangeMin:o,setRangeMax:s,onItemFocused:l,focusedItemData:c,textAlign:u,onSandwich:d,colorScheme:m,totalProfileTicks:k,totalProfileTicksRight:A,totalViewTicks:D,showFlameGraphOnly:g,collapsedMap:S,setCollapsedMap:E,getExtraContextMenuButtons:y,collapsing:b,search:w,selectedView:v},N=T?(0,_i.jsxs)(_i.Fragment,{children:[(0,_i.jsxs)("div",{className:x.sandwichCanvasWrapper,children:[(0,_i.jsxs)("div",{className:x.sandwichMarker,children:["Callers",(0,_i.jsx)(r.Icon,{className:x.sandwichMarkerIcon,name:"arrow-down"})]}),(0,_i.jsx)(Ul,nc(tc({},I),{root:T[T.length-1][0],depth:T.length,direction:"parents",collapsing:!1}))]}),(0,_i.jsxs)("div",{className:x.sandwichCanvasWrapper,children:[(0,_i.jsxs)("div",{className:(0,t.cx)(x.sandwichMarker,x.sandwichMarkerCalees),children:[(0,_i.jsx)(r.Icon,{className:x.sandwichMarkerIcon,name:"arrow-up"}),"Callees"]}),(0,_i.jsx)(Ul,nc(tc({},I),{root:_[0][0],depth:_.length,direction:"children",collapsing:!1}))]})]}):(0,_i.jsx)(Ul,nc(tc({},I),{root:_[0][0],depth:_.length,direction:"children"}));return(0,_i.jsxs)("div",{className:x.graph,children:[(0,_i.jsx)(Gl,{data:e,focusedItem:c,sandwichedLabel:p,totalTicks:D,onFocusPillClick:h,onSandwichPillClick:f}),N]})},ic=()=>({graph:(0,t.css)({label:"graph",overflow:"auto",flexGrow:1,flexBasis:"50%"}),sandwichCanvasWrapper:(0,t.css)({label:"sandwichCanvasWrapper",display:"flex",marginBottom:Ps/window.devicePixelRatio+"px"}),sandwichMarker:(0,t.css)({label:"sandwichMarker",writingMode:"vertical-lr",transform:"rotate(180deg)",overflow:"hidden",whiteSpace:"nowrap"}),sandwichMarkerCalees:(0,t.css)({label:"sandwichMarkerCalees",textAlign:"right"}),sandwichMarkerIcon:(0,t.css)({label:"sandwichMarkerIcon",verticalAlign:"baseline"})});var ac=__webpack_require__(3241),oc=Object.defineProperty,sc=Object.defineProperties,lc=Object.getOwnPropertyDescriptors,cc=Object.getOwnPropertySymbols,uc=Object.prototype.hasOwnProperty,dc=Object.prototype.propertyIsEnumerable,pc=(e,t,n)=>t in e?oc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,hc=(e,t)=>{for(var n in t||(t={}))uc.call(t,n)&&pc(e,n,t[n]);if(cc)for(var n of cc(t))dc.call(t,n)&&pc(e,n,t[n]);return e},fc=(e,t)=>sc(e,lc(t));function mc(e,t){const n=function(e){return e.map((e=>{var t,n;if(!(null==(t=e.parents)?void 0:t.length))return e;const r=fc(hc({},e),{children:[]}),i=[{child:r,parent:e.parents[0]}];for(;i.length;){const e=i.shift(),t=fc(hc({},e.parent),{children:e.child?[e.child]:[],parents:[]});e.child&&(t.value=e.child.value,e.child.parents=[t]),(null==(n=e.parent.parents)?void 0:n.length)&&i.push({child:t,parent:e.parent.parents[0]})}return r}))}(e);return gc(n,t,"parents")}function gc(e,t,n="children"){var r;const i="parents"===n?"children":"parents",a=[],o=[{previous:void 0,items:e,level:0}];for(;o.length;){const e=o.shift(),s=e.items.flatMap((e=>e.itemIndexes)),l={value:e.items.reduce(((e,t)=>e+t.value),0),itemIndexes:s,children:[],parents:[],start:0,level:e.level};if(a[e.level]=a[e.level]||[],a[e.level].push(l),e.previous){l[i]=[e.previous];const t=(null==(r=e.previous[n])?void 0:r.reduce(((e,t)=>e+t.value),0))||0;l.start=e.previous.start+t,e.previous[n].push(l)}const c=e.items.flatMap((e=>e[n]||[])),u=(0,ac.groupBy)(c,(e=>t.getLabel(e.itemIndexes[0])));for(const t of Object.values(u))o.push({previous:l,items:t,level:e.level+1})}return"parents"===n&&(a.reverse(),a.forEach(((e,t)=>{e.forEach((e=>{e.level=t}))}))),a}var yc=Object.defineProperty,bc=Object.defineProperties,vc=Object.getOwnPropertyDescriptors,wc=Object.getOwnPropertySymbols,Sc=Object.prototype.hasOwnProperty,Ec=Object.prototype.propertyIsEnumerable,xc=(e,t,n)=>t in e?yc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_c=(e,t)=>{for(var n in t||(t={}))Sc.call(t,n)&&xc(e,n,t[n]);if(wc)for(var n of wc(t))Ec.call(t,n)&&xc(e,n,t[n]);return e},Oc=(e,t)=>bc(e,vc(t)),Tc=(e,t,n)=>(xc(e,"symbol"!=typeof t?t+"":t,n),n);class Cc{constructor(e){Tc(this,"map",new Map),this.map=e||new Map}get(e){return this.map.get(e)}keys(){return this.map.keys()}values(){return this.map.values()}size(){return this.map.size}setCollapsedStatus(e,t){const n=new Map(this.map),r=this.map.get(e),i=Oc(_c({},r),{collapsed:t});for(const e of r.items)n.set(e,i);return new Cc(n)}setAllCollapsedStatus(e){const t=new Map(this.map);for(const n of this.map.keys()){const r=this.map.get(n),i=Oc(_c({},r),{collapsed:e});t.set(n,i)}return new Cc(t)}}class kc{constructor(e){Tc(this,"map",new Map),Tc(this,"threshold",.99),void 0!==e&&(this.threshold=e)}addTree(e){var t;const n=[e];for(;n.length;){const e=n.shift();(null==(t=e.parents)?void 0:t.length)&&this.addItem(e,e.parents[0]),e.children.length&&n.unshift(...e.children)}}addItem(e,t){if(t&&e.value>t.value*this.threshold&&1===t.children.length)if(this.map.has(t)){const n=this.map.get(t);this.map.set(e,n),n.items.push(e)}else{const n={items:[t,e],collapsed:!0};this.map.set(t,n),this.map.set(e,n)}}getCollapsedMap(){return new Cc(this.map)}}class Pc{constructor(t,n,r=(0,e.createTheme)()){var i,a,o;Tc(this,"data"),Tc(this,"options"),Tc(this,"labelField"),Tc(this,"levelField"),Tc(this,"valueField"),Tc(this,"selfField"),Tc(this,"valueRightField"),Tc(this,"selfRightField"),Tc(this,"labelDisplayProcessor"),Tc(this,"valueDisplayProcessor"),Tc(this,"uniqueLabels"),Tc(this,"levels"),Tc(this,"uniqueLabelsMap"),Tc(this,"collapsedMap"),this.data=t,this.options=n;const s=function(t){const n=[["label",[e.FieldType.string,e.FieldType.enum]],["level",[e.FieldType.number]],["value",[e.FieldType.number]],["self",[e.FieldType.number]]],r=[],i=[];for(const e of n){const[n,a]=e,o=t.fields.find((e=>e.name===n));o?a.includes(o.type)||i.push({name:n,expectedTypes:a,type:o.type}):r.push(n)}if(r.length>0||i.length>0)return{wrongTypeFields:i,missingFields:r}}(t);if(s)throw new Error(function(e){return e.missingFields.length?`Data is missing fields: ${e.missingFields.join(", ")}`:e.wrongTypeFields.length?`Data has fields of wrong type: ${e.wrongTypeFields.map((e=>`${e.name} has type ${e.type} but should be ${e.expectedTypes.join(" or ")}`)).join(", ")}`:""}(s));if(this.labelField=t.fields.find((e=>"label"===e.name)),this.levelField=t.fields.find((e=>"level"===e.name)),this.valueField=t.fields.find((e=>"value"===e.name)),this.selfField=t.fields.find((e=>"self"===e.name)),this.valueRightField=t.fields.find((e=>"valueRight"===e.name)),this.selfRightField=t.fields.find((e=>"selfRight"===e.name)),(this.valueField||this.selfField)&&(!this.valueField||!this.selfField))throw new Error("Malformed dataFrame: both valueRight and selfRight has to be present if one of them is present.");const l=null==(o=null==(a=null==(i=this.labelField)?void 0:i.config)?void 0:a.type)?void 0:o.enum;l?(this.labelDisplayProcessor=(0,e.getDisplayProcessor)({field:this.labelField,theme:r}),this.uniqueLabels=l.text||[]):(this.labelDisplayProcessor=e=>({text:e+"",numeric:0}),this.uniqueLabels=[...new Set(this.labelField.values)]),this.valueDisplayProcessor=(0,e.getDisplayProcessor)({field:this.valueField,theme:r})}isDiffFlamegraph(){return Boolean(this.valueRightField&&this.selfRightField)}getLabel(e){return this.labelDisplayProcessor(this.labelField.values[e]).text}getLevel(e){return this.levelField.values[e]}getValue(e){return Ac(this.valueField,e)}getValueRight(e){return Ac(this.valueRightField,e)}getSelf(e){return Ac(this.selfField,e)}getSelfRight(e){return Ac(this.selfRightField,e)}getSelfDisplay(e){return this.valueDisplayProcessor(this.getSelf(e))}getUniqueLabels(){return this.uniqueLabels}getUnitTitle(){switch(this.valueField.config.unit){case Tl.Bytes:return"RAM";case Tl.Nanoseconds:return"Time"}return"Count"}getLevels(){return this.initLevels(),this.levels}getSandwichLevels(e){const t=this.getNodesWithLabel(e);return(null==t?void 0:t.length)?[mc(t,this),gc(t,this)]:[[],[]]}getNodesWithLabel(e){return this.initLevels(),this.uniqueLabelsMap[e]}getCollapsedMap(){return this.initLevels(),this.collapsedMap}initLevels(){if(!this.levels){const[e,t,n]=function(e,t){const n=[];let r,i=0;const a={};for(let t=0;t<e.data.length;t++){const o=e.getLevel(t),s=t>0?e.getLevel(t-1):void 0;if(n[o]=n[o]||[],s&&s>=o){const t=n[o][n[o].length-1];i=t.start+e.getValue(t.itemIndexes[0])+e.getValueRight(t.itemIndexes[0]),r=t.parents[0]}const l={itemIndexes:[t],value:e.getValue(t)+e.getValueRight(t),valueRight:e.isDiffFlamegraph()?e.getValueRight(t):void 0,start:i,parents:r&&[r],children:[],level:o};a[e.getLabel(t)]?a[e.getLabel(t)].push(l):a[e.getLabel(t)]=[l],r&&r.children.push(l),r=l,n[o].push(l)}const o=new kc(null==t?void 0:t.collapsingThreshold);return(null==t?void 0:t.collapsing)&&o.addTree(n[0][0]),[n,a,o.getCollapsedMap()]}(this,this.options);this.levels=e,this.uniqueLabelsMap=t,this.collapsedMap=n}}}function Ac(e,t){return e?("number"==typeof t?[t]:t).reduce(((t,n)=>t+e.values[n]),0):0}var Rc=__webpack_require__(4386),Dc=__webpack_require__(1336);const jc=({search:e,setSearch:n,selectedView:i,setSelectedView:a,containerWidth:o,onReset:s,textAlign:l,onTextAlignChange:c,showResetButton:u,colorScheme:d,onColorSchemeChange:p,stickyHeader:h,extraHeaderElements:f,vertical:m,isDiffMode:g,setCollapsedMap:y,collapsedMap:b})=>{const v=(0,r.useStyles2)(Mc),[w,S]=function(e,t){const[n,r]=(0,Ei.useState)(e),i=(0,Dc.A)(e);return(0,Rc.A)((()=>{t(n)}),250,[n]),(0,Ei.useEffect)((()=>{i!==e&&e!==n&&r(e)}),[e,i,n]),[n,r]}(e,n),E=""!==w?(0,_i.jsx)(r.Button,{icon:"times",fill:"text",size:"sm",onClick:()=>{n(""),S("")},children:"Clear"}):null;return(0,_i.jsxs)("div",{className:(0,t.cx)(v.header,{[v.stickyHeader]:h}),children:[(0,_i.jsx)("div",{className:v.inputContainer,children:(0,_i.jsx)(r.Input,{value:w||"",onChange:e=>{S(e.currentTarget.value)},placeholder:"Search...",suffix:E})}),(0,_i.jsxs)("div",{className:v.rightContainer,children:[u&&(0,_i.jsx)(r.Button,{variant:"secondary",fill:"outline",size:"sm",icon:"history-alt",tooltip:"Reset focus and sandwich state",onClick:()=>{s()},className:v.buttonSpacing,"aria-label":"Reset focus and sandwich state"}),(0,_i.jsx)(Ic,{value:d,onChange:p,isDiffMode:g}),(0,_i.jsxs)(r.ButtonGroup,{className:v.buttonSpacing,children:[(0,_i.jsx)(r.Button,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Expand all groups",onClick:()=>{y(b.setAllCollapsedStatus(!1))},"aria-label":"Expand all groups",icon:"angle-double-down",disabled:i===Cl.TopTable}),(0,_i.jsx)(r.Button,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Collapse all groups",onClick:()=>{y(b.setAllCollapsedStatus(!0))},"aria-label":"Collapse all groups",icon:"angle-double-up",disabled:i===Cl.TopTable})]}),(0,_i.jsx)(r.RadioButtonGroup,{size:"sm",disabled:i===Cl.TopTable,options:Nc,value:l,onChange:c,className:v.buttonSpacing}),(0,_i.jsx)(r.RadioButtonGroup,{size:"sm",options:Lc(o,m),value:i,onChange:a}),f&&(0,_i.jsx)("div",{className:v.extraElements,children:f})]})]})};function Ic(e){const n=(0,r.useStyles2)(Mc);let i=(0,_i.jsxs)(r.Menu,{children:[(0,_i.jsx)(r.Menu.Item,{label:"By package name",onClick:()=>e.onChange(kl.PackageBased)}),(0,_i.jsx)(r.Menu.Item,{label:"By value",onClick:()=>e.onChange(kl.ValueBased)})]});const a={[kl.ValueBased]:n.colorDotByValue,[kl.PackageBased]:n.colorDotByPackage,[Pl.DiffColorBlind]:n.colorDotDiffColorBlind,[Pl.Default]:n.colorDotDiffDefault}[e.value]||n.colorDotByValue;let o=(0,_i.jsx)("span",{className:(0,t.cx)(n.colorDot,a)});return e.isDiffMode&&(i=(0,_i.jsxs)(r.Menu,{children:[(0,_i.jsx)(r.Menu.Item,{label:"Default (green to red)",onClick:()=>e.onChange(Pl.Default)}),(0,_i.jsx)(r.Menu.Item,{label:"Color blind (blue to red)",onClick:()=>e.onChange(Pl.DiffColorBlind)})]}),o=(0,_i.jsxs)("div",{className:(0,t.cx)(n.colorDotDiff,a),children:[(0,_i.jsx)("div",{children:"-100% (removed)"}),(0,_i.jsx)("div",{children:"0%"}),(0,_i.jsx)("div",{children:"+100% (added)"})]})),(0,_i.jsx)(r.Dropdown,{overlay:i,children:(0,_i.jsx)(r.Button,{variant:"secondary",fill:"outline",size:"sm",tooltip:"Change color scheme",onClick:()=>{},className:n.buttonSpacing,"aria-label":"Change color scheme",children:o})})}const Nc=[{value:"left",description:"Align text left",icon:"align-left"},{value:"right",description:"Align text right",icon:"align-right"}];function Lc(e,t){let n=[{value:Cl.TopTable,label:"Top Table",description:"Only show top table"},{value:Cl.FlameGraph,label:"Flame Graph",description:"Only show flame graph"}];return(e>=800||t)&&n.push({value:Cl.Both,label:"Both",description:"Show both the top table and flame graph"}),n}const Mc=e=>({header:(0,t.css)({label:"header",display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",top:0,gap:e.spacing(1),marginTop:e.spacing(1)}),stickyHeader:(0,t.css)({zIndex:e.zIndex.navbarFixed,position:"sticky",background:e.colors.background.primary}),inputContainer:(0,t.css)({label:"inputContainer",flexGrow:1,minWidth:"150px",maxWidth:"350px"}),rightContainer:(0,t.css)({label:"rightContainer",display:"flex",alignItems:"flex-start",flexWrap:"wrap"}),buttonSpacing:(0,t.css)({label:"buttonSpacing",marginRight:e.spacing(1)}),resetButton:(0,t.css)({label:"resetButton",display:"flex",marginRight:e.spacing(2)}),resetButtonIconWrapper:(0,t.css)({label:"resetButtonIcon",padding:"0 5px",color:e.colors.text.disabled}),colorDot:(0,t.css)({label:"colorDot",display:"inline-block",width:"10px",height:"10px",borderRadius:"50%"}),colorDotDiff:(0,t.css)({label:"colorDotDiff",display:"flex",width:"200px",height:"12px",color:"white",fontSize:9,lineHeight:1.3,fontWeight:300,justifyContent:"space-between",padding:"0 2px",borderRadius:"2px"}),colorDotByValue:(0,t.css)({label:"colorDotByValue",background:Dl}),colorDotByPackage:(0,t.css)({label:"colorDotByPackage",background:jl}),colorDotDiffDefault:(0,t.css)({label:"colorDotDiffDefault",background:Ll}),colorDotDiffColorBlind:(0,t.css)({label:"colorDotDiffColorBlind",background:Fl}),extraElements:(0,t.css)({label:"extraElements",marginLeft:e.spacing(1)})});let Fc;Fc="undefined"!=typeof window?window:"undefined"!=typeof self?self:__webpack_require__.g;let $c=null,Bc=null;const Vc=Fc.clearTimeout,zc=Fc.setTimeout,Uc=Fc.cancelAnimationFrame||Fc.mozCancelAnimationFrame||Fc.webkitCancelAnimationFrame,qc=Fc.requestAnimationFrame||Fc.mozRequestAnimationFrame||Fc.webkitRequestAnimationFrame;null==Uc||null==qc?($c=Vc,Bc=function(e){return zc(e,20)}):($c=function([e,t]){Uc(e),Vc(t)},Bc=function(e){const t=qc((function(){Vc(n),e()})),n=zc((function(){Uc(t),e()}),20);return[t,n]});class Hc extends Ei.Component{constructor(...e){super(...e),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:e,disableWidth:t,onResize:n}=this.props;if(this._parentNode){const r=window.getComputedStyle(this._parentNode)||{},i=parseFloat(r.paddingLeft||"0"),a=parseFloat(r.paddingRight||"0"),o=parseFloat(r.paddingTop||"0"),s=parseFloat(r.paddingBottom||"0"),l=this._parentNode.getBoundingClientRect(),c=l.height-o-s,u=l.width-i-a,d=this._parentNode.offsetHeight-o-s,p=this._parentNode.offsetWidth-i-a;(e||this.state.height===d&&this.state.scaledHeight===c)&&(t||this.state.width===p&&this.state.scaledWidth===u)||(this.setState({height:d,width:p,scaledHeight:c,scaledWidth:u}),"function"==typeof n&&n({height:d,scaledHeight:c,scaledWidth:u,width:p}))}},this._setRef=e=>{this._autoSizer=e}}componentDidMount(){const{nonce:e}=this.props,t=this._autoSizer?this._autoSizer.parentNode:null;if(null!=t&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){this._parentNode=t;const n=t.ownerDocument.defaultView.ResizeObserver;null!=n?(this._resizeObserver=new n((()=>{this._timeoutId=setTimeout(this._onResize,0)})),this._resizeObserver.observe(t)):(this._detectElementResize=function(e){let t,n,r,i,a,o,s;const l="undefined"!=typeof document&&document.attachEvent;if(!l){o=function(e){const t=e.__resizeTriggers__,n=t.firstElementChild,r=t.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},a=function(e){return e.offsetWidth!==e.__resizeLast__.width||e.offsetHeight!==e.__resizeLast__.height},s=function(e){if(e.target.className&&"function"==typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)return;const t=this;o(this),this.__resizeRAF__&&$c(this.__resizeRAF__),this.__resizeRAF__=Bc((function(){a(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(n){n.call(t,e)})))}))};let e=!1,l="";r="animationstart";const c="Webkit Moz O ms".split(" ");let u="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),d="";{const t=document.createElement("fakeelement");if(void 0!==t.style.animationName&&(e=!0),!1===e)for(let n=0;n<c.length;n++)if(void 0!==t.style[c[n]+"AnimationName"]){d=c[n],l="-"+d.toLowerCase()+"-",r=u[n],e=!0;break}}n="resizeanim",t="@"+l+"keyframes "+n+" { from { opacity: 0; } to { opacity: 0; } } ",i=l+"animation: 1ms "+n+"; "}return{addResizeListener:function(a,c){if(l)a.attachEvent("onresize",c);else{if(!a.__resizeTriggers__){const l=a.ownerDocument,c=Fc.getComputedStyle(a);c&&"static"===c.position&&(a.style.position="relative"),function(n){if(!n.getElementById("detectElementResize")){const r=(t||"")+".resize-triggers { "+(i||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',a=n.head||n.getElementsByTagName("head")[0],o=n.createElement("style");o.id="detectElementResize",o.type="text/css",null!=e&&o.setAttribute("nonce",e),o.styleSheet?o.styleSheet.cssText=r:o.appendChild(n.createTextNode(r)),a.appendChild(o)}}(l),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=l.createElement("div")).className="resize-triggers";const u=l.createElement("div");u.className="expand-trigger",u.appendChild(l.createElement("div"));const d=l.createElement("div");d.className="contract-trigger",a.__resizeTriggers__.appendChild(u),a.__resizeTriggers__.appendChild(d),a.appendChild(a.__resizeTriggers__),o(a),a.addEventListener("scroll",s,!0),r&&(a.__resizeTriggers__.__animationListener__=function(e){e.animationName===n&&o(a)},a.__resizeTriggers__.addEventListener(r,a.__resizeTriggers__.__animationListener__))}a.__resizeListeners__.push(c)}},removeResizeListener:function(e,t){if(l)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",s,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(r,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}(e),this._detectElementResize.addResizeListener(t,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),null!==this._timeoutId&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:e,defaultHeight:t,defaultWidth:n,disableHeight:r=!1,disableWidth:i=!1,doNotBailOutOnEmptyChildren:a=!1,nonce:o,onResize:s,style:l={},tagName:c="div",...u}=this.props,{height:d,scaledHeight:p,scaledWidth:h,width:f}=this.state,m={overflow:"visible"},g={};let y=!1;return r||(0===d&&(y=!0),m.height=0,g.height=d,g.scaledHeight=p),i||(0===f&&(y=!0),m.width=0,g.width=f,g.scaledWidth=h),a&&(y=!1),(0,Ei.createElement)(c,{ref:this._setRef,style:{...m,...l},...u},!y&&e(g))}}const Gc=(0,Ei.memo)((({data:t,onSymbolClick:n,search:i,matchedLabels:a,onSearch:o,sandwichItem:s,onSandwich:l,onTableSort:c,colorScheme:u})=>{const d=(0,Ei.useMemo)((()=>{let e={};for(let n=0;n<t.data.length;n++){const r=t.getValue(n),i=t.getValueRight(n),o=t.getSelf(n),s=t.getLabel(n);a&&!a.has(s)||(e[s]=e[s]||{},e[s].self=e[s].self?e[s].self+o:o,e[s].total=e[s].total?e[s].total+r:r,e[s].totalRight=e[s].totalRight?e[s].totalRight+i:i)}return e}),[t,a]),p=(0,r.useStyles2)(Yc),h=(0,r.useTheme2)(),[f,m]=(0,Ei.useState)([{displayName:"Self",desc:!0}]);return(0,_i.jsx)("div",{className:p.topTableContainer,"data-testid":"topTable",children:(0,_i.jsx)(Hc,{style:{width:"100%"},children:({width:a,height:p})=>{if(a<3||p<3)return null;const g=function(t,n,i,a,o,s,l,c,u,d){const p=function(t,n,i,a){const o={type:r.TableCellDisplayMode.Custom,cellComponent:e=>(0,_i.jsx)(Kc,{frame:e.frame,onSandwich:t,onSearch:n,search:i,sandwichItem:a,rowIndex:e.rowIndex})},s={filterable:!1,width:Qc,hideHeader:!0,inspect:!1,align:"auto",cellOptions:o};return{type:e.FieldType.number,name:"actions",values:[],config:{custom:s}}}(s,o,u,d),h={type:e.FieldType.string,name:"Symbol",values:[],config:{custom:{width:i-Qc-240},links:[{title:"Highlight symbol",url:"",onClick:e=>{const t=e.origin.field.values[e.origin.rowIndex];a(t)}}]}};let f;if(t.isDiffFlamegraph()){h.config.custom.width=i-Qc-360;const a=Wc("Baseline","percent"),o=Wc("Comparison","percent"),s=Wc("Diff","percent");s.config.custom.cellOptions.type=r.TableCellDisplayMode.ColorText;const[l,u]=c===Pl.DiffColorBlind?[Ml[0],Ml[2]]:[Nl[0],Nl[2]];s.config.mappings=[{type:e.MappingType.ValueToText,options:{[1/0]:{text:"new",color:u}}},{type:e.MappingType.ValueToText,options:{[-100]:{text:"removed",color:l}}},{type:e.MappingType.RangeToText,options:{from:0,to:1/0,result:{color:u}}},{type:e.MappingType.RangeToText,options:{from:-1/0,to:0,result:{color:l}}}];const d=t.getLevels(),m=d.length?d[0][0].value:0,g=d.length?d[0][0].valueRight:void 0;for(let e in n){p.values.push(null),h.values.push(e);const t=n[e].total,r=n[e].totalRight,i=m-g,l=Math.round(1e4*t/i)/100,c=Math.round(1e4*r/g)/100,u=(c-l)/l*100;s.values.push(u),a.values.push(l),o.values.push(c)}f={fields:[p,h,a,o,s],length:h.values.length}}else{const e=Wc("Self",t.selfField.config.unit),r=Wc("Total",t.valueField.config.unit);for(let t in n)p.values.push(null),h.values.push(t),e.values.push(n[t].self),r.values.push(n[t].total);f={fields:[p,h,e,r],length:h.values.length}}const m=(0,e.applyFieldOverrides)({data:[f],fieldConfig:{defaults:{},overrides:[]},replaceVariables:e=>e,theme:l});return m[0]}(t,d,a,n,o,l,h,u,i,s);return(0,_i.jsx)(r.Table,{initialSortBy:f,onSortByChange:e=>{e&&e.length&&(null==c||c(e[0].displayName+"_"+(e[0].desc?"desc":"asc"))),m(e)},data:g,width:a,height:p})}})})}));function Wc(t,n){const i={width:120,align:"auto",inspect:!1,cellOptions:{type:r.TableCellDisplayMode.Auto}};return{type:e.FieldType.number,name:t,values:[],config:{unit:n,custom:i}}}Gc.displayName="FlameGraphTopTableContainer";const Qc=61;function Kc(e){var t;const n=Xc(),i=null==(t=e.frame.fields.find((e=>"Symbol"===e.name)))?void 0:t.values[e.rowIndex],a=e.search===i,o=e.sandwichItem===i;return(0,_i.jsxs)("div",{className:n.actionCellWrapper,children:[(0,_i.jsx)(r.IconButton,{className:n.actionCellButton,name:"search",variant:a?"primary":"secondary",tooltip:a?"Clear from search":"Search for symbol","aria-label":a?"Clear from search":"Search for symbol",onClick:()=>{e.onSearch(a?"":i)}}),(0,_i.jsx)(r.IconButton,{className:n.actionCellButton,name:"gf-show-context",tooltip:o?"Remove from sandwich view":"Show in sandwich view",variant:o?"primary":"secondary","aria-label":o?"Remove from sandwich view":"Show in sandwich view",onClick:()=>{e.onSandwich(o?void 0:i)}})]})}const Yc=e=>({topTableContainer:(0,t.css)({label:"topTableContainer",padding:e.spacing(1),backgroundColor:e.colors.background.secondary,height:"100%"})}),Xc=()=>({actionCellWrapper:(0,t.css)({label:"actionCellWrapper",display:"flex",height:"24px"}),actionCellButton:(0,t.css)({label:"actionCellButton",marginRight:0,width:"24px"})}),Jc=new vs,Zc=({data:e,onTableSymbolClick:n,onViewSelected:i,onTextAlignSelected:a,onTableSort:o,getTheme:s,stickyHeader:l,extraHeaderElements:c,vertical:u,showFlameGraphOnly:d,disableCollapsing:p,getExtraContextMenuButtons:h})=>{const[f,m]=(0,Ei.useState)(),[g,y]=(0,Ei.useState)(0),[b,v]=(0,Ei.useState)(1),[w,S]=(0,Ei.useState)(""),[E,x]=(0,Ei.useState)(Cl.Both),[_,{width:O}]=ks(),[T,C]=(0,Ei.useState)("left"),[k,P]=(0,Ei.useState)(),[A,R]=(0,Ei.useState)(new Cc),D=(0,Ei.useMemo)((()=>s()),[s]),j=(0,Ei.useMemo)((()=>{if(!e)return;const t=new Pc(e,{collapsing:!p},D);return R(t.getCollapsedMap()),t}),[e,D,p]),[I,N]=function(e){const t=(null==e?void 0:e.isDiffFlamegraph())?Pl.Default:kl.PackageBased,[n,r]=(0,Ei.useState)(t);return(0,Ei.useEffect)((()=>{r(t)}),[t]),[n,r]}(j),L=function(e){return{container:(0,t.css)({label:"container",overflow:"auto",height:"100%",display:"flex",flex:"1 1 0",flexDirection:"column",minHeight:0,gap:e.spacing(1)}),body:(0,t.css)({label:"body",flexGrow:1}),tableContainer:(0,t.css)({height:800}),horizontalContainer:(0,t.css)({label:"horizontalContainer",display:"flex",minHeight:0,flexDirection:"row",columnGap:e.spacing(1),width:"100%"}),horizontalGraphContainer:(0,t.css)({flexBasis:"50%"}),horizontalTableContainer:(0,t.css)({flexBasis:"50%",maxHeight:800}),verticalGraphContainer:(0,t.css)({marginBottom:e.spacing(1)}),verticalTableContainer:(0,t.css)({height:800})}}(D),M=function(e,t){return(0,Ei.useMemo)((()=>{if(e&&t){const n=new Set;let r=Jc.filter(t.getUniqueLabels(),e);if(r)for(let e of r)n.add(t.getUniqueLabels()[e]);return n}}),[e,t])}(w,j);(0,Ei.useEffect)((()=>{O>0&&O<800&&E===Cl.Both&&!u&&x(Cl.FlameGraph)}),[E,x,O,u]);const F=(0,Ei.useCallback)((()=>{m(void 0),y(0),v(1)}),[m,v,y]);function $(){P(void 0)}(0,Ei.useEffect)((()=>{F(),$()}),[e,F]);const B=(0,Ei.useCallback)((e=>{w===e?S(""):(null==n||n(e),S(e),F())}),[S,F,n,w]);if(!j)return null;const V=(0,_i.jsx)(rc,{data:j,rangeMin:g,rangeMax:b,matchedLabels:M,setRangeMin:y,setRangeMax:v,onItemFocused:e=>m(e),focusedItemData:f,textAlign:T,sandwichItem:k,onSandwich:e=>{F(),P(e)},onFocusPillClick:F,onSandwichPillClick:$,colorScheme:I,showFlameGraphOnly:d,collapsing:!p,getExtraContextMenuButtons:h,selectedView:E,search:w,collapsedMap:A,setCollapsedMap:R}),z=(0,_i.jsx)(Gc,{data:j,onSymbolClick:B,search:w,matchedLabels:M,sandwichItem:k,onSandwich:P,onSearch:S,onTableSort:o,colorScheme:I});let U;return d||E===Cl.FlameGraph?U=V:E===Cl.TopTable?U=(0,_i.jsx)("div",{className:L.tableContainer,children:z}):E===Cl.Both&&(U=u?(0,_i.jsxs)("div",{children:[(0,_i.jsx)("div",{className:L.verticalGraphContainer,children:V}),(0,_i.jsx)("div",{className:L.verticalTableContainer,children:z})]}):(0,_i.jsxs)("div",{className:L.horizontalContainer,children:[(0,_i.jsx)("div",{className:L.horizontalTableContainer,children:z}),(0,_i.jsx)("div",{className:L.horizontalGraphContainer,children:V})]})),(0,_i.jsx)(r.ThemeContext.Provider,{value:D,children:(0,_i.jsxs)("div",{ref:_,className:L.container,children:[!d&&(0,_i.jsx)(jc,{search:w,setSearch:S,selectedView:E,setSelectedView:e=>{x(e),null==i||i(e)},containerWidth:O,onReset:()=>{F(),$()},textAlign:T,onTextAlignChange:e=>{C(e),null==a||a(e)},showResetButton:Boolean(f||k),colorScheme:I,onColorSchemeChange:N,stickyHeader:Boolean(l),extraHeaderElements:c,vertical:u,isDiffMode:j.isDiffFlamegraph(),setCollapsedMap:R,collapsedMap:A}),(0,_i.jsx)("div",{className:L.body,children:U})]})})},eu=mi.PROFILES_EXPLORER_VIEW.slice(1);function tu(){const{pathname:e}=new URL(window.location.toString());return e.split("/").pop()||""}function nu(){const e={appRelease:n.config.apps[hi].version,appVersion:gi,page:tu()};return e.page===eu&&(e.view=new URLSearchParams(window.location.search).get("explorationType")||""),e}function ru(e,t){(0,n.reportInteraction)(e,{props:t,meta:nu()})}var iu={},au=Uint8Array,ou=Uint16Array,su=Int32Array,lu=new au([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),cu=new au([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uu=new au([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),du=function(e,t){for(var n=new ou(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new su(n[30]);for(r=1;r<30;++r)for(var a=n[r];a<n[r+1];++a)i[a]=a-n[r]<<5|r;return{b:n,r:i}},pu=du(lu,2),hu=pu.b,fu=pu.r;hu[28]=258,fu[258]=28;for(var mu=du(cu,0),gu=mu.b,yu=mu.r,bu=new ou(32768),vu=0;vu<32768;++vu){var wu=(43690&vu)>>1|(21845&vu)<<1;wu=(61680&(wu=(52428&wu)>>2|(13107&wu)<<2))>>4|(3855&wu)<<4,bu[vu]=((65280&wu)>>8|(255&wu)<<8)>>1}var Su=function(e,t,n){for(var r=e.length,i=0,a=new ou(t);i<r;++i)e[i]&&++a[e[i]-1];var o,s=new ou(t);for(i=1;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;if(n){o=new ou(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],d=s[e[i]-1]++<<u,p=d|(1<<u)-1;d<=p;++d)o[bu[d]>>l]=c}else for(o=new ou(r),i=0;i<r;++i)e[i]&&(o[i]=bu[s[e[i]-1]++]>>15-e[i]);return o},Eu=new au(288);for(vu=0;vu<144;++vu)Eu[vu]=8;for(vu=144;vu<256;++vu)Eu[vu]=9;for(vu=256;vu<280;++vu)Eu[vu]=7;for(vu=280;vu<288;++vu)Eu[vu]=8;var xu=new au(32);for(vu=0;vu<32;++vu)xu[vu]=5;var _u=Su(Eu,9,0),Ou=Su(Eu,9,1),Tu=Su(xu,5,0),Cu=Su(xu,5,1),ku=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Pu=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},Au=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},Ru=function(e){return(e+7)/8|0},Du=function(e,t,n){return(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length),new au(e.subarray(t,n))},ju=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Iu=function(e,t,n){var r=new Error(t||ju[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Iu),!n)throw r;return r},Nu=function(e,t,n,r){var i=e.length,a=r?r.length:0;if(!i||t.f&&!t.l)return n||new au(0);var o=!n,s=o||2!=t.i,l=t.i;o&&(n=new au(3*i));var c=function(e){var t=n.length;if(e>t){var r=new au(Math.max(2*t,e));r.set(n),n=r}},u=t.f||0,d=t.p||0,p=t.b||0,h=t.l,f=t.d,m=t.m,g=t.n,y=8*i;do{if(!h){u=Pu(e,d,1);var b=Pu(e,d+1,3);if(d+=3,!b){var v=e[(A=Ru(d)+4)-4]|e[A-3]<<8,w=A+v;if(w>i){l&&Iu(0);break}s&&c(p+v),n.set(e.subarray(A,w),p),t.b=p+=v,t.p=d=8*w,t.f=u;continue}if(1==b)h=Ou,f=Cu,m=9,g=5;else if(2==b){var S=Pu(e,d,31)+257,E=Pu(e,d+10,15)+4,x=S+Pu(e,d+5,31)+1;d+=14;for(var _=new au(x),O=new au(19),T=0;T<E;++T)O[uu[T]]=Pu(e,d+3*T,7);d+=3*E;var C=ku(O),k=(1<<C)-1,P=Su(O,C,1);for(T=0;T<x;){var A,R=P[Pu(e,d,k)];if(d+=15&R,(A=R>>4)<16)_[T++]=A;else{var D=0,j=0;for(16==A?(j=3+Pu(e,d,3),d+=2,D=_[T-1]):17==A?(j=3+Pu(e,d,7),d+=3):18==A&&(j=11+Pu(e,d,127),d+=7);j--;)_[T++]=D}}var I=_.subarray(0,S),N=_.subarray(S);m=ku(I),g=ku(N),h=Su(I,m,1),f=Su(N,g,1)}else Iu(1);if(d>y){l&&Iu(0);break}}s&&c(p+131072);for(var L=(1<<m)-1,M=(1<<g)-1,F=d;;F=d){var $=(D=h[Au(e,d)&L])>>4;if((d+=15&D)>y){l&&Iu(0);break}if(D||Iu(2),$<256)n[p++]=$;else{if(256==$){F=d,h=null;break}var B=$-254;if($>264){var V=lu[T=$-257];B=Pu(e,d,(1<<V)-1)+hu[T],d+=V}var z=f[Au(e,d)&M],U=z>>4;if(z||Iu(3),d+=15&z,N=gu[U],U>3&&(V=cu[U],N+=Au(e,d)&(1<<V)-1,d+=V),d>y){l&&Iu(0);break}s&&c(p+131072);var q=p+B;if(p<N){var H=a-N,G=Math.min(N,q);for(H+p<0&&Iu(3);p<G;++p)n[p]=r[H+p]}for(;p<q;++p)n[p]=n[p-N]}}t.l=h,t.p=F,t.b=p,t.f=u,h&&(u=1,t.m=m,t.d=f,t.n=g)}while(!u);return p!=n.length&&o?Du(n,0,p):n.subarray(0,p)},Lu=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},Mu=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},Fu=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,a=n.slice();if(!i)return{t:Hu,l:0};if(1==i){var o=new au(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var s=n[0],l=n[1],c=0,u=1,d=2;for(n[0]={s:-1,f:s.f+l.f,l:s,r:l};u!=i-1;)s=n[n[c].f<n[d].f?c++:d++],l=n[c!=u&&n[c].f<n[d].f?c++:d++],n[u++]={s:-1,f:s.f+l.f,l:s,r:l};var p=a[0].s;for(r=1;r<i;++r)a[r].s>p&&(p=a[r].s);var h=new ou(p+1),f=$u(n[u-1],h,0);if(f>t){r=0;var m=0,g=f-t,y=1<<g;for(a.sort((function(e,t){return h[t.s]-h[e.s]||e.f-t.f}));r<i;++r){var b=a[r].s;if(!(h[b]>t))break;m+=y-(1<<f-h[b]),h[b]=t}for(m>>=g;m>0;){var v=a[r].s;h[v]<t?m-=1<<t-h[v]++-1:++r}for(;r>=0&&m;--r){var w=a[r].s;h[w]==t&&(--h[w],++m)}f=t}return{t:new au(h),l:f}},$u=function(e,t,n){return-1==e.s?Math.max($u(e.l,t,n+1),$u(e.r,t,n+1)):t[e.s]=n},Bu=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new ou(++t),r=0,i=e[0],a=1,o=function(e){n[r++]=e},s=1;s<=t;++s)if(e[s]==i&&s!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=e[s]}return{c:n.subarray(0,r),n:t}},Vu=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},zu=function(e,t,n){var r=n.length,i=Ru(t+2);e[i]=255&r,e[i+1]=r>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var a=0;a<r;++a)e[i+a+4]=n[a];return 8*(i+4+r)},Uu=function(e,t,n,r,i,a,o,s,l,c,u){Lu(t,u++,n),++i[256];for(var d=Fu(i,15),p=d.t,h=d.l,f=Fu(a,15),m=f.t,g=f.l,y=Bu(p),b=y.c,v=y.n,w=Bu(m),S=w.c,E=w.n,x=new ou(19),_=0;_<b.length;++_)++x[31&b[_]];for(_=0;_<S.length;++_)++x[31&S[_]];for(var O=Fu(x,7),T=O.t,C=O.l,k=19;k>4&&!T[uu[k-1]];--k);var P,A,R,D,j=c+5<<3,I=Vu(i,Eu)+Vu(a,xu)+o,N=Vu(i,p)+Vu(a,m)+o+14+3*k+Vu(x,T)+2*x[16]+3*x[17]+7*x[18];if(l>=0&&j<=I&&j<=N)return zu(t,u,e.subarray(l,l+c));if(Lu(t,u,1+(N<I)),u+=2,N<I){P=Su(p,h,0),A=p,R=Su(m,g,0),D=m;var L=Su(T,C,0);for(Lu(t,u,v-257),Lu(t,u+5,E-1),Lu(t,u+10,k-4),u+=14,_=0;_<k;++_)Lu(t,u+3*_,T[uu[_]]);u+=3*k;for(var M=[b,S],F=0;F<2;++F){var $=M[F];for(_=0;_<$.length;++_){var B=31&$[_];Lu(t,u,L[B]),u+=T[B],B>15&&(Lu(t,u,$[_]>>5&127),u+=$[_]>>12)}}}else P=_u,A=Eu,R=Tu,D=xu;for(_=0;_<s;++_){var V=r[_];if(V>255){Mu(t,u,P[257+(B=V>>18&31)]),u+=A[B+257],B>7&&(Lu(t,u,V>>23&31),u+=lu[B]);var z=31&V;Mu(t,u,R[z]),u+=D[z],z>3&&(Mu(t,u,V>>5&8191),u+=cu[z])}else Mu(t,u,P[V]),u+=A[V]}return Mu(t,u,P[256]),u+A[256]},qu=new su([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Hu=new au(0),Gu=function(e,t,n,r,i,a){var o=a.z||e.length,s=new au(r+o+5*(1+Math.ceil(o/7e3))+i),l=s.subarray(r,s.length-i),c=a.l,u=7&(a.r||0);if(t){u&&(l[0]=a.r>>3);for(var d=qu[t-1],p=d>>13,h=8191&d,f=(1<<n)-1,m=a.p||new ou(32768),g=a.h||new ou(f+1),y=Math.ceil(n/3),b=2*y,v=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<b)&f},w=new su(25e3),S=new ou(288),E=new ou(32),x=0,_=0,O=a.i||0,T=0,C=a.w||0,k=0;O+2<o;++O){var P=v(O),A=32767&O,R=g[P];if(m[A]=R,g[P]=A,C<=O){var D=o-O;if((x>7e3||T>24576)&&(D>423||!c)){u=Uu(e,l,0,w,S,E,_,T,k,O-k,u),T=x=_=0,k=O;for(var j=0;j<286;++j)S[j]=0;for(j=0;j<30;++j)E[j]=0}var I=2,N=0,L=h,M=A-R&32767;if(D>2&&P==v(O-M))for(var F=Math.min(p,D)-1,$=Math.min(32767,O),B=Math.min(258,D);M<=$&&--L&&A!=R;){if(e[O+I]==e[O+I-M]){for(var V=0;V<B&&e[O+V]==e[O+V-M];++V);if(V>I){if(I=V,N=M,V>F)break;var z=Math.min(M,V-2),U=0;for(j=0;j<z;++j){var q=O-M+j&32767,H=q-m[q]&32767;H>U&&(U=H,R=q)}}}M+=(A=R)-(R=m[A])&32767}if(N){w[T++]=268435456|fu[I]<<18|yu[N];var G=31&fu[I],W=31&yu[N];_+=lu[G]+cu[W],++S[257+G],++E[W],C=O+I,++x}else w[T++]=e[O],++S[e[O]]}}for(O=Math.max(O,C);O<o;++O)w[T++]=e[O],++S[e[O]];u=Uu(e,l,c,w,S,E,_,T,k,O-k,u),c||(a.r=7&u|l[u/8|0]<<3,u-=7,a.h=g,a.p=m,a.i=O,a.w=C)}else{for(O=a.w||0;O<o+c;O+=65535){var Q=O+65535;Q>=o&&(l[u/8|0]=c,Q=o),u=zu(l,u+1,e.subarray(O,Q))}a.i=o}return Du(s,0,r+Ru(u)+i)},Wu=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(1&n&&-306674912)^n>>>1;e[t]=n}return e}(),Qu=function(){var e=-1;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=Wu[255&n^t[r]]^n>>>8;e=n},d:function(){return~e}}},Ku=function(){var e=1,t=0;return{p:function(n){for(var r=e,i=t,a=0|n.length,o=0;o!=a;){for(var s=Math.min(o+2655,a);o<s;++o)i+=r+=n[o];r=(65535&r)+15*(r>>16),i=(65535&i)+15*(i>>16)}e=r,t=i},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},Yu=function(e,t,n,r,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),o=new au(a.length+e.length);o.set(a),o.set(e,a.length),e=o,i.w=a.length}return Gu(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,n,r,i)},Xu=function(e,t,n){for(var r=e(),i=e.toString(),a=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),o=0;o<r.length;++o){var s=r[o],l=a[o];if("function"==typeof s){t+=";"+l+"=";var c=s.toString();if(s.prototype)if(-1!=c.indexOf("[native code]")){var u=c.indexOf(" ",8)+1;t+=c.slice(u,c.indexOf("(",u))}else for(var d in t+=c,s.prototype)t+=";"+l+".prototype."+d+"="+s.prototype[d].toString();else t+=c}else n[l]=s}return t},Ju=[],Zu=function(){return[au,ou,su,lu,cu,uu,hu,gu,Ou,Cu,bu,ju,Su,ku,Pu,Au,Ru,Du,Iu,Nu,Ed,ad,od]},ed=function(){return[au,ou,su,lu,cu,uu,fu,yu,_u,Eu,Tu,xu,bu,qu,Hu,Su,Lu,Mu,Fu,$u,Bu,Vu,zu,Uu,Ru,Du,Gu,Yu,vd,ad]},td=function(){return[ud,hd,cd,Qu,Wu]},nd=function(){return[dd,pd]},rd=function(){return[fd,cd,Ku]},id=function(){return[md]},ad=function(e){return postMessage(e,[e.buffer])},od=function(e){return e&&{out:e.size&&new au(e.size),dictionary:e.dictionary}},sd=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){t.data.length?(e.push(t.data[0],t.data[1]),postMessage([t.data[0].length])):e.flush()}},ld=function(e,t,n,r,i,a,o){var s,l=function(e,t,n,r){if(!Ju[n]){for(var i="",a={},o=e.length-1,s=0;s<o;++s)i=Xu(e[s],i,a);Ju[n]={c:Xu(e[o],i,a),e:a}}var l=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}({},Ju[n].e);return function(e,t,n,r,i){var a=new Worker(iu[t]||(iu[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return a.onmessage=function(e){var t=e.data,n=t.$e$;if(n){var r=new Error(n[0]);r.code=n[1],r.stack=n[2],i(r,null)}else i(null,t)},a.postMessage(n,r),a}(Ju[n].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,l,function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t}(l),r)}(e,r,i,(function(e,n){e?(l.terminate(),t.ondata.call(t,e)):Array.isArray(n)?1==n.length?(t.queuedSize-=n[0],t.ondrain&&t.ondrain(n[0])):(n[1]&&l.terminate(),t.ondata.call(t,e,n[0],n[1])):o(n)}));l.postMessage(n),t.queuedSize=0,t.push=function(e,n){t.ondata||Iu(5),s&&t.ondata(Iu(4,0,1),null,!!n),t.queuedSize+=e.length,l.postMessage([e,s=n],[e.buffer])},t.terminate=function(){l.terminate()},a&&(t.flush=function(){l.postMessage([])})},cd=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},ud=function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&cd(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}},dd=function(e){31==e[0]&&139==e[1]&&8==e[2]||Iu(6,"invalid gzip data");var t=e[3],n=10;4&t&&(n+=2+(e[10]|e[11]<<8));for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(2&t)},pd=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},hd=function(e){return 10+(e.filename?e.filename.length+1:0)},fd=function(e,t){var n=t.level,r=0==n?0:n<6?1:9==n?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=Ku();i.p(t.dictionary),cd(e,2,i.d())}},md=function(e,t){return(8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Iu(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Iu(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),2+(e[1]>>3&4)};function gd(e,t){return"function"==typeof e&&(t=e,e={}),this.ondata=t,e}var yd=function(){function e(e,t){if("function"==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new au(98304),this.o.dictionary){var n=this.o.dictionary.subarray(-32768);this.b.set(n,32768-n.length),this.s.i=32768-n.length}}return e.prototype.p=function(e,t){this.ondata(Yu(e,this.o,0,0,this.s),t)},e.prototype.push=function(e,t){this.ondata||Iu(5),this.s.l&&Iu(4);var n=e.length+this.s.z;if(n>this.b.length){if(n>2*this.b.length-32768){var r=new au(-32768&n);r.set(this.b.subarray(0,this.s.z)),this.b=r}var i=this.b.length-this.s.z;this.b.set(e.subarray(0,i),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(i),32768),this.s.z=e.length-i+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=1&t,(this.s.z>this.s.w+8191||t)&&(this.p(this.b,t||!1),this.s.w=this.s.i,this.s.i-=2)},e.prototype.flush=function(){this.ondata||Iu(5),this.s.l&&Iu(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},e}(),bd=function(){return function(e,t){ld([ed,function(){return[sd,yd]}],this,gd.call(this,e,t),(function(e){var t=new yd(e.data);onmessage=sd(t)}),6,1)}}();function vd(e,t){return Yu(e,t||{},0,0)}var wd=function(){function e(e,t){"function"==typeof e&&(t=e,e={}),this.ondata=t;var n=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:n?n.length:0},this.o=new au(32768),this.p=new au(0),n&&this.o.set(n)}return e.prototype.e=function(e){if(this.ondata||Iu(5),this.d&&Iu(4),this.p.length){if(e.length){var t=new au(this.p.length+e.length);t.set(this.p),t.set(e,this.p.length),this.p=t}}else this.p=e},e.prototype.c=function(e){this.s.i=+(this.d=e||!1);var t=this.s.b,n=Nu(this.p,this.s,this.o);this.ondata(Du(n,t,this.s.b),this.d),this.o=Du(n,this.s.b-32768),this.s.b=this.o.length,this.p=Du(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),Sd=function(){return function(e,t){ld([Zu,function(){return[sd,wd]}],this,gd.call(this,e,t),(function(e){var t=new wd(e.data);onmessage=sd(t)}),7,0)}}();function Ed(e,t){return Nu(e,{i:2},t&&t.out,t&&t.dictionary)}var xd=function(){function e(e,t){this.c=Qu(),this.l=0,this.v=1,yd.call(this,e,t)}return e.prototype.push=function(e,t){this.c.p(e),this.l+=e.length,yd.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){var n=Yu(e,this.o,this.v&&hd(this.o),t&&8,this.s);this.v&&(ud(n,this.o),this.v=0),t&&(cd(n,n.length-8,this.c.d()),cd(n,n.length-4,this.l)),this.ondata(n,t)},e.prototype.flush=function(){yd.prototype.flush.call(this)},e}(),_d=function(){return function(e,t){ld([ed,td,function(){return[sd,yd,xd]}],this,gd.call(this,e,t),(function(e){var t=new xd(e.data);onmessage=sd(t)}),8,1)}}(),Od=function(){function e(e,t){this.v=1,this.r=0,wd.call(this,e,t)}return e.prototype.push=function(e,t){if(wd.prototype.e.call(this,e),this.r+=e.length,this.v){var n=this.p.subarray(this.v-1),r=n.length>3?dd(n):4;if(r>n.length){if(!t)return}else this.v>1&&this.onmember&&this.onmember(this.r-n.length);this.p=n.subarray(r),this.v=0}wd.prototype.c.call(this,t),!this.s.f||this.s.l||t||(this.v=Ru(this.s.p)+9,this.s={i:0},this.o=new au(0),this.push(new au(0),t))},e}(),Td=function(){return function(e,t){var n=this;ld([Zu,nd,function(){return[sd,wd,Od]}],this,gd.call(this,e,t),(function(e){var t=new Od(e.data);t.onmember=function(e){return postMessage(e)},onmessage=sd(t)}),9,0,(function(e){return n.onmember&&n.onmember(e)}))}}(),Cd=function(){function e(e,t){this.c=Ku(),this.v=1,yd.call(this,e,t)}return e.prototype.push=function(e,t){this.c.p(e),yd.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){var n=Yu(e,this.o,this.v&&(this.o.dictionary?6:2),t&&4,this.s);this.v&&(fd(n,this.o),this.v=0),t&&cd(n,n.length-4,this.c.d()),this.ondata(n,t)},e.prototype.flush=function(){yd.prototype.flush.call(this)},e}(),kd=function(){return function(e,t){ld([ed,rd,function(){return[sd,yd,Cd]}],this,gd.call(this,e,t),(function(e){var t=new Cd(e.data);onmessage=sd(t)}),10,1)}}(),Pd=function(){function e(e,t){wd.call(this,e,t),this.v=e&&e.dictionary?2:1}return e.prototype.push=function(e,t){if(wd.prototype.e.call(this,e),this.v){if(this.p.length<6&&!t)return;this.p=this.p.subarray(md(this.p,this.v-1)),this.v=0}t&&(this.p.length<4&&Iu(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),wd.prototype.c.call(this,t)},e}(),Ad=function(){return function(e,t){ld([Zu,id,function(){return[sd,wd,Pd]}],this,gd.call(this,e,t),(function(e){var t=new Pd(e.data);onmessage=sd(t)}),11,0)}}(),Rd="undefined"!=typeof TextDecoder&&new TextDecoder;try{Rd.decode(Hu,{stream:!0})}catch(Vt){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;const Dd=e=>class{constructor(){this.i=new e,this.i.ondata=(e,t)=>{this.ondata(null,e,t)}}push(e,t){try{this.queuedSize+=e.length,this.i.push(e,t),this.queuedSize-=e.length,this.ondrain&&this.ondrain(e.length)}catch(e){this.ondata(e,null,t||!1)}}};let jd=1;try{(new bd).terminate()}catch(Iu){jd=0}const Id=jd?{gzip:_d,deflate:kd,"deflate-raw":bd}:{gzip:Dd(xd),deflate:Dd(Cd),"deflate-raw":Dd(yd)},Nd=jd?{gzip:Td,deflate:Ad,"deflate-raw":Sd}:{gzip:Dd(Od),deflate:Dd(Pd),"deflate-raw":Dd(wd)},Ld=(e,t,n)=>class extends e{constructor(e){if(!arguments.length)throw new TypeError(`Failed to construct '${n}': 1 argument required, but only 0 present.`);const r=t[e];if(!r)throw new TypeError(`Failed to construct '${n}': Unsupported compression format: '${e}'`);let i,a=new r;super({start:e=>{a.ondata=(t,n,r)=>{t?e.error(t):n&&(e.enqueue(n),r&&(i?i():e.terminate()))}},transform:e=>{if(e instanceof ArrayBuffer)e=new Uint8Array(e);else{if(!ArrayBuffer.isView(e))throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}if(a.push(e),a.queuedSize>=32768)return new Promise((e=>{a.ondrain=()=>{a.queuedSize<32768&&e()}}))},flush:()=>new Promise((e=>{i=e,a.push(new Uint8Array(0),!0)}))},{size:e=>0|e.byteLength,highWaterMark:65536},{size:e=>0|e.byteLength,highWaterMark:65536})}},Md="undefined"==typeof globalThis?"undefined"==typeof self?"undefined"==typeof global?{}:global:self:globalThis;var Fd;void 0===Md.CompressionStream&&(Md.CompressionStream=(Fd=TransformStream,Ld(Fd,Id,"CompressionStream"))),void 0===Md.DecompressionStream&&(Md.DecompressionStream=function(e){return Ld(e,Nd,"DecompressionStream")}(TransformStream));var $d=__webpack_require__(2249),Bd=__webpack_require__.n($d);function Vd(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}const zd=new class extends qi{upload(e,t){var n,r=this;return(n=function*(){const n=yield r.fetch("/upload/v1",{method:"POST",body:JSON.stringify({name:e,profile:btoa(JSON.stringify(t)),fileTypeData:{units:t.metadata.units,spyName:t.metadata.spyName},type:"json"})});return yield n.json()},function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){Vd(a,r,i,o,s,"next",e)}function s(e){Vd(a,r,i,o,s,"throw",e)}o(void 0)}))})()}constructor(){super("https://flamegraph.com/api",{"content-type":"application/json"})}};var Ud;!function(e){e.BASELINE="baseline",e.COMPARISON="comparison"}(Ud||(Ud={}));const qd=new Intl.DateTimeFormat("fr-CA",{year:"numeric",month:"2-digit",day:"2-digit",hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});function Hd(e){const t=qd.formatToParts(e).reduce(((e,{type:t,value:n})=>(e[t]=n,e)),{});return`${t.year}-${t.month}-${t.day}_${t.hour}${t.minute}`}function Gd(e){const t=new Date(Math.round(1e3*e.from.unix())),n=new Date(Math.round(1e3*e.to.unix()));return`${Hd(t)}-to-${Hd(n)}`}function Wd(t){const[n,r]=t===Ud.BASELINE?["diffFrom","diffTo"]:["diffFrom-2","diffTo-2"],i=new URLSearchParams(window.location.search),a=i.get(n),o=i.get(r);return{raw:{from:a,to:o},from:(0,e.dateTimeParse)(a),to:(0,e.dateTimeParse)(o)}}function Qd(e){const t=["baseline",Gd(Wd(Ud.BASELINE)),"comparison",Gd(Wd(Ud.COMPARISON))];return e?[e,...t].join("_"):["flamegraph",...t].join("_")}function Kd(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function Yd(e){const{actions:t}=function({profile:e,enableFlameGraphDotComExport:t}){const n=function(){var t,n=(t=function*(){ru("g_pyroscope_app_export_profile",{format:"flamegraph.com"});const t=Qd(e.metadata.appName);let n;try{n=yield zd.upload(t,e)}catch(e){return void Ko(e,["Failed to export to flamegraph.com!",e.message])}const r=document.createElement("a");r.target="_blank",r.href=n.url,document.body.appendChild(r),r.click(),document.body.removeChild(r)},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){Kd(a,r,i,o,s,"next",e)}function s(e){Kd(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();return{data:{shouldDisplayFlamegraphDotCom:Boolean(t)},actions:{downloadPng:()=>{ru("g_pyroscope_app_export_profile",{format:"png"});const t=`${Qd(e.metadata.appName)}.png`;document.querySelector('canvas[data-testid="flameGraph"]').toBlob((e=>{if(e)Bd()(e,t);else{const e=new Error("No Blob, the image cannot be created.");Ko(e,["Failed to export to png!",e.message])}}),"image/png")},downloadJson:()=>{ru("g_pyroscope_app_export_profile",{format:"json"});const t=`${Qd(e.metadata.appName)}.json`,n=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(e))}`;try{Bd()(n,t)}catch(e){return void Ko(e,["Failed to export to JSON!",e.message])}},uploadToFlamegraphDotCom:n}}}(e);return xi().createElement(r.Menu,null,xi().createElement(r.Menu.Item,{label:"png",onClick:t.downloadPng}),xi().createElement(r.Menu.Item,{label:"json",onClick:t.downloadJson}))}function Xd(e){const{profile:t,enableFlameGraphDotComExport:n}=e;return xi().createElement(r.Dropdown,{overlay:xi().createElement(Yd,{profile:t,enableFlameGraphDotComExport:n})},xi().createElement(r.Button,{icon:"download-alt",size:"sm",variant:"secondary",fill:"outline","aria-label":"Export profile data",tooltip:"Export profile data"}))}const Jd=(0,Ei.memo)(Xd);function Zd(e,t,n){const r=[],i=n?7:4;for(let a=0;a<e.length;a+=i)r.push({level:0,label:n?t[e[a+6]]:t[e[a+3]],offset:e[a],val:e[a+1],self:e[a+2],selfRight:n?e[a+5]:0,valRight:n?e[a+4]:0,valTotal:n?e[a+1]+e[a+4]:e[a+1],offsetRight:n?e[a+3]:0,offsetTotal:n?e[a]+e[a+3]:e[a],children:[]});return r}function ep({profile:t,diff:n,vertical:i,enableFlameGraphDotComExport:a,collapsedFlamegraphs:o,getExtraContextMenuButtons:s}){const{isLight:l}=(0,r.useTheme2)(),c=(0,Ei.useMemo)((()=>function(t,n,r,i){if(!t.length)return;const a=[];for(let e=0;e<t.length;e++){a[e]=[];for(const r of Zd(t[e],n,i))if(r.level=e,a[e].push(r),e>0){const t=a[e].slice(0,-1).reduce(((e,t)=>t.offsetTotal+t.valTotal+e),0)+r.offsetTotal,n=a[e-1];let i=0;for(const e of n){const n=i+e.offsetTotal,a=n+e.valTotal;if(n<=t&&a>t){e.children.push(r);break}i+=e.offsetTotal+e.valTotal}}}const o=[a[0][0]],s=[],l=[],c=[],u=[],d=[],p=[];for(;o.length;){const e=o.shift();s.push(e.label),l.push(e.level),c.push(e.self),u.push(e.val),d.push(e.selfRight),p.push(e.valRight),o.unshift(...e.children)}let h="short";switch(r){case"samples":case"trace_samples":case"lock_nanoseconds":case"nanoseconds":h="ns";break;case"bytes":h="bytes"}const f=[{name:"level",values:l},{name:"label",values:s,type:e.FieldType.string},{name:"self",values:c,config:{unit:h}},{name:"value",values:u,config:{unit:h}}];i&&f.push({name:"selfRight",values:d,config:{unit:h}},{name:"valueRight",values:p,config:{unit:h}});const m={name:"response",meta:{preferredVisualisationType:"flamegraph"},fields:f};return(0,e.createDataFrame)(m)}(t.flamebearer.levels,t.flamebearer.names,t.metadata.units,Boolean(n))),[t,n]);return xi().createElement(Zc,{data:c,disableCollapsing:!o,extraHeaderElements:xi().createElement(Jd,{profile:t,enableFlameGraphDotComExport:a}),vertical:i,getTheme:()=>(0,e.createTheme)({colors:{mode:l?"light":"dark"}}),getExtraContextMenuButtons:s})}const tp=(0,Ei.memo)(ep),np=e=>({flamegraph:t.css`
    margin-top: ${e.spacing(2)};
  `});function rp({profile:e,diff:t}){const n=(0,r.useStyles2)(np);return xi().createElement("div",{className:n.flamegraph,"data-testid":"flamegraph"},xi().createElement(tp,{profile:e,diff:t}))}const ip=e=>({selectorContainer:t.css`
    display: flex;
    justify-content: center;
    margin-bottom: ${e.spacing(2)};
  `});function ap({profileTypes:e,onChange:t}){const n=(0,r.useStyles2)(ip),i=(0,Ei.useMemo)((()=>e.map((e=>({value:e,label:e})))),[e]),[a,o]=(0,Ei.useState)(),s=(0,Ei.useCallback)((e=>{o(e),t(e)}),[t]);return(0,Ei.useEffect)((()=>{o(i[0])}),[i]),xi().createElement("div",{className:n.selectorContainer},xi().createElement(r.InlineFieldRow,null,xi().createElement(r.InlineField,{label:"Profile",disabled:!i.length,"data-testid":"profile-types-dropdown"},xi().createElement(r.Select,{key:null==a?void 0:a.value,value:a,options:i,onChange:s,width:16}))))}const op=e=>({spinner:t.css`
    text-align: center;
    margin-top: ${e.spacing(2)};
  `});function sp(){const e=(0,r.useStyles2)(op);return xi().createElement("div",{className:e.spinner},xi().createElement(r.Spinner,{size:36}))}function lp(){const{processFile:e,profileTypes:t,selectProfileType:n,profile:r,removeFile:i,isLoading:a}=function(){const[e,t]=(0,Ei.useState)(!1),[n,r]=(0,Ei.useState)(os);(0,Ei.useEffect)((()=>()=>{es.abort()}),[]);const i=(0,Ei.useCallback)((()=>{es.abort(),t(!1),r(os)}),[]),a=(0,Ei.useCallback)(function(){var e=ns((function*(e){i();try{t(!0);const n=yield es.uploadSingle(e);r(n)}catch(e){r(os),es.isAbortError(e)||Ko(e,["Error while uploading profile!",e.message])}t(!1)}));return function(t){return e.apply(this,arguments)}}(),[i]),o=(0,Ei.useCallback)(function(){var e=ns((function*(e){const i=e.value;if(i&&n.id&&n.profileTypes.includes(i)){es.abort(),t(!1),r((e=>as(is({},e),{profile:null}))),t(!0);try{const e=yield es.get(n.id,i);r((t=>as(is({},t),{profile:e.profile})))}catch(e){es.isAbortError(e)||Ko(e,["Error while fetching profile!",e.message])}t(!1)}}));return function(t){return e.apply(this,arguments)}}(),[n.id,n.profileTypes]);return{processFile:a,profileTypes:n.profileTypes,selectProfileType:o,profile:n.profile,removeFile:i,isLoading:e}}();return xi().createElement("div",null,xi().createElement(ap,{profileTypes:t,onChange:n}),xi().createElement(us,{onFileDropped:e,onFileRemove:i}),a&&!r?xi().createElement(sp,null):null,r&&xi().createElement(rp,{profile:r}))}const cp=(0,Ei.memo)(lp);function up(){return xi().createElement(Wo,{left:xi().createElement(cp,null),right:xi().createElement(cp,null)})}const dp=e=>({tabContent:t.css`
    padding: ${e.spacing(2)};
    margin: ${e.spacing(2)};
  `});function pp(){const e=(0,r.useStyles2)(dp),[t,n]=(0,Ei.useState)(0);return xi().createElement("div",null,xi().createElement(r.TabsBar,null,xi().createElement(r.Tab,{label:" Single view",active:0===t,onChangeTab:()=>n(0)}),xi().createElement(r.Tab,{label:" Comparison view",active:1===t,onChangeTab:()=>n(1)})),xi().createElement(r.TabContent,{className:e.tabContent},0===t&&xi().createElement(cp,null),1===t&&xi().createElement(up,null)))}function hp(){return xi().createElement(xi().Fragment,null,xi().createElement(ko,{title:"Ad hoc view"}),xi().createElement(pp,null))}var fp=Object.defineProperty,mp=Object.getOwnPropertySymbols,gp=Object.prototype.hasOwnProperty,yp=Object.prototype.propertyIsEnumerable,bp=(e,t,n)=>t in e?fp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vp=(e,t)=>{for(var n in t||(t={}))gp.call(t,n)&&bp(e,n,t[n]);if(mp)for(var n of mp(t))yp.call(t,n)&&bp(e,n,t[n]);return e};function wp(t,r){const i=vp({},n.locationService.getSearchObject());if(r)for(const e of Object.keys(i))r.includes(e)||delete i[e];return e.urlUtil.renderUrl(e.locationUtil.assureBaseUrl(t),i)}function Sp(e,t){return xi().createElement(e.Component,{model:e,routeProps:t})}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;const Ep=new Map;var xp=__webpack_require__(1269);const _p={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Op;const Tp=new Uint8Array(16);function Cp(){if(!Op&&(Op="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Op))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Op(Tp)}const kp=[];for(let e=0;e<256;++e)kp.push((e+256).toString(16).slice(1));const Pp=function(e,t,n){if(_p.randomUUID&&!t&&!e)return _p.randomUUID();const r=(e=e||{}).random||(e.rng||Cp)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return kp[e[t+0]]+kp[e[t+1]]+kp[e[t+2]]+kp[e[t+3]]+"-"+kp[e[t+4]]+kp[e[t+5]]+"-"+kp[e[t+6]]+kp[e[t+7]]+"-"+kp[e[t+8]]+kp[e[t+9]]+"-"+kp[e[t+10]]+kp[e[t+11]]+kp[e[t+12]]+kp[e[t+13]]+kp[e[t+14]]+kp[e[t+15]]}(r)};var Ap=Object.defineProperty,Rp=Object.defineProperties,Dp=Object.getOwnPropertyDescriptors,jp=Object.getOwnPropertySymbols,Ip=Object.prototype.hasOwnProperty,Np=Object.prototype.propertyIsEnumerable,Lp=(e,t,n)=>t in e?Ap(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const Mp=xi().memo((function(e){var t,n=e,{model:r}=n,i=((e,t)=>{var n={};for(var r in e)Ip.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&jp)for(var r of jp(e))t.indexOf(r)<0&&Np.call(e,r)&&(n[r]=e[r]);return n})(n,["model"]);const a=null!=(t=r.constructor.Component)?t:Fp,[o,s]=(0,Ei.useState)(0);return(0,Ei.useEffect)((()=>{const e=r.activate();return s((e=>e+1)),e}),[r]),r.isActive?xi().createElement(a,((e,t)=>Rp(e,Dp(t)))(((e,t)=>{for(var n in t||(t={}))Ip.call(t,n)&&Lp(e,n,t[n]);if(jp)for(var n of jp(t))Np.call(t,n)&&Lp(e,n,t[n]);return e})({},i),{model:r})):null}));function Fp(e){return null}class $p extends e.BusEventWithPayload{}$p.type="scene-object-state-change";class Bp extends e.BusEventWithPayload{}Bp.type="scene-object-user-action";var Vp,zp=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)};class Up{constructor(e){var t,n;((e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,void 0)})(this,Vp),n=e,zp(this,t=Vp,"write to private field"),t.set(this,n)}resolve(){return zp(this,e=Vp,"read from private field"),e.get(this);var e}}Vp=new WeakMap;var qp=Object.defineProperty,Hp=Object.getOwnPropertySymbols,Gp=Object.prototype.hasOwnProperty,Wp=Object.prototype.propertyIsEnumerable,Qp=(e,t,n)=>t in e?qp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Kp=(e,t)=>{for(var n in t||(t={}))Gp.call(t,n)&&Qp(e,n,t[n]);if(Hp)for(var n of Hp(t))Wp.call(t,n)&&Qp(e,n,t[n]);return e};class Yp{constructor(t){this._isActive=!1,this._activationHandlers=[],this._deactivationHandlers=new Map,this._subs=new xp.Subscription,this._refCount=0,t.key||(t.key=Pp()),this._events=new e.EventBusSrv,this._state=Object.freeze(t),this._setParent(this._state)}get state(){return this._state}get isActive(){return this._isActive}get parent(){return this._parent}get variableDependency(){return this._variableDependency}get urlSync(){return this._urlSync}get Component(){return Mp}_setParent(e){Jp(e,(e=>{e._parent&&e._parent!==this&&console.warn("SceneObject already has a parent set that is different from the new parent. You cannot share the same SceneObject instance in multiple scenes or in multiple different places of the same scene graph. Use SceneObject.clone() to duplicate a SceneObject or store a state key reference and use sceneGraph.findObject to locate it.",e,this),e._parent=this}))}subscribeToState(e){return this._events.subscribe($p,(t=>{t.payload.changedObject===this&&e(t.payload.newState,t.payload.prevState)}))}subscribeToEvent(e,t){return this._events.subscribe(e,t)}setState(e){const t=this._state,n=Kp(Kp({},this._state),e);this._state=Object.freeze(n),this._setParent(e),this._handleActivationOfChangedStateProps(t,n),this.publishEvent(new $p({prevState:t,newState:n,partialUpdate:e,changedObject:this}),!0)}_handleActivationOfChangedStateProps(e,t){this.isActive&&(e.$behaviors!==t.$behaviors&&this._handleChangedBehaviors(e.$behaviors,t.$behaviors),e.$data!==t.$data&&this._handleChangedStateActivation(e.$data,t.$data),e.$variables!==t.$variables&&this._handleChangedStateActivation(e.$variables,t.$variables),e.$timeRange!==t.$timeRange&&this._handleChangedStateActivation(e.$timeRange,t.$timeRange))}_handleChangedStateActivation(e,t){if(e){const t=this._deactivationHandlers.get(e);t&&(t(),this._deactivationHandlers.delete(e))}t&&this._deactivationHandlers.set(t,t.activate())}_handleChangedBehaviors(e,t){if(e)for(const n of e)if(!t||!t.includes(n)){const e=this._deactivationHandlers.get(n);e&&(e(),this._deactivationHandlers.delete(n))}if(t)for(const n of t)e&&e.includes(n)||this._activateBehavior(n)}publishEvent(e,t){this._events.publish(e),t&&this.parent&&this.parent.publishEvent(e,t)}getRoot(){return this._parent?this._parent.getRoot():this}_internalActivate(){this._isActive=!0;const{$data:e,$variables:t,$timeRange:n,$behaviors:r}=this.state;if(this._activationHandlers.forEach((e=>{const t=e();t&&this._deactivationHandlers.set(t,t)})),n&&!n.isActive&&this._deactivationHandlers.set(n,n.activate()),t&&!t.isActive&&this._deactivationHandlers.set(t,t.activate()),e&&!e.isActive&&this._deactivationHandlers.set(e,e.activate()),r)for(const e of r)this._activateBehavior(e)}_activateBehavior(e){if(e instanceof Yp)this._deactivationHandlers.set(e,e.activate());else if("function"==typeof e){const t=e(this);t&&this._deactivationHandlers.set(e,t)}}activate(){this.isActive||this._internalActivate(),this._refCount++;let e=!1;return()=>{if(this._refCount--,e)throw new Error("SceneObject cancelation handler returned by activate() called a second time");e=!0,0===this._refCount&&this._internalDeactivate()}}_internalDeactivate(){this._isActive=!1;for(let e of this._deactivationHandlers.values())e();this._deactivationHandlers.clear(),this._events.removeAllListeners(),this._subs.unsubscribe(),this._subs=new xp.Subscription}useState(){return Xp(this)}forceRender(){this.setState({})}clone(e){return function(e,t){const n=ah(e.state,t);return new e.constructor(n)}(this,e)}addActivationHandler(e){this._activationHandlers.push(e)}forEachChild(e){Jp(this.state,e)}getRef(){return this._ref||(this._ref=new Up(this)),this._ref}}function Xp(e,t){var n;const[r,i]=(0,Ei.useState)(e.state),a=e.state,o=null!=(n=null==t?void 0:t.shouldActivateOrKeepAlive)&&n;return(0,Ei.useEffect)((()=>{let t;o&&(t=e.activate());const n=e.subscribeToState((e=>{i(e)}));return e.state!==a&&i(e.state),()=>{n.unsubscribe(),t&&t()}}),[e,o]),e.state}function Jp(e,t){for(const n of Object.values(e))if(n instanceof Yp&&t(n),Array.isArray(n))for(const e of n)e instanceof Yp&&t(e)}var Zp=Object.defineProperty,eh=Object.getOwnPropertySymbols,th=Object.prototype.hasOwnProperty,nh=Object.prototype.propertyIsEnumerable,rh=(e,t,n)=>t in e?Zp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ih=(e,t)=>{for(var n in t||(t={}))th.call(t,n)&&rh(e,n,t[n]);if(eh)for(var n of eh(t))nh.call(t,n)&&rh(e,n,t[n]);return e};function ah(e,t){const n=ih({},e);for(const e in n){const t=n[e];if(t instanceof Yp&&(n[e]=t.clone()),t instanceof Up)throw new Error("Cannot clone a SceneObject with a SceneObjectRef in state");if(Array.isArray(t)){const r=[];for(const e of t)e instanceof Yp?r.push(e.clone()):r.push(e);n[e]=r}}return Object.assign(n,t),n}function oh(e,t){let n,r=e;for(;r&&!n;)n=t(r),r=r.parent;return n}class sh extends e.DataSourceApi{constructor(t,n){super({name:"RuntimeDataSource-"+t,uid:n,type:t,id:1,readOnly:!0,jsonData:{},access:"direct",meta:{id:t,name:"RuntimeDataSource-"+t,type:e.PluginType.datasource,info:{author:{name:""},description:"",links:[],logos:{large:"",small:""},screenshots:[],updated:"",version:""},module:"",baseUrl:""}})}testDatasource(){return Promise.resolve({})}}const lh=new Map;class ch{constructor(){this.index=new Map}getUniqueKey(e,t){const n=this.index.get(e);if(!n)throw new Error("Cannot find any scene object that uses the key '"+e+"'");const r=n.findIndex((e=>e.sceneObject===t));return r>0?`${e}-${r+1}`:e}rebuildIndex(e){this.index.clear(),this.buildIndex(e,0)}buildIndex(e,t){if(e.urlSync)for(const n of e.urlSync.getKeys()){const r=this.index.get(n);r?(r.push({sceneObject:e,depth:t}),r.sort(((e,t)=>e.depth-t.depth))):this.index.set(n,[{sceneObject:e,depth:t}])}e.forEachChild((e=>this.buildIndex(e,t+1)))}}function uh(e){const t=new ch;t.rebuildIndex(e);const n={},r=e=>{if(e.urlSync){const r=e.urlSync.getUrlState();for(const[i,a]of Object.entries(r))if(null!=a){const r=t.getUniqueKey(i,e);n[r]=a}}e.forEachChild(r)};return r(e),n}function dh(e,t,n){if(e.urlSync){const r={},i=e.urlSync.getUrlState();for(const a of e.urlSync.getKeys()){const o=n.getUniqueKey(a,e),s=t.getAll(o),l=i[a];ph(s,l)||(s.length>0?Array.isArray(l)?r[a]=s:r[a]=s[0]:r[a]=null)}Object.keys(r).length>0&&e.urlSync.updateFromUrl(r)}e.forEachChild((e=>dh(e,t,n)))}function ph(e,t){return 0===e.length&&null==t||(Array.isArray(t)||1!==(null==e?void 0:e.length)?0===(null==t?void 0:t.length)&&null===e||(0,ac.isEqual)(e,t):t===e[0])}var hh=(e=>(e.Linear="linear",e.Log="log",e.Ordinal="ordinal",e.Symlog="symlog",e))(hh||{}),fh=(e=>(e.Hue="hue",e.None="none",e.Opacity="opacity",e.Scheme="scheme",e))(fh||{}),mh=(e=>(e.Ascending="asc",e.Descending="desc",e.None="none",e))(mh||{}),gh=(e=>(e.Basic="basic",e.Gradient="gradient",e.Lcd="lcd",e))(gh||{}),yh=(e=>(e.Color="color",e.Hidden="hidden",e.Text="text",e))(yh||{}),bh=(e=>(e.Auto="auto",e.Left="left",e.Top="top",e))(bh||{}),vh=(e=>(e.Auto="auto",e.Manual="manual",e))(vh||{}),wh=(e=>(e.Auto="auto",e.BasicGauge="basic",e.ColorBackground="color-background",e.ColorBackgroundSolid="color-background-solid",e.ColorText="color-text",e.Custom="custom",e.DataLinks="data-links",e.Gauge="gauge",e.GradientGauge="gradient-gauge",e.Image="image",e.JSONView="json-view",e.LcdGauge="lcd-gauge",e.Sparkline="sparkline",e))(wh||{}),Sh=(e=>(e.CSV="csv",e.Date="date",e.Distributed="distributed",e.DoubleQuote="doublequote",e.Glob="glob",e.HTML="html",e.JSON="json",e.Lucene="lucene",e.PercentEncode="percentencode",e.Pipe="pipe",e.QueryParam="queryparam",e.Raw="raw",e.Regex="regex",e.SQLString="sqlstring",e.SingleQuote="singlequote",e.Text="text",e.UriEncode="uriencode",e))(Sh||{});wh.Auto;var Eh=(e=>(e.NotStarted="NotStarted",e.Loading="Loading",e.Streaming="Streaming",e.Done="Done",e.Error="Error",e))(Eh||{}),xh=Object.defineProperty,_h=Object.getOwnPropertySymbols,Oh=Object.prototype.hasOwnProperty,Th=Object.prototype.propertyIsEnumerable,Ch=(e,t,n)=>t in e?xh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const kh={state:Eh.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()};class Ph{constructor(e,t){this._sceneObject=e,this._keys=t.keys}getKeys(){return"function"==typeof this._keys?this._keys():this._keys}getUrlState(){return this._sceneObject.getUrlState()}updateFromUrl(e){this._sceneObject.updateFromUrl(e)}}const Ah=/^\d+[yYmMsSwWhHdD]$/;function Rh(t){if("string"!=typeof t)return null;if(-1!==t.indexOf("now"))return t;if(Ah.test(t))return t;if(8===t.length){const n=(0,e.toUtc)(t,"YYYYMMDD");if(n.isValid())return n.toISOString()}else if(15===t.length){const n=(0,e.toUtc)(t,"YYYYMMDDTHHmmss");if(n.isValid())return n.toISOString()}else if(24===t.length)return(0,e.toUtc)(t).toISOString();const n=parseInt(t,10);return isNaN(n)?null:(0,e.toUtc)(n).toISOString()}function Dh(t,n,r,i,a){const o=a&&"now"===n;return{from:e.dateMath.parse(t,!1,r,i),to:e.dateMath.parse(o?"now-"+a:n,!0,r,i),raw:{from:t,to:n}}}var jh=Object.defineProperty,Ih=Object.getOwnPropertySymbols,Nh=Object.prototype.hasOwnProperty,Lh=Object.prototype.propertyIsEnumerable,Mh=(e,t,n)=>t in e?jh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Fh extends Yp{constructor(t={}){var n,r;const i=null!=(n=t.from)?n:"now-6h",a=null!=(r=t.to)?r:"now",o=t.timeZone;super(((e,t)=>{for(var n in t||(t={}))Nh.call(t,n)&&Mh(e,n,t[n]);if(Ih)for(var n of Ih(t))Lh.call(t,n)&&Mh(e,n,t[n]);return e})({from:i,to:a,timeZone:o,value:Dh(i,a,o||(0,e.getTimeZone)(),t.fiscalYearStartMonth,t.UNSAFE_nowDelay)},t)),this._urlSync=new Ph(this,{keys:["from","to","timezone"]}),this.onTimeRangeChange=e=>{const t={},n={};"string"==typeof e.raw.from?(t.from=e.raw.from,n.from=e.raw.from):(t.from=e.raw.from.toISOString(),n.from=e.raw.from.toISOString(!0)),"string"==typeof e.raw.to?(t.to=e.raw.to,n.to=e.raw.to):(t.to=e.raw.to.toISOString(),n.to=e.raw.to.toISOString(!0)),t.value=Dh(n.from,n.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay),t.from===this.state.from&&t.to===this.state.to||this.setState(t)},this.onTimeZoneChange=e=>{this.setState({timeZone:e})},this.onRefresh=()=>{this.setState({value:Dh(this.state.from,this.state.to,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)})},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){if(!this.state.timeZone){const e=this.getTimeZoneSource();e!==this&&this._subs.add(e.subscribeToState(((t,n)=>{void 0!==t.timeZone&&t.timeZone!==n.timeZone&&this.setState({value:Dh(this.state.from,this.state.to,e.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)})})))}return this.state.weekStart&&(0,e.setWeekStart)(this.state.weekStart),()=>{this.state.weekStart&&(0,e.setWeekStart)(n.config.bootData.user.weekStart)}}getTimeZoneSource(){if(!this.parent||!this.parent.parent)return this;const e=oh(this.parent.parent,(e=>{if(e.state.$timeRange&&e.state.$timeRange.state.timeZone)return e.state.$timeRange}));return e||this}getTimeZone(){if(this.state.timeZone)return this.state.timeZone;const t=this.getTimeZoneSource();return t!==this?t.state.timeZone:(0,e.getTimeZone)()}getUrlState(){const e={from:this.state.from,to:this.state.to};return this.state.timeZone&&(e.timezone=this.state.timeZone),e}updateFromUrl(e){var t,n,r;if(!e.to&&!e.from)return;const i={},a=Rh(e.from);a&&(i.from=a);const o=Rh(e.to);o&&(i.to=o),"string"==typeof e.timezone&&(i.timeZone=""!==e.timezone?e.timezone:void 0),i.value=Dh(null!=(t=i.from)?t:this.state.from,null!=(n=i.to)?n:this.state.to,null!=(r=i.timeZone)?r:this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay),this.setState(i)}}const $h=new class extends Yp{constructor(e){super(((e,t)=>{for(var n in t||(t={}))Oh.call(t,n)&&Ch(e,n,t[n]);if(_h)for(var n of _h(t))Th.call(t,n)&&Ch(e,n,t[n]);return e})({data:kh},e))}getResultsStream(){const e={origin:this,data:this.state.data};return(0,xp.of)(e)}},Bh=new Fh,Vh=new class extends Yp{constructor(){super({variables:[]})}getByName(e){}isVariableLoadingOrWaitingToUpdate(e){return!1}};function zh(e){var t;return null!=(t=oh(e,(e=>e.state.$timeRange)))?t:Bh}class Uh extends e.BusEventWithPayload{}function qh(e){return"object"==typeof e&&"formatter"in e}Uh.type="scene-variable-changed-value";let Hh,Gh={};function Wh(e){return Gh[e]||(Gh[e]=(0,ac.property)(e))}class Qh{constructor(e,t){this.state={name:e,value:t,type:"scopedvar"}}getValue(e){let{value:t}=this.state,n=t.value;return n=e?Wh(e)(t.value):t.value,"string"===n||"number"===n||"boolean"===n?n:String(n)}getValueText(){const{value:e}=this.state;return null!=e.text?String(e.text):String(e)}}const Kh=new e.Registry((()=>{const t=[{id:Sh.Lucene,name:"Lucene",description:"Values are lucene escaped and multi-valued variables generate an OR expression",formatter:e=>"string"==typeof e?Yh(e):Array.isArray(e)?0===e.length?"__empty__":"("+(0,ac.map)(e,(e=>'"'+Yh(e)+'"')).join(" OR ")+")":Yh(`${e}`)},{id:Sh.Raw,name:"raw",description:"Keep value as is",formatter:e=>String(e)},{id:Sh.Regex,name:"Regex",description:"Values are regex escaped and multi-valued variables generate a (<value>|<value>) expression",formatter:t=>{if("string"==typeof t)return(0,e.escapeRegex)(t);if(Array.isArray(t)){const n=t.map((t=>"string"==typeof t?(0,e.escapeRegex)(t):(0,e.escapeRegex)(String(t))));return 1===n.length?n[0]:"("+n.join("|")+")"}return(0,e.escapeRegex)(`${t}`)}},{id:Sh.Pipe,name:"Pipe",description:"Values are separated by | character",formatter:e=>"string"==typeof e?e:Array.isArray(e)?e.join("|"):`${e}`},{id:Sh.Distributed,name:"Distributed",description:"Multiple values are formatted like variable=value",formatter:(e,t,n)=>"string"==typeof e?e:Array.isArray(e)?(e=(0,ac.map)(e,((e,t)=>0!==t?n.state.name+"="+e:e))).join(","):`${e}`},{id:Sh.CSV,name:"Csv",description:"Comma-separated values",formatter:e=>"string"==typeof e?e:(0,ac.isArray)(e)?e.join(","):String(e)},{id:Sh.HTML,name:"HTML",description:"HTML escaping of values",formatter:t=>"string"==typeof t?e.textUtil.escapeHtml(t):(0,ac.isArray)(t)?e.textUtil.escapeHtml(t.join(", ")):e.textUtil.escapeHtml(String(t))},{id:Sh.JSON,name:"JSON",description:"JSON stringify value",formatter:e=>"string"==typeof e?e:JSON.stringify(e)},{id:Sh.PercentEncode,name:"Percent encode",description:"Useful for URL escaping values",formatter:e=>(0,ac.isArray)(e)?Xh("{"+e.join(",")+"}"):Xh(e)},{id:Sh.SingleQuote,name:"Single quote",description:"Single quoted values",formatter:e=>{const t=new RegExp("'","g");if((0,ac.isArray)(e))return(0,ac.map)(e,(e=>`'${(0,ac.replace)(e,t,"\\'")}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,ac.replace)(n,t,"\\'")}'`}},{id:Sh.DoubleQuote,name:"Double quote",description:"Double quoted values",formatter:e=>{const t=new RegExp('"',"g");if((0,ac.isArray)(e))return(0,ac.map)(e,(e=>`"${(0,ac.replace)(e,t,'\\"')}"`)).join(",");let n="string"==typeof e?e:String(e);return`"${(0,ac.replace)(n,t,'\\"')}"`}},{id:Sh.SQLString,name:"SQL string",description:"SQL string quoting and commas for use in IN statements and other scenarios",formatter:nf},{id:Sh.Date,name:"Date",description:"Format date in different ways",formatter:(t,n)=>{var r;let i=NaN;if("number"==typeof t?i=t:"string"==typeof t&&(i=parseInt(t,10)),isNaN(i))return"NaN";const a=null!=(r=n[0])?r:"iso";switch(a){case"ms":return String(t);case"seconds":return`${Math.round(i/1e3)}`;case"iso":return(0,e.dateTime)(i).toISOString();default:return(n||[]).length>1?(0,e.dateTime)(i).format(n.join(":")):(0,e.dateTime)(i).format(a)}}},{id:Sh.Glob,name:"Glob",description:"Format multi-valued variables using glob syntax, example {value1,value2}",formatter:e=>(0,ac.isArray)(e)&&e.length>1?"{"+e.join(",")+"}":String(e)},{id:Sh.Text,name:"Text",description:"Format variables in their text representation. Example in multi-variable scenario A + B + C.",formatter:(e,t,n)=>n.getValueText?n.getValueText():String(e)},{id:Sh.QueryParam,name:"Query parameter",description:"Format variables as URL parameters. Example in multi-variable scenario A + B + C => var-foo=A&var-foo=B&var-foo=C.",formatter:(e,t,n)=>Array.isArray(e)?e.map((e=>ef(n.state.name,e))).join("&"):ef(n.state.name,e)},{id:Sh.UriEncode,name:"Percent encode as URI",description:"Useful for URL escaping values, taking into URI syntax characters",formatter:e=>(0,ac.isArray)(e)?Jh("{"+e.join(",")+"}"):Jh(e)}];return t}));function Yh(e){return!1===isNaN(+e)?e:e.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\/"])/g,"\\$1")}function Xh(e){return"object"==typeof e&&(e=String(e)),Zh(encodeURIComponent(e))}const Jh=e=>Zh(encodeURI(String(e))),Zh=e=>e.replace(/[!'()*]/g,(e=>"%"+e.charCodeAt(0).toString(16).toUpperCase()));function ef(e,t){return`var-${e}=${Xh(t)}`}const tf={"'":"''",'"':'\\"'};function nf(e){const t=new RegExp("'|\"","g");if((0,ac.isArray)(e))return(0,ac.map)(e,(e=>`'${(0,ac.replace)(e,t,(e=>{var t;return null!=(t=tf[e])?t:""}))}'`)).join(",");let n="string"==typeof e?e:String(e);return`'${(0,ac.replace)(n,t,(e=>{var t;return null!=(t=tf[e])?t:""}))}'`}const rf="All",af="$__all",of="$__auto",sf=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function lf(e,t){const n=t.state.$variables;if(!n)return t.parent?lf(e,t.parent):null;return n.getByName(e)||(t.parent?lf(e,t.parent):null)}function cf(e,t,n,r,i){return t?(sf.lastIndex=0,t.replace(sf,((t,a,o,s,l,c,u)=>{const d=a||o||l,p=s||u||r,h=function(e,t,n,r){if(n&&n.hasOwnProperty(e)){const t=n[e];if(t)return function(e,t){return Hh?(Hh.state.name=e,Hh.state.value=t):Hh=new Qh(e,t),Hh}(e,t)}const i=lf(e,r);if(i)return i;const a=Af.get(e);return a?new a(e,r,t,n):null}(d,t,n,e);if(!h)return i&&i.push({match:t,variableName:d,fieldPath:c,format:p,value:t,found:!1}),t;const f=function(e,t,n,r){if(null==n)return"";if(qh(n))return cf(e,n.formatter(r));if(Array.isArray(n)||"object"!=typeof n||(n=`${n}`),"function"==typeof r)return r(n,{name:t.state.name,type:t.state.type,multi:t.state.isMulti,includeAll:t.state.includeAll});let i=[];r?(i=r.split(":"),i.length>1?(r=i[0],i=i.slice(1)):i=[]):r=Sh.Glob;let a=Kh.getIfExists(r);return a||(console.error(`Variable format ${r} not found. Using glob format as fallback.`),a=Kh.get(Sh.Glob)),a.formatter(n,i,t)}(e,h,h.getValue(c),p);return i&&i.push({match:t,variableName:d,fieldPath:c,format:p,value:f,found:f!==t}),f}))):null!=t?t:""}function uf(e){return void 0!==e.useState}function df(e){return"enrichDataRequest"in e}function pf(e){return"isDataLayer"in e}function hf(e){return"isQueryController"in e}function ff(e){var t;return null!=(t=oh(e,(e=>e.state.$data)))?t:$h}function mf(e,t,n,r){if(t(e))return e;let i=null;return e.forEachChild((e=>{if(e===n)return;let r=mf(e,t);r&&(i=r)})),i||(r&&e.parent?mf(e.parent,t,e,!0):null)}function gf(e,t){return mf(e,t,void 0,!0)}new WeakMap;class yf{constructor(e){this._value=e}formatter(){return this._value}}class bf{constructor(e,t){this.state={name:e,type:"time_macro"},this._sceneObject=t}getValue(){const e=zh(this._sceneObject);return"__from"===this.state.name?e.state.value.from.valueOf():e.state.value.to.valueOf()}getValueText(){const t=zh(this._sceneObject);return"__from"===this.state.name?(0,e.dateTimeFormat)(t.state.value.from,{timeZone:t.getTimeZone()}):(0,e.dateTimeFormat)(t.state.value.to,{timeZone:t.getTimeZone()})}}class vf{constructor(e,t,n){this.state={name:e,type:"time_macro",match:n},this._sceneObject=t}getValue(){var e;const t=ff(this._sceneObject);if(t){const n=null==(e=t.state.data)?void 0:e.request;return n?"__interval_ms"===this.state.name?n.intervalMs:n.interval:this.state.match}return this.state.match}}function wf(e,t={}){if(e.state.$variables)for(const n of e.state.$variables.state.variables)n.state.skipUrlSync||t[n.state.name]||(t[n.state.name]=n);return e.parent&&wf(e.parent,t),t}var Sf=Object.defineProperty,Ef=Object.defineProperties,xf=Object.getOwnPropertyDescriptors,_f=Object.getOwnPropertySymbols,Of=Object.prototype.hasOwnProperty,Tf=Object.prototype.propertyIsEnumerable,Cf=(e,t,n)=>t in e?Sf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const kf=(0,e.getDisplayProcessor)();class Pf{constructor(e){this._urlQueryParams=e}formatter(e){if(!e)return this._urlQueryParams;const t=e.split(":");if("exclude"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams);for(const n of t[1].split(","))e.delete(n);return`?${e}`}if("include"===t[0]&&t.length>1){const e=new URLSearchParams(this._urlQueryParams),n=t[1].split(",");for(const t of e.keys())n.includes(t)||e.delete(t);return`?${e}`}return this._urlQueryParams}}const Af=new Map([[e.DataLinkBuiltInVars.includeVars,class{constructor(e,t){this.state={name:e,type:"url_variable"},this._sceneObject=t}getValue(){const e=wf(this._sceneObject),t=Kh.get(Sh.QueryParam),n=[];for(const r of Object.keys(e)){const i=e[r],a=i.getValue();a&&(qh(a)?n.push(a.formatter(Sh.QueryParam)):n.push(t.formatter(a,[],i)))}return new yf(n.join("&"))}getValueText(){return""}}],[e.DataLinkBuiltInVars.keepTime,class{constructor(e,t){this.state={name:e,type:"url_variable"},this._sceneObject=t}getValue(){var t;const n=null==(t=zh(this._sceneObject).urlSync)?void 0:t.getUrlState();return new yf(e.urlUtil.toUrlParams(n))}getValueText(){return""}}],["__value",class{constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__value"}}getValue(t){var n,r;const i=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!i)return this._match;const{frame:a,rowIndex:o,field:s,calculatedValue:l}=i.value;if(l)switch(t){case"numeric":case"raw":return l.numeric;case"time":return"";default:return(0,e.formattedValueToString)(l)}if(null==o)return this._match;if("time"===t){const t=a.fields.find((t=>t.type===e.FieldType.time));return t?t.values.get(o):void 0}if(!s)return this._match;const c=s.values.get(o);if("raw"===t)return c;const u=(null!=(r=s.display)?r:kf)(c);return"numeric"===t?u.numeric:(0,e.formattedValueToString)(u)}getValueText(){return""}}],["__data",class{constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__data"}}getValue(t){var n,r;const i=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!i||!t)return this._match;const{frame:a,rowIndex:o}=i.value;if(void 0===o||void 0===t)return this._match;const s={name:a.name,refId:a.refId,fields:(0,e.getFieldDisplayValuesProxy)({frame:a,rowIndex:o})};return null!=(r=Wh(t)(s))?r:""}getValueText(){return""}}],["__series",class{constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__series"}}getValue(t){var n;const r=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!r||!t)return this._match;if("name"!==t)return this._match;const{frame:i,frameIndex:a}=r.value;return(0,e.getFrameDisplayName)(i,a)}getValueText(){return""}}],["__field",class{constructor(e,t,n,r){this._match=n,this._scopedVars=r,this.state={name:e,type:"__field"}}getValue(t){var n,r;const i=null==(n=this._scopedVars)?void 0:n.__dataContext;if(!i||!t)return this._match;if(void 0===t||""===t)return this._match;const{frame:a,field:o,data:s}=i.value,l=function(t,n,r){return new Proxy({},{get:(i,a)=>"name"===a?t.name:"displayName"===a?(0,e.getFieldDisplayName)(t,n,r):"labels"===a||"formattedLabels"===a?t.labels?((e,t)=>Ef(e,xf(t)))(((e,t)=>{for(var n in t||(t={}))Of.call(t,n)&&Cf(e,n,t[n]);if(_f)for(var n of _f(t))Tf.call(t,n)&&Cf(e,n,t[n]);return e})({},t.labels),{__values:Object.values(t.labels).sort().join(", "),toString:()=>(0,e.formatLabels)(t.labels,"",!0)}):"":void 0})}(o,a,s);return null!=(r=Wh(t)(l))?r:""}getValueText(){return""}}],["__url",class{constructor(e,t){this.state={name:e,type:"url_macro"}}getValue(e){var t;const r=n.locationService.getLocation(),i=null!=(t=n.config.appSubUrl)?t:"";switch(null!=e?e:""){case"params":return new Pf(r.search);case"path":return i+r.pathname;default:return i+r.pathname+r.search}}getValueText(){return""}}],["__from",bf],["__to",bf],["__timezone",class{constructor(e,t){this.state={name:e,type:"time_macro"},this._sceneObject=t}getValue(){const e=zh(this._sceneObject).getTimeZone();return"browser"===e?Intl.DateTimeFormat().resolvedOptions().timeZone:e}getValueText(){return this.getValue()}}],["__user",class{constructor(e,t){this.state={name:e,type:"user_macro"}}getValue(e){const t=n.config.bootData.user;switch(e){case"login":return t.login;case"email":return t.email;default:return String(t.id)}}getValueText(){return""}}],["__org",class{constructor(e,t){this.state={name:e,type:"org_macro"}}getValue(e){const t=n.config.bootData.user;return"name"===e?t.orgName:String(t.orgId)}getValueText(){return""}}],["__interval",vf],["__interval_ms",vf]]),Rf={getVariables:function(e){var t;return null!=(t=oh(e,(e=>e.state.$variables)))?t:Vh},getData:ff,getTimeRange:zh,getLayout:function(e){const t=oh(e,(e=>function(e){return"isDraggable"in e}(e)?e:void 0));return t||null},getDataLayers:function(e,t=!1){let n=e,r=[];for(;n;){const e=n.state.$data;if(e){if(pf(e)?r=r.concat(e):e.state.$data&&pf(e.state.$data)&&(r=r.concat(e.state.$data)),t&&r.length>0)break;n=n.parent}else n=n.parent}return r},interpolate:function(e,t,n,r,i){return""===t||null==t?"":cf(e,t,n,r,i)},lookupVariable:lf,hasVariableDependencyInLoadingState:function(e){if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){const n=lf(t,e);if(n&&n.parent.isVariableLoadingOrWaitingToUpdate(n))return!0}return!1},findByKey:function(e,t){const n=gf(e,(e=>e.state.key===t));if(!n)throw new Error("Unable to find scene with key "+t);return n},findByKeyAndType:function(e,t,n){const r=gf(e,(e=>e.state.key===t));if(!r)throw new Error("Unable to find scene with key "+t);if(!(r instanceof n))throw new Error(`Found scene object with key ${t} does not match type ${n.name}`);return r},findObject:gf,findAllObjects:function e(t,n){const r=[];return t.forEachChild((t=>{n(t)&&r.push(t),r.push(...e(t,n))})),r},getAncestor:function(e,t){let n=e;for(;n;){if(n instanceof t)return n;n=n.parent}if(!n)throw new Error("Unable to find parent of type "+t.name);return n},getQueryController:function(e){let t=e;for(;t;){if(t.state.$behaviors)for(const e of t.state.$behaviors)if(hf(e))return e;t=t.parent}}};async function Df(e,t){if(null==e?void 0:e.uid){const t=lh.get(e.uid);if(t)return t}return e&&e.query?e:await(0,n.getDataSourceSrv)().get(e,t)}function jf(e,t,...n){let r=!1;"undefined"!=typeof window&&(r="true"===localStorage.getItem("grafana.debug.scenes")),r&&console.log(`${e}: `,t,...n)}class If{constructor(e,t){this._sceneObject=e,this._options=t,this._dependencies=new Set,this._isWaitingForVariables=!1,this.scanCount=0,this._statePaths=t.statePaths}hasDependencyOn(e){return this.getNames().has(e)}variableUpdateCompleted(t,n){const r=this.getNames();let i=!1;(r.has(t.state.name)||r.has(e.DataLinkBuiltInVars.includeVars))&&n&&(i=!0),jf("VariableDependencyConfig","variableUpdateCompleted",t.state.name,i,this._isWaitingForVariables),this._options.onAnyVariableChanged&&this._options.onAnyVariableChanged(t),this._options.onVariableUpdateCompleted&&(this._isWaitingForVariables||i)&&this._options.onVariableUpdateCompleted(),i&&(this._options.onReferencedVariableValueChanged&&this._options.onReferencedVariableValueChanged(t),this._options.onReferencedVariableValueChanged||this._options.onVariableUpdateCompleted||this._sceneObject.forceRender())}hasDependencyInLoadingState(){return Rf.hasVariableDependencyInLoadingState(this._sceneObject)?(this._isWaitingForVariables=!0,!0):(this._isWaitingForVariables=!1,!1)}getNames(){const e=this._state,t=this._state=this._sceneObject.state;if(!e)return this.scanStateForDependencies(this._state),this._dependencies;if(t!==e)if(this._statePaths){for(const n of this._statePaths)if("*"===n||t[n]!==e[n]){this.scanStateForDependencies(t);break}}else this.scanStateForDependencies(t);return this._dependencies}setVariableNames(e){this._options.variableNames=e,this.scanStateForDependencies(this._state)}setPaths(e){this._statePaths=e}scanStateForDependencies(e){if(this._dependencies.clear(),this.scanCount+=1,this._options.variableNames)for(const e of this._options.variableNames)this._dependencies.add(e);if(this._statePaths)for(const t of this._statePaths){if("*"===t){this.extractVariablesFrom(e);break}{const n=e[t];n&&this.extractVariablesFrom(n)}}}extractVariablesFrom(e){sf.lastIndex=0;const t=("string"!=typeof e?Cg(e):e).matchAll(sf);if(t)for(const e of t){const[,t,n,,r]=e,i=t||n||r;this._dependencies.add(i)}}}class Nf{constructor(){this._values=new Map}recordCurrentDependencyValuesForSceneObject(e){if(this.clearValues(),e.variableDependency)for(const t of e.variableDependency.getNames()){const n=Rf.lookupVariable(t,e);n&&this._values.set(n.state.name,n.getValue())}}cloneAndRecordCurrentValuesForSceneObject(e){const t=new Nf;return t.recordCurrentDependencyValuesForSceneObject(e),t}clearValues(){this._values.clear()}hasValues(){return!!this._values}recordCurrentValue(e){this._values.set(e.state.name,e.getValue())}hasRecordedValue(e){return this._values.has(e.state.name)}hasValueChanged(e){return!(!this._values.has(e.state.name)||Tg(this._values.get(e.state.name),e.getValue()))}hasDependenciesChanged(e){if(!this._values)return!1;if(!e.variableDependency)return!1;for(const t of e.variableDependency.getNames()){const n=Rf.lookupVariable(t,e);if(!n)continue;const r=n.state.name;if(n&&this._values.has(r)&&!Tg(this._values.get(r),n.getValue()))return!0}return!1}}function Lf(e){return"object"==typeof e&&"getExtraQueries"in e}var Mf=Object.defineProperty,Ff=Object.defineProperties,$f=Object.getOwnPropertyDescriptors,Bf=Object.getOwnPropertySymbols,Vf=Object.prototype.hasOwnProperty,zf=Object.prototype.propertyIsEnumerable,Uf=(e,t,n)=>t in e?Mf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const qf=(e,t)=>(0,xp.of)(t);var Hf=Object.defineProperty,Gf=Object.defineProperties,Wf=Object.getOwnPropertyDescriptors,Qf=Object.getOwnPropertySymbols,Kf=Object.prototype.hasOwnProperty,Yf=Object.prototype.propertyIsEnumerable,Xf=(e,t,n)=>t in e?Hf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Jf=(e,t)=>{for(var n in t||(t={}))Kf.call(t,n)&&Xf(e,n,t[n]);if(Qf)for(var n of Qf(t))Yf.call(t,n)&&Xf(e,n,t[n]);return e},Zf=(e,t)=>Gf(e,Wf(t));function em(e){const t=e.getRoot();return df(t)?t.enrichDataRequest(e):null}let tm,nm=new Set;function rm(e){return t=>{const n=Rf.getQueryController(e.origin);return n?new xp.Observable((r=>{e.cancel||(e.cancel=()=>r.complete()),n.queryStarted(e);let i=!1;const a=t.subscribe({next:t=>{i||t.state===Eh.Loading||(i=!0,n.queryCompleted(e)),r.next(t)},error:e=>r.error(e),complete:()=>{r.complete()}});return()=>{a.unsubscribe(),i||n.queryCompleted(e)}})):t}}const im=new Set;function am(e,t){e.setState(t)}class om extends Yp{constructor(){super(...arguments),this._urlSync=new sm(this)}validateAndUpdate(){return this.getValueOptions({}).pipe((0,xp.map)((e=>(this.updateValueGivenNewOptions(e),{}))))}onCancel(){this.setStateHelper({loading:!1});const e=this.parent;null==e||e.cancel(this)}updateValueGivenNewOptions(e){const{value:t,text:n}=this.state,r=this.getStateUpdateGivenNewOptions(e,t,n);this.interceptStateUpdateAfterValidation(r),this.setStateHelper(r),(r.value!==t||r.text!==n||this.hasAllValue())&&this.publishEvent(new Uh(this),!0)}getStateUpdateGivenNewOptions(e,t,n){const r={options:e,loading:!1,value:t,text:n};if(0===e.length)return this.state.defaultToAll||this.state.includeAll?(r.value=af,r.text=rf):this.state.isMulti?(r.value=[],r.text=[]):(r.value="",r.text=""),r;if(this.hasAllValue())return this.state.includeAll||(r.value=e[0].value,r.text=e[0].label,this.state.isMulti&&(r.value=[r.value],r.text=[r.text])),r;if(this.state.isMulti){const i=(Array.isArray(t)?t:[t]).filter((t=>e.find((e=>e.value===t)))),a=i.map((t=>e.find((e=>e.value===t)).label));if(0===i.length){const t=this.getDefaultMultiState(e);r.value=t.value,r.text=t.text}else(0,ac.isEqual)(i,t)||(r.value=i),(0,ac.isEqual)(a,n)||(r.text=a);return r}let i=function(e,t,n){let r;for(const i of n){if(i.value===e)return i;i.label===t&&(r=i)}return r}(t,n,e);return i?(r.text=i.label,r.value=i.value):this.state.defaultToAll?(r.value=af,r.text=rf):(r.value=e[0].value,r.text=e[0].label),r}interceptStateUpdateAfterValidation(e){const t=e.value===af&&this.state.text===rf;this.skipNextValidation&&e.value!==this.state.value&&!t&&(e.value=this.state.value,e.text=this.state.text),this.skipNextValidation=!1}getValue(){return this.hasAllValue()?this.state.allValue?new lm(this.state.allValue,this):this.state.options.map((e=>e.value)):this.state.value}getValueText(){return this.hasAllValue()?rf:Array.isArray(this.state.text)?this.state.text.join(" + "):String(this.state.text)}hasAllValue(){const e=this.state.value;return e===af||Array.isArray(e)&&e[0]===af}getDefaultMultiState(e){return this.state.defaultToAll?{value:[af],text:[rf]}:e.length>0?{value:[e[0].value],text:[e[0].label]}:{value:[],text:[]}}changeValueTo(e,t){if(e!==this.state.value||t!==this.state.text){if(t||(t=Array.isArray(e)?e.map((e=>this.findLabelTextForValue(e))):this.findLabelTextForValue(e)),Array.isArray(e)){if(0===e.length){const n=this.getDefaultMultiState(this.state.options);e=n.value,t=n.text}e[e.length-1]===af?(e=[af],t=[rf]):e[0]===af&&e.length>1&&(e.shift(),Array.isArray(t)&&t.shift())}(0,ac.isEqual)(e,this.state.value)&&(0,ac.isEqual)(t,this.state.text)||(this.setStateHelper({value:e,text:t,loading:!1}),this.publishEvent(new Uh(this),!0))}}findLabelTextForValue(e){if(e===af)return rf;const t=this.state.options.find((t=>t.value===e));if(t)return t.label;const n=this.state.options.find((t=>t.label===e));return n?n.label:e}setStateHelper(e){am(this,e)}getOptionsForSelect(){let e=this.state.options;if(this.state.includeAll&&(e=[{value:af,label:rf},...e]),!Array.isArray(this.state.value)){const t=e.find((e=>e.value===this.state.value));t||(e=[{value:this.state.value,label:String(this.state.text)},...e])}return e}}class sm{constructor(e){this._sceneObject=e}getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){if(this._sceneObject.state.skipUrlSync)return{};let e=null,t=this._sceneObject.state.value;return e=Array.isArray(t)?t.map(String):this._sceneObject.state.isMulti?[String(t)]:String(t),{[this.getKey()]:e}}updateFromUrl(e){let t=e[this.getKey()];null!=t&&(this._sceneObject.state.includeAll&&(t=function(e){return(0,ac.isArray)(e)&&e[0]===rf?[af]:e===rf?af:e}(t)),this._sceneObject.state.allValue&&this._sceneObject.state.allValue===t&&(t=af),this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0),this._sceneObject.changeValueTo(t))}}class lm{constructor(e,t){this._value=e,this._variable=t}formatter(e){return e===Sh.Text?rf:e===Sh.PercentEncode?Kh.get(Sh.PercentEncode).formatter(this._value,[],this._variable):e===Sh.QueryParam?Kh.get(Sh.QueryParam).formatter(rf,[],this._variable):this._value}}const cm={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:e=>`data-testid ${e} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch",codeModeMetricNamesSuggestionLimit:"data-testid code mode metric names suggestion limit"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsCountInfo:"data-testid metrics count disclaimer",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:e=>`${e} menu`,MenuGroup:e=>`${e} menu group`,MenuItem:e=>`${e} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:e=>`data-testid Panel header ${e}`,content:"data-testid panel content",headerItems:e=>`data-testid Panel header item ${e}`,menuItems:e=>`data-testid Panel menu item ${e}`,menu:e=>`data-testid Panel menu ${e}`,containerByTitle:e=>`${e} panel`,headerCornerInfo:e=>`Panel header ${e}`,status:e=>`data-testid Panel status ${e}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:e=>`gpl alias ${e}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:e=>`data-testid VizLegend series ${e}`},Drawer:{General:{title:e=>`Drawer title ${e}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"},DashboardSaveDrawer:{saveButton:"data-testid Save dashboard drawer button",saveAsButton:"data-testid Save as dashboard drawer button",saveAsTitleInput:"Save dashboard title field"}},PanelEditor:{General:{content:"data-testid Panel editor content"},OptionsPane:{content:"data-testid Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:e=>`${e} field property editor`,fieldInput:e=>`data-testid Panel editor option pane field input ${e}`},DataPane:{content:"data-testid Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"data-testid toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"data-testid Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:e=>`Tab ${e}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query",queryGroupTopSection:"data-testid query group top section",addExpression:"data-testid query-tab-add-expression"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:e=>`data-testid ${e}`,title:e=>`Query editor row title ${e}`,container:e=>`Query editor row ${e}`},AlertTab:{content:"data-testid Alert editor tab content"},AlertRules:{groupToggle:"data-testid group-collapse-toggle",toggle:"data-testid collapse-toggle",expandedContent:"data-testid expanded-content",previewButton:"data-testid alert-rule preview-button",ruleNameField:"data-testid alert-rule name-field",newFolderButton:"data-testid alert-rule new-folder-button",newFolderNameField:"data-testid alert-rule name-folder-name-field",newFolderNameCreateButton:"data-testid alert-rule name-folder-name-create-button",newEvaluationGroupButton:"data-testid alert-rule new-evaluation-group-button",newEvaluationGroupName:"data-testid alert-rule new-evaluation-group-name",newEvaluationGroupInterval:"data-testid alert-rule new-evaluation-group-interval",newEvaluationGroupCreate:"data-testid alert-rule new-evaluation-group-create-button"},Alert:{alert:e=>`Alert ${e}`,alertV2:e=>`data-testid Alert ${e}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:e=>`data-testid New transform ${e}`,transformationEditor:e=>`data-testid Transformation editor ${e}`,transformationEditorDebugger:e=>`data-testid Transformation editor debugger ${e}`},Transforms:{card:e=>`data-testid New transform ${e}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar",shareDashboard:"data-testid Share dashboard",markAsFavorite:"data-testid Mark as favorite",editDashboard:{editButton:"data-testid Edit dashboard button",saveButton:"data-testid Save dashboard button",exitButton:"data-testid Exit edit mode button",settingsButton:"data-testid Dashboard settings",addRowButton:"data-testid Add row button",addLibraryPanelButton:"data-testid Add a panel from the panel library button",addVisualizationButton:"data-testid Add new visualization menu item",pastePanelButton:"data-testid Paste panel button",discardChangesButton:"data-testid Discard changes button",discardLibraryPanelButton:"data-testid Discard library panel button",unlinkLibraryPanelButton:"data-testid Unlink library panel button",saveLibraryPanelButton:"data-testid Save library panel button",backToDashboardButton:"data-testid Back to dashboard button"}},PageToolbar:{container:()=>".page-toolbar",item:e=>`${e}`,itemButton:e=>`data-testid ${e}`},QueryEditorToolbarItem:{button:e=>`QueryEditor toolbar item button ${e}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:e=>e?`data-testid Options group ${e}`:"data-testid Options group",toggle:e=>e?`data-testid Options group ${e} toggle`:"data-testid Options group toggle"},PluginVisualization:{item:e=>`Plugin visualization item ${e}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"data-testid Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container",changeTimeSettingsButton:"data-testid Time zone picker Change time settings button"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",inputSelect:"data-testid Select label-input",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:e=>`data-testid Value picker button ${e}`,select:e=>`data-testid Value picker select ${e}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:e=>`data-testid Collapse folder ${e}`,expandFolder:e=>`data-testid Expand folder ${e}`,dashboardItem:e=>`${cm.Search.dashboardItems} ${e}`,dashboardCard:e=>`data-testid Search card ${e}`,folderHeader:e=>`data-testid Folder header ${e}`,folderContent:e=>`data-testid Folder content ${e}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:e=>`Call to action button ${e}`,buttonV2:e=>`data-testid Call to action button ${e}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},ReactMonacoEditor:{editorLazy:"data-testid ReactMonacoEditor editorLazy"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:e=>`data-testid suggestion-${e}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:e=>`data-testid dashboard-row-title-${e}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:e=>`data-testid-extension-point-tab-${e}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option"},Annotations:{annotationsTypeInput:"data-testid annotations-type-input",annotationsChoosePanelInput:"data-testid choose-panels-input",editor:{testButton:"data-testid annotations-test-button",resultContainer:"data-testid annotations-query-result-container"}},Tooltip:{container:"data-testid tooltip"},ReturnToPrevious:{buttonGroup:"data-testid dismissable button group",backButton:"data-testid back",dismissButton:"data-testid dismiss"},SQLQueryEditor:{selectColumn:"data-testid select-column",selectAggregation:"data-testid select-aggregation",selectAlias:"data-testid select-alias",filterConjunction:"data-testid filter-conjunction",filterField:"data-testid filter-field",filterOperator:"data-testid filter-operator",headerTableSelector:"data-testid header-table-selector",headerFilterSwitch:"data-testid header-filter-switch",headerGroupSwitch:"data-testid header-group-switch",headerOrderSwitch:"data-testid header-order-switch",headerPreviewSwitch:"data-testid header-preview-switch"}},um={Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:e=>`Data source list item ${e}`},EditDataSource:{url:e=>`/datasources/edit/${e}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:e=>`Data source plugin item ${e}`,dataSourcePluginsV2:e=>`Add new data source ${e}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:e=>`data-testid ${e}`,addNewPanel:"data-testid Add new panel",addNewRow:"data-testid Add new row",addNewPanelLibrary:"data-testid Add new panel from panel library"},Dashboard:{url:e=>`/d/${e}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button",scrollContainer:"data-testid Dashboard canvas scroll container",newShareButton:{container:"data-testid new share button",shareLink:"data-testid new share link-button",arrowMenu:"data-testid new share button arrow menu",menu:{container:"data-testid new share button menu",shareInternally:"data-testid new share button share internally"}},playlistControls:{prev:"data-testid playlist previous dashboard button",stop:"data-testid playlist stop dashboard button",next:"data-testid playlist next dashboard button"}},Controls:"data-testid dashboard controls",SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:e=>`data-testid Dashboard template variables submenu Label ${e}`,submenuItemValueDropDownValueLinkTexts:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:e=>`data-testid Dashboard annotations submenu Label ${e}`,annotationToggle:e=>`data-testid Dashboard annotations submenu Toggle ${e}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"data-testid Dashboard settings page delete dashboard button",sectionItems:e=>`Dashboard settings section item ${e}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Tab General"},Annotations:{List:{addAnnotationCTA:cm.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:cm.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"data-testid Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"data-testid show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:cm.CallToActionCard.button("Add variable"),addVariableCTAV2:cm.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:e=>`Variable editor Table Name field ${e}`,tableRowDefinitionFields:e=>`Variable editor Table Definition field ${e}`,tableRowArrowUpButtons:e=>`Variable editor Table ArrowUp button ${e}`,tableRowArrowDownButtons:e=>`Variable editor Table ArrowDown button ${e}`,tableRowDuplicateButtons:e=>`Variable editor Table Duplicate button ${e}`,tableRowRemoveButtons:e=>`Variable editor Table Remove button ${e}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:cm.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:cm.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:cm.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text",modeToggle:"data-testid ad-hoc filters variable mode toggle"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:e=>`Dashboard search item ${e}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox",saveRefresh:"Dashboard settings Save Dashboard Modal Save refresh checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{Tab:"Tab Public dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}},PublicDashboardScene:{Tab:"Tab Public Dashboard"},SnapshotScene:{url:e=>`/dashboard/snapshot/${e}`,Tab:"Tab Snapshot",PublishSnapshot:"data-testid publish snapshot button",CopyUrlButton:"data-testid snapshot copy url button",CopyUrlInput:"data-testid snapshot copy url input"}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"},footer:"public-dashboard-footer"},PublicDashboardScene:{loadingPage:"public-dashboard-scene-loading-page",page:"public-dashboard-scene-page",controls:"public-dashboard-controls"},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"},QueryHistory:{container:"data-testid QueryHistory"}},SoloPanel:{url:e=>`/d-solo/${e}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:e=>`data-testid browse dashboards row ${e}`,checkbox:e=>`data-testid ${e} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:e=>`data-testid dashboards-list-item-${e}`}}},ProfilePage:{url:"/profile"}},dm={pages:um,components:cm};function pm(e,t){const n=new vs;let r=e;const i=[],a=1e4;return t&&(r=[{value:af,label:rf},...r]),e=>{if(""===e)return r.length>a?r.slice(0,a):r;if(0===i.length)for(let e=0;e<r.length;e++)i.push(r[e].label);const t=n.filter(i,e),o=[];if(t){for(let e=0;e<t.length;e++)if(o.push(r[t[e]]),o.length>a)return o;return o}return r.length>a?r.slice(0,a):r}}var hm=Object.defineProperty,fm=Object.defineProperties,mm=Object.getOwnPropertyDescriptors,gm=Object.getOwnPropertySymbols,ym=Object.prototype.hasOwnProperty,bm=Object.prototype.propertyIsEnumerable,vm=(e,t,n)=>t in e?hm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const wm=()=>!0;function Sm({model:e}){const{value:t,text:n,key:i,options:a,includeAll:o,isReadOnly:s}=e.useState(),[l,c]=(0,Ei.useState)(""),[u,d]=(0,Ei.useState)(!1),p=function(e,t){return{value:e,label:null!=t?t:String(e)}}(t,String(n)),h=(0,Ei.useMemo)((()=>pm(a,o)),[a,o])(l);return xi().createElement(r.Select,{id:i,isValidNewOption:e=>e.trim().length>0,placeholder:"Select value",width:"auto",disabled:s,value:p,inputValue:l,allowCustomValue:!0,virtualized:!0,filterOption:wm,tabSelectsValue:!1,onInputChange:(t,{action:n})=>"input-change"===n?(c(t),e.onSearchChange&&e.onSearchChange(t),t):t,onOpenMenu:()=>{u&&c(String(n))},onCloseMenu:()=>{c("")},options:h,"data-testid":dm.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${t}`),onChange:t=>{e.changeValueTo(t.value,t.label),u!==t.__isNew__&&d(t.__isNew__)}})}function Em({model:e}){const{value:t,options:n,key:i,maxVisibleValues:a,noValueOnClear:o,includeAll:s,isReadOnly:l}=e.useState(),c=(0,Ei.useMemo)((()=>(0,ac.isArray)(t)?t:[t]),[t]),[u,d]=(0,Ei.useState)(c),[p,h]=(0,Ei.useState)(""),f=(0,Ei.useMemo)((()=>pm(n,s)),[n,s]);(0,Ei.useEffect)((()=>{d(c)}),[c]);const m=n.length>0?"Select value":"",g=f(p);return xi().createElement(r.MultiSelect,{id:i,placeholder:m,width:"auto",inputValue:p,disabled:l,value:u,noMultiValueWrap:!0,maxVisibleValues:null!=a?a:5,tabSelectsValue:!1,virtualized:!0,allowCustomValue:!0,options:g,closeMenuOnSelect:!1,components:{Option:xm},isClearable:!0,hideSelectedOptions:!1,onInputChange:(t,{action:n})=>"input-change"===n?(h(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(h(""),""):p,onBlur:()=>{e.changeValueTo(u)},filterOption:wm,"data-testid":dm.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${u}`),onChange:(t,n)=>{"clear"===n.action&&o&&e.changeValueTo([]),d(t.map((e=>e.value)))}})}const xm=({children:e,data:n,innerProps:i,innerRef:a,isFocused:o,isSelected:s,renderOptionLabel:l})=>{var c;const u=((e,t)=>{var n={};for(var r in e)ym.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&gm)for(var r of gm(e))t.indexOf(r)<0&&bm.call(e,r)&&(n[r]=e[r]);return n})(i,["onMouseMove","onMouseOver"]),d=(0,r.useTheme2)(),p=(0,r.getSelectStyles)(d),h=(0,r.useStyles2)(_m);return xi().createElement("div",((e,t)=>fm(e,mm(t)))(((e,t)=>{for(var n in t||(t={}))ym.call(t,n)&&vm(e,n,t[n]);if(gm)for(var n of gm(t))bm.call(t,n)&&vm(e,n,t[n]);return e})({ref:a,className:(0,t.cx)(p.option,o&&p.optionFocused)},u),{"data-testid":dm.components.Select.option,title:n.title}),xi().createElement("div",{className:h.checkbox},xi().createElement(r.Checkbox,{value:s})),xi().createElement("div",{className:p.optionBody,"data-testid":dm.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(null!=(c=n.label)?c:String(n.value))},xi().createElement("span",null,e)))};xm.displayName="SelectMenuOptions";const _m=e=>({checkbox:(0,t.css)({marginRight:e.spacing(2)})});function Om(e){return e.state.isMulti?xi().createElement(Em,{model:e}):xi().createElement(Sm,{model:e})}class Tm{constructor(e){this._sceneObject=e}getKey(){return`var-${this._sceneObject.state.name}`}getKeys(){return this._sceneObject.state.skipUrlSync?[]:[this.getKey()]}getUrlState(){return this._sceneObject.state.skipUrlSync?{}:{[this.getKey()]:(e=this._sceneObject.state.value,t=this._sceneObject.state.text,e=Array.isArray(e)?e:[e],t=Array.isArray(t)?t:[t],e.map(((e,n)=>{if(null==e)return"";e=String(e);let r=t[n];return r=null==r?e:String(r),Ng(e,r)})))};var e,t}updateFromUrl(e){let t=e[this.getKey()];if(null!=t){this._sceneObject.isActive||(this._sceneObject.skipNextValidation=!0);const{values:e,texts:r}=(n=t,(n=Array.isArray(n)?n:[n]).reduce(((e,t)=>{const[n,r]=(null!=t?t:"").split(",");return e.values.push(Ig(n)),e.texts.push(Ig(null!=r?r:n)),e}),{values:[],texts:[]}));this._sceneObject.changeValueTo(e,r)}var n}}function Cm(e){const t=e.getRoot();return"enrichFiltersRequest"in t?t.enrichFiltersRequest(e):null}var km=Object.defineProperty,Pm=Object.defineProperties,Am=Object.getOwnPropertyDescriptors,Rm=Object.getOwnPropertySymbols,Dm=Object.prototype.hasOwnProperty,jm=Object.prototype.propertyIsEnumerable,Im=(e,t,n)=>t in e?km(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Nm=(e,t)=>{for(var n in t||(t={}))Dm.call(t,n)&&Im(e,n,t[n]);if(Rm)for(var n of Rm(t))jm.call(t,n)&&Im(e,n,t[n]);return e};class Lm extends om{constructor(e){super(((e,t)=>Pm(e,Am({noValueOnClear:!0})))(Nm({isMulti:!0,name:"",value:[],text:[],options:[],datasource:null,baseFilters:[],applyMode:"auto",layout:"horizontal",type:"groupby"},e))),this.isLazy=!0,this._urlSync=new Tm(this),this._getKeys=async e=>{var t,n,r;const i=await(null==(n=(t=this.state).getTagKeysProvider)?void 0:n.call(t,this,null));if(i&&i.replace)return i.values;if(this.state.defaultOptions)return this.state.defaultOptions.concat(null!=(r=null==i?void 0:i.values)?r:[]);if(!e.getTagKeys)return[];const a=Rg(this),o=this.state.baseFilters||[],s=Rf.getTimeRange(this).state.value;let l=await e.getTagKeys(Nm({filters:o,queries:a,timeRange:s},Cm(this)));i&&(l=l.concat(i.values));const c=this.state.tagKeyRegexFilter;return c&&(l=l.filter((e=>e.text.match(c)))),l},this.addActivationHandler((()=>(im.add(this),()=>im.delete(this))))}validateAndUpdate(){return this.getValueOptions({}).pipe((0,xp.map)((e=>(this._updateValueGivenNewOptions(e),{}))))}_updateValueGivenNewOptions(e){const{value:t,text:n}=this.state,r={options:e,loading:!1,value:null!=t?t:[],text:null!=n?n:[]};this.setState(r)}getValueOptions(e){return this.state.defaultOptions?(0,xp.of)(this.state.defaultOptions.map((e=>({label:e.text,value:String(e.value)})))):(this.setState({loading:!0,error:null}),(0,xp.from)(Df(this.state.datasource,{__sceneObject:{text:"__sceneObject",value:this}})).pipe((0,xp.mergeMap)((e=>(0,xp.from)(this._getKeys(e)).pipe((0,xp.take)(1),(0,xp.mergeMap)((e=>{const t=e.map((e=>({label:e.text,value:e.value?String(e.value):e.text})));return(0,xp.of)(t)})))))))}getDefaultMultiState(e){return{value:[],text:[]}}}Lm.Component=function({model:e}){const{value:t,text:n,key:i,maxVisibleValues:a,noValueOnClear:o,options:s,includeAll:l}=e.useState(),c=(0,Ei.useMemo)((()=>{const e=(0,ac.isArray)(t)?t:[t],r=(0,ac.isArray)(n)?n:[n];return e.map(((e,t)=>{var n;return{value:e,label:String(null!=(n=r[t])?n:e)}}))}),[t,n]),[u,d]=(0,Ei.useState)(!1),[p,h]=(0,Ei.useState)(!1),[f,m]=(0,Ei.useState)(""),[g,y]=(0,Ei.useState)(c),b=(0,Ei.useMemo)((()=>pm(s,l)),[s,l]);(0,Ei.useEffect)((()=>{y(c)}),[c]);const v=b(f);return xi().createElement(r.MultiSelect,{"data-testid":`GroupBySelect-${i}`,id:i,placeholder:"Select value",width:"auto",inputValue:f,value:g,noMultiValueWrap:!0,maxVisibleValues:null!=a?a:5,tabSelectsValue:!1,virtualized:!0,options:v,filterOption:Mm,closeMenuOnSelect:!1,isOpen:p,isClearable:!0,hideSelectedOptions:!1,isLoading:u,components:{Option:xm},onInputChange:(t,{action:n})=>"input-change"===n?(m(t),e.onSearchChange&&e.onSearchChange(t),t):"input-blur"===n?(m(""),""):f,onBlur:()=>{e.changeValueTo(g.map((e=>e.value)),g.map((e=>e.label)))},onChange:(t,n)=>{"clear"===n.action&&o&&e.changeValueTo([]),y(t)},onOpenMenu:async()=>{d(!0),await(0,xp.lastValueFrom)(e.validateAndUpdate()),d(!1),h(!0)},onCloseMenu:()=>{h(!1)}})};const Mm=()=>!0;function Fm(e){return xi().createElement(r.Tooltip,{content:"Cancel query"},xi().createElement(r.Icon,{className:"spin-clockwise",name:"sync",size:"xs",role:"button",onMouseDown:t=>{e.onCancel(t)}}))}function $m(e){const t=(0,r.useStyles2)(Bm),n=(0,r.useTheme2)(),i="vertical"===e.layout,a=Boolean(e.isLoading)?xi().createElement("div",{style:{marginLeft:n.spacing(1),marginTop:"-1px"},"aria-label":dm.components.LoadingIndicator.icon},xi().createElement(Fm,{onCancel:t=>{var n;t.preventDefault(),t.stopPropagation(),null==(n=e.onCancel)||n.call(e)}})):null;let o=null;e.error&&(o=xi().createElement(r.Tooltip,{content:e.error,placement:"bottom"},xi().createElement(r.Icon,{className:t.errorIcon,name:"exclamation-triangle"})));let s=null;e.description&&(s=xi().createElement(r.Tooltip,{content:e.description,placement:i?"top":"bottom"},xi().createElement(r.Icon,{className:t.normalIcon,name:"info-circle"})));const l="string"==typeof e.label?dm.pages.Dashboard.SubMenu.submenuItemLabels(e.label):"";let c;return c=i?xi().createElement("label",{className:t.verticalLabel,"data-testid":l,htmlFor:e.htmlFor},e.label,s,o,e.icon&&xi().createElement(r.Icon,{name:e.icon,className:t.normalIcon}),a,e.onRemove&&xi().createElement(r.IconButton,{variant:"secondary",size:"xs",name:"times",onClick:e.onRemove,tooltip:"Remove"})):xi().createElement("label",{className:t.horizontalLabel,"data-testid":l,htmlFor:e.htmlFor},o,e.icon&&xi().createElement(r.Icon,{name:e.icon,className:t.normalIcon}),e.label,s,a),c}const Bm=e=>({horizontalLabel:(0,t.css)({background:e.isDark?e.colors.background.primary:e.colors.background.secondary,display:"flex",alignItems:"center",padding:e.spacing(0,1),fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,height:e.spacing(e.components.height.md),lineHeight:e.spacing(e.components.height.md),borderRadius:e.shape.borderRadius(1),border:`1px solid ${e.components.input.borderColor}`,position:"relative",right:-1,whiteSpace:"nowrap",gap:e.spacing(.5)}),verticalLabel:(0,t.css)({display:"flex",alignItems:"center",fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.bodySmall.fontSize,lineHeight:e.typography.bodySmall.lineHeight,whiteSpace:"nowrap",marginBottom:e.spacing(.5),gap:e.spacing(1)}),errorIcon:(0,t.css)({color:e.colors.error.text}),normalIcon:(0,t.css)({color:e.colors.text.secondary})});function Vm(e){var t;return{label:null!=(t=e.label)?t:String(e.value),value:e.value}}function zm(e,t){return""!==e?{value:e,label:t||e}:null}const Um=()=>!0;function qm({filter:e,model:n}){var i,a;const o=(0,r.useStyles2)(Hm),[s,l]=(0,Ei.useState)([]),[c,u]=(0,Ei.useState)([]),[d,p]=(0,Ei.useState)(!1),[h,f]=(0,Ei.useState)(!1),[m,g]=(0,Ei.useState)(!1),[y,b]=(0,Ei.useState)(!1),[v,w]=(0,Ei.useState)(""),[S,E]=(0,Ei.useState)(!1),x=zm(e.key,e.keyLabel),_=zm(e.value,e.valueLabel),O=(0,Ei.useMemo)((()=>pm(c.map(Vm),void 0)),[c])(v),T=xi().createElement(r.Select,{virtualized:!0,allowCustomValue:!0,isValidNewOption:e=>e.trim().length>0,allowCreateWhileLoading:!0,formatCreateLabel:e=>`Use custom value: ${e}`,disabled:n.state.readOnly,className:(0,t.cx)(o.value,m?o.widthWhenOpen:void 0),width:"auto",value:_,filterOption:Um,placeholder:"Select value",options:O,inputValue:v,onInputChange:(e,{action:t})=>("input-change"===t&&w(e),e),onChange:t=>{n._updateFilter(e,"value",t),S!==t.__isNew__&&E(t.__isNew__)},isOpen:y&&!h,isLoading:h,autoFocus:""!==e.key&&""===e.value,openMenuOnFocus:!0,onOpenMenu:async()=>{var t;f(!0),b(!0);const r=await n._getValuesFor(e);f(!1),u(r),S&&w(null!=(t=null==_?void 0:_.label)?t:"")},onCloseMenu:()=>{b(!1),w("")}}),C=xi().createElement(r.Select,{key:h?"loading":"loaded",disabled:n.state.readOnly,className:(0,t.cx)(o.key,m?o.widthWhenOpen:void 0),width:"auto",value:x,placeholder:"Select label",options:s,onChange:t=>n._updateFilter(e,"key",t),autoFocus:""===e.key,isOpen:m&&!d,isLoading:d,onOpenMenu:async()=>{g(!0),p(!0);const t=await n._getKeys(e.key);p(!1),l(t)},onCloseMenu:()=>{g(!1)},onBlur:()=>{""===e.key&&n._removeFilter(e)},openMenuOnFocus:!0});if("vertical"===n.state.layout){if(e.key){const t=xi().createElement($m,{layout:"vertical",label:null!=(i=e.key)?i:"",onRemove:()=>n._removeFilter(e)});return xi().createElement(r.Field,{label:t,"data-testid":`AdHocFilter-${e.key}`,className:o.field},xi().createElement("div",{className:o.wrapper},xi().createElement(r.Select,{className:o.operator,value:e.operator,disabled:n.state.readOnly,options:n._getOperators(),width:"auto",onChange:t=>n._updateFilter(e,"operator",t)}),T))}return xi().createElement(r.Field,{label:"Select label","data-testid":`AdHocFilter-${e.key}`,className:o.field},C)}return xi().createElement("div",{className:o.wrapper,"data-testid":`AdHocFilter-${e.key}`},C,xi().createElement(r.Select,{className:o.operator,value:e.operator,disabled:n.state.readOnly,options:n._getOperators(),width:"auto",onChange:t=>n._updateFilter(e,"operator",t)}),T,xi().createElement(r.Button,{variant:"secondary","aria-label":"Remove filter",title:"Remove filter",className:o.removeButton,icon:"times","data-testid":`AdHocFilter-remove-${null!=(a=e.key)?a:""}`,onClick:()=>n._removeFilter(e)}))}const Hm=e=>({field:(0,t.css)({marginBottom:0}),wrapper:(0,t.css)({display:"flex","> *":{"&:not(:first-child)":{marginLeft:-1},"&:first-child":{borderTopRightRadius:0,borderBottomRightRadius:0},"&:last-child":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:first-child):not(:last-child)":{borderRadius:0},position:"relative",zIndex:0,"&:hover":{zIndex:1},"&:focus-within":{zIndex:2}}}),widthWhenOpen:(0,t.css)({minWidth:e.spacing(16)}),value:(0,t.css)({flexShrink:1}),key:(0,t.css)({minWidth:"90px",flexShrink:1}),operator:(0,t.css)({flexShrink:0}),removeButton:(0,t.css)({paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5),borderLeft:"none",width:e.spacing(3),marginRight:e.spacing(1),boxSizing:"border-box",position:"relative",left:"1px"})});function Gm({model:e,addFilterButtonText:t}){const{_wip:n}=e.useState();return n?xi().createElement(qm,{filter:n,model:e}):xi().createElement(r.Button,{variant:"secondary",icon:"plus",title:"Add filter","aria-label":"Add filter","data-testid":"AdHocFilter-add",onClick:()=>e._addWip()},t)}class Wm{constructor(e){this._variable=e}getKey(){return`var-${this._variable.state.name}`}getKeys(){return[this.getKey()]}getUrlState(){const e=this._variable.state.filters;if(0===e.length)return{[this.getKey()]:[""]};const t=e.filter(cg).map((e=>function(e){return[Ng(e.key,e.keyLabel),e.operator,Ng(e.value,e.valueLabel)]}(e).map(Dg).join("|")));return{[this.getKey()]:t}}updateFromUrl(e){const t=e[this.getKey()];if(null==t)return;const n=function(e){if(Array.isArray(e))return e.map(Qm).filter(Km);const t=Qm(e);return null===t?[]:[t]}(t);this._variable.setState({filters:n})}}function Qm(e){if("string"!=typeof e||0===e.length)return null;const[t,n,r,i,a,o]=e.split("|").reduce(((e,t)=>{const[n,r]=t.split(",");return e.push(n,null!=r?r:n),e}),[]).map(Ig);return{key:t,keyLabel:n,operator:r,value:a,valueLabel:o,condition:""}}function Km(e){return null!==e&&"string"==typeof e.key&&"string"==typeof e.value}var Ym=Object.defineProperty,Xm=Object.defineProperties,Jm=Object.getOwnPropertyDescriptors,Zm=Object.getOwnPropertySymbols,eg=Object.prototype.hasOwnProperty,tg=Object.prototype.propertyIsEnumerable,ng=(e,t,n)=>t in e?Ym(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rg=(e,t)=>{for(var n in t||(t={}))eg.call(t,n)&&ng(e,n,t[n]);if(Zm)for(var n of Zm(t))tg.call(t,n)&&ng(e,n,t[n]);return e},ig=(e,t)=>Xm(e,Jm(t));class ag extends Yp{constructor(e){var t,r;super(rg({type:"adhoc",name:null!=(t=e.name)?t:"Filters",filters:[],datasource:null,applyMode:"auto",filterExpression:null!=(r=e.filterExpression)?r:og(e.expressionBuilder,e.filters)},e)),this._scopedVars={__sceneObject:{value:this}},this._dataSourceSrv=(0,n.getDataSourceSrv)(),this._urlSync=new Wm(this),"auto"===this.state.applyMode&&function(e){if(e.addActivationHandler((()=>(nm.add(e),()=>nm.delete(e)))),tm)return;const t=(0,n.getTemplateSrv)();(null==t?void 0:t.getAdhocFilters)?(tm=t.getAdhocFilters,t.getAdhocFilters=function(e){var r;if(0===nm.size)return tm.call(t);const i=(0,n.getDataSourceSrv)().getInstanceSettings(e);if(!i)return[];for(const e of nm.values())if((null==(r=e.state.datasource)?void 0:r.uid)===i.uid)return e.state.filters;return[]}.bind(t)):console.log("Failed to patch getAdhocFilters")}(this)}setState(e){let t=!1;e.filters&&e.filters!==this.state.filters&&!e.filterExpression&&(e.filterExpression=og(this.state.expressionBuilder,e.filters),t=e.filterExpression!==this.state.filterExpression),super.setState(e),t&&this.publishEvent(new Uh(this),!0)}getValue(){return this.state.filterExpression}_updateFilter(e,t,{value:n,label:r}){if(null==n)return;const{filters:i,_wip:a}=this.state,o=`${t}Label`;if(e===a)return void("value"===t?this.setState({filters:[...i,ig(rg({},a),{[t]:n,[o]:r})],_wip:void 0}):this.setState({_wip:ig(rg({},e),{[t]:n,[o]:r})}));const s=this.state.filters.map((i=>{if(i===e){const a=ig(rg({},i),{[t]:n,[o]:r});return"key"===t&&e[t]!==n&&(a.value="",a.valueLabel=""),a}return i}));this.setState({filters:s})}_removeFilter(e){e!==this.state._wip?this.setState({filters:this.state.filters.filter((t=>t!==e))}):this.setState({_wip:void 0})}async _getKeys(e){var t,n,r;const i=await(null==(n=(t=this.state).getTagKeysProvider)?void 0:n.call(t,this,e));if(i&&i.replace)return i.values.map(lg);if(this.state.defaultKeys)return this.state.defaultKeys.map(lg);const a=await this._dataSourceSrv.get(this.state.datasource,this._scopedVars);if(!a||!a.getTagKeys)return[];const o=this.state.filters.filter((t=>t.key!==e)).concat(null!=(r=this.state.baseFilters)?r:[]),s=Rf.getTimeRange(this).state.value,l=this.state.useQueriesAsFilterForOptions?Rg(this):void 0;let c=await a.getTagKeys(rg({filters:o,queries:l,timeRange:s},Cm(this)));i&&(c=c.concat(i.values));const u=this.state.tagKeyRegexFilter;return u&&(c=c.filter((e=>e.text.match(u)))),c.map(lg)}async _getValuesFor(e){var t,n,r;const i=await(null==(n=(t=this.state).getTagValuesProvider)?void 0:n.call(t,this,e));if(i&&i.replace)return ug(i.values);const a=await this._dataSourceSrv.get(this.state.datasource,this._scopedVars);if(!a||!a.getTagValues)return[];const o=this.state.filters.filter((t=>t.key!==e.key)).concat(null!=(r=this.state.baseFilters)?r:[]),s=Rf.getTimeRange(this).state.value,l=this.state.useQueriesAsFilterForOptions?Rg(this):void 0;let c=await a.getTagValues(rg({key:e.key,filters:o,timeRange:s,queries:l},Cm(this)));return i&&(c=c.concat(i.values)),ug(c)}_addWip(){this.setState({_wip:{key:"",keyLabel:"",value:"",valueLabel:"",operator:"=",condition:""}})}_getOperators(){return["=","!=","<",">","=~","!~"].map((e=>({label:e,value:e})))}}function og(e,t){return(null!=e?e:kg)(null!=t?t:[])}ag.Component=function({model:e}){const{filters:t,readOnly:n,addFilterButtonText:i}=e.useState(),a=(0,r.useStyles2)(sg);return xi().createElement("div",{className:a.wrapper},t.map(((t,n)=>xi().createElement(xi().Fragment,{key:n},xi().createElement(qm,{filter:t,model:e})))),!n&&xi().createElement(Gm,{model:e,key:"'builder",addFilterButtonText:i}))};const sg=e=>({wrapper:(0,t.css)({display:"flex",flexWrap:"wrap",alignItems:"flex-end",columnGap:e.spacing(2),rowGap:e.spacing(1)}),filterIcon:(0,t.css)({color:e.colors.text.secondary,paddingRight:e.spacing(.5)})});function lg({text:e,value:t}){return{label:e,value:String(null!=t?t:e)}}function cg(e){return""!==e.key&&""!==e.operator&&""!==e.value}function ug(e){const t=[],n=new Map;for(const r of e){const e=r.group;if(e){let i=n.get(e);i||(i=[],n.set(e,i),t.push({label:e,options:i})),i.push(lg(r))}else t.push(lg(r))}return t}class dg{constructor(){this._resultsMap=new Map,this._prevLayers=[]}getMergedStream(e){(function(e,t){if(e.length!==t.length)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!0;return!1})(e,this._prevLayers)&&(this._resultsMap=new Map,this._prevLayers=e);const t=e.map((e=>e.getResultsStream())),n=[];for(const t of e)n.push(t.activate());return(0,xp.merge)(t).pipe((0,xp.mergeAll)(),(0,xp.filter)((e=>this._resultsMap.get(e.origin.state.key)!==e)),(0,xp.map)((e=>(this._resultsMap.set(e.origin.state.key,e),this._resultsMap.values()))),(0,xp.finalize)((()=>{n.forEach((e=>e()))})))}}var pg=Object.defineProperty,hg=Object.defineProperties,fg=Object.getOwnPropertyDescriptors,mg=Object.getOwnPropertySymbols,gg=Object.prototype.hasOwnProperty,yg=Object.prototype.propertyIsEnumerable,bg=(e,t,n)=>t in e?pg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vg=(e,t)=>{for(var n in t||(t={}))gg.call(t,n)&&bg(e,n,t[n]);if(mg)for(var n of mg(t))yg.call(t,n)&&bg(e,n,t[n]);return e},wg=(e,t)=>hg(e,fg(t));let Sg=100;function Eg(){return"SQR"+Sg++}class xg extends Yp{constructor(t){super(t),this._dataLayersMerger=new dg,this._variableValueRecorder=new Nf,this._results=new xp.ReplaySubject(1),this._scopedVars={__sceneObject:{value:this,text:"__sceneObject"}},this._variableDependency=new If(this,{statePaths:["queries","datasource"],onVariableUpdateCompleted:this.onVariableUpdatesCompleted.bind(this),onAnyVariableChanged:this.onAnyVariableChanged.bind(this)}),this.onDataReceived=t=>{const n=(0,e.preProcessPanelData)(t,this.state.data);this._resultAnnotations=t.annotations;const r=this._combineDataLayers(n);let i=this.state._hasFetchedData;i||n.state===Eh.Loading||(i=!0),this.setState({data:r,_hasFetchedData:i}),this._results.next({origin:this,data:r})},this.addActivationHandler((()=>this._onActivate()))}getResultsStream(){return this._results}_onActivate(){const e=Rf.getTimeRange(this),t=this.getClosestExtraQueryProviders();for(const e of t)this._subs.add(e.subscribeToState(((t,n)=>{e.shouldRerun(n,t)&&this.runQueries()})));return this.subscribeToTimeRangeChanges(e),this.shouldRunQueriesOnActivate()&&this.runQueries(),this._dataLayersSub||this._handleDataLayers(),()=>this._onDeactivate()}_handleDataLayers(){const e=Rf.getDataLayers(this);0!==e.length&&(this._dataLayersSub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayersReceived.bind(this)))}_onLayersReceived(t){var n,r,i,a,o;const s=Rf.getTimeRange(this),{dataLayerFilter:l}=this.state;let c,u=[],d=[];for(const i of t)for(let t of i.data.series)(null==(n=t.meta)?void 0:n.dataTopic)===e.DataTopic.Annotations&&(u=u.concat(t)),(null==(r=t.meta)?void 0:r.dataTopic)===e.DataTopic.AlertStates&&(d=d.concat(t));if((null==l?void 0:l.panelId)&&(u.length>0&&(u=function(e,t){var n;if(!Array.isArray(e)||0===e.length)return e;const r=Array.from({length:e.length},(()=>new Set));let i=0;for(const a of e){for(let e=0;e<a.length;e++){if(r[i].has(e))continue;let o=!0;const s=a.fields.find((e=>"panelId"===e.name)),l=a.fields.find((e=>"source"===e.name));if(l){s&&"dashboard"===l.values[e].type&&(o=s.values[e]===t.panelId);const r=l.values[e].filter;if(r){const e=(null!=(n=r.ids)?n:[]).includes(t.panelId);r.exclude?e&&(o=!1):e||(o=!1)}}o&&r[i].add(e)}i++}const a=[];i=0;for(const t of e){const e=r[i].size,n=[];for(const e of t.fields){const a=[];for(let n=0;n<t.length;n++)r[i].has(n)&&a.push(e.values[n]);n.push(Zf(Jf({},e),{values:a}))}a.push(Zf(Jf({},t),{fields:n,length:e})),i++}return a}(u,l)),d.length>0))for(const t of d){const n=new e.DataFrameView(t);for(const e of n)if(e.panelId===l.panelId){c=e;break}}if(Og(u)&&Og(this._layerAnnotations)&&(0,ac.isEqual)(c,null==(i=this.state.data)?void 0:i.alertState))return;this._layerAnnotations=u;const p=this.state.data?this.state.data:wg(vg({},kh),{timeRange:s.state.value});this.setState({data:wg(vg({},p),{annotations:[...null!=(a=this._resultAnnotations)?a:[],...u],alertState:null!=c?c:null==(o=this.state.data)?void 0:o.alertState})})}onVariableUpdatesCompleted(){this.runQueries()}onAnyVariableChanged(e){this._adhocFiltersVar!==e&&this._groupByVar!==e&&(e instanceof ag&&this._isRelevantAutoVariable(e)&&this.runQueries(),e instanceof Lm&&this._isRelevantAutoVariable(e)&&this.runQueries())}_isRelevantAutoVariable(e){var t,n;const r=null!=(t=this.state.datasource)?t:_g(this.state.queries);return"auto"===e.state.applyMode&&(null==r?void 0:r.uid)===(null==(n=e.state.datasource)?void 0:n.uid)}shouldRunQueriesOnActivate(){return this._variableValueRecorder.hasDependenciesChanged(this)?(jf("SceneQueryRunner","Variable dependency changed while inactive, shouldRunQueriesOnActivate returns true"),!0):!this.state.data||!!this._isDataTimeRangeStale(this.state.data)}_isDataTimeRangeStale(e){const t=Rf.getTimeRange(this).state.value,n=e.timeRange;return(t.from.unix()!==n.from.unix()||t.to.unix()!==n.to.unix())&&(jf("SceneQueryRunner","Data time range is stale"),!0)}_onDeactivate(){var e;this._querySub&&(this._querySub.unsubscribe(),this._querySub=void 0),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),null==(e=this._timeSub)||e.unsubscribe(),this._timeSub=void 0,this._timeSubRange=void 0,this._adhocFiltersVar=void 0,this._groupByVar=void 0,this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}setContainerWidth(e){!this._containerWidth&&e>0?(this._containerWidth=e,this.state.maxDataPointsFromWidth&&!this.state.maxDataPoints&&setTimeout((()=>{this.isActive&&!this.state._hasFetchedData&&this.runQueries()}),0)):e>0&&(this._containerWidth=e)}isDataReadyToDisplay(){return Boolean(this.state._hasFetchedData)}subscribeToTimeRangeChanges(e){this._timeSubRange!==e&&(this._timeSub&&this._timeSub.unsubscribe(),this._timeSubRange=e,this._timeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)})))}runQueries(){const e=Rf.getTimeRange(this);this.subscribeToTimeRangeChanges(e),this.runWithTimeRange(e)}getMaxDataPoints(){var e;return this.state.maxDataPoints?this.state.maxDataPoints:this.state.maxDataPointsFromWidth&&null!=(e=this._containerWidth)?e:500}cancelQuery(){var e;null==(e=this._querySub)||e.unsubscribe(),this._dataLayersSub&&(this._dataLayersSub.unsubscribe(),this._dataLayersSub=void 0),this.setState({data:wg(vg({},this.state.data),{state:Eh.Done})})}async runWithTimeRange(e){var t,r;if(!this.state.maxDataPoints&&this.state.maxDataPointsFromWidth&&!this._containerWidth)return;if(this._dataLayersSub||this._handleDataLayers(),null==(t=this._querySub)||t.unsubscribe(),this._variableDependency.hasDependencyInLoadingState())return jf("SceneQueryRunner","Variable dependency is in loading state, skipping query execution"),void this.setState({data:wg(vg({},this.state.data),{state:Eh.Loading})});const{queries:i}=this.state;if(null==i?void 0:i.length)try{const t=null!=(r=this.state.datasource)?r:_g(i),a=await Df(t,this._scopedVars);this.findAndSubscribeToAdHocFilters(null==t?void 0:t.uid);const o=(0,n.getRunRequest)(),{primary:s,secondaries:l,processors:c}=this.prepareRequests(e,a);jf("SceneQueryRunner","Starting runRequest",this.state.key);let u=o(a,s);if(l.length>0){const e=l.map((e=>o(a,e))),t=(e=>t=>t.pipe((0,xp.mergeMap)((([t,...n])=>{const r=n.flatMap((n=>{var r,i;return null!=(i=null==(r=e.get(n.request.requestId))?void 0:r(t,n))?i:(0,xp.of)(n)}));return(0,xp.forkJoin)([(0,xp.of)(t),...r])})),(0,xp.map)((([e,...t])=>{var n;return((e,t)=>Ff(e,$f(t)))(((e,t)=>{for(var n in t||(t={}))Vf.call(t,n)&&Uf(e,n,t[n]);if(Bf)for(var n of Bf(t))zf.call(t,n)&&Uf(e,n,t[n]);return e})({},e),{series:[...e.series,...t.flatMap((e=>e.series))],annotations:[...null!=(n=e.annotations)?n:[],...t.flatMap((e=>{var t;return null!=(t=e.annotations)?t:[]}))]})}))))(c);u=(0,xp.forkJoin)([u,...e]).pipe(t)}u=u.pipe(rm({type:"data",request:s,origin:this,cancel:()=>this.cancelQuery()})),this._querySub=u.subscribe(this.onDataReceived)}catch(e){console.error("PanelQueryRunner Error",e),this.onDataReceived(wg(vg(vg({},kh),this.state.data),{state:Eh.Error,errors:[(0,n.toDataQueryError)(e)]}))}else this._setNoDataState()}clone(e){var t;const n=super.clone(e);return this._resultAnnotations&&(n._resultAnnotations=this._resultAnnotations.map((e=>vg({},e)))),this._layerAnnotations&&(n._layerAnnotations=this._layerAnnotations.map((e=>vg({},e)))),n._variableValueRecorder=this._variableValueRecorder.cloneAndRecordCurrentValuesForSceneObject(this),n._containerWidth=this._containerWidth,n._results.next({origin:this,data:null!=(t=this.state.data)?t:kh}),n}prepareRequests(t,r){var i;const{minInterval:a,queries:o}=this.state;let s=vg({app:"scenes",requestId:Eg(),timezone:t.getTimeZone(),range:t.state.value,interval:"1s",intervalMs:1e3,targets:(0,ac.cloneDeep)(o),maxDataPoints:this.getMaxDataPoints(),scopedVars:this._scopedVars,startTime:Date.now(),liveStreaming:this.state.liveStreaming,rangeRaw:{from:t.state.from,to:t.state.to},cacheTimeout:this.state.cacheTimeout,queryCachingTTL:this.state.queryCachingTTL},em(this));this._adhocFiltersVar&&(s.filters=this._adhocFiltersVar.state.filters.filter(cg)),this._groupByVar&&(s.groupByKeys=this._groupByVar.state.value),s.targets=s.targets.map((e=>{var t;return e.datasource&&(e.datasource.uid===r.uid||(null==(t=r.meta)?void 0:t.mixed)||!n.isExpressionReference||(0,n.isExpressionReference)(e.datasource))||(e.datasource=r.getRef()),e}));const l=a||r.interval,c=e.rangeUtil.calculateInterval(t.state.value,s.maxDataPoints,l);s.scopedVars=Object.assign({},s.scopedVars,{__interval:{text:c.interval,value:c.interval},__interval_ms:{text:c.intervalMs.toString(),value:c.intervalMs}}),s.interval=c.interval,s.intervalMs=c.intervalMs;const u=t.state.value;let d=[],p=new Map;for(const e of null!=(i=this.getClosestExtraQueryProviders())?i:[])for(const{req:t,processor:n}of e.getExtraQueries(s)){const e=Eg();d.push(wg(vg({},t),{requestId:e})),p.set(e,null!=n?n:qf)}return s.range=u,{primary:s,secondaries:d,processors:p}}_combineDataLayers(e){return this._layerAnnotations&&this._layerAnnotations.length>0&&(e.annotations=(e.annotations||[]).concat(this._layerAnnotations)),this.state.data&&this.state.data.alertState&&(e.alertState=this.state.data.alertState),e}_setNoDataState(){this.state.data!==kh&&this.setState({data:kh})}getClosestExtraQueryProviders(){const e=new Map;return this.parent?(oh(this.parent,(t=>(Lf(t)&&!e.has(t.constructor)&&e.set(t.constructor,t),t.forEachChild((t=>{Lf(t)&&!e.has(t.constructor)&&e.set(t.constructor,t)})),null))),Array.from(e.values())):[]}findAndSubscribeToAdHocFilters(e){const t=function(e){var t;for(const n of nm.values())if((null==(t=n.state.datasource)?void 0:t.uid)===e)return n}(e);this._adhocFiltersVar!==t&&(this._adhocFiltersVar=t,this._updateExplicitVariableDependencies());const n=function(e){var t;for(const n of im.values())if((null==(t=n.state.datasource)?void 0:t.uid)===e)return n}(e);this._groupByVar!==n&&(this._groupByVar=n,this._updateExplicitVariableDependencies())}_updateExplicitVariableDependencies(){const e=[];this._adhocFiltersVar&&e.push(this._adhocFiltersVar.state.name),this._groupByVar&&e.push(this._groupByVar.state.name),this._variableDependency.setVariableNames(e)}}function _g(e){var t,n;return null!=(n=null==(t=e.find((e=>null!==e.datasource)))?void 0:t.datasource)?n:void 0}function Og(e){if(!e)return!0;for(let t=0;t<e.length;t++)if(e[t].length>0)return!1;return!0}function Tg(e,t){return e===t||(0,ac.isEqual)(e,t)}function Cg(e){try{return JSON.stringify(e,(()=>{const e=new WeakSet;return(t,n)=>{if("object"==typeof n&&null!==n){if(e.has(n))return;e.add(n)}return n}})())}catch(e){console.error(e)}return""}function kg(e){return e.map((e=>function(e){let t="";return t="=~"===e.operator||"!~"===e.operator?Pg(function(e){return e.replace(Ag,"\\$&")}(e.value)):Pg(e.value),`${e.key}${e.operator}"${t}"`}(e))).join(",")}function Pg(e){return e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}const Ag=/[*+?()|\\.\[\]{}^$]/g;function Rg(e){const t=Rf.findAllObjects(e.getRoot(),(e=>e instanceof xg)),n=function(e){const t={};for(const n of e)n.state.key&&(n.state.key in t||(t[n.state.key]=[]),t[n.state.key].push(n));return Object.values(t).flatMap((e=>{const t=e.filter((e=>e.isActive));return 0===t.length&&1===e.length?e:t}))}(t).filter((t=>{var n,r;return(null==(n=t.state.datasource)?void 0:n.uid)===(null==(r=e.state.datasource)?void 0:r.uid)}));if(0===n.length)return[];const r=[];return n.forEach((e=>{r.push(...e.state.queries)})),r}function Dg(e){return null==e?"":/\|/g[Symbol.replace](e,"__gfp__")}function jg(e){return null==e?"":/,/g[Symbol.replace](e,"__gfc__")}function Ig(e){return null==e?"":(e=/__gfp__/g[Symbol.replace](e,"|"),e=/__gfc__/g[Symbol.replace](e,","))}function Ng(e,t){return t&&e!==t?[e,t].map(jg).join(","):jg(e)}var Lg=(e=>(e[e.never=0]="never",e[e.onDashboardLoad=1]="onDashboardLoad",e[e.onTimeRangeChanged=2]="onTimeRangeChanged",e))(Lg||{}),Mg=(e=>(e[e.Crosshair=1]="Crosshair",e[e.Off=0]="Off",e[e.Tooltip=2]="Tooltip",e))(Mg||{}),Fg=Object.defineProperty,$g=Object.defineProperties,Bg=Object.getOwnPropertyDescriptors,Vg=Object.getOwnPropertySymbols,zg=Object.prototype.hasOwnProperty,Ug=Object.prototype.propertyIsEnumerable,qg=(e,t,n)=>t in e?Fg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Hg extends Yp{constructor(e){super(((e,t)=>$g(e,Bg(t)))(((e,t)=>{for(var n in t||(t={}))zg.call(t,n)&&qg(e,n,t[n]);if(Vg)for(var n of Vg(t))Ug.call(t,n)&&qg(e,n,t[n]);return e})({},e),{sync:e.sync||Mg.Off})),this.getEventsBus=e=>{if(!this.parent)throw new Error("EnableCursorSync cannot be used as a standalone scene object");return new Gg(this.parent,e)}}getEventsScope(){if(!this.parent)throw new Error("EnableCursorSync cannot be used as a standalone scene object");return this.state.key}}class Gg{constructor(e,t){this._source=e,this._eventsOrigin=t}publish(e){e.origin=this,this._eventsOrigin.publishEvent(e,!0)}getStream(e){return new xp.Observable((t=>{const n=this._source.subscribeToEvent(e,(e=>{t.next(e)}));return()=>n.unsubscribe()}))}subscribe(e,t){return this.getStream(e).pipe().subscribe(t)}removeAllListeners(){}newScopedBus(e,t){throw new Error("For internal use only")}}var Wg=function(){},Qg="undefined"!=typeof window;const Kg=Qg?Ei.useLayoutEffect:Ei.useEffect;var Yg={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const Xg=Qg&&void 0!==window.ResizeObserver?function(){var e=(0,Ei.useState)(null),t=e[0],n=e[1],r=(0,Ei.useState)(Yg),i=r[0],a=r[1],o=(0,Ei.useMemo)((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,r=t.y,i=t.width,o=t.height,s=t.top,l=t.left,c=t.bottom,u=t.right;a({x:n,y:r,width:i,height:o,top:s,left:l,bottom:c,right:u})}}))}),[]);return Kg((function(){if(t)return o.observe(t),function(){o.disconnect()}}),[t]),[n,i]}:function(){return[Wg,Yg]};function Jg(e,t){if(t)return t;let n=e.error?e.error.message:void 0;return e.errors&&(n=e.errors.map((e=>e.message)).join(", ")),n}const Zg=(0,t.css)({position:"relative",width:"100%",height:"100%"}),ey=(0,t.css)({position:"absolute",width:"100%",height:"100%"}),ty=e=>({ok:(0,t.css)({color:e.colors.success.text}),pending:(0,t.css)({color:e.colors.warning.text}),alerting:(0,t.css)({color:e.colors.error.text})});var ny=Object.defineProperty,ry=Object.defineProperties,iy=Object.getOwnPropertyDescriptors,ay=Object.getOwnPropertySymbols,oy=Object.prototype.hasOwnProperty,sy=Object.prototype.propertyIsEnumerable,ly=(e,t,n)=>t in e?ny(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,cy=(e,t)=>{for(var n in t||(t={}))oy.call(t,n)&&ly(e,n,t[n]);if(ay)for(var n of ay(t))sy.call(t,n)&&ly(e,n,t[n]);return e},uy=(e,t)=>ry(e,iy(t));const dy="hideSeriesFrom",py=(0,e.isSystemOverrideWithRef)(dy);function hy(t,n=e.ByNamesMatcherMode.exclude,r){return r=null!=r?r:{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:dy,matcher:{id:e.FieldMatcherID.byNames,options:{mode:n,names:t,prefix:n===e.ByNamesMatcherMode.exclude?"All except:":void 0,readOnly:!0}},properties:[uy(cy({},r),{value:{viz:!0,legend:!1,tooltip:!1}})]}}const fy=e=>{var t;const n=null==(t=e.matcher.options)?void 0:t.names;return Array.isArray(n)?[...n]:[]},my=(t,n)=>{const r=new Set;for(const i of t)for(const a of i.fields){if(a.type!==e.FieldType.number)continue;const o=(0,e.getFieldDisplayName)(a,i,t);o!==n&&r.add(o)}return Array.from(r)},gy=(t,n)=>{var r;let i=[];for(const a of t){const t=a.properties.find((e=>"custom.hideFrom"===e.id));if(void 0!==t&&!0===(null==(r=t.value)?void 0:r.legend)){const t=e.fieldMatchers.get(a.matcher.id).get(a.matcher.options);for(const r of n)for(const a of r.fields){if(a.type!==e.FieldType.number)continue;const o=(0,e.getFieldDisplayName)(a,r,n);t(a,r,n)&&i.push(o)}}}return i};var yy=Object.defineProperty,by=Object.defineProperties,vy=Object.getOwnPropertyDescriptors,wy=Object.getOwnPropertySymbols,Sy=Object.prototype.hasOwnProperty,Ey=Object.prototype.propertyIsEnumerable,xy=(e,t,n)=>t in e?yy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,_y=(e,t)=>{for(var n in t||(t={}))Sy.call(t,n)&&xy(e,n,t[n]);if(wy)for(var n of wy(t))Ey.call(t,n)&&xy(e,n,t[n]);return e},Oy=(e,t)=>by(e,vy(t));const Ty=(t,n)=>({matcher:{id:e.FieldMatcherID.byName,options:t},properties:[Cy(n)]}),Cy=t=>({id:"color",value:{mode:e.FieldColorModeId.Fixed,fixedColor:t}});var ky=Object.defineProperty,Py=Object.defineProperties,Ay=Object.getOwnPropertyDescriptors,Ry=Object.getOwnPropertySymbols,Dy=Object.prototype.hasOwnProperty,jy=Object.prototype.propertyIsEnumerable,Iy=(e,t,n)=>t in e?ky(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ny=(e,t)=>{for(var n in t||(t={}))Dy.call(t,n)&&Iy(e,n,t[n]);if(Ry)for(var n of Ry(t))jy.call(t,n)&&Iy(e,n,t[n]);return e},Ly=(e,t)=>Py(e,Ay(t));class My extends Yp{constructor(t){var n;super(Ny({options:{},fieldConfig:{defaults:{},overrides:[]},title:"Title",pluginId:"timeseries"},t)),this._variableDependency=new If(this,{statePaths:["title","options","fieldConfig"]}),this._structureRev=0,this.onTimeRangeChange=t=>{Rf.getTimeRange(this).onTimeRangeChange({raw:{from:(0,e.toUtc)(t.from),to:(0,e.toUtc)(t.to)},from:(0,e.toUtc)(t.from),to:(0,e.toUtc)(t.to)})},this.getTimeRange=e=>{const t=Rf.findObject(this,(e=>e instanceof $y)),n=Rf.getTimeRange(this);if(t instanceof $y&&t.isEnabled)return Dh(n.state.from,n.state.to,n.getTimeZone(),n.state.fiscalYearStartMonth,n.state.UNSAFE_nowDelay);const r=this.getPlugin();return r&&!r.meta.skipDataQuery&&e&&e.timeRange?e.timeRange:n.state.value},this.onTitleChange=e=>{this.setState({title:e})},this.onDescriptionChange=e=>{this.setState({description:e})},this.onDisplayModeChange=e=>{this.setState({displayMode:e})},this.onOptionsChange=(t,n=!1)=>{const{fieldConfig:r,options:i}=this.state,a=n?t:(0,ac.mergeWith)((0,ac.cloneDeep)(i),t,((e,t)=>{if((0,ac.isArray)(t))return t})),o=(0,e.getPanelOptionsWithDefaults)({plugin:this._plugin,currentOptions:a,currentFieldConfig:r,isAfterPluginChange:!1});this.setState({options:o.options})},this.onFieldConfigChange=(t,n)=>{const{fieldConfig:r,options:i}=this.state,a=n?t:(0,ac.merge)((0,ac.cloneDeep)(r),t),o=(0,e.getPanelOptionsWithDefaults)({plugin:this._plugin,currentOptions:i,currentFieldConfig:a,isAfterPluginChange:!1});this._dataWithFieldConfig=void 0,this.setState({fieldConfig:o.fieldConfig})},this.interpolate=(e,t,n)=>Rf.interpolate(this,e,t,n),this.getDescription=()=>{this.publishEvent(new Bp({origin:this,interaction:"panel-description-shown"}),!0);const{description:t}=this.state;if(t){const n=this.interpolate(t);return(0,e.renderMarkdown)(n)}return""},this.onCancelQuery=()=>{var e;this.publishEvent(new Bp({origin:this,interaction:"panel-cancel-query-clicked"}),!0);const t=Rf.getData(this);null==(e=t.cancelQuery)||e.call(t)},this.onStatusMessageClick=()=>{this.publishEvent(new Bp({origin:this,interaction:"panel-status-message-clicked"}),!0)},this._onSeriesColorChange=(t,n)=>{this.onFieldConfigChange(((t,n,r)=>{const{overrides:i}=r,a=r.overrides.findIndex((n=>n.matcher.id===e.FieldMatcherID.byName&&n.matcher.options===t));if(a<0)return Oy(_y({},r),{overrides:[...r.overrides,Ty(t,n)]});const o=Array.from(i),s=o[a],l=s.properties.findIndex((e=>"color"===e.id));if(l<0)return o[a]=Oy(_y({},s),{properties:[...s.properties,Cy(n)]}),Oy(_y({},r),{overrides:o});const c=Array.from(s.properties);return c[l]=Cy(n),o[a]=Oy(_y({},s),{properties:c}),Oy(_y({},r),{overrides:o})})(t,n,this.state.fieldConfig))},this._onSeriesVisibilityChange=(t,n)=>{this._dataWithFieldConfig&&this.onFieldConfigChange(function(t,n,i,a){const{overrides:o}=i,s=t,l=o.findIndex(py);if(l<0){if(n===r.SeriesVisibilityChangeMode.ToggleSelection){const e=hy([s,...gy(o,a)]);return uy(cy({},i),{overrides:[...i.overrides,e]})}const e=hy(my(a,s));return uy(cy({},i),{overrides:[...i.overrides,e]})}const c=Array.from(o),[u]=c.splice(l,1);if(n===r.SeriesVisibilityChangeMode.ToggleSelection){let e=fy(u);const t=gy(c,a);if(t.length>0&&(e=e.filter((e=>t.indexOf(e)<0))),e[0]===s&&1===e.length)return uy(cy({},i),{overrides:c});const n=hy([s,...t]);return uy(cy({},i),{overrides:[...c,n]})}const d=((t,n,r=e.ByNamesMatcherMode.exclude)=>{const i=t.properties.find((e=>"custom.hideFrom"===e.id)),a=fy(t),o=a.findIndex((e=>e===n));return o<0?a.push(n):a.splice(o,1),hy(a,r,i)})(u,s);return((e,t)=>fy(e).length===my(t).length)(d,a)?uy(cy({},i),{overrides:c}):uy(cy({},i),{overrides:[...c,d]})}(t,n,this.state.fieldConfig,this._dataWithFieldConfig.series),!0)},this._onInstanceStateChange=e=>{this._panelContext&&(this._panelContext=Ly(Ny({},this._panelContext),{instanceState:e})),this.setState({_pluginInstanceState:e})},this._onToggleLegendSort=e=>{const t=this.state.options.legend;if(!t)return;let n=t.sortDesc,r=t.sortBy;e!==r&&(n=void 0),!1===n?(r=void 0,n=void 0):(n=!n,r=e),this.onOptionsChange(Ly(Ny({},this.state.options),{legend:Ly(Ny({},t),{sortBy:r,sortDesc:n})}),!0)},this.addActivationHandler((()=>{this._onActivate()})),null==(n=t.menu)||n.addActivationHandler((()=>{this.publishEvent(new Bp({origin:this,interaction:"panel-menu-shown"}),!0)}))}_onActivate(){this._plugin||this._loadPlugin(this.state.pluginId)}async _loadPlugin(t){const r=function(e){var t;const{getPanelPluginFromCache:r}=(0,n.getPluginImportUtils)();return null!=(t=r(e))?t:Ep.get(e)}(t);if(r)this._pluginLoaded(r);else{const{importPanelPlugin:r}=(0,n.getPluginImportUtils)();try{const e=await r(t);this._pluginLoaded(e)}catch(n){this._pluginLoaded(function(t){const n=new e.PanelPlugin((()=>null));return n.meta={id:t,name:t,sort:100,type:e.PluginType.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},n}(t)),n instanceof Error&&this.setState({_pluginLoadError:n.message})}}}getLegacyPanelId(){const e=parseInt(this.state.key.replace("panel-",""),10);return isNaN(e)?0:e}async _pluginLoaded(t){const{options:n,fieldConfig:r,title:i,pluginVersion:a,_UNSAFE_customMigrationHandler:o}=this.state,s={title:i,options:n,fieldConfig:r,id:this.getLegacyPanelId(),type:t.meta.id,pluginVersion:a},l=this._getPluginVersion(t);null==o||o(s,t),t.onPanelMigration&&l!==this.state.pluginVersion&&(s.options=await t.onPanelMigration(s));const c=(0,e.getPanelOptionsWithDefaults)({plugin:t,currentOptions:s.options,currentFieldConfig:s.fieldConfig,isAfterPluginChange:!1});if(this._plugin=t,this.setState({options:c.options,fieldConfig:c.fieldConfig,pluginVersion:l}),t.meta.skipDataQuery){const e=Rf.getTimeRange(this);this._subs.add(e.subscribeToState((()=>this.forceRender())))}}_getPluginVersion(e){return e&&e.meta.info.version?e.meta.info.version:n.config.buildInfo.version}getPlugin(){return this._plugin}getPanelContext(){return null!=this._panelContext||(this._panelContext=this.buildPanelContext()),this._panelContext}clearFieldConfigCache(){this._dataWithFieldConfig=void 0}applyFieldConfig(t){var r,i,a,o;const s=this._plugin;if(!s||s.meta.skipDataQuery||!t)return kh;if(this._prevData===t&&this._dataWithFieldConfig)return this._dataWithFieldConfig;const l=s.dataSupport||{alertStates:!1,annotations:!1},c=s.fieldConfigRegistry,u=null!=(i=null==(r=this._dataWithFieldConfig)?void 0:r.series)?i:[],d=(0,e.applyFieldOverrides)({data:t.series,fieldConfig:this.state.fieldConfig,fieldConfigRegistry:c,replaceVariables:this.interpolate,theme:n.config.theme2,timeZone:null==(a=t.request)?void 0:a.timezone});return(0,e.compareArrayValues)(d,u,e.compareDataFrameStructures)||this._structureRev++,this._dataWithFieldConfig=Ly(Ny({},t),{structureRev:this._structureRev,series:d}),this._dataWithFieldConfig.annotations&&(this._dataWithFieldConfig.annotations=(0,e.applyFieldOverrides)({data:this._dataWithFieldConfig.annotations,fieldConfig:{defaults:{},overrides:[]},fieldConfigRegistry:c,replaceVariables:this.interpolate,theme:n.config.theme2,timeZone:null==(o=t.request)?void 0:o.timezone})),l.alertStates||(this._dataWithFieldConfig.alertState=void 0),l.annotations||(this._dataWithFieldConfig.annotations=void 0),this._prevData=t,this._dataWithFieldConfig}buildPanelContext(){const t=Rf.findObject(this,(e=>e instanceof Hg));const r={eventsScope:t?t.getEventsScope():"__global_",eventBus:t?t.getEventsBus(this):(0,n.getAppEvents)(),app:e.CoreApp.Unknown,sync:()=>t?t.state.sync:e.DashboardCursorSync.Off,onSeriesColorChange:this._onSeriesColorChange,onToggleSeriesVisibility:this._onSeriesVisibilityChange,onToggleLegendSort:this._onToggleLegendSort,onInstanceStateChange:this._onInstanceStateChange};return this.state.extendPanelContext&&this.state.extendPanelContext(this,r),r}}My.Component=function({model:i}){var a;const{title:o,options:s,fieldConfig:l,_pluginLoadError:c,displayMode:u,hoverHeader:d,hoverHeaderOffset:p,menu:h,headerActions:f,titleItems:m,description:g}=i.useState(),[y,{width:b,height:v}]=Xg(),w=(0,Ei.useMemo)((()=>(0,n.getAppEvents)()),[]),S=(0,Ei.useCallback)((()=>w.publish(new e.SetPanelAttentionEvent({panelId:i.state.key}))),[i.state.key,w]),E=(0,Ei.useMemo)((()=>(0,ac.debounce)(S,100)),[S]),x=i.getPlugin(),{dragClass:_,dragClassCancel:O}=function(e){var t,n;const r=Rf.getLayout(e),i=null==r?void 0:r.isDraggable();return r&&i&&!function(e,t){let n=e.parent;for(;n&&n!==t;){if("isDraggable"in n.state&&!1===n.state.isDraggable)return!0;n=n.parent}return!1}(e,r)?{dragClass:null==(t=r.getDragClass)?void 0:t.call(r),dragClassCancel:null==(n=null==r?void 0:r.getDragClassCancel)?void 0:n.call(r)}:{dragClass:"",dragClassCancel:""}}(i),T=Rf.getData(i),C=T.useState(),k=i.applyFieldConfig(C.data),P=Rf.getTimeRange(i).getTimeZone(),A=i.getTimeRange(k),R=i.interpolate(o,void 0,"text"),D=(0,r.useStyles2)(ty);if(!x)return xi().createElement("div",null,"Loading plugin panel...");if(!x.panel)return xi().createElement("div",null,"Panel plugin has no panel component");const j=x.panel;T&&T.setContainerWidth&&T.setContainerWidth(Math.round(b));let I,N,L=[];m&&(Array.isArray(m)?L=L.concat(m.map((e=>xi().createElement(e.Component,{model:e,key:`${e.state.key}`})))):uf(m)?L.push(xi().createElement(m.Component,{model:m})):L.push(m)),i.state.$timeRange&&L.push(xi().createElement(i.state.$timeRange.Component,{model:i.state.$timeRange,key:i.state.key})),k.alertState&&L.push(xi().createElement(r.Tooltip,{content:null!=(a=k.alertState.state)?a:"unknown",key:`alert-states-icon-${i.state.key}`},xi().createElement(r.PanelChrome.TitleItem,{className:(0,t.cx)({[D.ok]:k.alertState.state===e.AlertState.OK,[D.pending]:k.alertState.state===e.AlertState.Pending,[D.alerting]:k.alertState.state===e.AlertState.Alerting})},xi().createElement(r.Icon,{name:"alerting"===k.alertState.state?"heart-break":"heart",className:"panel-alert-icon",size:"md"})))),h&&(I=xi().createElement(h.Component,{model:h})),f&&(N=Array.isArray(f)?xi().createElement(xi().Fragment,null,f.map((e=>xi().createElement(e.Component,{model:e,key:`${e.state.key}`})))):uf(f)?xi().createElement(f.Component,{model:f}):f);const M=k,F=!T.isDataReadyToDisplay||T.isDataReadyToDisplay(),$=i.getPanelContext(),B=i.getLegacyPanelId();return xi().createElement("div",{className:Zg},xi().createElement("div",{ref:y,className:ey,"data-viz-panel-key":i.state.key},b>0&&v>0&&xi().createElement(r.PanelChrome,{title:R,description:(null==g?void 0:g.trim())?i.getDescription:void 0,loadingState:M.state,statusMessage:Jg(M,c),statusMessageOnClick:i.onStatusMessageClick,width:b,height:v,displayMode:u,hoverHeader:d,hoverHeaderOffset:p,titleItems:L,dragClass:_,actions:N,dragClassCancel:O,padding:x.noPadding?"none":"md",menu:I,onCancelQuery:i.onCancelQuery,onFocus:S,onMouseMove:E},((t,n)=>xi().createElement(xi().Fragment,null,xi().createElement(r.ErrorBoundaryAlert,{dependencies:[x,M]},xi().createElement(e.PluginContextProvider,{meta:x.meta},xi().createElement(r.PanelContextProvider,{value:$},F&&xi().createElement(j,{id:B,data:M,title:o,timeRange:A,timeZone:P,options:s,fieldConfig:l,transparent:!1,width:t,height:n,renderCounter:0,replaceVariables:i.interpolate,onOptionsChange:i.onOptionsChange,onFieldConfigChange:i.onFieldConfigChange,onChangeTimeRange:i.onTimeRangeChange,eventBus:w})))))))))};const Fy=class extends Yp{constructor({enabled:e=!1}){super({enabled:e}),this.timerId=void 0,this._activationHandler=()=>(this.state.enabled&&this.enable(),()=>{window.clearInterval(this.timerId),this.timerId=void 0}),this.addActivationHandler(this._activationHandler)}enable(){window.clearInterval(this.timerId),this.timerId=void 0,this.timerId=window.setInterval((()=>{const e=Rf.findAllObjects(this.getRoot(),(e=>e instanceof My));for(const t of e)t.forceRender()}),Fy.REFRESH_RATE),this.setState({enabled:!0})}disable(){window.clearInterval(this.timerId),this.timerId=void 0,this.setState({enabled:!1})}get isEnabled(){return this.state.enabled}};let $y=Fy;function By(e){if("string"==typeof e)return e;if(e){if(e instanceof Error)return e.message;if((0,n.isFetchError)(e)){if(e.data&&e.data.message)return e.data.message;if(e.statusText)return e.statusText}else if(e.hasOwnProperty("message"))return e.message}return JSON.stringify(e)}$y.REFRESH_RATE=100;var Vy=Object.defineProperty,zy=Object.getOwnPropertySymbols,Uy=Object.prototype.hasOwnProperty,qy=Object.prototype.propertyIsEnumerable,Hy=(e,t,n)=>t in e?Vy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Gy extends Yp{constructor(e,t=[]){super(((e,t)=>{for(var n in t||(t={}))Uy.call(t,n)&&Hy(e,n,t[n]);if(zy)for(var n of zy(t))qy.call(t,n)&&Hy(e,n,t[n]);return e})({isEnabled:!0},e)),this._results=new xp.ReplaySubject(1),this.isDataLayer=!0,this._variableValueRecorder=new Nf,this._variableDependency=new If(this,{onVariableUpdateCompleted:this.onVariableUpdateCompleted.bind(this)}),this._variableDependency.setPaths(t),this.addActivationHandler((()=>this.onActivate()))}onActivate(){return this.state.isEnabled&&this.onEnable(),this.shouldRunLayerOnActivate()&&this.runLayer(),this.subscribeToState(((e,t)=>{!e.isEnabled&&this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0,this.onDisable(),this._results.next({origin:this,data:kh}),this.setStateHelper({data:kh})),e.isEnabled&&!t.isEnabled&&(this.onEnable(),this.runLayer())})),()=>{this.onDeactivate()}}onDeactivate(){this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0),this.onDisable(),this._variableValueRecorder.recordCurrentDependencyValuesForSceneObject(this)}onVariableUpdateCompleted(){this.runLayer()}cancelQuery(){this.querySub&&(this.querySub.unsubscribe(),this.querySub=void 0,this.publishResults(kh))}publishResults(e){this.state.isEnabled&&(this._results.next({origin:this,data:e}),this.setStateHelper({data:e}))}getResultsStream(){return this._results}shouldRunLayerOnActivate(){return this._variableValueRecorder.hasDependenciesChanged(this)?(jf("SceneDataLayerBase","Variable dependency changed while inactive, shouldRunLayerOnActivate returns true"),!0):!this.state.data}setStateHelper(e){am(this,e)}}function Wy({layer:e}){var t,n;const i=`data-layer-${e.state.key}`,{data:a,isEnabled:o}=e.useState(),s=Boolean(a&&a.state===Eh.Loading);return xi().createElement("div",{className:Qy},xi().createElement($m,{htmlFor:i,isLoading:s,onCancel:()=>{var t;return null==(t=e.cancelQuery)?void 0:t.call(e)},label:e.state.name,description:e.state.description,error:null==(n=null==(t=e.state.data)?void 0:t.errors)?void 0:n[0].message}),xi().createElement(r.InlineSwitch,{id:i,value:o,onChange:()=>e.setState({isEnabled:!o})}))}(class extends Yp{constructor(){super({})}}).Component=function({model:e}){const t=Rf.getDataLayers(e,!0);return 0===t.length?null:xi().createElement(xi().Fragment,null,t.map((e=>xi().createElement(e.Component,{model:e,key:e.state.key}))))};const Qy=(0,t.css)({display:"flex"});function Ky(e){return"function"==typeof e}function Yy(e){return function(t){if(function(e){return Ky(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var Xy,Jy,Zy=__webpack_require__(4629),eb=(Xy=function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}},(Jy=Xy((function(e){Error.call(e),e.stack=(new Error).stack}))).prototype=Object.create(Error.prototype),Jy.prototype.constructor=Jy,Jy);function tb(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var nb=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=(0,Zy.__values)(a),s=o.next();!s.done;s=o.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var l=this.initialTeardown;if(Ky(l))try{l()}catch(e){i=e instanceof eb?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=(0,Zy.__values)(c),d=u.next();!d.done;d=u.next()){var p=d.value;try{ib(p)}catch(e){i=null!=i?i:[],e instanceof eb?i=(0,Zy.__spreadArray)((0,Zy.__spreadArray)([],(0,Zy.__read)(i)),(0,Zy.__read)(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}if(i)throw new eb(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)ib(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&tb(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&tb(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function rb(e){return e instanceof nb||e&&"closed"in e&&Ky(e.remove)&&Ky(e.add)&&Ky(e.unsubscribe)}function ib(e){Ky(e)?e():e.unsubscribe()}nb.EMPTY;var ab={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ob={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=ob.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,(0,Zy.__spreadArray)([e,t],(0,Zy.__read)(n))):setTimeout.apply(void 0,(0,Zy.__spreadArray)([e,t],(0,Zy.__read)(n)))},clearTimeout:function(e){var t=ob.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function sb(e){ob.setTimeout((function(){var t=ab.onUnhandledError;if(!t)throw e;t(e)}))}function lb(){}var cb=ub("C",void 0,void 0);function ub(e,t,n){return{kind:e,value:t,error:n}}var db=null,pb=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,rb(t)&&t.add(n)):n.destination=vb,n}return(0,Zy.__extends)(t,e),t.create=function(e,t,n){return new gb(e,t,n)},t.prototype.next=function(e){this.isStopped?bb(function(e){return ub("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?bb(ub("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?bb(cb,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(nb),hb=Function.prototype.bind;function fb(e,t){return hb.call(e,t)}var mb=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){yb(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){yb(e)}else yb(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){yb(e)}},e}(),gb=function(e){function t(t,n,r){var i,a,o=e.call(this)||this;return Ky(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:o&&ab.useDeprecatedNextContext?((a=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},i={next:t.next&&fb(t.next,a),error:t.error&&fb(t.error,a),complete:t.complete&&fb(t.complete,a)}):i=t,o.destination=new mb(i),o}return(0,Zy.__extends)(t,e),t}(pb);function yb(e){ab.useDeprecatedSynchronousErrorHandling?function(e){ab.useDeprecatedSynchronousErrorHandling&&db&&(db.errorThrown=!0,db.error=e)}(e):sb(e)}function bb(e,t){var n=ab.onStoppedNotification;n&&ob.setTimeout((function(){return n(e,t)}))}var vb={closed:!0,next:lb,error:function(e){throw e},complete:lb};function wb(e,t,n,r,i){return new Sb(e,t,n,r,i)}var Sb=function(e){function t(t,n,r,i,a,o){var s=e.call(this,t)||this;return s.onFinalize=a,s.shouldUnsubscribe=o,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return(0,Zy.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(pb);function Eb(e,t){return Yy((function(n,r){var i=0;n.subscribe(wb(r,(function(n){r.next(e.call(t,n,i++))})))}))}var xb=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e},_b="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ob(e){return e}var Tb=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,a=(r=e)&&r instanceof pb||function(e){return e&&Ky(e.next)&&Ky(e.error)&&Ky(e.complete)}(r)&&rb(r)?e:new gb(e,t,n);return function(e){if(ab.useDeprecatedSynchronousErrorHandling){var t=!db;if(t&&(db={errorThrown:!1,error:null}),e(),t){var n=db,r=n.errorThrown,i=n.error;if(db=null,r)throw i}}else e()}((function(){var e=i,t=e.operator,n=e.source;a.add(t?t.call(a,n):n?i._subscribe(a):i._trySubscribe(a))})),a},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=Cb(t))((function(t,r){var i=new gb({next:function(t){try{e(t)}catch(e){r(e),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[_b]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0===(n=e).length?Ob:1===n.length?n[0]:function(e){return n.reduce((function(e,t){return t(e)}),e)})(this);var n},e.prototype.toPromise=function(e){var t=this;return new(e=Cb(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function Cb(e){var t;return null!==(t=null!=e?e:ab.Promise)&&void 0!==t?t:Promise}var kb="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Pb(e){if(e instanceof Tb)return e;if(null!=e){if(function(e){return Ky(e[_b])}(e))return a=e,new Tb((function(e){var t=a[_b]();if(Ky(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if(xb(e))return i=e,new Tb((function(e){for(var t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()}));if(Ky(null==(r=e)?void 0:r.then))return n=e,new Tb((function(e){n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,sb)}));if(function(e){return Symbol.asyncIterator&&Ky(null==e?void 0:e[Symbol.asyncIterator])}(e))return Ab(e);if(function(e){return Ky(null==e?void 0:e[kb])}(e))return t=e,new Tb((function(e){var n,r;try{for(var i=(0,Zy.__values)(t),a=i.next();!a.done;a=i.next()){var o=a.value;if(e.next(o),e.closed)return}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()}));if(function(e){return Ky(null==e?void 0:e.getReader)}(e))return Ab(function(e){return(0,Zy.__asyncGenerator)(this,arguments,(function(){var t,n,r;return(0,Zy.__generator)(this,(function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,(0,Zy.__await)(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,(0,Zy.__await)(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,(0,Zy.__await)(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e))}var t,n,r,i,a;throw function(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}(e)}function Ab(e){return new Tb((function(t){(function(e,t){var n,r,i,a;return(0,Zy.__awaiter)(this,void 0,void 0,(function(){var o,s;return(0,Zy.__generator)(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=(0,Zy.__asyncValues)(e),l.label=1;case 1:return[4,n.next()];case 2:if((r=l.sent()).done)return[3,4];if(o=r.value,t.next(o),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=l.sent(),i={error:s},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(a=n.return)?[4,a.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}function Rb(e,t,n){return void 0===n&&(n=1/0),Ky(t)?Rb((function(n,r){return Eb((function(e,i){return t(n,e,r,i)}))(Pb(e(n,r)))}),n):("number"==typeof t&&(n=t),Yy((function(t,r){return function(e,t,n,r,i,a,o,s){var l=[],c=0,u=0,d=!1,p=function(){!d||l.length||c||t.complete()},h=function(e){return c<r?f(e):l.push(e)},f=function(e){c++;var i=!1;Pb(n(e,u++)).subscribe(wb(t,(function(e){t.next(e)}),(function(){i=!0}),void 0,(function(){if(i)try{c--;for(var e=function(){var e=l.shift();f(e)};l.length&&c<r;)e();p()}catch(e){t.error(e)}})))};return e.subscribe(wb(t,h,(function(){d=!0,p()}))),function(){}}(t,r,e,n)})))}var Db=Object.defineProperty,jb=Object.defineProperties,Ib=Object.getOwnPropertyDescriptors,Nb=Object.getOwnPropertySymbols,Lb=Object.prototype.hasOwnProperty,Mb=Object.prototype.propertyIsEnumerable,Fb=(e,t,n)=>t in e?Db(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const $b={prepareAnnotation:e=>{if((0,ac.isString)(null==e?void 0:e.query)){const t=e,{query:n}=t;return((e,t)=>jb(e,Ib(t)))(((e,t)=>{for(var n in t||(t={}))Lb.call(t,n)&&Fb(e,n,t[n]);if(Nb)for(var n of Nb(t))Mb.call(t,n)&&Fb(e,n,t[n]);return e})({},((e,t)=>{var n={};for(var r in e)Lb.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Nb)for(var r of Nb(e))t.indexOf(r)<0&&Mb.call(e,r)&&(n[r]=e[r]);return n})(t,["query"])),{target:{refId:"annotation_query",query:n},mappings:{}})}return e},prepareQuery:e=>e.target,processEvents:(t,n)=>function(t,n){return(0,xp.of)(t).pipe((t=>t.pipe(Rb((t=>{if(!(null==t?void 0:t.length))return(0,xp.of)(void 0);if(1===t.length)return(0,xp.of)(t[0]);return(0,xp.of)(t).pipe(e.standardTransformers.mergeTransformer.operator({},{interpolate:e=>e}),Eb((e=>e[0])))})))),Eb((t=>{if(!(null==t?void 0:t.length))return[];let r=!1,i=!1;const a={};for(const n of t.fields)a[(0,e.getFieldDisplayName)(n,t).toLowerCase()]=n;n||(n={});const o=[];for(const s of Vb){const l=n[s.key]||{};if(l.source===e.AnnotationEventFieldSource.Skip)continue;const c={key:s.key,split:s.split};if(l.source===e.AnnotationEventFieldSource.Text)c.text=l.value;else{const e=(l.value||s.key).toLowerCase();c.field=a[e],!c.field&&s.field&&(c.field=s.field(t))}(c.field||c.text)&&(o.push(c),"time"===c.key?r=!0:"text"===c.key&&(i=!0))}if(!r||!i)return console.error("Cannot process annotation fields. No time or text present."),[];const s=[];for(let e=0;e<t.length;e++){const t={type:"default",color:"red"};for(const n of o){let r;if(n.text)r=n.text;else if(n.field&&(r=n.field.values.get(e),void 0!==r&&n.regex)){const e=n.regex.exec(r);e&&(r=e[1]?e[1]:e[0])}null!=r&&(n.split&&"string"==typeof r&&(r=r.split(",")),t[n.key]=r)}s.push(t)}return s})))}(n,t.mappings)},Bb=[{key:"time",field:t=>t.fields.find((t=>t.type===e.FieldType.time)),placeholder:"time, or the first time field"},{key:"timeEnd",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:t=>t.fields.find((t=>t.type===e.FieldType.string)),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],Vb=[...n.config.publicDashboardAccessToken?[{key:"color"},{key:"isRegion"},{key:"source"}]:[],...Bb,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}],zb=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];var Ub=Object.defineProperty,qb=Object.defineProperties,Hb=Object.getOwnPropertyDescriptors,Gb=Object.getOwnPropertySymbols,Wb=Object.prototype.hasOwnProperty,Qb=Object.prototype.propertyIsEnumerable,Kb=(e,t,n)=>t in e?Ub(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Yb=(e,t)=>{for(var n in t||(t={}))Wb.call(t,n)&&Kb(e,n,t[n]);if(Gb)for(var n of Gb(t))Qb.call(t,n)&&Kb(e,n,t[n]);return e},Xb=(e,t)=>qb(e,Hb(t));let Jb=100;var Zb=Object.defineProperty,ev=Object.getOwnPropertySymbols,tv=Object.prototype.hasOwnProperty,nv=Object.prototype.propertyIsEnumerable,rv=(e,t,n)=>t in e?Zb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function iv(e){return"panel-alert"===e.eventType}var av=Object.defineProperty,ov=Object.defineProperties,sv=Object.getOwnPropertyDescriptors,lv=Object.getOwnPropertySymbols,cv=Object.prototype.hasOwnProperty,uv=Object.prototype.propertyIsEnumerable,dv=(e,t,n)=>t in e?av(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pv=(e,t)=>{for(var n in t||(t={}))cv.call(t,n)&&dv(e,n,t[n]);if(lv)for(var n of lv(t))uv.call(t,n)&&dv(e,n,t[n]);return e},hv=(e,t)=>ov(e,sv(t));(class extends Gy{constructor(e){super(pv({isEnabled:!0},e),["query"]),this._scopedVars={__sceneObject:{value:this,text:"__sceneObject"}}}onEnable(){const e=Rf.getTimeRange(this);this._timeRangeSub=e.subscribeToState((()=>{this.runWithTimeRange(e)}))}onDisable(){var e;null==(e=this._timeRangeSub)||e.unsubscribe()}runLayer(){jf("AnnotationsDataLayer","run layer");const e=Rf.getTimeRange(this);this.runWithTimeRange(e)}async runWithTimeRange(t){const{query:r}=this.state;if(this.querySub&&this.querySub.unsubscribe(),this._variableDependency.hasDependencyInLoadingState())jf("AnnotationsDataLayer","Variable dependency is in loading state, skipping query execution");else try{let i=function(t,r,i,a){var o;if(t.annotationQuery&&function(e){const{type:t}=e;return!e.annotations||zb.includes(t)}(t))return console.warn("Using deprecated annotationQuery method, please upgrade your datasource"),(0,xp.from)(t.annotationQuery({range:r.state.value,rangeRaw:r.state.value.raw,annotation:i,dashboard:{}})).pipe(Eb((e=>({state:Eh.Done,events:e}))));const s=Yb(Yb({},$b),t.annotations),l=Yb(Yb({},null==(o=s.getDefaultQuery)?void 0:o.call(s)),i),c=s.prepareAnnotation(l);if(!c)return(0,xp.of)({state:Eh.Done,events:[]});const u=s.prepareQuery(c);if(!u)return(0,xp.of)({state:Eh.Done,events:[]});const d=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,p=e.rangeUtil.calculateInterval(r.state.value,d,t.interval),h={__interval:{text:p.interval,value:p.interval},__interval_ms:{text:p.intervalMs.toString(),value:p.intervalMs},__annotation:{text:c.name,value:c},__sceneObject:{text:"__sceneObject",value:a}},f=Yb(Xb(Yb({startTime:Date.now(),requestId:"AQ"+Jb++,range:r.state.value,maxDataPoints:d,scopedVars:h},p),{app:e.CoreApp.Dashboard,timezone:r.getTimeZone(),targets:[Xb(Yb({},u),{refId:"Anno"})]}),em(a));return(0,n.getRunRequest)()(t,f).pipe(Rb((t=>{const n=(null==t?void 0:t.series.length)?t.series:t.annotations;return(null==n?void 0:n.length)?(n.forEach((t=>{var n;(null==(n=t.meta)?void 0:n.dataTopic)||(t.meta=Xb(Yb({},t.meta||{}),{dataTopic:e.DataTopic.Annotations}))})),s.processEvents(c,n).pipe(Eb((e=>({state:t.state,events:e||[]}))))):(0,xp.of)({state:t.state,events:[]})})))}(await this.resolveDataSource(r),t,r,this).pipe(rm({type:"annotations",origin:this,cancel:()=>this.cancelQuery()}),(0,xp.map)((e=>this.processEvents(r,e))));this.querySub=i.subscribe((e=>{this.publishResults(e)}))}catch(e){this.publishResults(hv(pv({},kh),{state:Eh.Error,errors:[{message:By(e)}]})),console.error("AnnotationsDataLayer error",e)}}async resolveDataSource(e){return await Df(e.datasource||void 0,this._scopedVars)}processEvents(t,r){let i=function(e,t){e.snapshotData&&delete(e=(0,ac.cloneDeep)(e)).snapshotData;const r=t.map((t=>{var r;const i=((e,t)=>{for(var n in t||(t={}))tv.call(t,n)&&rv(e,n,t[n]);if(ev)for(var n of ev(t))nv.call(t,n)&&rv(e,n,t[n]);return e})({},t);switch(i.source=e,i.color=n.config.theme2.visualization.getColorByName(e.iconColor),i.type=e.name,i.isRegion=Boolean(i.timeEnd&&i.time!==i.timeEnd),null==(r=i.newState)?void 0:r.toLowerCase()){case"pending":i.color="yellow";break;case"alerting":i.color="red";break;case"ok":case"normal":i.color="green";break;case"no_data":case"nodata":i.color="gray"}return i}));return r}(t,r.events||[]);i=function(e){let t=[];const n=(0,ac.partition)(e,"id"),r=(0,ac.groupBy)(n[0],"id");return t=(0,ac.map)(r,(e=>e.length>1&&!(0,ac.every)(e,iv)?(0,ac.find)(e,(e=>"panel-alert"!==e.eventType)):(0,ac.head)(e))),t=(0,ac.concat)(t,n[1]),t}(i);const a=hv(pv({},kh),{state:r.state}),o=(0,e.arrayToDataFrame)(i);return o.meta=hv(pv({},o.meta),{dataTopic:e.DataTopic.Annotations}),a.series=[o],a}}).Component=function({model:e}){const{isHidden:t}=e.useState();return t?null:xi().createElement(Wy,{layer:e})},Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var fv=Object.defineProperty,mv=Object.defineProperties,gv=Object.getOwnPropertyDescriptors,yv=Object.getOwnPropertySymbols,bv=Object.prototype.hasOwnProperty,vv=Object.prototype.propertyIsEnumerable,wv=(e,t,n)=>t in e?fv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Sv extends Yp{constructor(){super(...arguments),this.isDataLayer=!0,this._results=new xp.ReplaySubject(1),this._dataLayersMerger=new dg}subscribeToAllLayers(e){e.length>0?this.querySub=this._dataLayersMerger.getMergedStream(e).subscribe(this._onLayerUpdateReceived.bind(this)):(this._results.next({origin:this,data:kh}),this.setStateHelper({data:kh}))}_onLayerUpdateReceived(e){var t;let n=[];for(const r of e)(null==(t=r.data)?void 0:t.series)&&(n=n.concat(r.data.series));const r=((e,t)=>mv(e,gv(t)))(((e,t)=>{for(var n in t||(t={}))bv.call(t,n)&&wv(e,n,t[n]);if(yv)for(var n of yv(t))vv.call(t,n)&&wv(e,n,t[n]);return e})({},kh),{series:n});this._results.next({origin:this,data:r}),this.setStateHelper({data:r})}getResultsStream(){return this._results}cancelQuery(){var e;null==(e=this.querySub)||e.unsubscribe()}setStateHelper(e){am(this,e)}}class Ev extends Sv{constructor(e){var t,n;super({name:null!=(t=e.name)?t:"Data layers",layers:null!=(n=e.layers)?n:[]}),this.addActivationHandler((()=>this._onActivate()))}_onActivate(){return this._subs.add(this.subscribeToState(((e,t)=>{var n;e.layers!==t.layers&&(null==(n=this.querySub)||n.unsubscribe(),this.subscribeToAllLayers(e.layers))}))),this.subscribeToAllLayers(this.state.layers),()=>{var e;null==(e=this.querySub)||e.unsubscribe()}}}Ev.Component=({model:e})=>{const{layers:t}=e.useState();return xi().createElement(xi().Fragment,null,t.map((e=>xi().createElement(e.Component,{model:e,key:e.state.key}))))};var xv=Object.defineProperty,_v=Object.defineProperties,Ov=Object.getOwnPropertyDescriptors,Tv=Object.getOwnPropertySymbols,Cv=Object.prototype.hasOwnProperty,kv=Object.prototype.propertyIsEnumerable,Pv=(e,t,n)=>t in e?xv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Av=(e,t)=>{for(var n in t||(t={}))Cv.call(t,n)&&Pv(e,n,t[n]);if(Tv)for(var n of Tv(t))kv.call(t,n)&&Pv(e,n,t[n]);return e},Rv=(e,t)=>_v(e,Ov(t));class Dv extends Yp{constructor(e){super(e),this._results=new xp.ReplaySubject(1),this._variableDependency=new If(this,{statePaths:["transformations"],onReferencedVariableValueChanged:()=>this.reprocessTransformations()}),this.addActivationHandler((()=>this.activationHandler()))}activationHandler(){const e=this.getSourceData();return this._subs.add(e.subscribeToState((e=>this.transform(e.data)))),e.state.data&&this.transform(e.state.data),()=>{this._transformSub&&this._transformSub.unsubscribe()}}getSourceData(){if(this.state.$data){if(this.state.$data instanceof Ev)throw new Error("SceneDataLayerSet can not be used as data provider for SceneDataTransformer.");return this.state.$data}if(!this.parent||!this.parent.parent)throw new Error("SceneDataTransformer must either have $data set on it or have a parent.parent with $data");return Rf.getData(this.parent.parent)}setContainerWidth(e){this.state.$data&&this.state.$data.setContainerWidth&&this.state.$data.setContainerWidth(e)}isDataReadyToDisplay(){const e=this.getSourceData();return!e.isDataReadyToDisplay||e.isDataReadyToDisplay()}reprocessTransformations(){this.transform(this.getSourceData().state.data,!0)}cancelQuery(){var e,t;null==(t=(e=this.getSourceData()).cancelQuery)||t.call(e)}getResultsStream(){return this._results}clone(e){const t=super.clone(e);return this._prevDataFromSource&&(t._prevDataFromSource=this._prevDataFromSource),t}haveAlreadyTransformedData(e){if(!this._prevDataFromSource)return!1;if(e===this._prevDataFromSource)return!0;const{series:t,annotations:n}=this._prevDataFromSource;return e.series===t&&e.annotations===n&&(this.state.data&&e.state!==this.state.data.state&&this.setState({data:Rv(Av({},this.state.data),{state:e.state})}),!0)}transform(t,r=!1){var i;if(0===this.state.transformations.length||!t)return this._prevDataFromSource=t,this.setState({data:t}),void(t&&this._results.next({origin:this,data:t}));if(!r&&this.haveAlreadyTransformedData(t))return;const a=this.state.transformations.filter((t=>!("options"in t)&&!("topic"in t)||null==t.topic||t.topic===e.DataTopic.Series)).map((e=>"operator"in e?e.operator:e)),o=this.state.transformations.filter((t=>("options"in t||"topic"in t)&&t.topic===e.DataTopic.Annotations)).map((e=>"operator"in e?e.operator:e));this._transformSub&&this._transformSub.unsubscribe();const s={interpolate:e=>{var n;return Rf.interpolate(this,e,null==(n=t.request)?void 0:n.scopedVars)}};let l=[(0,e.transformDataFrame)(a,t.series,s)];t.annotations&&t.annotations.length>0&&o.length>0&&l.push((0,e.transformDataFrame)(o,null!=(i=t.annotations)?i:[])),this._transformSub=(0,xp.forkJoin)(l).pipe((0,xp.map)((e=>{const n=e[0],r=e[1];return Rv(Av({},t),{series:n,annotations:null!=r?r:t.annotations})})),(0,xp.catchError)((r=>{var i;console.error("Error transforming data: ",r);const a=(null==(i=this.getSourceData().state.data)?void 0:i.errors)||[],o=(0,n.toDataQueryError)(r);o.message=`Error transforming data: ${o.message}`;const s=Rv(Av({},t),{state:e.LoadingState.Error,errors:[...a,o]});return(0,xp.of)(s)}))).subscribe((e=>{this.setState({data:e}),this._results.next({origin:this,data:e}),this._prevDataFromSource=t}))}}function jv({variable:t,layout:n,showAlways:r,hideLabel:i}){return Xp(t,{shouldActivateOrKeepAlive:!0}).hide!==e.VariableHide.hideVariable||r?"vertical"===n?xi().createElement("div",{className:Lv,"data-testid":dm.pages.Dashboard.SubMenu.submenuItem},xi().createElement(Iv,{variable:t,layout:n,hideLabel:i}),xi().createElement(t.Component,{model:t})):xi().createElement("div",{className:Nv,"data-testid":dm.pages.Dashboard.SubMenu.submenuItem},xi().createElement(Iv,{variable:t,hideLabel:i}),xi().createElement(t.Component,{model:t})):null}function Iv({variable:t,layout:n,hideLabel:r}){var i,a;const{state:o}=t;if(t.state.hide===e.VariableHide.hideLabel||r)return null;const s=`var-${o.key}`,l=null!=(i=o.label)?i:o.name;return xi().createElement($m,{htmlFor:s,isLoading:o.loading,onCancel:()=>{var e;return null==(e=t.onCancel)?void 0:e.call(t)},label:l,error:o.error,layout:n,description:null!=(a=o.description)?a:void 0})}(class extends Yp{}).Component=function({model:e}){const t=Rf.getVariables(e).useState();return xi().createElement(xi().Fragment,null,t.variables.map((t=>xi().createElement(jv,{key:t.state.key,variable:t,layout:e.state.layout}))))};const Nv=(0,t.css)({display:"flex"}),Lv=(0,t.css)({display:"flex",flexDirection:"column"});(class extends Yp{}).Component=function({model:e}){const t=Rf.lookupVariable(e.state.variableName,e);return t?xi().createElement(jv,{key:t.state.key,variable:t,layout:e.state.layout,showAlways:!0}):null};class Mv extends Yp{constructor(e){super(e),this._variablesThatHaveChanged=new Set,this._variablesToUpdate=new Set,this._updating=new Map,this._variableValueRecorder=new Nf,this._variableDependency=new $v(this._handleParentVariableUpdatesCompleted.bind(this)),this._onActivate=()=>{const e=Rf.getTimeRange(this);this._subs.add(this.subscribeToEvent(Uh,(e=>this._handleVariableValueChanged(e.payload)))),this._subs.add(e.subscribeToState((()=>{this._refreshTimeRangeBasedVariables()}))),this._subs.add(this.subscribeToState(this._onStateChanged)),this._checkForVariablesThatChangedWhileInactive();for(const e of this.state.variables)this._variableNeedsUpdate(e)&&this._variablesToUpdate.add(e);return this._updateNextBatch(),this._onDeactivate},this._onDeactivate=()=>{var e;for(const t of this._updating.values())null==(e=t.subscription)||e.unsubscribe();for(const e of this.state.variables)this._variablesToUpdate.has(e)||this._updating.has(e)||this._variableValueRecorder.recordCurrentValue(e);this._variablesToUpdate.clear(),this._updating.clear()},this._onStateChanged=(e,t)=>{const n=this._variablesToUpdate.size;for(const n of t.variables)if(!e.variables.includes(n)){const e=this._updating.get(n);(null==e?void 0:e.subscription)&&e.subscription.unsubscribe(),this._updating.delete(n),this._variablesToUpdate.delete(n)}for(const n of e.variables)t.variables.includes(n)||this._variableNeedsUpdate(n)&&this._variablesToUpdate.add(n);0===n&&this._variablesToUpdate.size>0&&this._updateNextBatch()},this.addActivationHandler(this._onActivate)}getByName(e){return this.state.variables.find((t=>t.state.name===e))}_refreshTimeRangeBasedVariables(){for(const t of this.state.variables)"refresh"in t.state&&t.state.refresh===e.VariableRefresh.onTimeRangeChanged&&this._variablesToUpdate.add(t);this._updateNextBatch()}_checkForVariablesThatChangedWhileInactive(){if(this._variableValueRecorder.hasValues())for(const e of this.state.variables)this._variableValueRecorder.hasValueChanged(e)&&(Fv(e,"Changed while in-active"),this._addDependentVariablesToUpdateQueue(e))}_variableNeedsUpdate(e){return!(e.isLazy||!e.validateAndUpdate||this._variableValueRecorder.hasRecordedValue(e)&&(Fv(e,"Skipping updateAndValidate current value valid"),1))}_updateNextBatch(){for(const e of this._variablesToUpdate){if(!e.validateAndUpdate)throw new Error("Variable added to variablesToUpdate but does not have validateAndUpdate");if(this._updating.has(e))continue;if(Rf.hasVariableDependencyInLoadingState(e))continue;const t={variable:e};this._updating.set(e,t),Fv(e,"updateAndValidate started"),t.subscription=e.validateAndUpdate().subscribe({next:()=>this._validateAndUpdateCompleted(e),complete:()=>this._validateAndUpdateCompleted(e),error:t=>this._handleVariableError(e,t)})}}_validateAndUpdateCompleted(e){var t;if(!this._updating.has(e))return;const n=this._updating.get(e);null==(t=null==n?void 0:n.subscription)||t.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e),Fv(e,"updateAndValidate completed"),this._notifyDependentSceneObjects(e),this._updateNextBatch()}cancel(e){var t;const n=this._updating.get(e);null==(t=null==n?void 0:n.subscription)||t.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e)}_handleVariableError(e,t){var n;const r=this._updating.get(e);null==(n=null==r?void 0:r.subscription)||n.unsubscribe(),this._updating.delete(e),this._variablesToUpdate.delete(e),e.setState({loading:!1,error:t.message}),console.error("SceneVariableSet updateAndValidate error",t),Fv(e,"updateAndValidate error",t)}_handleVariableValueChanged(e){this._variablesThatHaveChanged.add(e),this._addDependentVariablesToUpdateQueue(e),this._updating.has(e)||(this._updateNextBatch(),this._notifyDependentSceneObjects(e))}_handleParentVariableUpdatesCompleted(e,t){t&&this._addDependentVariablesToUpdateQueue(e),this._variablesToUpdate.size>0&&0===this._updating.size&&this._updateNextBatch()}_addDependentVariablesToUpdateQueue(e){for(const t of this.state.variables)t.variableDependency&&t.variableDependency.hasDependencyOn(e.state.name)&&(Fv(t,"Added to update queue, dependant variable value changed"),this._updating.has(t)&&t.onCancel&&t.onCancel(),this._variablesToUpdate.add(t))}_notifyDependentSceneObjects(e){this.parent&&(this._traverseSceneAndNotify(this.parent,e,this._variablesThatHaveChanged.has(e)),this._variablesThatHaveChanged.delete(e))}_traverseSceneAndNotify(e,t,n){if(this!==e&&e.isActive){if(e.state.$variables&&e.state.$variables!==this&&e.state.$variables.getByName(t.state.name))return;e.variableDependency&&e.variableDependency.variableUpdateCompleted(t,n),e.forEachChild((e=>this._traverseSceneAndNotify(e,t,n)))}}isVariableLoadingOrWaitingToUpdate(e){return!(!e.isAncestorLoading||!e.isAncestorLoading())||!(!this._variablesToUpdate.has(e)&&!this._updating.has(e))||Rf.hasVariableDependencyInLoadingState(e)}}function Fv(e,t,n){n?jf("SceneVariableSet",`Variable[${e.state.name}]: ${t}`,n):jf("SceneVariableSet",`Variable[${e.state.name}]: ${t}`)}class $v{constructor(e){this._variableUpdatesCompleted=e,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(e){return!1}variableUpdateCompleted(e,t){this._variableUpdatesCompleted(e,t)}}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var Bv=Object.defineProperty,Vv=Object.getOwnPropertySymbols,zv=Object.prototype.hasOwnProperty,Uv=Object.prototype.propertyIsEnumerable,qv=(e,t,n)=>t in e?Bv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;(class extends om{constructor(e){super(((e,t)=>{for(var n in t||(t={}))zv.call(t,n)&&qv(e,n,t[n]);if(Vv)for(var n of Vv(t))Uv.call(t,n)&&qv(e,n,t[n]);return e})({type:"custom",query:"",value:"",text:"",options:[],name:""},e)),this._variableDependency=new If(this,{statePaths:["query"]})}getValueOptions(e){var t;const n=(null!=(t=Rf.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g))?t:[]).map((e=>{var t;e=e.replace(/\\,/g,",");const n=null!=(t=/^(.+)\s:\s(.+)$/g.exec(e))?t:[];if(3===n.length){const[,e,t]=n;return{label:e.trim(),value:t.trim()}}return{label:e.trim(),value:e.trim()}}));return(0,xp.of)(n)}}).Component=({model:e})=>Om(e);var Hv=Object.defineProperty,Gv=Object.getOwnPropertySymbols,Wv=Object.prototype.hasOwnProperty,Qv=Object.prototype.propertyIsEnumerable,Kv=(e,t,n)=>t in e?Hv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Yv extends om{constructor(e){super(((e,t)=>{for(var n in t||(t={}))Wv.call(t,n)&&Kv(e,n,t[n]);if(Gv)for(var n of Gv(t))Qv.call(t,n)&&Kv(e,n,t[n]);return e})({type:"datasource",value:"",text:"",options:[],name:"",regex:"",pluginId:""},e)),this._variableDependency=new If(this,{statePaths:["regex"]})}getValueOptions(t){if(!this.state.pluginId)return(0,xp.of)([]);const r=(0,n.getDataSourceSrv)().getList({metrics:!0,variables:!1,pluginId:this.state.pluginId});let i;if(this.state.regex){const t=Rf.interpolate(this,this.state.regex,void 0,"regex");i=(0,e.stringToJsRegex)(t)}const a=[];for(let e=0;e<r.length;e++){const t=r[e];Xv(t,i)&&a.push({label:t.name,value:t.uid}),this.state.defaultOptionEnabled&&Jv(t,i)&&a.push({label:"default",value:"default"})}return 0===a.length?this.setState({error:"No data sources found"}):this.state.error&&this.setState({error:null}),(0,xp.of)(a)}}function Xv(e,t){return!t||t.exec(e.name)}function Jv(e,t){return!!e.isDefault&&(!t||t.exec("default"))}Yv.Component=({model:e})=>Om(e);const Zv=e=>Boolean(e.metricFindQuery)&&!Boolean(e.variables),ew=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Standard)return!1;const n=t.variables;return"toDataQuery"in n&&Boolean(n.toDataQuery)},tw=t=>{if(!t.variables)return!1;if(t.variables.getType()!==e.VariableSupportType.Custom)return!1;const n=t.variables;return"query"in n&&"editor"in n&&Boolean(n.query)&&Boolean(n.editor)};var nw=Object.defineProperty,rw=Object.defineProperties,iw=Object.getOwnPropertyDescriptors,aw=Object.getOwnPropertySymbols,ow=Object.prototype.hasOwnProperty,sw=Object.prototype.propertyIsEnumerable,lw=(e,t,n)=>t in e?nw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,cw=(e,t)=>{for(var n in t||(t={}))ow.call(t,n)&&lw(e,n,t[n]);if(aw)for(var n of aw(t))sw.call(t,n)&&lw(e,n,t[n]);return e},uw=(e,t)=>rw(e,iw(t));class dw{constructor(e,t=(0,n.getRunRequest)()){this.datasource=e,this._runRequest=t}getTarget(e){if(ew(this.datasource))return this.datasource.variables.toDataQuery(function(e){var t;const n=null!=(t=e.state.query)?t:"";return"string"==typeof n?{query:n,refId:`variable-${e.state.name}`}:null==n.refId?uw(cw({},n),{refId:`variable-${e.state.name}`}):e.state.query}(e));throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return ew(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):fw()}}class pw{constructor(e){this.datasource=e}getTarget(e){if(Zv(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({variable:t,searchFilter:n},r){return Zv(this.datasource)?(0,xp.from)(this.datasource.metricFindQuery(t.state.query,uw(cw({},r),{variable:{name:t.state.name,type:t.state.type},searchFilter:n}))).pipe((0,xp.mergeMap)((t=>{if(!t||!t.length)return fw();const n=t;return(0,xp.of)({series:n,state:e.LoadingState.Done,timeRange:r.range})}))):fw()}}class hw{constructor(e,t=(0,n.getRunRequest)()){this.datasource=e,this._runRequest=t}getTarget(e){if(tw(this.datasource))return e.state.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest(e,t){return tw(this.datasource)?this.datasource.variables.query?this._runRequest(this.datasource,t,this.datasource.variables.query.bind(this.datasource.variables)):this._runRequest(this.datasource,t):fw()}}function fw(){return(0,xp.of)({state:e.LoadingState.Done,series:[],timeRange:(0,e.getDefaultTimeRange)()})}const mw=(e,t)=>{const n=[];let r=null;t.lastIndex=0;do{r=t.exec(e),r&&n.push(r)}while(t.global&&r&&""!==r[0]&&void 0!==r[0]);return n};var gw=Object.defineProperty,yw=Object.getOwnPropertySymbols,bw=Object.prototype.hasOwnProperty,vw=Object.prototype.propertyIsEnumerable,ww=(e,t,n)=>t in e?gw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class Sw extends om{constructor(t){super(((e,t)=>{for(var n in t||(t={}))bw.call(t,n)&&ww(e,n,t[n]);if(yw)for(var n of yw(t))vw.call(t,n)&&ww(e,n,t[n]);return e})({type:"query",name:"",value:"",text:"",options:[],datasource:null,regex:"",query:{refId:"A"},refresh:e.VariableRefresh.onDashboardLoad,sort:e.VariableSort.disabled},t)),this._variableDependency=new If(this,{statePaths:["regex","query","datasource"]}),this.onSearchChange=e=>{Cg(this.state.query).indexOf("__searchFilter")>-1&&this._updateOptionsBasedOnSearchFilter(e)},this._updateOptionsBasedOnSearchFilter=(0,ac.debounce)((async e=>{const t=await(0,xp.lastValueFrom)(this.getValueOptions({searchFilter:e}));this.setState({options:t,loading:!1})}),400)}getValueOptions(t){return this.state.query?(this.setState({loading:!0,error:null}),(0,xp.from)(Df(this.state.datasource,{__sceneObject:{text:"__sceneObject",value:this}})).pipe((0,xp.mergeMap)((r=>{const i=function(e){if(ew(e))return new dw(e,(0,n.getRunRequest)());if(Zv(e))return new pw(e);if(tw(e))return new hw(e);throw new Error(`Couldn't create a query runner for datasource ${e.type}`)}(r),a=i.getTarget(this),o=this.getRequest(a,t.searchFilter);return i.runRequest({variable:this,searchFilter:t.searchFilter},o).pipe(rm({type:"variable",request:o,origin:this}),(0,xp.filter)((t=>t.state===e.LoadingState.Done||t.state===e.LoadingState.Error)),(0,xp.take)(1),(0,xp.mergeMap)((t=>t.state===e.LoadingState.Error?(0,xp.throwError)((()=>t.error)):(0,xp.of)(t))),(t=>t.pipe((0,xp.map)((t=>{const n=t.series;if(!n||!n.length)return[];if(function(t){if(!t)return!1;if(!t.length)return!0;const n=t[0];if((0,e.isDataFrame)(n))return!1;for(const e in n){if(!n.hasOwnProperty(e))continue;if(null!==n[e]&&"string"!=typeof n[e]&&"number"!=typeof n[e])continue;const t=e.toLowerCase();if("text"===t||"value"===t)return!0}return!1}(n))return n;if(0===n[0].fields.length)return[];const r=(0,e.getProcessedDataFrames)(n),i=[];let a=-1,o=-1,s=-1,l=-1;for(const t of r)for(let r=0;r<t.fields.length;r++){const i=t.fields[r],c=(0,e.getFieldDisplayName)(i,t,n).toLowerCase();i.type===e.FieldType.string&&-1===s&&(s=r),"text"===c&&i.type===e.FieldType.string&&-1===o&&(o=r),"value"===c&&i.type===e.FieldType.string&&-1===a&&(a=r),"expandable"!==c||i.type!==e.FieldType.boolean&&i.type!==e.FieldType.number||-1!==l||(l=r)}if(-1===s)throw new Error("Couldn't find any field of type string in the results.");for(const e of n)for(let t=0;t<e.length;t++){const n=-1!==l?e.fields[l].values.get(t):void 0,r=e.fields[s].values.get(t),c=-1!==o?e.fields[o].values.get(t):null,u=-1!==a?e.fields[a].values.get(t):null;-1!==a||-1!==o?-1!==a||-1===o?-1===a||-1!==o?i.push({text:c,value:u,expandable:n}):i.push({text:u,value:u,expandable:n}):i.push({text:c,value:c,expandable:n}):i.push({text:r,value:r,expandable:n})}return i})))),(0,xp.mergeMap)((t=>{let n="";return this.state.regex&&(n=Rf.interpolate(this,this.state.regex,void 0,"regex")),(0,xp.of)(((t,n,r)=>{var i,a,o,s,l,c;let u,d=[];t&&(u=(0,e.stringToJsRegex)(t));for(let e=0;e<r.length;e++){const t=r[e];let n=void 0===t.text||null===t.text?t.value:t.text,p=void 0===t.value||null===t.value?t.text:t.value;if((0,ac.isNumber)(p)&&(p=p.toString()),(0,ac.isNumber)(n)&&(n=n.toString()),u){const e=mw(p,u);if(!e.length)continue;const t=e.find((e=>e.groups&&e.groups.value)),r=e.find((e=>e.groups&&e.groups.text)),h=e.find((e=>e.length>1)),f=e.length>1&&h;if(t||r)p=null!=(o=null==(i=null==t?void 0:t.groups)?void 0:i.value)?o:null==(a=null==r?void 0:r.groups)?void 0:a.text,n=null!=(c=null==(s=null==r?void 0:r.groups)?void 0:s.text)?c:null==(l=null==t?void 0:t.groups)?void 0:l.value;else{if(f){for(let t=0;t<e.length;t++){const n=e[t];d.push({label:n[1],value:n[1]})}continue}h&&(n=h[1],p=h[1])}}d.push({label:n,value:p})}return d=(0,ac.uniqBy)(d,"value"),((t,n)=>{if(n===e.VariableSort.disabled)return t;const r=e=>{if(!e.text)return-1;const t=e.text.match(/.*?(\d+).*/);return!t||t.length<2?-1:parseInt(t[1],10)},i=e=>e.sort(((e,t)=>e.text?t.text?e.text.localeCompare(t.text,void 0,{numeric:!0}):1:-1));switch(n){case e.VariableSort.alphabeticalAsc:t=(0,ac.sortBy)(t,"label");break;case e.VariableSort.alphabeticalDesc:t=(0,ac.sortBy)(t,"label").reverse();break;case e.VariableSort.numericalAsc:t=(0,ac.sortBy)(t,r);break;case e.VariableSort.numericalDesc:t=(t=(0,ac.sortBy)(t,r)).reverse();break;case e.VariableSort.alphabeticalCaseInsensitiveAsc:t=(0,ac.sortBy)(t,(e=>(0,ac.toLower)(e.label)));break;case e.VariableSort.alphabeticalCaseInsensitiveDesc:t=(t=(0,ac.sortBy)(t,(e=>(0,ac.toLower)(e.label)))).reverse();break;case e.VariableSort.naturalAsc||7:t=i(t);break;case e.VariableSort.naturalDesc||8:t=(t=i(t)).reverse()}return t})(d,n)})(n,this.state.sort,t))})),(0,xp.catchError)((e=>e.cancelled?(0,xp.of)([]):(0,xp.throwError)((()=>e)))))})))):(0,xp.of)([])}getRequest(t,n){const r={__sceneObject:{text:"__sceneObject",value:this}};n&&(r.__searchFilter={value:n,text:n});const i=Rf.getTimeRange(this).state.value;return{app:e.CoreApp.Dashboard,requestId:Pp(),timezone:"",range:i,interval:"",intervalMs:0,targets:[t],scopedVars:r,startTime:Date.now()}}}function Ew(e,t){const n=["A","B","C","D","E","F","G","H"],r=[];if(t>5)return[];for(const i of n){const n=`${e}${i}`;r.push({name:n,children:Ew(n,t+1)})}return r}function xw(e,t,n){if(n>=t.length)return e;if("*"===t[n])return e;const r=t[n];let i=[],a=[r];r.startsWith("{")&&(a=r.replace(/\{|\}/g,"").split(","));for(const r of e)for(const e of a)if(-1!==e.indexOf("*")){const a=e.replace("*","");new RegExp(`^${a}.*`,"gi").test(r.name)&&(i=i.concat(xw([r],t,n+1)))}else r.name===e&&(i=i.concat(xw(r.children,t,n+1)));return i}function _w(e){return 0===e.indexOf("value")?[{name:e,children:[]}]:xw(Ew("",0),e.split("."),0)}Sw.Component=({model:e})=>Om(e);var Ow=Object.defineProperty,Tw=Object.getOwnPropertySymbols,Cw=Object.prototype.hasOwnProperty,kw=Object.prototype.propertyIsEnumerable,Pw=(e,t,n)=>t in e?Ow(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function Aw({model:e}){const{value:t,key:n,loading:i}=e.useState(),a=(0,Ei.useCallback)((t=>{e.setValue(t.currentTarget.value)}),[e]),o=(0,Ei.useCallback)((t=>{"Enter"===t.key&&e.setValue(t.currentTarget.value)}),[e]);return xi().createElement(r.AutoSizeInput,{id:n,placeholder:"Enter value",minWidth:15,defaultValue:t,loading:i,onBlur:a,onKeyDown:o})}(class extends om{constructor(t,n=!1){super(((e,t)=>{for(var n in t||(t={}))Cw.call(t,n)&&Pw(e,n,t[n]);if(Tw)for(var n of Tw(t))kw.call(t,n)&&Pw(e,n,t[n]);return e})({type:"custom",name:"Test",value:"Value",text:"Text",query:"Query",options:[],refresh:e.VariableRefresh.onDashboardLoad},t)),this.completeUpdate=new xp.Subject,this.isGettingValues=!0,this.getValueOptionsCount=0,this.isLazy=!1,this._variableDependency=new If(this,{statePaths:["query"]}),this.isLazy=n}getValueOptions(e){const{delayMs:t}=this.state;this.getValueOptionsCount+=1;const n=Rf.getQueryController(this);return new xp.Observable((e=>{const r={type:"variable",origin:this,cancel:()=>e.complete()};if(n&&n.queryStarted(r),this.setState({loading:!0}),this.state.throwError)throw new Error(this.state.throwError);const i=Rf.interpolate(this,this.state.query),a=this.getOptions(i),o=this.completeUpdate.subscribe({next:()=>{this.setState({issuedQuery:i,options:a,loading:!1}),e.next(a),e.complete()}});let s;return t?s=window.setTimeout((()=>this.signalUpdateCompleted()),t):0===t&&this.signalUpdateCompleted(),this.isGettingValues=!0,()=>{o.unsubscribe(),window.clearTimeout(s),this.isGettingValues=!1,this.state.loading&&this.setState({loading:!1}),n&&n.queryCompleted(r)}}))}cancel(){const e=oh(this,(e=>e instanceof Mv?e:void 0));null==e||e.cancel(this)}getOptions(e){return this.state.optionsToReturn?this.state.optionsToReturn:_w(e).map((e=>({label:e.name,value:e.name})))}signalUpdateCompleted(){this.completeUpdate.next(1)}}).Component=({model:e})=>Om(e);var Rw=Object.defineProperty,Dw=Object.getOwnPropertySymbols,jw=Object.prototype.hasOwnProperty,Iw=Object.prototype.propertyIsEnumerable,Nw=(e,t,n)=>t in e?Rw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;(class extends Yp{constructor(e){super(((e,t)=>{for(var n in t||(t={}))jw.call(t,n)&&Nw(e,n,t[n]);if(Dw)for(var n of Dw(t))Iw.call(t,n)&&Nw(e,n,t[n]);return e})({type:"textbox",value:"",name:""},e)),this._urlSync=new Ph(this,{keys:()=>[this.getKey()]})}getValue(){return this.state.value}setValue(e){e!==this.state.value&&(this.setState({value:e}),this.publishEvent(new Uh(this),!0))}getKey(){return`var-${this.state.name}`}getUrlState(){return{[this.getKey()]:this.state.value}}updateFromUrl(e){const t={},n=e[this.getKey()];"string"==typeof n&&(t.value=n),this.setState(t)}}).Component=({model:e})=>xi().createElement(Aw,{model:e}),Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var Lw=Object.defineProperty,Mw=Object.getOwnPropertySymbols,Fw=Object.prototype.hasOwnProperty,$w=Object.prototype.propertyIsEnumerable,Bw=(e,t,n)=>t in e?Lw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;(class extends Yp{constructor(e){super(((e,t)=>{for(var n in t||(t={}))Fw.call(t,n)&&Bw(e,n,t[n]);if(Mw)for(var n of Mw(t))$w.call(t,n)&&Bw(e,n,t[n]);return e})({type:"interval",value:"",intervals:["1m","10m","30m","1h","6h","12h","1d","7d","14d","30d"],name:"",autoStepCount:30,autoMinInterval:"10s",autoEnabled:!1,refresh:Lg.onTimeRangeChanged},e)),this._onChange=e=>{this.setState({value:e.value}),this.publishEvent(new Uh(this),!0)},this._urlSync=new Ph(this,{keys:()=>[this.getKey()]})}getKey(){return`var-${this.state.name}`}getUrlState(){return{[this.getKey()]:this.state.value}}updateFromUrl(e){const t={},n=e[this.getKey()];"string"==typeof n&&(n.startsWith("$__auto_interval_")?t.value=of:t.value=n),this.setState(t)}getOptionsForSelect(){const{value:e,intervals:t,autoEnabled:n}=this.state;let r=t.map((e=>({value:e,label:e})));return n&&(r=[{value:of,label:"Auto"},...r]),e&&!r.some((t=>t.value===e))&&r.push({value:e,label:e}),r}getValue(){const{value:e,autoStepCount:t,autoMinInterval:n}=this.state;return e===of?this.getAutoRefreshInteval(t,n):e}getAutoRefreshInteval(t,n){const r=Rf.getTimeRange(this).state.value;return e.rangeUtil.calculateInterval(r,t,n).interval}validateAndUpdate(){const{value:e,intervals:t}=this.state;let n=!1;if(e===of)n=!0;else if(!e&&t.length>0){const e=t[0];this.setState({value:e}),n=!0}return n&&this.publishEvent(new Uh(this),!0),(0,xp.of)({})}}).Component=({model:e})=>{const{key:t,value:n}=e.useState();return xi().createElement(r.Select,{id:t,placeholder:"Select value",width:"auto",value:n,tabSelectsValue:!1,options:e.getOptionsForSelect(),onChange:e._onChange})};class Vw{constructor(){this._urlKeyMapper=new ch,this._stateSub=null,this._locationSub=null,this._ignoreNextLocationUpdate=!1,this._onLocationUpdate=e=>{if(this._ignoreNextLocationUpdate)return void(this._ignoreNextLocationUpdate=!1);if(this._lastPath!==e.pathname)return;const t=new URLSearchParams(e.search);this._urlKeyMapper.rebuildIndex(this._sceneRoot),dh(this._sceneRoot,t,this._urlKeyMapper),this._lastPath=e.pathname},this._onStateChanged=({payload:e})=>{const t=e.changedObject;if(t.urlSync){const e=t.urlSync.getUrlState(),r=n.locationService.getSearch(),i={};this._urlKeyMapper.rebuildIndex(this._sceneRoot);for(const[n,a]of Object.entries(e)){const e=this._urlKeyMapper.getUniqueKey(n,t);ph(r.getAll(e),a)||(i[e]=a)}Object.keys(i).length>0&&(this._ignoreNextLocationUpdate=!0,n.locationService.partial(i,!0))}}}initSync(e){this._locationSub||(jf("UrlSyncManager","New location listen"),this._locationSub=n.locationService.getHistory().listen(this._onLocationUpdate)),this._stateSub&&(jf("UrlSyncManager","Unregister previous scene state subscription",this._sceneRoot.state.key),this._stateSub.unsubscribe()),this._sceneRoot=e,this._lastPath=n.locationService.getLocation().pathname,this._stateSub=e.subscribeToEvent($p,this._onStateChanged),this.syncFrom(this._sceneRoot)}cleanUp(e){this._sceneRoot===e&&(jf("UrlSyncManager","Clean up"),this._locationSub&&(this._locationSub(),jf("UrlSyncManager","Unregister history listen"),this._locationSub=null),this._stateSub&&(this._stateSub.unsubscribe(),this._stateSub=null,jf("UrlSyncManager","Root deactived, unsub to state","same key",this._sceneRoot.state.key===e.state.key)))}syncFrom(e){const t=n.locationService.getSearch();this._urlKeyMapper.rebuildIndex(this._sceneRoot),dh(e,t,this._urlKeyMapper)}getUrlState(e){return uh(e)}}let zw;function Uw(){return zw||(zw=new Vw),zw}class qw extends Yp{constructor(e){super(e),this.addActivationHandler((()=>{const e=function(e){const t=window.__grafanaSceneContext;return jf("setWindowGrafanaScene","set window.__grafanaSceneContext",e),window.__grafanaSceneContext=e,()=>{window.__grafanaSceneContext===e&&(jf("setWindowGrafanaScene","restore window.__grafanaSceneContext",t),window.__grafanaSceneContext=t)}}(this);return()=>{e(),Uw().cleanUp(this)}}))}initUrlSync(){Uw().initSync(this)}}qw.Component=function({model:e}){const{body:t,controls:n}=e.useState(),i=(0,r.useStyles2)(Hw);return xi().createElement("div",{className:i.container},n&&xi().createElement("div",{className:i.controls},n.map((e=>xi().createElement(e.Component,{key:e.state.key,model:e})))),xi().createElement("div",{className:i.body},xi().createElement(t.Component,{model:t})))};const Hw=e=>({container:(0,t.css)({flexGrow:1,display:"flex",gap:e.spacing(2),minHeight:"100%",flexDirection:"column"}),body:(0,t.css)({flexGrow:1,display:"flex",gap:e.spacing(1)}),controls:(0,t.css)({display:"flex",gap:e.spacing(2),alignItems:"flex-end",flexWrap:"wrap"})});class Gw extends Yp{addItem(e){this.setState({items:this.state.items?[...this.state.items,e]:[e]})}setItems(e){this.setState({items:e})}}function Ww(e){return e instanceof rE}Gw.Component=function({model:e}){const{items:t=[]}=e.useState(),n=xi().useRef(null);(0,Ei.useEffect)((()=>{n.current&&n.current.focus()}),[]);const i=e=>e.map((e=>{switch(e.type){case"divider":return xi().createElement(r.Menu.Divider,{key:e.text});case"group":return xi().createElement(r.Menu.Group,{key:e.text,label:e.text},e.subMenu?i(e.subMenu):void 0);default:return xi().createElement(r.Menu.Item,{key:e.text,label:e.text,icon:e.iconClassName,childItems:e.subMenu?i(e.subMenu):void 0,url:e.href,onClick:e.onClick,shortcut:e.shortcut,testId:dm.components.Panels.Panel.menuItems(e.text)})}}));return xi().createElement(r.Menu,{ref:n},i(t))},class extends Yp{}.Component=function({model:e}){const{body:t}=e.useState(),n=e.parent;if(n&&!(n instanceof GS)&&!Ww(n))throw new Error("SceneGridItem must be a child of SceneGridLayout or SceneGridRow");return t?xi().createElement(t.Component,{model:t}):null};var Qw=__webpack_require__(2548),Kw=__webpack_require__.n(Qw),Yw=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Xw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jw=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},Zw=void 0;Zw="undefined"!=typeof window?window:"undefined"!=typeof self?self:__webpack_require__.g;var eS=null,tS=null,nS=Zw.clearTimeout,rS=Zw.setTimeout,iS=Zw.cancelAnimationFrame||Zw.mozCancelAnimationFrame||Zw.webkitCancelAnimationFrame,aS=Zw.requestAnimationFrame||Zw.mozRequestAnimationFrame||Zw.webkitRequestAnimationFrame;null==iS||null==aS?(eS=nS,tS=function(e){return rS(e,20)}):(eS=function(e){var t=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(e,2),n=t[0],r=t[1];iS(n),nS(r)},tS=function(e){var t=aS((function(){nS(n),e()})),n=rS((function(){iS(t),e()}),20);return[t,n]});var oS=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=r=Jw(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a))),r.state={height:r.props.defaultHeight||0,width:r.props.defaultWidth||0},r._onResize=function(){var e=r.props,t=e.disableHeight,n=e.disableWidth,i=e.onResize;if(r._parentNode){var a=r._parentNode.offsetHeight||0,o=r._parentNode.offsetWidth||0,s=window.getComputedStyle(r._parentNode)||{},l=parseInt(s.paddingLeft,10)||0,c=parseInt(s.paddingRight,10)||0,u=parseInt(s.paddingTop,10)||0,d=parseInt(s.paddingBottom,10)||0,p=a-u-d,h=o-l-c;(!t&&r.state.height!==p||!n&&r.state.width!==h)&&(r.setState({height:a-u-d,width:o-l-c}),i({height:a,width:o}))}},r._setRef=function(e){r._autoSizer=e},Jw(r,n)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Yw(t,[{key:"componentDidMount",value:function(){var e=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._detectElementResize=function(e){var t=void 0,n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,l="undefined"!=typeof document&&document.attachEvent;if(!l){o=function(e){var t=e.__resizeTriggers__,n=t.firstElementChild,r=t.lastElementChild,i=n.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,i.style.width=n.offsetWidth+1+"px",i.style.height=n.offsetHeight+1+"px",n.scrollLeft=n.scrollWidth,n.scrollTop=n.scrollHeight},a=function(e){return e.offsetWidth!==e.__resizeLast__.width||e.offsetHeight!==e.__resizeLast__.height},s=function(e){if(!(e.target.className&&"function"==typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)){var t=this;o(this),this.__resizeRAF__&&eS(this.__resizeRAF__),this.__resizeRAF__=tS((function(){a(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach((function(n){n.call(t,e)})))}))}};var c=!1,u="";r="animationstart";var d="Webkit Moz O ms".split(" "),p="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),h=document.createElement("fakeelement");if(void 0!==h.style.animationName&&(c=!0),!1===c)for(var f=0;f<d.length;f++)if(void 0!==h.style[d[f]+"AnimationName"]){u="-"+d[f].toLowerCase()+"-",r=p[f],c=!0;break}t="@"+u+"keyframes "+(n="resizeanim")+" { from { opacity: 0; } to { opacity: 0; } } ",i=u+"animation: 1ms "+n+"; "}return{addResizeListener:function(a,c){if(l)a.attachEvent("onresize",c);else{if(!a.__resizeTriggers__){var u=a.ownerDocument,d=Zw.getComputedStyle(a);d&&"static"===d.position&&(a.style.position="relative"),function(n){if(!n.getElementById("detectElementResize")){var r=(t||"")+".resize-triggers { "+(i||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',a=n.head||n.getElementsByTagName("head")[0],o=n.createElement("style");o.id="detectElementResize",o.type="text/css",null!=e&&o.setAttribute("nonce",e),o.styleSheet?o.styleSheet.cssText=r:o.appendChild(n.createTextNode(r)),a.appendChild(o)}}(u),a.__resizeLast__={},a.__resizeListeners__=[],(a.__resizeTriggers__=u.createElement("div")).className="resize-triggers";var p=u.createElement("div");p.className="expand-trigger",p.appendChild(u.createElement("div"));var h=u.createElement("div");h.className="contract-trigger",a.__resizeTriggers__.appendChild(p),a.__resizeTriggers__.appendChild(h),a.appendChild(a.__resizeTriggers__),o(a),a.addEventListener("scroll",s,!0),r&&(a.__resizeTriggers__.__animationListener__=function(e){e.animationName===n&&o(a)},a.__resizeTriggers__.addEventListener(r,a.__resizeTriggers__.__animationListener__))}a.__resizeListeners__.push(c)}},removeResizeListener:function(e,t){if(l)e.detachEvent("onresize",t);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(t),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",s,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(r,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch(e){}}}}}(e),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.className,r=e.disableHeight,i=e.disableWidth,a=e.style,o=this.state,s=o.height,l=o.width,c={overflow:"visible"},u={},d=!1;return r||(0===s&&(d=!0),c.height=0,u.height=s),i||(0===l&&(d=!0),c.width=0,u.width=l),(0,Ei.createElement)("div",{className:n,ref:this._setRef,style:Xw({},c,a)},!d&&t(u))}}]),t}(Ei.PureComponent);oS.defaultProps={onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}};const sS=oS;var lS=Object.defineProperty,cS=Object.getOwnPropertySymbols,uS=Object.prototype.hasOwnProperty,dS=Object.prototype.propertyIsEnumerable,pS=(e,t,n)=>t in e?lS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function hS(){const e=(0,Ei.useRef)(void 0);return null!=e.current||(e.current=(0,ac.uniqueId)()),e.current}const fS=xi().forwardRef(((e,t)=>{var n=e,{children:r,onLoad:i,onChange:a}=n,o=((e,t)=>{var n={};for(var r in e)uS.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&cS)for(var r of cS(e))t.indexOf(r)<0&&dS.call(e,r)&&(n[r]=e[r]);return n})(n,["children","onLoad","onChange"]);const s=hS(),[l,c]=(0,Ei.useState)(!1),[u,d]=(0,Ei.useState)(!1),p=(0,Ei.useRef)(null);return(0,Ei.useImperativeHandle)(t,(()=>p.current)),h=()=>{fS.addCallback(s,(e=>{!l&&e.isIntersecting&&(c(!0),null==i||i()),d(e.isIntersecting),null==a||a(e.isIntersecting)}));const e=p.current;return e&&fS.observer.observe(e),()=>{delete fS.callbacks[s],e&&fS.observer.unobserve(e),0===Object.keys(fS.callbacks).length&&fS.observer.disconnect()}},(0,Ei.useEffect)(h,[]),xi().createElement("div",((e,t)=>{for(var n in t||(t={}))uS.call(t,n)&&pS(e,n,t[n]);if(cS)for(var n of cS(t))dS.call(t,n)&&pS(e,n,t[n]);return e})({id:s,ref:p},o),l&&("function"==typeof r?r({isInView:u}):r));var h}));fS.displayName="LazyLoader",fS.callbacks={},fS.addCallback=(e,t)=>fS.callbacks[e]=t,fS.observer=new IntersectionObserver((e=>{for(const t of e)fS.callbacks[t.target.id](t)}),{rootMargin:"100px"});var mS=Object.defineProperty,gS=Object.defineProperties,yS=Object.getOwnPropertyDescriptors,bS=Object.getOwnPropertySymbols,vS=Object.prototype.hasOwnProperty,wS=Object.prototype.propertyIsEnumerable,SS=(e,t,n)=>t in e?mS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ES=(e,t)=>{for(var n in t||(t={}))vS.call(t,n)&&SS(e,n,t[n]);if(bS)for(var n of bS(t))wS.call(t,n)&&SS(e,n,t[n]);return e},xS=(e,t)=>gS(e,yS(t)),_S=(e,t)=>{var n={};for(var r in e)vS.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&bS)for(var r of bS(e))t.indexOf(r)<0&&wS.call(e,r)&&(n[r]=e[r]);return n};const OS=xi().forwardRef(((e,n)=>{var r;const i=e,{grid:a,layoutItem:o,index:s,totalCount:l,isLazy:c,style:u,onLoad:d,onChange:p,children:h}=i,f=_S(i,["grid","layoutItem","index","totalCount","isLazy","style","onLoad","onChange","children"]),m=a.getSceneLayoutChild(o.i),g=null==(r=m.getClassName)?void 0:r.call(m),y=xi().createElement(m.Component,{model:m,key:m.state.key});return c?xi().createElement(fS,xS(ES({},f),{key:m.state.key,"data-griditem-key":m.state.key,className:(0,t.cx)(g,e.className),style:u,ref:n}),y,h):xi().createElement("div",xS(ES({},f),{ref:n,key:m.state.key,"data-griditem-key":m.state.key,className:(0,t.cx)(g,e.className),style:u}),y,h)}));function TS(e,t,n){e.current?t?e.current.classList.add("react-grid-layout--enable-move-animations"):e.current.classList.remove("react-grid-layout--enable-move-animations"):n||setTimeout((()=>TS(e,t,!0)),50)}OS.displayName="GridItemWrapper";const CS=xi().forwardRef(((e,t)=>{var n=_S(e,["handleAxis"]);const i=(0,r.useStyles2)(kS);return xi().createElement("div",xS(ES({ref:t},n),{className:`${i} scene-resize-handle`}),xi().createElement("svg",{width:"16px",height:"16px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xi().createElement("path",{d:"M21 15L15 21M21 8L8 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))}));function kS(e){return(0,t.css)({position:"absolute",bottom:0,right:0,zIndex:999,padding:e.spacing(1.5,0,0,1.5),color:e.colors.border.strong,cursor:"se-resize","&:hover":{color:e.colors.text.link},svg:{display:"block"},".react-resizable-hide &":{display:"none"}})}CS.displayName="ResizeHandle";var PS=Object.defineProperty,AS=Object.defineProperties,RS=Object.getOwnPropertyDescriptors,DS=Object.getOwnPropertySymbols,jS=Object.prototype.hasOwnProperty,IS=Object.prototype.propertyIsEnumerable,NS=(e,t,n)=>t in e?PS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var LS=Object.defineProperty,MS=Object.defineProperties,FS=Object.getOwnPropertyDescriptors,$S=Object.getOwnPropertySymbols,BS=Object.prototype.hasOwnProperty,VS=Object.prototype.propertyIsEnumerable,zS=(e,t,n)=>t in e?LS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,US=(e,t)=>{for(var n in t||(t={}))BS.call(t,n)&&zS(e,n,t[n]);if($S)for(var n of $S(t))VS.call(t,n)&&zS(e,n,t[n]);return e},qS=(e,t)=>MS(e,FS(t));const HS=class extends Yp{constructor(e){super(qS(US({},e),{children:QS(e.children)})),this._skipOnLayoutChange=!1,this._oldLayout=[],this._loadOldLayout=!1,this.onLayoutChange=e=>{if(this._skipOnLayoutChange)this._skipOnLayoutChange=!1;else{this._loadOldLayout&&(e=[...this._oldLayout],this._loadOldLayout=!1);for(const t of e){const e=this.getSceneLayoutChild(t.i),n={x:t.x,y:t.y,width:t.w,height:t.h};WS(e.state,n)||e.setState(US({},n))}this.setState({children:QS(this.state.children)})}},this.onResizeStop=(e,t,n)=>{this.getSceneLayoutChild(n.i).setState({width:n.w,height:n.h})},this.onDragStart=e=>{this._oldLayout=[...e]},this.onDragStop=(e,t,n)=>{const r=this.getSceneLayoutChild(n.i);e=KS(e);for(let t=0;t<e.length;t++){const n=e[t],r=this.getSceneLayoutChild(n.i),i=r.state;(null==i?void 0:i.x)===n.x&&(null==i?void 0:i.y)===n.y||r.setState({x:n.x,y:n.y})}const i=e.findIndex((e=>e.i===n.i));let a=this.findGridItemSceneParent(e,i-1),o=this.state.children;r instanceof rE&&a instanceof rE&&(this.isRowDropValid(e,n,i)||(this._loadOldLayout=!0),a=this),a!==r.parent&&(o=this.moveChildTo(r,a)),this.setState({children:QS(o)}),this._skipOnLayoutChange=!0}}isDraggable(){var e;return null!=(e=this.state.isDraggable)&&e}getDragClass(){return`grid-drag-handle-${this.state.key}`}getDragClassCancel(){return"grid-drag-cancel"}toggleRow(e){var t,n;if(!e.state.isCollapsed)return e.setState({isCollapsed:!0}),void this.setState({});const r=e.state.children;if(0===r.length)return e.setState({isCollapsed:!1}),void this.setState({});const i=e.state.y,a=(null!=(t=r[0].state.y)?t:i)-(i+1);let o=i;for(const e of r){const t=US({},e.state);t.y=null!=(n=t.y)?n:i,t.y-=a,t.y!==e.state.y&&e.setState(t),o=Math.max(o,Number(t.y)+Number(t.height))}const s=o-i-1;for(const t of this.state.children)if(t.state.y>i&&this.pushChildDown(t,s),Ww(t)&&t!==e)for(const e of t.state.children)e.state.y>i&&this.pushChildDown(e,s);e.setState({isCollapsed:!1}),this.setState({})}getSceneLayoutChild(e){for(const t of this.state.children){if(t.state.key===e)return t;if(t instanceof rE)for(const n of t.state.children)if(n.state.key===e)return n}throw new Error("Scene layout child not found for GridItem")}pushChildDown(e,t){e.setState({y:e.state.y+t})}findGridItemSceneParent(e,t){for(let n=t;n>=0;n--){const t=e[n],r=this.getSceneLayoutChild(t.i);if(r instanceof rE)return r.state.isCollapsed?this:r}return this}isRowDropValid(e,t,n){if(e[e.length-1].i===t.i)return!0;const r=this.getSceneLayoutChild(e[n+1].i);return r instanceof rE||r.parent instanceof HS}moveChildTo(e,t){const n=e.parent;let r=this.state.children;const i=e.clone({key:e.state.key});if(n instanceof rE){const a=n.clone();if(a.setState({children:a.state.children.filter((t=>t.state.key!==e.state.key))}),r=r.map((e=>e===n?a:e)),t instanceof rE){const e=t.clone();e.setState({children:[...e.state.children,i]}),r=r.map((n=>n===t?e:n))}else r=[...r,i]}else if(!(t instanceof HS)){r=r.filter((t=>t.state.key!==e.state.key));const n=t.clone();n.setState({children:[...n.state.children,i]}),r=r.map((e=>e===t?n:e))}return r}toGridCell(e){var t,n;const r=e.state;let i=null!=(t=r.x)?t:0,a=null!=(n=r.y)?n:0;const o=Number.isInteger(Number(r.width))?Number(r.width):4,s=Number.isInteger(Number(r.height))?Number(r.height):4;let l=e.state.isDraggable,c=e.state.isResizable;return e instanceof rE&&(l=!!e.state.isCollapsed,c=!1),{i:e.state.key,x:i,y:a,h:s,w:o,isResizable:c,isDraggable:l}}buildGridLayout(e,t){let n=[];for(const e of this.state.children)if(n.push(this.toGridCell(e)),e instanceof rE&&!e.state.isCollapsed)for(const t of e.state.children)n.push(this.toGridCell(t));return n=KS(n),this.state.UNSAFE_fitPanels&&(n=function(e,t){const n=t-32,r=Math.max(...e.map((e=>e.h+e.y)))/Math.floor(n/38);return e.map((e=>((e,t)=>AS(e,RS(t)))(((e,t)=>{for(var n in t||(t={}))jS.call(t,n)&&NS(e,n,t[n]);if(DS)for(var n of DS(t))IS.call(t,n)&&NS(e,n,t[n]);return e})({},e),{y:Math.round(e.y/r)||0,h:Math.round(e.h/r)||1})))}(n,t)),e<768?(this._skipOnLayoutChange=!0,n.map((e=>qS(US({},e),{w:24})))):(this._skipOnLayoutChange=!1,n)}};let GS=HS;function WS(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function QS(e){return e.forEach((e=>{e instanceof rE&&e.setState({children:QS(e.state.children)})})),[...e].sort(((e,t)=>e.state.y-t.state.y||e.state.x-t.state.x))}function KS(e){return[...e].sort(((e,t)=>e.y-t.y||e.x-t.x))}GS.Component=function({model:e}){const{children:t,isLazy:n,isDraggable:r,isResizable:i}=e.useState(),a=(0,Ei.useRef)(null);return(0,Ei.useEffect)((()=>{TS(a,!!r)}),[r]),function(e){if(e.some((e=>void 0===e.state.height||void 0===e.state.width||void 0===e.state.x||void 0===e.state.y)))throw new Error("All children must have a size specified")}(t),xi().createElement(sS,null,(({width:t,height:o})=>{if(0===t)return null;const s=e.buildGridLayout(t,o);return xi().createElement("div",{ref:a,style:{width:`${t}px`,height:"100%",position:"relative",zIndex:1},className:"react-grid-layout"},xi().createElement(Kw(),{width:t,isDraggable:r&&t>768,isResizable:null!=i&&i,containerPadding:[0,0],useCSSTransforms:!0,margin:[8,8],cols:24,rowHeight:30,draggableHandle:`.grid-drag-handle-${e.state.key}`,draggableCancel:".grid-drag-cancel",layout:s,onDragStart:e.onDragStart,onDragStop:e.onDragStop,onResizeStop:e.onResizeStop,onLayoutChange:e.onLayoutChange,isBounded:!1,resizeHandle:xi().createElement(CS,null)},s.map(((t,r)=>xi().createElement(OS,{key:t.i,grid:e,layoutItem:t,index:r,isLazy:n,totalCount:s.length})))))}))};var YS=Object.defineProperty,XS=Object.defineProperties,JS=Object.getOwnPropertyDescriptors,ZS=Object.getOwnPropertySymbols,eE=Object.prototype.hasOwnProperty,tE=Object.prototype.propertyIsEnumerable,nE=(e,t,n)=>t in e?YS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class rE extends Yp{constructor(e){super(((e,t)=>XS(e,JS({x:0,height:1,width:24})))(((e,t)=>{for(var n in t||(t={}))eE.call(t,n)&&nE(e,n,t[n]);if(ZS)for(var n of ZS(t))tE.call(t,n)&&nE(e,n,t[n]);return e})({children:e.children||[],isCollapsible:e.isCollapsible||!0,title:e.title||""},e))),this.onCollapseToggle=()=>{this.state.isCollapsible&&this.getGridLayout().toggleRow(this)}}getGridLayout(){const e=this.parent;if(!(e&&e instanceof GS))throw new Error("SceneGridRow must be a child of SceneGridLayout");return e}getUrlState(){return{rowc:this.state.isCollapsed?"1":"0"}}updateFromUrl(e){null!=e.rowc&&e.rowc!==this.getUrlState().rowc&&this.onCollapseToggle()}}rE.Component=function({model:e}){const n=(0,r.useStyles2)(iE),{isCollapsible:i,isCollapsed:a,title:o,actions:s,children:l}=e.useState(),c=e.getGridLayout(),u=c.getDragClass(),d=c.isDraggable(),p=l?l.length:0,h=1===p?"panel":"panels";return xi().createElement("div",{className:(0,t.cx)(n.row,a&&n.rowCollapsed)},xi().createElement("div",{className:n.rowTitleAndActionsGroup},xi().createElement("button",{onClick:e.onCollapseToggle,className:n.rowTitleButton,"aria-label":a?"Expand row":"Collapse row","data-testid":dm.components.DashboardRow.title(Rf.interpolate(e,o,void 0,"text"))},i&&xi().createElement(r.Icon,{name:a?"angle-right":"angle-down"}),xi().createElement("span",{className:n.rowTitle,role:"heading"},Rf.interpolate(e,o,void 0,"text"))),xi().createElement("span",{className:(0,t.cx)(n.panelCount,a&&n.panelCountCollapsed)},"(",p," ",h,")"),s&&xi().createElement("div",{className:n.rowActions},xi().createElement(s.Component,{model:s}))),d&&a&&xi().createElement("div",{className:(0,t.cx)(n.dragHandle,u)},xi().createElement(r.Icon,{name:"draggabledots"})))};const iE=e=>({row:(0,t.css)({width:"100%",height:"30px",display:"flex",justifyContent:"space-between",gap:e.spacing(1)}),rowTitleButton:(0,t.css)({display:"flex",alignItems:"center",cursor:"pointer",background:"transparent",border:"none",gap:e.spacing(1)}),rowCollapsed:(0,t.css)({borderBottom:`1px solid ${e.colors.border.weak}`}),rowTitle:(0,t.css)({fontSize:e.typography.h5.fontSize,fontWeight:e.typography.fontWeightMedium}),collapsedInfo:(0,t.css)({fontSize:e.typography.bodySmall.fontSize,color:e.colors.text.secondary,display:"flex",alignItems:"center",flexGrow:1}),rowTitleAndActionsGroup:(0,t.css)({display:"flex","&:hover, &:focus-within":{"& > div":{opacity:1}}}),rowActions:(0,t.css)({display:"flex",opacity:0,transition:"200ms opacity ease-in 200ms","&:hover, &:focus-within":{opacity:1}}),dragHandle:(0,t.css)({display:"flex",padding:e.spacing(0,1),alignItems:"center",justifyContent:"flex-end",cursor:"move",color:e.colors.text.secondary,"&:hover":{color:e.colors.text.primary}}),panelCount:(0,t.css)({paddingLeft:e.spacing(2),color:e.colors.text.secondary,fontStyle:"italic",fontSize:e.typography.size.sm,fontWeight:"normal",display:"none",lineHeight:"30px"}),panelCountCollapsed:(0,t.css)({display:"inline-block"})});(class extends Yp{constructor(){super(...arguments),this.onToggle=()=>{this.setState({isCollapsed:!this.state.isCollapsed})},this.onRemove=()=>{const e=this.parent;(function(e){return"body"in e.state})(e)&&e.setState({body:void 0})}}}).Component=function({model:e}){const{title:n,isCollapsed:i,canCollapse:a,canRemove:o,body:s,controls:l}=e.useState(),c=(0,r.useStyles2)(iE),u=(0,r.useStyles2)(aE),d=(null!=l?l:[]).map((e=>xi().createElement(e.Component,{key:e.state.key,model:e})));return o&&d.push(xi().createElement(r.ToolbarButton,{icon:"times",variant:"default",onClick:e.onRemove,key:"remove-button","aria-label":"Remove scene"})),xi().createElement("div",{className:u.wrapper},xi().createElement("div",{className:(0,t.cx)(u.row,i&&u.rowCollapsed)},xi().createElement("button",{onClick:e.onToggle,className:c.rowTitleButton,"aria-label":i?"Expand scene":"Collapse scene"},a&&xi().createElement(r.Icon,{name:i?"angle-right":"angle-down"}),xi().createElement("span",{className:c.rowTitle,role:"heading"},Rf.interpolate(e,n,void 0,"text"))),xi().createElement("div",{className:u.actions},d)),!i&&xi().createElement(s.Component,{model:s}))};const aE=e=>({wrapper:(0,t.css)({display:"flex",flexDirection:"column",flexGrow:1,gap:e.spacing(1)}),row:(0,t.css)({width:"100%",display:"flex",justifyContent:"space-between",gap:e.spacing(1)}),rowCollapsed:(0,t.css)({borderBottom:`1px solid ${e.colors.border.weak}`,paddingBottom:e.spacing(1)}),actions:(0,t.css)({display:"flex",alignItems:"center",gap:e.spacing(1),justifyContent:"flex-end",flexGrow:1})});(class extends Yp{constructor(){super(...arguments),this._variableDependency=new If(this,{statePaths:["text"]})}}).Component=({model:e})=>{const{text:n,fontSize:i=20,align:a="left",key:o,spacing:s}=e.useState(),l=(0,r.useTheme2)(),c=(0,t.css)({fontSize:i,display:"flex",flexGrow:1,alignItems:"center",padding:s?l.spacing(s,0):void 0,justifyContent:a});return xi().createElement("div",{className:c,"data-testid":o},Rf.interpolate(e,n))},class extends Yp{}.Component=({model:e})=>{const t=e.useState();return xi().createElement(r.ToolbarButton,{onClick:t.onClick,icon:t.icon})},class extends Yp{}.Component=({model:e})=>{const t=e.useState();return xi().createElement("div",{style:{display:"flex"}},t.label&&xi().createElement($m,{label:t.label}),xi().createElement(r.Input,{defaultValue:t.value,width:8,onBlur:t=>{e.state.onChange(parseInt(t.currentTarget.value,10))}}))};class oE extends Yp{constructor(){super(...arguments),this.onZoom=()=>{const t=Rf.getTimeRange(this),n=function(t,n){const r=t.to.valueOf()-t.from.valueOf(),i=t.to.valueOf()-r/2,a=0===r?3e4:2*r,o=i+a/2,s=i-a/2;return{from:(0,e.toUtc)(s),to:(0,e.toUtc)(o),raw:{from:(0,e.toUtc)(s),to:(0,e.toUtc)(o)}}}(t.state.value);t.onTimeRangeChange(n)},this.onChangeFiscalYearStartMonth=e=>{Rf.getTimeRange(this).setState({fiscalYearStartMonth:e})},this.onMoveBackward=()=>{const e=Rf.getTimeRange(this),{state:{value:t}}=e;e.onTimeRangeChange(lE(sE.Backward,t,Date.now()))},this.onMoveForward=()=>{const e=Rf.getTimeRange(this),{state:{value:t}}=e;e.onTimeRangeChange(lE(sE.Forward,t,Date.now()))}}}oE.Component=function({model:e}){const{hidePicker:t,isOnCanvas:n}=e.useState(),i=Rf.getTimeRange(e),a=i.getTimeZone(),o=i.useState();return t?null:xi().createElement(r.TimeRangePicker,{isOnCanvas:null==n||n,value:o.value,onChange:i.onTimeRangeChange,timeZone:a,fiscalYearStartMonth:o.fiscalYearStartMonth,onMoveBackward:e.onMoveBackward,onMoveForward:e.onMoveForward,onZoom:e.onZoom,onChangeTimeZone:i.onTimeZoneChange,onChangeFiscalYearStartMonth:e.onChangeFiscalYearStartMonth})};var sE=(e=>(e[e.Backward=0]="Backward",e[e.Forward=1]="Forward",e))(sE||{});function lE(t,n,r){const i=n.to.valueOf(),a=n.from.valueOf(),o=(i-a)/2;let s,l;0===t?(s=a-o,l=i-o):(s=a+o,l=i+o,l>r&&i<r&&(l=r,s=a));const c=(0,e.toUtc)(s),u=(0,e.toUtc)(l);return{from:c,to:u,raw:{from:c,to:u}}}var cE=Object.defineProperty,uE=Object.defineProperties,dE=Object.getOwnPropertyDescriptors,pE=Object.getOwnPropertySymbols,hE=Object.prototype.hasOwnProperty,fE=Object.prototype.propertyIsEnumerable,mE=(e,t,n)=>t in e?cE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const gE=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class yE extends Yp{constructor(t){var i,a,o;super(((e,t)=>uE(e,dE(t)))(((e,t)=>{for(var n in t||(t={}))hE.call(t,n)&&mE(e,n,t[n]);if(pE)for(var n of pE(t))fE.call(t,n)&&mE(e,n,t[n]);return e})({refresh:""},t),{autoValue:void 0,autoEnabled:null==(i=t.autoEnabled)||i,autoMinInterval:null!=(a=t.autoMinInterval)?a:n.config.minRefreshInterval,intervals:null!=(o=t.intervals)?o:gE})),this._urlSync=new Ph(this,{keys:["refresh"]}),this.onRefresh=()=>{const e=Rf.getQueryController(this);if(null==e?void 0:e.state.isRunning)return void e.cancelAll();const t=Rf.getTimeRange(this);this._intervalTimer&&clearInterval(this._intervalTimer),t.onRefresh(),this.setupIntervalTimer()},this.onIntervalChanged=e=>{this.setState({refresh:e}),this.setupIntervalTimer()},this.setupAutoTimeRangeListener=()=>Rf.getTimeRange(this).subscribeToState(((e,t)=>{e.from===t.from&&e.to===t.to||this.setupIntervalTimer()})),this.calculateAutoRefreshInterval=()=>{var t;const n=Rf.getTimeRange(this),r=null!=(t=null==window?void 0:window.innerWidth)?t:2e3;return e.rangeUtil.calculateInterval(n.state.value,r,this.state.autoMinInterval)},this.setupIntervalTimer=()=>{var t;const n=Rf.getTimeRange(this),{refresh:i,intervals:a}=this.state;if((this._intervalTimer||""===i)&&clearInterval(this._intervalTimer),""===i)return;if(i!==r.RefreshPicker.autoOption.value&&a&&!a.includes(i))return;let o;if(null==(t=this._autoTimeRangeListener)||t.unsubscribe(),i===r.RefreshPicker.autoOption.value){const e=this.calculateAutoRefreshInterval();o=e.intervalMs,this._autoTimeRangeListener=this.setupAutoTimeRangeListener(),e.interval!==this.state.autoValue&&this.setState({autoValue:e.interval})}else o=e.rangeUtil.intervalToMs(i);this._intervalTimer=setInterval((()=>{n.onRefresh()}),o)},this.addActivationHandler((()=>(this.setupIntervalTimer(),()=>{var e;this._intervalTimer&&clearInterval(this._intervalTimer),null==(e=this._autoTimeRangeListener)||e.unsubscribe()})))}getUrlState(){return{refresh:""!==this.state.refresh?this.state.refresh:void 0}}updateFromUrl(e){const t=e.refresh;"string"==typeof t?this.setState({refresh:t}):null==t&&this.setState({refresh:""})}}yE.Component=function({model:e}){var t;const{refresh:n,intervals:i,autoEnabled:a,autoValue:o,isOnCanvas:s,primary:l,withText:c}=e.useState(),u=function(e){const t=Rf.getQueryController(e);return!!t&&t.useState().isRunning}(e);let d,p,h=n===(null==(t=r.RefreshPicker.autoOption)?void 0:t.value)?o:c?"Refresh":void 0;return u&&(d="Cancel all queries",c&&(h="Cancel")),c&&(p="96px"),xi().createElement(r.RefreshPicker,{showAutoInterval:a,value:n,intervals:i,tooltip:d,width:p,text:h,onRefresh:e.onRefresh,primary:l,onIntervalChanged:e.onIntervalChanged,isLoading:u,isOnCanvas:null==s||s})};const bE=e=>`${e}-compare`;var vE=Object.defineProperty,wE=Object.defineProperties,SE=Object.getOwnPropertyDescriptors,EE=Object.getOwnPropertySymbols,xE=Object.prototype.hasOwnProperty,_E=Object.prototype.propertyIsEnumerable,OE=(e,t,n)=>t in e?vE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,TE=(e,t)=>{for(var n in t||(t={}))xE.call(t,n)&&OE(e,n,t[n]);if(EE)for(var n of EE(t))_E.call(t,n)&&OE(e,n,t[n]);return e},CE=(e,t)=>wE(e,SE(t));const kE="__previousPeriod",PE="__noPeriod",AE={label:"Previous period",value:kE},RE={label:"No comparison",value:PE},DE=[{label:"Day before",value:"24h"},{label:"Week before",value:"1w"},{label:"Month before",value:"1M"}];(class extends Yp{constructor(t){super(TE({compareOptions:DE},t)),this._urlSync=new Ph(this,{keys:["compareWith"]}),this._onActivate=()=>{const e=Rf.getTimeRange(this);this.setState({compareOptions:this.getCompareOptions(e.state.value)}),this._subs.add(e.subscribeToState((e=>{const t=this.getCompareOptions(e.value),n={compareOptions:t};Boolean(this.state.compareWith)&&!t.find((({value:e})=>e===this.state.compareWith))&&(n.compareWith=kE),this.setState(n)})))},this.getCompareOptions=t=>{const n=Math.ceil(t.to.diff(t.from)),r=DE.findIndex((({value:t})=>e.rangeUtil.intervalToMs(t)>=n));return[RE,AE,...DE.slice(r).map((({label:e,value:t})=>({label:e,value:t})))]},this.onCompareWithChanged=e=>{e===PE?this.onClearCompare():this.setState({compareWith:e})},this.onClearCompare=()=>{this.setState({compareWith:void 0})},this.addActivationHandler(this._onActivate)}getExtraQueries(e){const t=[],n=this.getCompareTimeRange(e.range);if(!n)return t;const r=e.targets.filter((e=>!1!==e.timeRangeCompare));return r.length&&t.push({req:CE(TE({},e),{targets:r,range:n}),processor:jE}),t}shouldRerun(e,t){return e.compareWith!==t.compareWith}getCompareTimeRange(t){let n,r;if(this.state.compareWith){if(this.state.compareWith===kE){const i=t.to.diff(t.from);n=(0,e.dateTime)(t.from).subtract(i),r=(0,e.dateTime)(t.to).subtract(i)}else n=(0,e.dateTime)(t.from).subtract(e.rangeUtil.intervalToMs(this.state.compareWith)),r=(0,e.dateTime)(t.to).subtract(e.rangeUtil.intervalToMs(this.state.compareWith));return{from:n,to:r,raw:{from:n,to:r}}}}getUrlState(){return{compareWith:this.state.compareWith}}updateFromUrl(e){if(!e.compareWith)return;const t=Rh(e.compareWith);t&&(this.getCompareOptions(Rf.getTimeRange(this).state.value).find((({value:e})=>e===t))?this.setState({compareWith:t}):this.setState({compareWith:"__previousPeriod"}))}}).Component=function({model:e}){var t;const n=(0,r.useStyles2)(IE),{compareWith:i,compareOptions:a}=e.useState(),[o,s]=xi().useState(i),l=null!=(t=a.find((({value:e})=>e===o)))?t:AE,c=a.find((({value:e})=>e===i)),u=Boolean(c),d=()=>{u?(s(i),e.onClearCompare()):u||e.onCompareWithChanged(l.value)};return xi().createElement(r.ButtonGroup,null,xi().createElement(r.ToolbarButton,{variant:"canvas",tooltip:"Enable time frame comparison",onClick:e=>{e.stopPropagation(),e.preventDefault(),d()}},xi().createElement(r.Checkbox,{label:" ",value:u,onClick:d}),"Comparison"),u?xi().createElement(r.ButtonSelect,{variant:"canvas",value:c,options:a,onChange:t=>{e.onCompareWithChanged(t.value)}}):xi().createElement(r.ToolbarButton,{className:n.previewButton,disabled:!0,variant:"canvas",isOpen:!1},l.label))};const jE=(t,r)=>{const i=r.timeRange.from.diff(t.timeRange.from);return r.series.forEach((t=>{t.refId=bE(t.refId||""),t.meta=CE(TE({},t.meta),{timeCompare:{diffMs:i,isTimeShiftQuery:!0}}),t.fields.forEach((t=>(t.type===e.FieldType.time&&(t.values=t.values.map((e=>i<0?e-i:e+i))),t.config=CE(TE({},t.config),{color:{mode:"fixed",fixedColor:n.config.theme.palette.gray60}}),t)))})),(0,xp.of)(r)};function IE(e){return{previewButton:(0,t.css)({"&:disabled":{border:`1px solid ${e.colors.secondary.border}`,color:e.colors.text.disabled,opacity:1}})}}(class extends Yp{constructor(t){super(t),this.addActivationHandler((()=>{const t=Rf.getData(this);this._subs.add(t.subscribeToState((t=>{var n;(null==(n=t.data)?void 0:n.state)===e.LoadingState.Done&&this.performRepeat(t.data)}))),t.state.data&&this.performRepeat(t.state.data)}))}performRepeat(e){const t=[];for(let n=0;n<e.series.length;n++){const r=this.state.getLayoutChild(e,e.series[n],n);t.push(r)}this.state.body.setState({children:t})}}).Component=({model:e})=>{const{body:t}=e.useState();return xi().createElement(t.Component,{model:t})},class extends Yp{constructor(e){super(e),this._variableDependency=new If(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>this.performRepeat()}),this.addActivationHandler((()=>this.performRepeat()))}performRepeat(){if(this._variableDependency.hasDependencyInLoadingState())return;const e=Rf.lookupVariable(this.state.variableName,this);if(!(e instanceof om))return void console.error("SceneByVariableRepeater: variable is not a MultiValueVariable");const t=function(e){const{value:t,text:n,options:r}=e.state;return e.hasAllValue()?r:Array.isArray(t)&&Array.isArray(n)?t.map(((e,t)=>({value:e,label:n[t]}))):[{value:t,label:n}]}(e),n=[];for(const e of t){const t=this.state.getLayoutChild(e);n.push(t)}this.state.body.setState({children:n})}}.Component=({model:e})=>{const{body:t}=e.useState();return xi().createElement(t.Component,{model:t})};const NE=class extends Yp{constructor(){super({})}get Component(){return NE.Component}};NE.Component=e=>xi().createElement("div",{style:{flexGrow:1}});class LE extends Yp{toggleDirection(){this.setState({direction:"row"===this.state.direction?"column":"row"})}isDraggable(){return!1}}LE.Component=function({model:e,parentState:r}){const{children:i,isHidden:a}=e.useState(),o=function(e,r){return(0,Ei.useMemo)((()=>{var i,a,o,s,l,c,u,d,p,h;const{direction:f="row",wrap:m}=e,g=n.config.theme2,y={};return r?FE(y,e,r):(y.display="flex",y.flexGrow=1,y.minWidth=e.minWidth,y.minHeight=e.minHeight),y.flexDirection=f,y.gap="8px",y.flexWrap=m||"nowrap",y.alignContent="baseline",y.minWidth=y.minWidth||0,y.minHeight=y.minHeight||0,y[g.breakpoints.down("md")]={flexDirection:null!=(a=null==(i=e.md)?void 0:i.direction)?a:"column",maxWidth:null!=(s=null==(o=e.md)?void 0:o.maxWidth)?s:"unset",maxHeight:null!=(c=null==(l=e.md)?void 0:l.maxHeight)?c:"unset",height:null!=(d=null==(u=e.md)?void 0:u.height)?d:"unset",width:null!=(h=null==(p=e.md)?void 0:p.width)?h:"unset"},(0,t.css)(y)}),[r,e])}(e.state,r);return a?null:xi().createElement("div",{className:o},i.map((t=>{const n=t.Component;return xi().createElement(n,{key:t.state.key,model:t,parentState:e.state})})))};class ME extends Yp{}function FE(e,t,n){var r,i,a;const o=null!=(r=n.direction)?r:"row",{xSizing:s="fill",ySizing:l="fill"}=t;return e.display="flex",e.position="relative",e.flexDirection=o,"column"===o?(t.height?e.height=t.height:e.flexGrow="fill"===l?1:0,t.width?e.width=t.width:e.alignSelf="fill"===s?"stretch":"flex-start"):(t.height?e.height=t.height:e.alignSelf="fill"===l?"stretch":"flex-start",t.width?e.width=t.width:e.flexGrow="fill"===s?1:0),e.minWidth=t.minWidth,e.maxWidth=t.maxWidth,e.maxHeight=t.maxHeight,e.minHeight=null!=(i=t.minHeight)?i:n.minHeight,e.height=null!=(a=t.height)?a:n.height,e}ME.Component=function({model:e,parentState:r}){if(!r)throw new Error("SceneFlexItem must be a child of SceneFlexLayout");const{body:i,isHidden:a}=e.useState(),o=function(e,r){return(0,Ei.useMemo)((()=>{var i,a,o,s,l,c,u,d,p,h;const f=n.config.theme2,m=FE({},e,r);return m[f.breakpoints.down("md")]={maxWidth:null!=(a=null==(i=e.md)?void 0:i.maxWidth)?a:"unset",maxHeight:null!=(s=null==(o=e.md)?void 0:o.maxHeight)?s:"unset",height:null!=(u=null==(l=e.md)?void 0:l.height)?u:null==(c=r.md)?void 0:c.height,width:null!=(h=null==(d=e.md)?void 0:d.width)?h:null==(p=r.md)?void 0:p.width},(0,t.css)(m)}),[e,r])}(e.state,r);return!i||a?null:xi().createElement("div",{className:o},xi().createElement(i.Component,{model:i}))};var $E=Object.defineProperty,BE=Object.getOwnPropertySymbols,VE=Object.prototype.hasOwnProperty,zE=Object.prototype.propertyIsEnumerable,UE=(e,t,n)=>t in e?$E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class qE extends Yp{constructor(e){var t,n;super(((e,t)=>{for(var n in t||(t={}))VE.call(t,n)&&UE(e,n,t[n]);if(BE)for(var n of BE(t))zE.call(t,n)&&UE(e,n,t[n]);return e})({rowGap:1,columnGap:1,templateColumns:"repeat(auto-fit, minmax(400px, 1fr))",autoRows:null!=(t=e.autoRows)?t:"320px",children:null!=(n=e.children)?n:[]},e))}isDraggable(){return!1}}qE.Component=function({model:e}){const{children:r,isHidden:i,isLazy:a}=e.useState(),o=(s=e.state,(0,Ei.useMemo)((()=>{var e,r,i,a,o,l,c,u,d,p,h;const f={},m=n.config.theme2;return f.display="grid",f.gridTemplateColumns=s.templateColumns,f.gridTemplateRows=s.templateRows||"unset",f.gridAutoRows=s.autoRows||"unset",f.rowGap=m.spacing(null!=(e=s.rowGap)?e:1),f.columnGap=m.spacing(null!=(r=s.columnGap)?r:1),f.justifyItems=s.justifyItems||"unset",f.alignItems=s.alignItems||"unset",f.justifyContent=s.justifyContent||"unset",f.flexGrow=1,s.md&&(f[m.breakpoints.down("md")]={gridTemplateRows:null==(i=s.md)?void 0:i.templateRows,gridTemplateColumns:null==(a=s.md)?void 0:a.templateColumns,rowGap:s.md.rowGap?m.spacing(null!=(l=null==(o=s.md)?void 0:o.rowGap)?l:1):void 0,columnGap:s.md.columnGap?m.spacing(null!=(u=null==(c=s.md)?void 0:c.rowGap)?u:1):void 0,justifyItems:null==(d=s.md)?void 0:d.justifyItems,alignItems:null==(p=s.md)?void 0:p.alignItems,justifyContent:null==(h=s.md)?void 0:h.justifyContent}),(0,t.css)(f)}),[s]));var s;return i?null:xi().createElement("div",{className:o},r.map((t=>{const n=t.Component;return a?xi().createElement(fS,{key:t.state.key,className:o},xi().createElement(n,{key:t.state.key,model:t,parentState:e.state})):xi().createElement(n,{key:t.state.key,model:t,parentState:e.state})})))};class HE extends Yp{}HE.Component=function({model:e,parentState:n}){if(!n)throw new Error("SceneCSSGridItem must be a child of SceneCSSGridLayout");const{body:r,isHidden:i}=e.useState(),a=(o=e.state,(0,Ei.useMemo)((()=>{const e={};return e.gridColumn=o.gridColumn||"unset",e.gridRow=o.gridRow||"unset",e.position="relative",(0,t.css)(e)}),[o]));var o;return!r||i?null:xi().createElement("div",{className:a},xi().createElement(r.Component,{model:r}))};var GE=Object.defineProperty,WE=Object.getOwnPropertySymbols,QE=Object.prototype.hasOwnProperty,KE=Object.prototype.propertyIsEnumerable,YE=(e,t,n)=>t in e?GE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,XE=(e,t)=>{for(var n in t||(t={}))QE.call(t,n)&&YE(e,n,t[n]);if(WE)for(var n of WE(t))KE.call(t,n)&&YE(e,n,t[n]);return e};const JE=new Set(["ArrowUp","ArrowDown"]),ZE=new Set(["ArrowLeft","ArrowRight"]),ex={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function tx({direction:e="row",handleSize:n=32,initialSize:i="auto",primaryPaneStyles:a,secondaryPaneStyles:o,onDragFinished:s,children:l}){const c=xi().Children.toArray(l),u=(0,Ei.useRef)(null),d=(0,Ei.useRef)(null),p=(0,Ei.useRef)(null),h=(0,Ei.useRef)(null),f=(0,Ei.useRef)(null),m=(0,Ei.useRef)("1fr"),g=(0,Ei.useRef)(void 0),y=(0,Ei.useRef)(void 0),b=ex[e].dim,v=ex[e].axis,w=ex[e].min,S=ex[e].max;!function(e,t,n=0,r){const i=(0,ac.throttle)(t,n);(0,Ei.useLayoutEffect)((()=>{if(!e)return;const t=new ResizeObserver(i);return t.observe(e,{box:"device-pixel-content-box"}),()=>t.disconnect()}),r)}(h.current,(e=>{for(const t of e){if(!t.target.isSameNode(h.current))return;const e=d.current.getBoundingClientRect()[b],n=rx(d.current);u.current.ariaValueNow=`${(0,ac.clamp)((e-n[w])/(n[S]-n[w])*100,0,100)}`}}),500,[S,w,e,b]);const E=(0,Ei.useRef)(null),x=(0,Ei.useCallback)((e=>{m.current=d.current.getBoundingClientRect()[b],f.current=h.current.getBoundingClientRect()[b],E.current=e[v],u.current.setPointerCapture(e.pointerId),g.current=rx(d.current),y.current=void 0}),[b,v]),_=(0,Ei.useCallback)((e=>{if(null!==E.current&&"1fr"!==m.current){const t=e[v]-E.current,r=g.current,i=(0,ac.clamp)(m.current+t,r[w],r[S]),a=i/(f.current-n);d.current.style.flexGrow=`${a}`,p.current.style.flexGrow=""+(1-a);const o=(0,ac.clamp)((i-r[w])/(r[S]-r[w])*100,0,100);u.current.ariaValueNow=`${o}`}}),[n,v,w,S]),O=(0,Ei.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),u.current.releasePointerCapture(e.pointerId),E.current=null,null==s||s(parseFloat(d.current.style.flexGrow))}),[s]),T=(0,Ei.useRef)(new Set),C=(0,Ei.useRef)(null),k=(0,Ei.useCallback)((t=>{var r;if(0===T.current.size)return void(C.current=null);if("1fr"===m.current)return;const i=.3*(t-(null!=(r=C.current)?r:t));let a=0;"row"===e?(T.current.has("ArrowLeft")&&(a-=i),T.current.has("ArrowRight")&&(a+=i)):(T.current.has("ArrowUp")&&(a-=i),T.current.has("ArrowDown")&&(a+=i));const o=g.current,s=d.current.getBoundingClientRect()[b],l=(0,ac.clamp)(s+a,o[w],o[S]),c=l/(f.current-n);d.current.style.flexGrow=`${c}`,p.current.style.flexGrow=""+(1-c);const h=(l-o[w])/(o[S]-o[w])*100;u.current.ariaValueNow=`${(0,ac.clamp)(h,0,100)}`,C.current=t,window.requestAnimationFrame(k)}),[e,n,w,S,b]),P=(0,Ei.useCallback)((t=>{if("Enter"!==t.key){if("Home"===t.key){g.current=rx(d.current),f.current=h.current.getBoundingClientRect()[b];const e=g.current[w]/(f.current-n);return d.current.style.flexGrow=`${e}`,p.current.style.flexGrow=""+(1-e),void(u.current.ariaValueNow="0")}if("End"===t.key){g.current=rx(d.current),f.current=h.current.getBoundingClientRect()[b];const e=g.current[S]/(f.current-n);return d.current.style.flexGrow=`${e}`,p.current.style.flexGrow=""+(1-e),void(u.current.ariaValueNow="100")}if(("column"===e&&JE.has(t.key)||"row"===e&&ZE.has(t.key))&&!T.current.has(t.key)&&(y.current=void 0,t.preventDefault(),t.stopPropagation(),m.current=d.current.getBoundingClientRect()[b],f.current=h.current.getBoundingClientRect()[b],g.current=rx(d.current),!T.current.has(t.key))){const e=0===T.current.size;T.current.add(t.key),e&&window.requestAnimationFrame(k)}}else void 0===y.current?(y.current=d.current.style.flexGrow,d.current.style.flexGrow="0",p.current.style.flexGrow="1"):(d.current.style.flexGrow=y.current,p.current.style.flexGrow=""+(1-parseFloat(y.current)),y.current=void 0)}),[e,k,n,S,b,w]),A=(0,Ei.useCallback)((t=>{"row"===e&&!ZE.has(t.key)||"column"===e&&!JE.has(t.key)||(T.current.delete(t.key),null==s||s(parseFloat(d.current.style.flexGrow)))}),[e,s]),R=(0,Ei.useCallback)((()=>{d.current.style.flexGrow="0.5",p.current.style.flexGrow="0.5";const e=rx(d.current);g.current=e,m.current=d.current.getBoundingClientRect()[b],u.current.ariaValueNow=""+(m.current-e[w])/(e[S]-e[w])*100}),[S,b,w]),D=(0,Ei.useCallback)((()=>{T.current.size>0&&(T.current.clear(),E.current=null,null==s||s(parseFloat(d.current.style.flexGrow)))}),[s]),j=(0,r.useStyles2)(nx),I=hS(),N=2===c.length?"visible":"hidden";return xi().createElement("div",{ref:h,className:j.container,style:{flexDirection:e}},xi().createElement("div",{ref:d,className:j.panel,style:XE({flexGrow:"auto"===i?.5:(0,ac.clamp)(i,0,1),[w]:"min-content"},a),id:`start-panel-${I}`},c[0]),c[1]&&xi().createElement(xi().Fragment,null,xi().createElement("div",{ref:u,style:{[b]:`${n}px`},className:(0,t.cx)(j.handle,{[j.handleHorizontal]:"column"===e}),onPointerUp:O,onPointerDown:x,onPointerMove:_,onKeyDown:P,onKeyUp:A,onDoubleClick:R,onBlur:D,role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":50,"aria-controls":`start-panel-${I}`,"aria-label":"Pane resize widget",tabIndex:0}),xi().createElement("div",{ref:p,className:j.panel,style:XE({flexGrow:"auto"===i?.5:(0,ac.clamp)(1-i,0,1),[w]:"min-content",visibility:`${N}`},o),id:`end-panel-${I}`},c[1])))}function nx(e){return{handle:(0,t.css)({cursor:"col-resize",position:"relative",flexShrink:0,userSelect:"none","&::before":{content:'""',position:"absolute",backgroundColor:e.colors.primary.main,left:"50%",transform:"translate(-50%)",top:0,height:"100%",width:"1px",opacity:0,transition:"opacity ease-in-out 0.2s"},"&::after":{content:'""',width:"4px",borderRadius:"4px",backgroundColor:e.colors.border.weak,transition:"background-color ease-in-out 0.2s",height:"50%",top:"calc(50% - (50%) / 2)",transform:"translateX(-50%)",position:"absolute",left:"50%"},"&:hover, &:focus-visible":{outline:"none","&::before":{opacity:1},"&::after":{backgroundColor:e.colors.primary.main}}}),handleHorizontal:(0,t.css)({cursor:"row-resize","&::before":{left:"inherit",transform:"translateY(-50%)",top:"50%",height:"1px",width:"100%"},"&::after":{width:"50%",height:"4px",top:"50%",transform:"translateY(-50%)",left:"calc(50% - (50%) / 2)"}}),container:(0,t.css)({display:"flex",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,t.css)({display:"flex",position:"relative",flexBasis:0})}}function rx(e){if(null===e)return;const t=document.body.style.overflow,n=e.style.width,r=e.style.height,i=e.style.flexGrow;document.body.style.overflow="hidden",e.style.flexGrow="0";const{width:a,height:o}=e.getBoundingClientRect();e.style.flexGrow="100";const{width:s,height:l}=e.getBoundingClientRect();return document.body.style.overflow=t,e.style.width=n,e.style.height=r,e.style.flexGrow=i,{minWidth:a,maxWidth:s,minHeight:o,maxHeight:l}}class ix extends Yp{toggleDirection(){this.setState({direction:"row"===this.state.direction?"column":"row"})}isDraggable(){return!1}}ix.Component=function({model:e}){const{primary:t,secondary:n,direction:r,isHidden:i,initialSize:a,primaryPaneStyles:o,secondaryPaneStyles:s}=e.useState();if(i)return null;const l=t.Component,c=null==n?void 0:n.Component;let u=n?a:1;return xi().createElement(tx,{direction:r,initialSize:null!=u?u:.5,primaryPaneStyles:o,secondaryPaneStyles:s},xi().createElement(l,{key:t.state.key,model:t,parentState:e.state}),c&&n&&xi().createElement(c,{key:n.state.key,model:n,parentState:e.state}))},class extends Yp{enrichDataRequest(){return{app:this.state.name||"app"}}}.Component=({model:e})=>{const{pages:t}=e.useState();return xi().createElement(Ho.Switch,null,t.map((e=>xi().createElement(Ho.Route,{key:e.state.url,exact:!1,path:e.state.url,render:t=>Sp(e,t)}))))};var ax=Object.defineProperty,ox=Object.getOwnPropertySymbols,sx=Object.prototype.hasOwnProperty,lx=Object.prototype.propertyIsEnumerable,cx=(e,t,n)=>t in e?ax(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class ux extends Yp{}function dx({node:e}){const t=e.useState(),n=(0,r.useStyles2)(px);return xi().createElement("div",{className:n.container},Object.keys(t).map((i=>xi().createElement("div",{className:n.row,key:i},xi().createElement("div",{className:n.keyName},i),xi().createElement("div",{className:n.value},function(e,t,n){if(null===t)return"null";switch(typeof t){case"number":return xi().createElement(r.Input,{type:"number",defaultValue:t,onBlur:t=>n.setState({[e]:t.currentTarget.valueAsNumber})});case"string":return xi().createElement(r.Input,{type:"text",defaultValue:t,onBlur:t=>n.setState({[e]:t.currentTarget.value})});case"object":return uf(t)?t.constructor.name:(0,ac.isPlainObject)(t)||(0,ac.isArray)(t)?xi().createElement(r.JSONFormatter,{json:t,open:0}):String(t);default:return typeof t}}(i,t[i],e))))))}function px(e){return{container:(0,t.css)({flexGrow:1,display:"flex",gap:e.spacing(.5),flexDirection:"column"}),row:(0,t.css)({display:"flex",gap:e.spacing(2)}),keyName:(0,t.css)({display:"flex",flexGrow:"0",width:120,alignItems:"center",height:e.spacing(e.components.height.md)}),value:(0,t.css)({flexGrow:1,minHeight:e.spacing(e.components.height.md),display:"flex",alignItems:"center"})}}function hx({node:e,selectedObject:n,onSelect:i}){const a=(0,r.useStyles2)(fx),o=[],s=e===n;return e.forEachChild((e=>{o.push(xi().createElement(hx,{node:e,key:e.state.key,selectedObject:n,onSelect:i}))})),xi().createElement("div",{className:a.container},xi().createElement("div",{className:(0,t.cx)(a.name,s&&a.selected),onClick:()=>i(e)},e.constructor.name),xi().createElement("div",{className:a.children},o))}function fx(e){return{container:(0,t.css)({flexGrow:1,display:"flex",gap:e.spacing(.5),flexDirection:"column"}),name:(0,t.css)({flexGrow:1,display:"flex",gap:e.spacing(1),fontSize:e.typography.bodySmall.fontSize,cursor:"pointer",padding:e.spacing(0,1),borderRadius:e.shape.borderRadius(2),position:"relative","&:hover":{background:e.colors.background.secondary}}),selected:(0,t.css)({"&::before":{display:"block",content:"' '",position:"absolute",left:0,width:4,bottom:2,top:2,borderRadius:e.shape.radius.default,backgroundImage:e.colors.gradients.brandVertical}}),children:(0,t.css)({flexGrow:1,display:"flex",flexDirection:"column",paddingLeft:e.spacing(1)})}}function mx({scene:e}){const t=(0,r.useStyles2)(gx),[n,i]=(0,Ei.useState)(!1),[a,o]=(0,Ei.useState)();return xi().createElement(xi().Fragment,null,xi().createElement(r.ToolbarButton,{variant:"canvas",icon:"bug",onClick:()=>i(!0)}),n&&xi().createElement(r.Drawer,{title:"Scene debugger",onClose:()=>i(!1),size:"lg"},xi().createElement("div",{className:t.panes},xi().createElement("div",{className:t.pane1},xi().createElement("div",{className:t.paneHeading},"Scene graph"),xi().createElement(r.CustomScrollbar,{autoHeightMin:"100%"},xi().createElement("div",{className:t.treeWrapper},xi().createElement(hx,{node:e,selectedObject:a,onSelect:o})))),xi().createElement("div",{className:t.pane2},xi().createElement("div",{className:t.paneHeading},"Object details"),a&&xi().createElement(dx,{node:a})))))}function gx(e){return{panes:(0,t.css)({flexGrow:1,display:"flex",height:"100%",flexDirection:"row",marginTop:e.spacing(-2)}),pane1:(0,t.css)({flexGrow:0,display:"flex",height:"100%",flexDirection:"column",borderRight:`1px solid ${e.colors.border.weak}`}),pane2:(0,t.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column",paddingLeft:e.spacing(2)}),treeWrapper:(0,t.css)({paddingRight:e.spacing(2),height:"100%",marginLeft:e.spacing(-1)}),paneHeading:(0,t.css)({padding:e.spacing(1,0),fontWeight:e.typography.fontWeightMedium})}}function yx({page:e,routeProps:t}){const r=function(e){return e.parent instanceof wx?e.parent:e}(e),i=r.useState(),a=function(){const e=(0,Ho.useLocation)();return(0,n.locationSearchToObject)(e.search||"")}(),o=e.getScene(t.match),s=i.initializedScene===o;if((0,Ei.useLayoutEffect)((()=>{s||r.initializeScene(o)}),[o,r,s]),(0,Ei.useEffect)((()=>()=>r.setState({initializedScene:void 0})),[r]),!s)return null;const l={text:i.title,img:i.titleImg,icon:i.titleIcon,url:wp(i.url,i.preserveUrlKeys),hideFromBreadcrumbs:i.hideFromBreadcrumbs,parentItem:bx(i.getParentPage?i.getParentPage():r.parent)};i.tabs&&(l.children=i.tabs.map((t=>({text:t.state.title,icon:t.state.titleIcon,tabSuffix:t.state.tabSuffix,active:e===t,url:wp(t.state.url,t.state.preserveUrlKeys),parentItem:l}))));let c=[];return i.controls&&(c=i.controls.map((e=>xi().createElement(e.Component,{model:e,key:e.state.key})))),a["scene-debugger"]&&c.push(xi().createElement(mx,{scene:r,key:"scene-debugger"})),xi().createElement(n.PluginPage,{pageNav:l,actions:c,renderTitle:i.renderTitle,subTitle:i.subTitle},xi().createElement(o.Component,{model:o}))}function bx(e,t){if(e instanceof wx)return{text:e.state.title,url:wp(e.state.url,e.state.preserveUrlKeys),hideFromBreadcrumbs:e.state.hideFromBreadcrumbs,parentItem:bx(e.state.getParentPage?e.state.getParentPage():e.parent)}}function vx({drilldown:e,parent:t,routeProps:n}){return Sp(t.getDrilldownPage(e,n.match),n)}ux.Component=({model:e})=>{const{component:t,props:n,reactNode:r}=e.useState();return t?xi().createElement(t,((e,t)=>{for(var n in t||(t={}))sx.call(t,n)&&cx(e,n,t[n]);if(ox)for(var n of ox(t))lx.call(t,n)&&cx(e,n,t[n]);return e})({},n)):r||null};class wx extends Yp{constructor(e){super(e),this._sceneCache=new Map,this._drilldownCache=new Map,this.addActivationHandler((()=>()=>Uw().cleanUp(this)))}initializeScene(e){this.setState({initializedScene:e}),Uw().initSync(this)}getScene(e){let t=this._sceneCache.get(e.url);if(t)return t;if(!this.state.getScene)throw new Error("Missing getScene on SceneAppPage "+this.state.title);return t=this.state.getScene(e),this._sceneCache.set(e.url,t),t}getDrilldownPage(e,t){let n=this._drilldownCache.get(t.url);return n||(n=e.getPage(t,this),this._drilldownCache.set(t.url,n),n)}enrichDataRequest(e){if(this.state.getParentPage)return this.state.getParentPage().enrichDataRequest(e);if(!this.parent)return null;const t=this.getRoot();return df(t)?t.enrichDataRequest(e):null}}wx.Component=function({model:e,routeProps:t}){var n,r;const{tabs:i,drilldowns:a}=e.useState(),o=[];if(i&&i.length>0)for(let t=0;t<i.length;t++){const a=i[t];if(0===t&&o.push(xi().createElement(Ho.Route,{exact:!0,key:e.state.url,path:null!=(n=e.state.routePath)?n:e.state.url,render:e=>Sp(a,e)})),o.push(xi().createElement(Ho.Route,{exact:!0,key:a.state.url,path:null!=(r=a.state.routePath)?r:a.state.url,render:e=>Sp(a,e)})),a.state.drilldowns)for(const e of a.state.drilldowns)o.push(xi().createElement(Ho.Route,{exact:!1,key:e.routePath,path:e.routePath,render:t=>xi().createElement(vx,{drilldown:e,parent:a,routeProps:t})}))}if(a)for(const t of a)o.push(xi().createElement(Ho.Route,{key:t.routePath,exact:!1,path:t.routePath,render:n=>xi().createElement(vx,{drilldown:t,parent:e,routeProps:n})}));return!i&&(s=e,(l=t.match).isExact&&(l.url===s.state.url||s.parent instanceof wx&&s.parent.state.tabs[0]===s&&s.parent.state.url===l.url))?xi().createElement(yx,{page:e,routeProps:t}):(o.push(function(e,t){return xi().createElement(Ho.Route,{key:"fallback route",render:n=>{var r,i,a;const o=null!=(a=null==(i=(r=e.state).getFallbackPage)?void 0:i.call(r))?a:new wx({url:"",title:"Not found",subTitle:"The url did not match any page",getScene:()=>new qw({body:new LE({direction:"column",children:[new ME({body:new ux({component:()=>xi().createElement("div",{"data-testid":"default-fallback-content"},"If you found your way here using a link then there might be a bug in this application.")})})]})})});return xi().createElement(yx,{page:o,routeProps:t})}})}(e,t)),xi().createElement(Ho.Switch,null,o));var s,l};var Sx=(e=>(e.Always="always",e.Auto="auto",e.Never="never",e))(Sx||{}),Ex=(e=>(e.Hue="hue",e.None="none",e.Opacity="opacity",e.Scheme="scheme",e))(Ex||{}),xx=(e=>(e.None="none",e.Normal="normal",e.Percent="percent",e))(xx||{}),_x=(e=>(e.Auto="auto",e.Horizontal="horizontal",e.Vertical="vertical",e))(_x||{}),Ox=(e=>(e.Background="background",e.BackgroundSolid="background_solid",e.None="none",e.Value="value",e))(Ox||{}),Tx=(e=>(e.Area="area",e.Line="line",e.None="none",e))(Tx||{}),Cx=(e=>(e.Auto="auto",e.Center="center",e))(Cx||{}),kx=(e=>(e.Auto="auto",e.Name="name",e.None="none",e.Value="value",e.ValueAndName="value_and_name",e))(kx||{}),Px=(e=>(e.Inverted="inverted",e.SameAsValue="same_as_value",e.Standard="standard",e))(Px||{}),Ax=(e=>(e.Multi="multi",e.None="none",e.Single="single",e))(Ax||{}),Rx=(e=>(e.Basic="basic",e.Gradient="gradient",e.Lcd="lcd",e))(Rx||{}),Dx=(e=>(e.Color="color",e.Hidden="hidden",e.Text="text",e))(Dx||{}),jx=(e=>(e.Auto="auto",e.Left="left",e.Top="top",e))(jx||{}),Ix=(e=>(e.Auto="auto",e.Manual="manual",e))(Ix||{}),Nx=(e=>(e.Auto="auto",e.Lg="lg",e.Md="md",e.Sm="sm",e))(Nx||{});_x.Auto,Sx.Auto,xx.None,Ex.None;const Lx={displayMode:Rx.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:jx.Auto,showUnfilled:!0,sizing:Ix.Auto,valueMode:Dx.Color},Mx=(Ix.Auto,Sx.Auto,Ax.Single,{bucketCount:30,bucketOffset:0}),Fx={fillOpacity:80,gradientMode:Ex.None,lineWidth:1};Ox.Value,Tx.Area,Cx.Auto,Px.Standard,kx.Auto,Sx.Auto,Sx.Auto,Nx.Sm,Sx.Auto;class $x{constructor(){this._overrides=[]}overrideColor(e){return this._overrides[this._overrides.length-1].properties.push({id:"color",value:e}),this}overrideDecimals(e){return this._overrides[this._overrides.length-1].properties.push({id:"decimals",value:e}),this}overrideDisplayName(e){return this._overrides[this._overrides.length-1].properties.push({id:"displayName",value:e}),this}overrideFilterable(e){return this._overrides[this._overrides.length-1].properties.push({id:"filterable",value:e}),this}overrideLinks(e){return this._overrides[this._overrides.length-1].properties.push({id:"links",value:e}),this}overrideMappings(e){return this._overrides[this._overrides.length-1].properties.push({id:"mappings",value:e}),this}overrideMax(e){return this._overrides[this._overrides.length-1].properties.push({id:"max",value:e}),this}overrideMin(e){return this._overrides[this._overrides.length-1].properties.push({id:"min",value:e}),this}overrideNoValue(e){return this._overrides[this._overrides.length-1].properties.push({id:"noValue",value:e}),this}overrideThresholds(e){return this._overrides[this._overrides.length-1].properties.push({id:"thresholds",value:e}),this}overrideUnit(e){return this._overrides[this._overrides.length-1].properties.push({id:"unit",value:e}),this}}class Bx extends $x{match(e){return this._overrides.push({matcher:e,properties:[]}),this}matchFieldsWithName(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byName,options:t},properties:[]}),this}matchFieldsWithNameByRegex(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byRegexp,options:t},properties:[]}),this}matchFieldsByType(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byType,options:t},properties:[]}),this}matchFieldsByQuery(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byFrameRefID,options:t},properties:[]}),this}matchFieldsByValue(t){return this._overrides.push({matcher:{id:e.FieldMatcherID.byValue,options:t},properties:[]}),this}matchComparisonQuery(e){return this.matchFieldsByQuery(bE(e))}overrideCustomFieldConfig(e,t){const n=`custom.${String(e)}`;return this._overrides[this._overrides.length-1].properties.push({id:n,value:t}),this}build(){return this._overrides}}var Vx=Object.defineProperty,zx=Object.defineProperties,Ux=Object.getOwnPropertyDescriptors,qx=Object.getOwnPropertySymbols,Hx=Object.prototype.hasOwnProperty,Gx=Object.prototype.propertyIsEnumerable,Wx=(e,t,n)=>t in e?Vx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Qx=(e,t)=>{for(var n in t||(t={}))Hx.call(t,n)&&Wx(e,n,t[n]);if(qx)for(var n of qx(t))Gx.call(t,n)&&Wx(e,n,t[n]);return e},Kx=(e,t)=>zx(e,Ux(t));class Yx{constructor(e){this.defaultFieldConfig=e,this._fieldConfig={defaults:{},overrides:[]},this._overridesBuilder=new Bx,this.setDefaults()}setDefaults(){const e={defaults:{custom:this.defaultFieldConfig?(0,ac.cloneDeep)(this.defaultFieldConfig()):{}},overrides:[]};this._fieldConfig=e}setColor(e){return this.setFieldConfigDefaults("color",e)}setDecimals(e){return this.setFieldConfigDefaults("decimals",e)}setDisplayName(e){return this.setFieldConfigDefaults("displayName",e)}setFilterable(e){return this.setFieldConfigDefaults("filterable",e)}setLinks(e){return this.setFieldConfigDefaults("links",e)}setMappings(e){return this.setFieldConfigDefaults("mappings",e)}setMax(e){return this.setFieldConfigDefaults("max",e)}setMin(e){return this.setFieldConfigDefaults("min",e)}setNoValue(e){return this.setFieldConfigDefaults("noValue",e)}setThresholds(e){return this.setFieldConfigDefaults("thresholds",e)}setUnit(e){return this.setFieldConfigDefaults("unit",e)}setCustomFieldConfig(e,t){return this._fieldConfig.defaults=Kx(Qx({},this._fieldConfig.defaults),{custom:(0,ac.merge)(this._fieldConfig.defaults.custom,{[e]:t})}),this}setOverrides(e){return e(this._overridesBuilder),this}setFieldConfigDefaults(e,t){return this._fieldConfig.defaults=Kx(Qx({},this._fieldConfig.defaults),{[e]:t}),this}build(){return{defaults:this._fieldConfig.defaults,overrides:this._overridesBuilder.build()}}}class Xx{constructor(e){this.defaultOptions=e,this._options={},this.setDefaults()}setDefaults(){this._options=this.defaultOptions?(0,ac.cloneDeep)(this.defaultOptions()):{}}setOption(e,t){return this._options=(0,ac.merge)(this._options,{[e]:t}),this}build(){return this._options}}var Jx=Object.defineProperty,Zx=Object.defineProperties,e_=Object.getOwnPropertyDescriptors,t_=Object.getOwnPropertySymbols,n_=Object.prototype.hasOwnProperty,r_=Object.prototype.propertyIsEnumerable,i_=(e,t,n)=>t in e?Jx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;class a_{constructor(e,t,n,r){this._state={},this._state.title="",this._state.description="",this._state.displayMode="default",this._state.hoverHeader=!1,this._state.pluginId=e,this._state.pluginVersion=t,this._fieldConfigBuilder=new Yx(r),this._panelOptionsBuilder=new Xx(n)}setTitle(e){return this._state.title=e,this}setDescription(e){return this._state.description=e,this}setDisplayMode(e){return this._state.displayMode=e,this}setHoverHeader(e){return this._state.hoverHeader=e,this}setMenu(e){return this._state.menu=e,this}setHeaderActions(e){return this._state.headerActions=e,this}setColor(e){return this._fieldConfigBuilder.setColor(e),this}setDecimals(e){return this._fieldConfigBuilder.setDecimals(e),this}setDisplayName(e){return this._fieldConfigBuilder.setDisplayName(e),this}setFilterable(e){return this._fieldConfigBuilder.setFilterable(e),this}setLinks(e){return this._fieldConfigBuilder.setLinks(e),this}setMappings(e){return this._fieldConfigBuilder.setMappings(e),this}setMax(e){return this._fieldConfigBuilder.setMax(e),this}setMin(e){return this._fieldConfigBuilder.setMin(e),this}setNoValue(e){return this._fieldConfigBuilder.setNoValue(e),this}setThresholds(e){return this._fieldConfigBuilder.setThresholds(e),this}setUnit(e){return this._fieldConfigBuilder.setUnit(e),this}setCustomFieldConfig(e,t){return this._fieldConfigBuilder.setCustomFieldConfig(e,t),this}setOverrides(e){return this._fieldConfigBuilder.setOverrides(e),this}setOption(e,t){return this._panelOptionsBuilder.setOption(e,t),this}setData(e){return this._state.$data=e,this}setTimeRange(e){return this._state.$timeRange=e,this}setVariables(e){return this._state.$variables=e,this}setBehaviors(e){return this._state.$behaviors=e,this}build(){const e=new My(((e,t)=>Zx(e,e_(t)))(((e,t)=>{for(var n in t||(t={}))n_.call(t,n)&&i_(e,n,t[n]);if(t_)for(var n of t_(t))r_.call(t,n)&&i_(e,n,t[n]);return e})({},this._state),{options:this._panelOptionsBuilder.build(),fieldConfig:this._fieldConfigBuilder.build()}));return e}}const o_=()=>new a_("bargauge","10.0.0",(()=>Lx)),s_=()=>new a_("histogram","10.0.0",(()=>Mx),(()=>Fx)),l_=()=>new a_("timeseries","10.0.0"),c_=function({dataSource:e}){if(lh.has(e.uid))throw new Error(`A runtime data source with uid ${e.uid} has already been registered`);lh.set(e.uid,e)};function u_(){history.pushState(null,"")}class d_ extends e.BusEventWithPayload{}var p_,h_,f_,m_,g_,y_,b_;f_="timeseries-data-received",(h_="type")in(p_=d_)?Object.defineProperty(p_,h_,{value:f_,enumerable:!0,configurable:!0,writable:!0}):p_[h_]=f_,function(e){e.partial="partial",e["attribute-operator-value"]="attribute-operator-value",e["attribute-operator"]="attribute-operator"}(m_||(m_={})),function(e){e["="]="=",e["!="]="!=",e.in="in",e["not-in"]="not-in",e["is-empty"]="is-empty",e["=~"]="=~",e["!~"]="!~"}(g_||(g_={})),function(e){e.attribute="attribute",e.operator="operator",e.value="value"}(y_||(y_={})),function(e){e.attribute="attribute",e.operator="operator",e.value="value"}(b_||(b_={}));var v_,w_,S_,E_,x_=function(){return x_=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},x_.apply(this,arguments)};function __(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function O_(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function T_(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function C_(e,t,n){if(n||2===arguments.length)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}(E_=v_||(v_={})).Start="xstate.start",E_.Stop="xstate.stop",E_.Raise="xstate.raise",E_.Send="xstate.send",E_.Cancel="xstate.cancel",E_.NullEvent="",E_.Assign="xstate.assign",E_.After="xstate.after",E_.DoneState="done.state",E_.DoneInvoke="done.invoke",E_.Log="xstate.log",E_.Init="xstate.init",E_.Invoke="xstate.invoke",E_.ErrorExecution="error.execution",E_.ErrorCommunication="error.communication",E_.ErrorPlatform="error.platform",E_.ErrorCustom="xstate.error",E_.Update="xstate.update",E_.Pure="xstate.pure",E_.Choose="xstate.choose",(S_=w_||(w_={})).Parent="#_parent",S_.Internal="#_internal";var k_,P_=v_.Start,A_=v_.Stop,R_=v_.Raise,D_=v_.Send,j_=v_.Cancel,I_=v_.NullEvent,N_=v_.Assign,L_=(v_.After,v_.DoneState,v_.Log),M_=v_.Init,F_=v_.Invoke,$_=(v_.ErrorExecution,v_.ErrorPlatform),B_=v_.ErrorCustom,V_=v_.Update,z_=v_.Choose,U_=v_.Pure,q_={},H_="xstate.guard",G_=!0;function W_(e,t,n){void 0===n&&(n=".");var r=Y_(e,n),i=Y_(t,n);return pO(i)?!!pO(r)&&i===r:pO(r)?r in i:Object.keys(r).every((function(e){return e in i&&W_(r[e],i[e])}))}function Q_(e){try{return pO(e)||"number"==typeof e?"".concat(e):e.type}catch(e){throw new Error("Events must be strings or objects with a string event.type property.")}}function K_(e,t){try{return uO(e)?e:e.toString().split(t)}catch(t){throw new Error("'".concat(e,"' is not a valid state path."))}}function Y_(e,t){return"object"==typeof(n=e)&&"value"in n&&"context"in n&&"event"in n&&"_event"in n?e.value:uO(e)?X_(e):"string"!=typeof e?e:X_(K_(e,t));var n}function X_(e){if(1===e.length)return e[0];for(var t={},n=t,r=0;r<e.length-1;r++)r===e.length-2?n[e[r]]=e[r+1]:(n[e[r]]={},n=n[e[r]]);return t}function J_(e,t){for(var n={},r=Object.keys(e),i=0;i<r.length;i++){var a=r[i];n[a]=t(e[a],a,e,i)}return n}function Z_(e,t,n){var r,i,a={};try{for(var o=O_(Object.keys(e)),s=o.next();!s.done;s=o.next()){var l=s.value,c=e[l];n(c)&&(a[l]=t(c,l,e))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}var eO=function(e){return function(t){var n,r,i=t;try{for(var a=O_(e),o=a.next();!o.done;o=a.next())i=i[o.value]}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return i}};function tO(e){if(!e)return[[]];if(pO(e))return[[e]];var t=nO(Object.keys(e).map((function(t){var n=e[t];return"string"==typeof n||n&&Object.keys(n).length?tO(e[t]).map((function(e){return[t].concat(e)})):[[t]]})));return t}function nO(e){var t;return(t=[]).concat.apply(t,C_([],T_(e),!1))}function rO(e){return uO(e)?e:[e]}function iO(e){return void 0===e?[]:rO(e)}function aO(e,t,n){var r,i;if(dO(e))return e(t,n.data);var a={};try{for(var o=O_(Object.keys(e)),s=o.next();!s.done;s=o.next()){var l=s.value,c=e[l];dO(c)?a[l]=c(t,n.data):a[l]=c}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return a}function oO(e){return e instanceof Promise||!(null===e||!dO(e)&&"object"!=typeof e||!dO(e.then))}function sO(e,t){return J_(e.states,(function(e,n){if(e){var r=(pO(t)?void 0:t[n])||(e?e.current:void 0);if(r)return{current:r,states:sO(e,r)}}}))}function lO(e,t,n,r){G_||cO(!!e,"Attempting to update undefined context");var i=e?n.reduce((function(e,n){var i,a,o=n.assignment,s={state:r,action:n,_event:t},l={};if(dO(o))l=o(e,t.data,s);else try{for(var c=O_(Object.keys(o)),u=c.next();!u.done;u=c.next()){var d=u.value,p=o[d];l[d]=dO(p)?p(e,t.data,s):p}}catch(e){i={error:e}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(i)throw i.error}}return Object.assign({},e,l)}),e):e;return i}var cO=function(){};function uO(e){return Array.isArray(e)}function dO(e){return"function"==typeof e}function pO(e){return"string"==typeof e}function hO(e,t){if(e)return pO(e)?{type:H_,name:e,predicate:t?t[e]:void 0}:dO(e)?{type:H_,name:e.name,predicate:e}:e}G_||(cO=function(e,t){var n=e instanceof Error?e:void 0;if((n||!e)&&void 0!==console){var r=["Warning: ".concat(t)];n&&r.push(n),console.warn.apply(console,r)}});var fO=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function mO(e){return!!e&&"__xstatenode"in e}function gO(e,t){return pO(e)||"number"==typeof e?x_({type:e},t):e}function yO(e,t){if(!pO(e)&&"$$type"in e&&"scxml"===e.$$type)return e;var n=gO(e);return x_({name:n.type,data:n,$$type:"scxml",type:"external"},t)}function bO(e,t){return rO(t).map((function(t){return void 0===t||"string"==typeof t||mO(t)?{target:t,event:e}:x_(x_({},t),{event:e})}))}function vO(e,t,n,r,i){var a=e.options.guards,o={state:i,cond:t,_event:r};if(t.type===H_)return((null==a?void 0:a[t.name])||t.predicate)(n,r.data,o);var s=null==a?void 0:a[t.type];if(!s)throw new Error("Guard '".concat(t.type,"' is not implemented on machine '").concat(e.id,"'."));return s(n,r.data,o)}function wO(e){return"string"==typeof e?{type:e}:e}function SO(e,t,n){var r=function(){},i="object"==typeof e,a=i?e:null;return{next:((i?e.next:e)||r).bind(a),error:((i?e.error:t)||r).bind(a),complete:((i?e.complete:n)||r).bind(a)}}function EO(e,t){return"".concat(e,":invocation[").concat(t,"]")}function xO(e){return(e.type===R_||e.type===D_&&e.to===w_.Internal)&&"number"!=typeof e.delay}(k_={})[fO]=function(){return this},k_[Symbol.observable]=function(){return this};var _O=function(e){return"atomic"===e.type||"final"===e.type};function OO(e){return Object.keys(e.states).map((function(t){return e.states[t]}))}function TO(e){return OO(e).filter((function(e){return"history"!==e.type}))}function CO(e){var t=[e];return _O(e)?t:t.concat(nO(TO(e).map(CO)))}function kO(e,t){var n,r,i,a,o,s,l,c,u=AO(new Set(e)),d=new Set(t);try{for(var p=O_(d),h=p.next();!h.done;h=p.next())for(var f=(x=h.value).parent;f&&!d.has(f);)d.add(f),f=f.parent}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}var m=AO(d);try{for(var g=O_(d),y=g.next();!y.done;y=g.next())if("compound"!==(x=y.value).type||m.get(x)&&m.get(x).length){if("parallel"===x.type)try{for(var b=(o=void 0,O_(TO(x))),v=b.next();!v.done;v=b.next()){var w=v.value;d.has(w)||(d.add(w),u.get(w)?u.get(w).forEach((function(e){return d.add(e)})):w.initialStateNodes.forEach((function(e){return d.add(e)})))}}catch(e){o={error:e}}finally{try{v&&!v.done&&(s=b.return)&&s.call(b)}finally{if(o)throw o.error}}}else u.get(x)?u.get(x).forEach((function(e){return d.add(e)})):x.initialStateNodes.forEach((function(e){return d.add(e)}))}catch(e){i={error:e}}finally{try{y&&!y.done&&(a=g.return)&&a.call(g)}finally{if(i)throw i.error}}try{for(var S=O_(d),E=S.next();!E.done;E=S.next()){var x;for(f=(x=E.value).parent;f&&!d.has(f);)d.add(f),f=f.parent}}catch(e){l={error:e}}finally{try{E&&!E.done&&(c=S.return)&&c.call(S)}finally{if(l)throw l.error}}return d}function PO(e,t){var n=t.get(e);if(!n)return{};if("compound"===e.type){var r=n[0];if(!r)return{};if(_O(r))return r.key}var i={};return n.forEach((function(e){i[e.key]=PO(e,t)})),i}function AO(e){var t,n,r=new Map;try{for(var i=O_(e),a=i.next();!a.done;a=i.next()){var o=a.value;r.has(o)||r.set(o,[]),o.parent&&(r.has(o.parent)||r.set(o.parent,[]),r.get(o.parent).push(o))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function RO(e,t){return PO(e,AO(kO([e],t)))}function DO(e,t){return Array.isArray(e)?e.some((function(e){return e===t})):e instanceof Set&&e.has(t)}function jO(e,t){return"compound"===t.type?TO(t).some((function(t){return"final"===t.type&&DO(e,t)})):"parallel"===t.type&&TO(t).every((function(t){return jO(e,t)}))}function IO(e){return new Set(nO(e.map((function(e){return e.tags}))))}var NO=yO({type:M_});function LO(e,t){return t&&t[e]||void 0}function MO(e,t){var n;if(pO(e)||"number"==typeof e)n=dO(r=LO(e,t))?{type:e,exec:r}:r||{type:e,exec:void 0};else if(dO(e))n={type:e.name||e.toString(),exec:e};else{var r;if(dO(r=LO(e.type,t)))n=x_(x_({},e),{exec:r});else if(r){var i=r.type||e.type;n=x_(x_(x_({},r),e),{type:i})}else n=e}return n}var FO=function(e,t){return e?(uO(e)?e:[e]).map((function(e){return MO(e,t)})):[]};function $O(e){var t=MO(e);return x_(x_({id:pO(e)?e:t.id},t),{type:t.type})}function BO(e,t){var n="".concat(v_.DoneState,".").concat(e);return{type:n,data:t,toString:function(){return n}}}function VO(e,t){var n="".concat(v_.DoneInvoke,".").concat(e);return{type:n,data:t,toString:function(){return n}}}function zO(e,t){var n="".concat(v_.ErrorPlatform,".").concat(e);return{type:n,data:t,toString:function(){return n}}}function UO(e,t,n,r,i,a,o){void 0===o&&(o=!1);var s=o?[]:function(e){var t,n,r=[];try{for(var i=O_(e),a=i.next();!a.done;a=i.next())for(var o=a.value,s=0;s<o.actions.length;)o.actions[s].type!==N_?s++:(r.push(o.actions[s]),o.actions.splice(s,1))}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(i),l=s.length?lO(n,r,s,t):n,c=o?[n]:void 0,u=[];function d(i,s){var d;switch(s.type){case R_:var p=function(e,t,n,r){var i,a={_event:n},o=yO(dO(e.event)?e.event(t,n.data,a):e.event);if(pO(e.delay)){var s=r&&r[e.delay];i=dO(s)?s(t,n.data,a):s}else i=dO(e.delay)?e.delay(t,n.data,a):e.delay;return x_(x_({},e),{type:R_,_event:o,delay:i})}(s,l,r,e.options.delays);return a&&"number"==typeof p.delay&&a(p,l,r),p;case D_:var h=function(e,t,n,r){var i,a={_event:n},o=yO(dO(e.event)?e.event(t,n.data,a):e.event);if(pO(e.delay)){var s=r&&r[e.delay];i=dO(s)?s(t,n.data,a):s}else i=dO(e.delay)?e.delay(t,n.data,a):e.delay;var l=dO(e.to)?e.to(t,n.data,a):e.to;return x_(x_({},e),{to:l,_event:o,event:o.data,delay:i})}(s,l,r,e.options.delays);if(!G_){var f=s.delay;cO(!pO(f)||"number"==typeof h.delay,"No delay reference for delay expression '".concat(f,"' was found on machine '").concat(e.id,"'"))}return a&&h.to!==w_.Internal&&("entry"===i?u.push(h):a(h,l,r)),h;case L_:var m=function(e,t,n){return x_(x_({},e),{value:pO(e.expr)?e.expr:e.expr(t,n.data,{_event:n})})}(s,l,r);return null==a||a(m,l,r),m;case z_:if(!(v=null===(d=s.conds.find((function(n){var i=hO(n.cond,e.options.guards);return!i||vO(e,i,l,r,a?void 0:t)})))||void 0===d?void 0:d.actions))return[];var g=T_(UO(e,t,l,r,[{type:i,actions:FO(iO(v),e.options.actions)}],a,o),2),y=g[0],b=g[1];return l=b,null==c||c.push(l),y;case U_:var v;if(!(v=s.get(l,r.data)))return[];var w=T_(UO(e,t,l,r,[{type:i,actions:FO(iO(v),e.options.actions)}],a,o),2),S=w[0],E=w[1];return l=E,null==c||c.push(l),S;case A_:return m=function(e,t,n){var r=dO(e.activity)?e.activity(t,n.data):e.activity,i="string"==typeof r?{id:r}:r;return{type:v_.Stop,activity:i}}(s,l,r),null==a||a(m,n,r),m;case N_:l=lO(l,r,[s],a?void 0:t),null==c||c.push(l);break;default:var x=MO(s,e.options.actions),_=x.exec;if(a)a(x,l,r);else if(_&&c){var O=c.length-1,T=x_(x_({},x),{exec:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];_.apply(void 0,C_([c[O]],T_(t),!1))}});x=T}return x}}var p=nO(i.map((function(e){var t,n,i=[];try{for(var o=O_(e.actions),s=o.next();!s.done;s=o.next()){var c=s.value,p=d(e.type,c);p&&(i=i.concat(p))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return u.forEach((function(e){a(e,l,r)})),u.length=0,i})));return[p,l]}function qO(e,t){if(e===t)return!0;if(void 0===e||void 0===t)return!1;if(pO(e)||pO(t))return e===t;var n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((function(n){return qO(e[n],t[n])}))}var HO=function(){function e(e){var t,n,r=this;this.actions=[],this.activities=q_,this.meta={},this.events=[],this.value=e.value,this.context=e.context,this._event=e._event,this._sessionid=e._sessionid,this.event=this._event.data,this.historyValue=e.historyValue,this.history=e.history,this.actions=e.actions||[],this.activities=e.activities||q_,this.meta=(void 0===(n=e.configuration)&&(n=[]),n.reduce((function(e,t){return void 0!==t.meta&&(e[t.id]=t.meta),e}),{})),this.events=e.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=e.configuration,this.transitions=e.transitions,this.children=e.children,this.done=!!e.done,this.tags=null!==(t=Array.isArray(e.tags)?new Set(e.tags):e.tags)&&void 0!==t?t:new Set,this.machine=e.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(e){return C_([],T_(new Set(nO(C_([],T_(e.map((function(e){return e.ownEvents}))),!1)))),!1)}(r.configuration)}})}return e.from=function(t,n){return t instanceof e?t.context!==n?new e({value:t.value,context:n,_event:t._event,_sessionid:null,historyValue:t.historyValue,history:t.history,actions:[],activities:t.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):t:new e({value:t,context:n,_event:NO,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},e.create=function(t){return new e(t)},e.inert=function(t,n){if(t instanceof e){if(!t.actions.length)return t;var r=NO;return new e({value:t.value,context:n,_event:r,_sessionid:null,historyValue:t.historyValue,history:t.history,activities:t.activities,configuration:t.configuration,transitions:[],children:{}})}return e.from(t,n)},e.prototype.toStrings=function(e,t){var n=this;if(void 0===e&&(e=this.value),void 0===t&&(t="."),pO(e))return[e];var r=Object.keys(e);return r.concat.apply(r,C_([],T_(r.map((function(r){return n.toStrings(e[r],t).map((function(e){return r+t+e}))}))),!1))},e.prototype.toJSON=function(){var e=this;e.configuration,e.transitions;var t=e.tags;e.machine;var n=__(e,["configuration","transitions","tags","machine"]);return x_(x_({},n),{tags:Array.from(t)})},e.prototype.matches=function(e){return W_(e,this.value)},e.prototype.hasTag=function(e){return this.tags.has(e)},e.prototype.can=function(e){var t;G_&&cO(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var n=null===(t=this.machine)||void 0===t?void 0:t.getTransitionData(this,e);return!!(null==n?void 0:n.transitions.length)&&n.transitions.some((function(e){return void 0!==e.target||e.actions.length}))},e}(),GO=[],WO=function(e,t){GO.push(e);var n=t(e);return GO.pop(),n};function QO(e){var t;return(t={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:e}}})[fO]=function(){return this},t}function KO(e,t,n){var r=QO(t);if(r.deferred=!0,mO(e)){var i=r.state=WO(void 0,(function(){return(n?e.withContext(n):e).initialState}));r.getSnapshot=function(){return i}}return r}function YO(e){return x_(x_({type:F_},e),{toJSON:function(){e.onDone,e.onError;var t,n=__(e,["onDone","onError"]);return x_(x_({},n),{type:F_,src:(t=e.src,"string"==typeof t?{type:t,toString:function(){return t}}:t)})}})}var XO="",JO="*",ZO={},eT=function(e){return"#"===e[0]},tT=function(){function e(t,n,r,i){void 0===r&&(r="context"in t?t.context:void 0);var a,o=this;this.config=t,this._context=r,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},n),this.parent=null==i?void 0:i.parent,this.key=this.config.key||(null==i?void 0:i.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||C_([this.machine.key],T_(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(a=this.config.schema)&&void 0!==a?a:{},this.description=this.config.description,G_||cO(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?J_(this.config.states,(function(t,n){var r,i=new e(t,{},void 0,{parent:o,key:n});return Object.assign(o.idMap,x_(((r={})[i.id]=i,r),i.idMap)),i})):ZO;var s=0;!function e(t){var n,r;t.order=s++;try{for(var i=O_(OO(t)),a=i.next();!a.done;a=i.next())e(a.value)}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(e){return e.event===XO})):XO in this.config.on),this.strict=!!this.config.strict,this.onEntry=iO(this.config.entry||this.config.onEntry).map((function(e){return MO(e)})),this.onExit=iO(this.config.exit||this.config.onExit).map((function(e){return MO(e)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=iO(this.config.invoke).map((function(e,t){var n,r;if(mO(e)){var i=EO(o.id,t);return o.machine.options.services=x_(((n={})[i]=e,n),o.machine.options.services),YO({src:i,id:i})}if(pO(e.src))return i=e.id||EO(o.id,t),YO(x_(x_({},e),{id:i,src:e.src}));if(mO(e.src)||dO(e.src))return i=e.id||EO(o.id,t),o.machine.options.services=x_(((r={})[i]=e.src,r),o.machine.options.services),YO(x_(x_({id:i},e),{src:i}));var a=e.src;return YO(x_(x_({id:EO(o.id,t)},e),{src:a}))})),this.activities=iO(this.config.activities).concat(this.invoke).map((function(e){return $O(e)})),this.transition=this.transition.bind(this),this.tags=iO(this.config.tags)}return e.prototype._init=function(){this.__cache.transitions||CO(this).forEach((function(e){return e.on}))},e.prototype.withConfig=function(t,n){var r=this.options,i=r.actions,a=r.activities,o=r.guards,s=r.services,l=r.delays;return new e(this.config,{actions:x_(x_({},i),t.actions),activities:x_(x_({},a),t.activities),guards:x_(x_({},o),t.guards),services:x_(x_({},s),t.services),delays:x_(x_({},l),t.delays)},null!=n?n:this.context)},e.prototype.withContext=function(t){return new e(this.config,this.options,t)},Object.defineProperty(e.prototype,"context",{get:function(){return dO(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:J_(this.states,(function(e){return e.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){return this.definition},Object.defineProperty(e.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var e=this.transitions;return this.__cache.on=e.reduce((function(e,t){return e[t.eventType]=e[t.eventType]||[],e[t.eventType].push(t),e}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),e.prototype.getCandidates=function(e){if(this.__cache.candidates[e])return this.__cache.candidates[e];var t=e===XO,n=this.transitions.filter((function(n){var r=n.eventType===e;return t?r:r||n.eventType===JO}));return this.__cache.candidates[e]=n,n},e.prototype.getDelayedTransitions=function(){var e=this,t=this.config.after;if(!t)return[];var n=function(t,n){var r,i,a,o=(r=dO(t)?"".concat(e.id,":delay[").concat(n,"]"):t,i=e.id,a=i?"#".concat(i):"","".concat(v_.After,"(").concat(r,")").concat(a));return e.onEntry.push(function(e,t){return{to:t?t.to:void 0,type:D_,event:dO(e)?e:gO(e),delay:t?t.delay:void 0,id:t&&void 0!==t.id?t.id:dO(e)?e.name:Q_(e)}}(o,{delay:t})),e.onExit.push({type:j_,sendId:o}),o},r=uO(t)?t.map((function(e,t){var r=n(e.delay,t);return x_(x_({},e),{event:r})})):nO(Object.keys(t).map((function(e,r){var i=t[e],a=pO(i)?{target:i}:i,o=isNaN(+e)?e:+e,s=n(o,r);return iO(a).map((function(e){return x_(x_({},e),{event:s,delay:o})}))})));return r.map((function(t){var n=t.delay;return x_(x_({},e.formatTransition(t)),{delay:n})}))},e.prototype.getStateNodes=function(e){var t,n=this;if(!e)return[];var r=e instanceof HO?e.value:Y_(e,this.delimiter);if(pO(r)){var i=this.getStateNode(r).initial;return void 0!==i?this.getStateNodes(((t={})[r]=i,t)):[this,this.states[r]]}var a=Object.keys(r),o=[this];return o.push.apply(o,C_([],T_(nO(a.map((function(e){return n.getStateNode(e).getStateNodes(r[e])})))),!1)),o},e.prototype.handles=function(e){var t=Q_(e);return this.events.includes(t)},e.prototype.resolveState=function(e){var t=e instanceof HO?e:HO.create(e),n=Array.from(kO([],this.getStateNodes(t.value)));return new HO(x_(x_({},t),{value:this.resolve(t.value),configuration:n,done:jO(n,this),tags:IO(n),machine:this.machine}))},e.prototype.transitionLeafNode=function(e,t,n){var r=this.getStateNode(e).next(t,n);return r&&r.transitions.length?r:this.next(t,n)},e.prototype.transitionCompoundNode=function(e,t,n){var r=Object.keys(e),i=this.getStateNode(r[0])._transition(e[r[0]],t,n);return i&&i.transitions.length?i:this.next(t,n)},e.prototype.transitionParallelNode=function(e,t,n){var r,i,a={};try{for(var o=O_(Object.keys(e)),s=o.next();!s.done;s=o.next()){var l=s.value,c=e[l];if(c){var u=this.getStateNode(l)._transition(c,t,n);u&&(a[l]=u)}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}var d=Object.keys(a).map((function(e){return a[e]})),p=nO(d.map((function(e){return e.transitions})));if(!d.some((function(e){return e.transitions.length>0})))return this.next(t,n);var h=nO(Object.keys(a).map((function(e){return a[e].configuration})));return{transitions:p,exitSet:nO(d.map((function(e){return e.exitSet}))),configuration:h,source:t,actions:nO(Object.keys(a).map((function(e){return a[e].actions})))}},e.prototype._transition=function(e,t,n){return pO(e)?this.transitionLeafNode(e,t,n):1===Object.keys(e).length?this.transitionCompoundNode(e,t,n):this.transitionParallelNode(e,t,n)},e.prototype.getTransitionData=function(e,t){return this._transition(e.value,e,yO(t))},e.prototype.next=function(e,t){var n,r,i,a=this,o=t.name,s=[],l=[];try{for(var c=O_(this.getCandidates(o)),u=c.next();!u.done;u=c.next()){var d=u.value,p=d.cond,h=d.in,f=e.context,m=!h||(pO(h)&&eT(h)?e.matches(Y_(this.getStateNodeById(h).path,this.delimiter)):W_(Y_(h,this.delimiter),eO(this.path.slice(0,-2))(e.value))),g=!1;try{g=!p||vO(this.machine,p,f,t,e)}catch(e){throw new Error("Unable to evaluate guard '".concat(p.name||p.type,"' in transition for event '").concat(o,"' in state node '").concat(this.id,"':\n").concat(e.message))}if(g&&m){void 0!==d.target&&(l=d.target),s.push.apply(s,C_([],T_(d.actions),!1)),i=d;break}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}if(i){if(!l.length)return{transitions:[i],exitSet:[],configuration:e.value?[this]:[],source:e,actions:s};var y=nO(l.map((function(t){return a.getRelativeStateNodes(t,e.historyValue)})));return{transitions:[i],exitSet:i.internal?[]:nO(l.map((function(e){return a.getPotentiallyReenteringNodes(e)}))),configuration:y,source:e,actions:s}}},e.prototype.getPotentiallyReenteringNodes=function(e){if(this.order<e.order)return[this];for(var t=[],n=this,r=e;n&&n!==r;)t.push(n),n=n.parent;return n!==r?[]:(t.push(r),t)},e.prototype.getActions=function(e,t,n,r,i,a,o){var s,l,c,u,d=this,p=a?kO([],this.getStateNodes(a.value)):[],h=new Set;try{for(var f=O_(Array.from(e).sort((function(e,t){return e.order-t.order}))),m=f.next();!m.done;m=f.next())(!DO(p,b=m.value)||DO(n.exitSet,b)||b.parent&&h.has(b.parent))&&h.add(b)}catch(e){s={error:e}}finally{try{m&&!m.done&&(l=f.return)&&l.call(f)}finally{if(s)throw s.error}}try{for(var g=O_(p),y=g.next();!y.done;y=g.next()){var b;DO(e,b=y.value)&&!DO(n.exitSet,b.parent)||n.exitSet.push(b)}}catch(e){c={error:e}}finally{try{y&&!y.done&&(u=g.return)&&u.call(g)}finally{if(c)throw c.error}}n.exitSet.sort((function(e,t){return t.order-e.order}));var v=Array.from(h).sort((function(e,t){return e.order-t.order})),w=new Set(n.exitSet),S=nO(v.map((function(e){var t=[];if("final"!==e.type)return t;var a=e.parent;if(!a.parent)return t;t.push(BO(e.id,e.doneData),BO(a.id,e.doneData?aO(e.doneData,r,i):void 0));var o=a.parent;return"parallel"===o.type&&TO(o).every((function(e){return jO(n.configuration,e)}))&&t.push(BO(o.id)),t}))),E=v.map((function(e){var t=e.onEntry,n=e.activities.map((function(e){return function(e){var t=$O(e);return{type:v_.Start,activity:t,exec:void 0}}(e)}));return{type:"entry",actions:FO(o?C_(C_([],T_(t),!1),T_(n),!1):C_(C_([],T_(n),!1),T_(t),!1),d.machine.options.actions)}})).concat({type:"state_done",actions:S.map((function(e){return function(e,t){return{type:R_,event:"function"==typeof e?e:gO(e),delay:void 0,id:void 0}}(e)}))}),x=Array.from(w).map((function(e){return{type:"exit",actions:FO(C_(C_([],T_(e.onExit),!1),T_(e.activities.map((function(e){return function(e){var t=dO(e)?e:$O(e);return{type:v_.Stop,activity:t,exec:void 0}}(e)}))),!1),d.machine.options.actions)}})).concat({type:"transition",actions:FO(n.actions,this.machine.options.actions)}).concat(E);if(t){var _=FO(nO(C_([],T_(e),!1).sort((function(e,t){return t.order-e.order})).map((function(e){return e.onExit}))),this.machine.options.actions).filter((function(e){return!xO(e)}));return x.concat({type:"stop",actions:_})}return x},e.prototype.transition=function(e,t,n,r){void 0===e&&(e=this.initialState);var i,a,o=yO(t);if(e instanceof HO)i=void 0===n?e:this.resolveState(HO.from(e,n));else{var s=pO(e)?this.resolve(X_(this.getResolvedPath(e))):this.resolve(e),l=null!=n?n:this.machine.context;i=this.resolveState(HO.from(s,l))}if(!G_&&o.name===JO)throw new Error("An event cannot have the wildcard type ('".concat(JO,"')"));if(this.strict&&!this.events.includes(o.name)&&(a=o.name,!/^(done|error)\./.test(a)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(o.name,"'"));var c=this._transition(i.value,i,o)||{transitions:[],configuration:[],exitSet:[],source:i,actions:[]},u=kO([],this.getStateNodes(i.value)),d=c.configuration.length?kO(u,c.configuration):u;return c.configuration=C_([],T_(d),!1),this.resolveTransition(c,i,i.context,r,o)},e.prototype.resolveRaisedTransition=function(e,t,n,r){var i,a=e.actions;return(e=this.transition(e,t,void 0,r))._event=n,e.event=n.data,(i=e.actions).unshift.apply(i,C_([],T_(a),!1)),e},e.prototype.resolveTransition=function(e,t,n,r,i){var a,o,s,l,c=this;void 0===i&&(i=NO);var u=e.configuration,d=!t||e.transitions.length>0,p=d?e.configuration:t?t.configuration:[],h=jO(p,this),f=d?RO(this.machine,u):void 0,m=t?t.historyValue?t.historyValue:e.source?this.machine.historyValue(t.value):void 0:void 0,g=this.getActions(new Set(p),h,e,n,i,t,r),y=t?x_({},t.activities):{};try{for(var b=O_(g),v=b.next();!v.done;v=b.next()){var w=v.value;try{for(var S=(s=void 0,O_(w.actions)),E=S.next();!E.done;E=S.next()){var x=E.value;x.type===P_?y[x.activity.id||x.activity.type]=x:x.type===A_&&(y[x.activity.id||x.activity.type]=!1)}}catch(e){s={error:e}}finally{try{E&&!E.done&&(l=S.return)&&l.call(S)}finally{if(s)throw s.error}}}}catch(e){a={error:e}}finally{try{v&&!v.done&&(o=b.return)&&o.call(b)}finally{if(a)throw a.error}}var _,O,T=T_(UO(this,t,n,i,g,r,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),C=T[0],k=T[1],P=T_(function(e,t){var n,r,i=T_([[],[]],2),a=i[0],o=i[1];try{for(var s=O_(e),l=s.next();!l.done;l=s.next()){var c=l.value;t(c)?a.push(c):o.push(c)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return[a,o]}(C,xO),2),A=P[0],R=P[1],D=C.filter((function(e){var t;return e.type===P_&&(null===(t=e.activity)||void 0===t?void 0:t.type)===F_})),j=D.reduce((function(e,t){return e[t.activity.id]=function(e,t,n,r){var i,a=wO(e.src),o=null===(i=null==t?void 0:t.options.services)||void 0===i?void 0:i[a.type],s=e.data?aO(e.data,n,r):void 0,l=o?KO(o,e.id,s):QO(e.id);return l.meta=e,l}(t.activity,c.machine,k,i),e}),t?x_({},t.children):{}),I=new HO({value:f||t.value,context:k,_event:i,_sessionid:t?t._sessionid:null,historyValue:f?m?(_=m,O=f,{current:O,states:sO(_,O)}):void 0:t?t.historyValue:void 0,history:!f||e.source?t:void 0,actions:f?R:[],activities:f?y:t?t.activities:{},events:[],configuration:p,transitions:e.transitions,children:j,done:h,tags:IO(p),machine:this}),N=n!==k;I.changed=i.name===V_||N;var L=I.history;L&&delete L.history;var M=!h&&(this._transient||u.some((function(e){return e._transient})));if(!(d||M&&i.name!==XO))return I;var F=I;if(!h)for(M&&(F=this.resolveRaisedTransition(F,{type:I_},i,r));A.length;){var $=A.shift();F=this.resolveRaisedTransition(F,$._event,i,r)}var B=F.changed||(L?!!F.actions.length||N||typeof L.value!=typeof F.value||!qO(F.value,L.value):void 0);return F.changed=B,F.history=L,F},e.prototype.getStateNode=function(e){if(eT(e))return this.machine.getStateNodeById(e);if(!this.states)throw new Error("Unable to retrieve child state '".concat(e,"' from '").concat(this.id,"'; no child states exist."));var t=this.states[e];if(!t)throw new Error("Child state '".concat(e,"' does not exist on '").concat(this.id,"'"));return t},e.prototype.getStateNodeById=function(e){var t=eT(e)?e.slice(1):e;if(t===this.id)return this;var n=this.machine.idMap[t];if(!n)throw new Error("Child state node '#".concat(t,"' does not exist on machine '").concat(this.id,"'"));return n},e.prototype.getStateNodeByPath=function(e){if("string"==typeof e&&eT(e))try{return this.getStateNodeById(e.slice(1))}catch(e){}for(var t=K_(e,this.delimiter).slice(),n=this;t.length;){var r=t.shift();if(!r.length)break;n=n.getStateNode(r)}return n},e.prototype.resolve=function(e){var t,n=this;if(!e)return this.initialStateValue||ZO;switch(this.type){case"parallel":return J_(this.initialStateValue,(function(t,r){return t?n.getStateNode(r).resolve(e[r]||t):ZO}));case"compound":if(pO(e)){var r=this.getStateNode(e);return"parallel"===r.type||"compound"===r.type?((t={})[e]=r.initialStateValue,t):e}return Object.keys(e).length?J_(e,(function(e,t){return e?n.getStateNode(t).resolve(e):ZO})):this.initialStateValue||{};default:return e||ZO}},e.prototype.getResolvedPath=function(e){if(eT(e)){var t=this.machine.idMap[e.slice(1)];if(!t)throw new Error("Unable to find state node '".concat(e,"'"));return t.path}return K_(e,this.delimiter)},Object.defineProperty(e.prototype,"initialStateValue",{get:function(){var e,t;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)t=Z_(this.states,(function(e){return e.initialStateValue||ZO}),(function(e){return!("history"===e.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));t=_O(this.states[this.initial])?this.initial:((e={})[this.initial]=this.states[this.initial].initialStateValue,e)}else t={};return this.__cache.initialStateValue=t,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),e.prototype.getInitialState=function(e,t){this._init();var n=this.getStateNodes(e);return this.resolveTransition({configuration:n,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=t?t:this.machine.context,void 0)},Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this.initialStateValue;if(!e)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){var e;if("history"===this.type){var t=this.config;e=pO(t.target)&&eT(t.target)?X_(this.machine.getStateNodeById(t.target).path.slice(this.path.length-1)):t.target}return e},enumerable:!1,configurable:!0}),e.prototype.getRelativeStateNodes=function(e,t,n){return void 0===n&&(n=!0),n?"history"===e.type?e.resolveHistory(t):e.initialStateNodes:[e]},Object.defineProperty(e.prototype,"initialStateNodes",{get:function(){var e=this;return _O(this)?[this]:"compound"!==this.type||this.initial?nO(tO(this.initialStateValue).map((function(t){return e.getFromRelativePath(t)}))):(G_||cO(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this])},enumerable:!1,configurable:!0}),e.prototype.getFromRelativePath=function(e){if(!e.length)return[this];var t=T_(e),n=t[0],r=t.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(n,"' from node with no states"));var i=this.getStateNode(n);if("history"===i.type)return i.resolveHistory();if(!this.states[n])throw new Error("Child state '".concat(n,"' does not exist on '").concat(this.id,"'"));return this.states[n].getFromRelativePath(r)},e.prototype.historyValue=function(e){if(Object.keys(this.states).length)return{current:e||this.initialStateValue,states:Z_(this.states,(function(t,n){if(!e)return t.historyValue();var r=pO(e)?void 0:e[n];return t.historyValue(r||t.initialStateValue)}),(function(e){return!e.history}))}},e.prototype.resolveHistory=function(e){var t=this;if("history"!==this.type)return[this];var n=this.parent;if(!e){var r=this.target;return r?nO(tO(r).map((function(e){return n.getFromRelativePath(e)}))):n.initialStateNodes}var i,a=(i=n.path,function(e){var t,n,r=e;try{for(var a=O_(i),o=a.next();!o.done;o=a.next()){var s=o.value;r=r.states[s]}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r})(e).current;return pO(a)?[n.getStateNode(a)]:nO(tO(a).map((function(e){return"deep"===t.history?n.getFromRelativePath(e):[n.states[e[0]]]})))},Object.defineProperty(e.prototype,"stateIds",{get:function(){var e=this,t=nO(Object.keys(this.states).map((function(t){return e.states[t].stateIds})));return[this.id].concat(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"events",{get:function(){var e,t,n,r;if(this.__cache.events)return this.__cache.events;var i=this.states,a=new Set(this.ownEvents);if(i)try{for(var o=O_(Object.keys(i)),s=o.next();!s.done;s=o.next()){var l=i[s.value];if(l.states)try{for(var c=(n=void 0,O_(l.events)),u=c.next();!u.done;u=c.next()){var d=u.value;a.add("".concat(d))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return this.__cache.events=Array.from(a)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownEvents",{get:function(){var e=new Set(this.transitions.filter((function(e){return!(!e.target&&!e.actions.length&&e.internal)})).map((function(e){return e.eventType})));return Array.from(e)},enumerable:!1,configurable:!0}),e.prototype.resolveTarget=function(e){var t=this;if(void 0!==e)return e.map((function(e){if(!pO(e))return e;var n=e[0]===t.delimiter;if(n&&!t.parent)return t.getStateNodeByPath(e.slice(1));var r=n?t.key+e:e;if(!t.parent)return t.getStateNodeByPath(r);try{return t.parent.getStateNodeByPath(r)}catch(e){throw new Error("Invalid transition definition for state node '".concat(t.id,"':\n").concat(e.message))}}))},e.prototype.formatTransition=function(e){var t=this,n=function(e){if(void 0!==e&&""!==e)return iO(e)}(e.target),r="internal"in e?e.internal:!n||n.some((function(e){return pO(e)&&e[0]===t.delimiter})),i=this.machine.options.guards,a=this.resolveTarget(n),o=x_(x_({},e),{actions:FO(iO(e.actions)),cond:hO(e.cond,i),target:a,source:this,internal:r,eventType:e.event,toJSON:function(){return x_(x_({},o),{target:o.target?o.target.map((function(e){return"#".concat(e.id)})):void 0,source:"#".concat(t.id)})}});return o},e.prototype.formatTransitions=function(){var e,t,n,r=this;if(this.config.on)if(Array.isArray(this.config.on))n=this.config.on;else{var i=this.config.on,a=i[JO],o=void 0===a?[]:a,s=__(i,["*"]);n=nO(Object.keys(s).map((function(e){G_||e!==XO||cO(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(r.id,'".'));var t=bO(e,s[e]);return G_||function(e,t,n){var r=n.slice(0,-1).some((function(e){return!("cond"in e)&&!("in"in e)&&(pO(e.target)||mO(e.target))})),i=t===XO?"the transient event":"event '".concat(t,"'");cO(!r,"One or more transitions for ".concat(i," on state '").concat(e.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")}(r,e,t),t})).concat(bO(JO,o)))}else n=[];var l=this.config.always?bO("",this.config.always):[],c=this.config.onDone?bO(String(BO(this.id)),this.config.onDone):[];G_||cO(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var u=nO(this.invoke.map((function(e){var t=[];return e.onDone&&t.push.apply(t,C_([],T_(bO(String(VO(e.id)),e.onDone)),!1)),e.onError&&t.push.apply(t,C_([],T_(bO(String(zO(e.id)),e.onError)),!1)),t}))),d=this.after,p=nO(C_(C_(C_(C_([],T_(c),!1),T_(u),!1),T_(n),!1),T_(l),!1).map((function(e){return iO(e).map((function(e){return r.formatTransition(e)}))})));try{for(var h=O_(d),f=h.next();!f.done;f=h.next()){var m=f.value;p.push(m)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}return p},e}(),nT=!1,rT={deferEvents:!1},iT=function(){function e(e){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=x_(x_({},rT),e)}return e.prototype.initialize=function(e){if(this.initialized=!0,e){if(!this.options.deferEvents)return void this.schedule(e);this.process(e)}this.flushEvents()},e.prototype.schedule=function(e){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(e),this.flushEvents()}else this.queue.push(e)},e.prototype.clear=function(){this.queue=[]},e.prototype.flushEvents=function(){for(var e=this.queue.shift();e;)this.process(e),e=this.queue.shift()},e.prototype.process=function(e){this.processingEvent=!0;try{e()}catch(e){throw this.clear(),e}finally{this.processingEvent=!1}},e}(),aT=new Map,oT=0,sT=function(e){aT.delete(e)};function lT(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:void(G_||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues"))}var cT,uT={sync:!1,autoForward:!1};!function(e){e[e.NotStarted=0]="NotStarted",e[e.Running=1]="Running",e[e.Stopped=2]="Stopped"}(cT||(cT={}));var dT=function(){function e(t,n){void 0===n&&(n=e.defaultOptions);var r=this;this.machine=t,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=cT.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(e,t){if(uO(e))return r.batch(e),r.state;var n=yO(gO(e,t));if(r.status===cT.Stopped)return G_||cO(!1,'Event "'.concat(n.name,'" was sent to stopped service "').concat(r.machine.id,'". This service has already reached its final state, and will not transition.\nEvent: ').concat(JSON.stringify(n.data))),r.state;if(r.status!==cT.Running&&!r.options.deferEvents)throw new Error('Event "'.concat(n.name,'" was sent to uninitialized service "').concat(r.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(n.data)));return r.scheduler.schedule((function(){r.forward(n);var e=r._nextState(n);r.update(e,n)})),r._state},this.sendTo=function(e,t,n){var i=r.parent&&(t===w_.Parent||r.parent.id===t),a=i?r.parent:pO(t)?t===w_.Internal?r:r.children.get(t)||function(e){return aT.get(e)}(t):function(e){return!!e&&"function"==typeof e.send}(t)?t:void 0;if(a)if("machine"in a){if(r.status!==cT.Stopped||r.parent!==a||r.state.done){var o=x_(x_({},e),{name:e.name===B_?"".concat(zO(r.id)):e.name,origin:r.sessionId});!n&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([a,o]):a.send(o)}}else!n&&r.machine.config.predictableActionArguments?r._outgoingQueue.push([a,e.data]):a.send(e.data);else{if(!i)throw new Error("Unable to send event to child '".concat(t,"' from service '").concat(r.id,"'."));G_||cO(!1,"Service '".concat(r.id,"' has no parent: unable to send event ").concat(e.type))}},this._exec=function(e,t,n,i){void 0===i&&(i=r.machine.options.actions);var a=e.exec||LO(e.type,i),o=dO(a)?a:a?a.exec:e.exec;if(o)try{return o(t,n.data,r.machine.config.predictableActionArguments?{action:e,_event:n}:{action:e,state:r.state,_event:n})}catch(e){throw r.parent&&r.parent.send({type:"xstate.error",data:e}),e}switch(e.type){case R_:var s=e;r.defer(s);break;case D_:var l=e;if("number"==typeof l.delay)return void r.defer(l);l.to?r.sendTo(l._event,l.to,n===NO):r.send(l._event);break;case j_:r.cancel(e.sendId);break;case P_:if(r.status!==cT.Running)return;var c=e.activity;if(!r.machine.config.predictableActionArguments&&!r.state.activities[c.id||c.type])break;if(c.type===v_.Invoke){var u=wO(c.src),d=r.machine.options.services?r.machine.options.services[u.type]:void 0,p=c.id,h=c.data;G_||cO(!("forward"in c),"`forward` property is deprecated (found in invocation of '".concat(c.src,"' in in machine '").concat(r.machine.id,"'). ")+"Please use `autoForward` instead.");var f="autoForward"in c?c.autoForward:!!c.forward;if(!d)return void(G_||cO(!1,"No service found for invocation '".concat(c.src,"' in machine '").concat(r.machine.id,"'.")));var m=h?aO(h,t,n):void 0;if("string"==typeof d)return;var g=dO(d)?d(t,n.data,{data:m,src:u,meta:c.meta}):d;if(!g)return;var y=void 0;mO(g)&&(g=m?g.withContext(m):g,y={autoForward:f}),r.spawn(g,p,y)}else r.spawnActivity(c);break;case A_:r.stopChild(e.activity.id);break;case L_:var b=e,v=b.label,w=b.value;v?r.logger(v,w):r.logger(w);break;default:G_||cO(!1,"No implementation found for action type '".concat(e.type,"'"))}};var i=x_(x_({},e.defaultOptions),n),a=i.clock,o=i.logger,s=i.parent,l=i.id,c=void 0!==l?l:t.id;this.id=c,this.logger=o,this.clock=a,this.parent=s,this.options=i,this.scheduler=new iT({deferEvents:this.options.deferEvents}),this.sessionId="x:".concat(oT++)}return Object.defineProperty(e.prototype,"initialState",{get:function(){var e=this;return this._initialState?this._initialState:WO(this,(function(){return e._initialState=e.machine.initialState,e._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return G_||cO(this.status!==cT.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),e.prototype.execute=function(e,t){var n,r;try{for(var i=O_(e.actions),a=i.next();!a.done;a=i.next()){var o=a.value;this.exec(o,e,t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}},e.prototype.update=function(e,t){var n,r,i,a,o,s,l,c,u=this;if(e._sessionid=this.sessionId,this._state=e,this.machine.config.predictableActionArguments&&t!==NO||!this.options.execute)for(var d=void 0;d=this._outgoingQueue.shift();)d[0].send(d[1]);else this.execute(this.state);if(this.children.forEach((function(e){u.state.children[e.id]=e})),this.devTools&&this.devTools.send(t.data,e),e.event)try{for(var p=O_(this.eventListeners),h=p.next();!h.done;h=p.next())(0,h.value)(e.event)}catch(e){n={error:e}}finally{try{h&&!h.done&&(r=p.return)&&r.call(p)}finally{if(n)throw n.error}}try{for(var f=O_(this.listeners),m=f.next();!m.done;m=f.next())(0,m.value)(e,e.event)}catch(e){i={error:e}}finally{try{m&&!m.done&&(a=f.return)&&a.call(f)}finally{if(i)throw i.error}}try{for(var g=O_(this.contextListeners),y=g.next();!y.done;y=g.next())(0,y.value)(this.state.context,this.state.history?this.state.history.context:void 0)}catch(e){o={error:e}}finally{try{y&&!y.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}if(this.state.done){var b=e.configuration.find((function(e){return"final"===e.type&&e.parent===u.machine})),v=b&&b.doneData?aO(b.doneData,e.context,t):void 0;this._doneEvent=VO(this.id,v);try{for(var w=O_(this.doneListeners),S=w.next();!S.done;S=w.next())(0,S.value)(this._doneEvent)}catch(e){l={error:e}}finally{try{S&&!S.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}this._stop(),this._stopChildren(),sT(this.sessionId)}},e.prototype.onTransition=function(e){return this.listeners.add(e),this.status===cT.Running&&e(this.state,this.state.event),this},e.prototype.subscribe=function(e,t,n){var r=this,i=SO(e,t,n);this.listeners.add(i.next),this.status!==cT.NotStarted&&i.next(this.state);var a=function(){r.doneListeners.delete(a),r.stopListeners.delete(a),i.complete()};return this.status===cT.Stopped?i.complete():(this.onDone(a),this.onStop(a)),{unsubscribe:function(){r.listeners.delete(i.next),r.doneListeners.delete(a),r.stopListeners.delete(a)}}},e.prototype.onEvent=function(e){return this.eventListeners.add(e),this},e.prototype.onSend=function(e){return this.sendListeners.add(e),this},e.prototype.onChange=function(e){return this.contextListeners.add(e),this},e.prototype.onStop=function(e){return this.stopListeners.add(e),this},e.prototype.onDone=function(e){return this.status===cT.Stopped&&this._doneEvent?e(this._doneEvent):this.doneListeners.add(e),this},e.prototype.off=function(e){return this.listeners.delete(e),this.eventListeners.delete(e),this.sendListeners.delete(e),this.stopListeners.delete(e),this.doneListeners.delete(e),this.contextListeners.delete(e),this},e.prototype.start=function(e){var t,n,r=this;if(this.status===cT.Running)return this;this.machine._init(),t=this.sessionId,n=this,aT.set(t,n),this.initialized=!0,this.status=cT.Running;var i=void 0===e?this.initialState:WO(this,(function(){return"object"==typeof(t=e)&&null!==t&&"value"in t&&"_event"in t?r.machine.resolveState(e):r.machine.resolveState(HO.from(e,r.machine.context));var t}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){r.update(i,NO)})),this},e.prototype._stopChildren=function(){this.children.forEach((function(e){dO(e.stop)&&e.stop()})),this.children.clear()},e.prototype._stop=function(){var e,t,n,r,i,a,o,s,l,c;try{for(var u=O_(this.listeners),d=u.next();!d.done;d=u.next()){var p=d.value;this.listeners.delete(p)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}try{for(var h=O_(this.stopListeners),f=h.next();!f.done;f=h.next())(p=f.value)(),this.stopListeners.delete(p)}catch(e){n={error:e}}finally{try{f&&!f.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}try{for(var m=O_(this.contextListeners),g=m.next();!g.done;g=m.next())p=g.value,this.contextListeners.delete(p)}catch(e){i={error:e}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}try{for(var y=O_(this.doneListeners),b=y.next();!b.done;b=y.next())p=b.value,this.doneListeners.delete(p)}catch(e){o={error:e}}finally{try{b&&!b.done&&(s=y.return)&&s.call(y)}finally{if(o)throw o.error}}if(!this.initialized)return this;this.initialized=!1,this.status=cT.Stopped,this._initialState=void 0;try{for(var v=O_(Object.keys(this.delayedEventsMap)),w=v.next();!w.done;w=v.next()){var S=w.value;this.clock.clearTimeout(this.delayedEventsMap[S])}}catch(e){l={error:e}}finally{try{w&&!w.done&&(c=v.return)&&c.call(v)}finally{if(l)throw l.error}}this.scheduler.clear(),this.scheduler=new iT({deferEvents:this.options.deferEvents})},e.prototype.stop=function(){var e=this,t=this.scheduler;return this._stop(),t.schedule((function(){var t;if(!(null===(t=e._state)||void 0===t?void 0:t.done)){var n=yO({type:"xstate.stop"}),r=WO(e,(function(){var t=nO(C_([],T_(e.state.configuration),!1).sort((function(e,t){return t.order-e.order})).map((function(t){return FO(t.onExit,e.machine.options.actions)}))),r=T_(UO(e.machine,e.state,e.state.context,n,[{type:"exit",actions:t}],e.machine.config.predictableActionArguments?e._exec:void 0,e.machine.config.predictableActionArguments||e.machine.config.preserveActionOrder),2),i=r[0],a=r[1],o=new HO({value:e.state.value,context:a,_event:n,_sessionid:e.sessionId,historyValue:void 0,history:e.state,actions:i.filter((function(e){return!xO(e)})),activities:{},events:[],configuration:[],transitions:[],children:{},done:e.state.done,tags:e.state.tags,machine:e.machine});return o.changed=!0,o}));e.update(r,n),e._stopChildren(),sT(e.sessionId)}})),this},e.prototype.batch=function(e){var t=this;if(this.status===cT.NotStarted&&this.options.deferEvents)G_||cO(!1,"".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'" and are deferred. Make sure .start() is called for this service.\nEvent: ').concat(JSON.stringify(event)));else if(this.status!==cT.Running)throw new Error("".concat(e.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(e.length){var n=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule((function(){var r,i,a=t.state,o=!1,s=[],l=function(e){var r=yO(e);t.forward(r),a=WO(t,(function(){return t.machine.transition(a,r,void 0,n||void 0)})),s.push.apply(s,C_([],T_(t.machine.config.predictableActionArguments?a.actions:a.actions.map((function(e){return function(e,t){var n=e.exec;return x_(x_({},e),{exec:void 0!==n?function(){return n(t.context,t.event,{action:e,state:t,_event:t._event})}:void 0})}(e,a)}))),!1)),o=o||!!a.changed};try{for(var c=O_(e),u=c.next();!u.done;u=c.next())l(u.value)}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}a.changed=o,a.actions=s,t.update(a,yO(e[e.length-1]))}))}},e.prototype.sender=function(e){return this.send.bind(this,e)},e.prototype._nextState=function(e,t){var n=this;void 0===t&&(t=!!this.machine.config.predictableActionArguments&&this._exec);var r=yO(e);if(0===r.name.indexOf($_)&&!this.state.nextEvents.some((function(e){return 0===e.indexOf($_)})))throw r.data.data;return WO(this,(function(){return n.machine.transition(n.state,r,void 0,t||void 0)}))},e.prototype.nextState=function(e){return this._nextState(e,!1)},e.prototype.forward=function(e){var t,n;try{for(var r=O_(this.forwardTo),i=r.next();!i.done;i=r.next()){var a=i.value,o=this.children.get(a);if(!o)throw new Error("Unable to forward event '".concat(e,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(a,"'."));o.send(e)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.defer=function(e){var t=this,n=this.clock.setTimeout((function(){"to"in e&&e.to?t.sendTo(e._event,e.to,!0):t.send(e._event)}),e.delay);e.id&&(this.delayedEventsMap[e.id]=n)},e.prototype.cancel=function(e){this.clock.clearTimeout(this.delayedEventsMap[e]),delete this.delayedEventsMap[e]},e.prototype.exec=function(e,t,n){void 0===n&&(n=this.machine.options.actions),this._exec(e,t.context,t._event,n)},e.prototype.removeChild=function(e){var t;this.children.delete(e),this.forwardTo.delete(e),null===(t=this.state)||void 0===t||delete t.children[e]},e.prototype.stopChild=function(e){var t=this.children.get(e);t&&(this.removeChild(e),dO(t.stop)&&t.stop())},e.prototype.spawn=function(e,t,n){if(this.status!==cT.Running)return KO(e,t);if(oO(e))return this.spawnPromise(Promise.resolve(e),t);if(dO(e))return this.spawnCallback(e,t);if(function(e){try{return"function"==typeof e.send}catch(e){return!1}}(r=e)&&"id"in r)return this.spawnActor(e,t);if(function(e){try{return"subscribe"in e&&dO(e.subscribe)}catch(e){return!1}}(e))return this.spawnObservable(e,t);if(mO(e))return this.spawnMachine(e,x_(x_({},n),{id:t}));if(function(e){return null!==e&&"object"==typeof e&&"transition"in e&&"function"==typeof e.transition}(e))return this.spawnBehavior(e,t);throw new Error('Unable to spawn entity "'.concat(t,'" of type "').concat(typeof e,'".'));var r},e.prototype.spawnMachine=function(t,n){var r=this;void 0===n&&(n={});var i=new e(t,x_(x_({},this.options),{parent:this,id:n.id||t.id})),a=x_(x_({},uT),n);a.sync&&i.onTransition((function(e){r.send(V_,{state:e,id:i.id})}));var o=i;return this.children.set(i.id,o),a.autoForward&&this.forwardTo.add(i.id),i.onDone((function(e){r.removeChild(i.id),r.send(yO(e,{origin:i.id}))})).start(),o},e.prototype.spawnBehavior=function(e,t){var n=function(e,t){void 0===t&&(t={});var n=e.initialState,r=new Set,i=[],a=!1,o=function(e){var t;return x_(((t={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[fO]=function(){return this},t),e)}({id:t.id,send:function(t){i.push(t),function(){if(!a){for(a=!0;i.length>0;){var t=i.shift();n=e.transition(n,t,s),r.forEach((function(e){return e.next(n)}))}a=!1}}()},getSnapshot:function(){return n},subscribe:function(e,t,i){var a=SO(e,t,i);return r.add(a),a.next(n),{unsubscribe:function(){r.delete(a)}}}}),s={parent:t.parent,self:o,id:t.id||"anonymous",observers:r};return n=e.start?e.start(s):n,o}(e,{id:t,parent:this});return this.children.set(t,n),n},e.prototype.spawnPromise=function(e,t){var n,r,i=this,a=!1;e.then((function(e){a||(r=e,i.removeChild(t),i.send(yO(VO(t,e),{origin:t})))}),(function(e){if(!a){i.removeChild(t);var n=zO(t,e);try{i.send(yO(n,{origin:t}))}catch(r){!function(e,t,n){if(!G_){var r=e.stack?" Stacktrace was '".concat(e.stack,"'"):"";if(e===t)console.error("Missing onError handler for invocation '".concat(n,"', error was '").concat(e,"'.").concat(r));else{var i=t.stack?" Stacktrace was '".concat(t.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(n,"'. ")+"Original error: '".concat(e,"'. ").concat(r," Current error is '").concat(t,"'.").concat(i))}}}(e,r,t),i.devTools&&i.devTools.send(n,i.state),i.machine.strict&&i.stop()}}}));var o=(n={id:t,send:function(){},subscribe:function(t,n,r){var i=SO(t,n,r),a=!1;return e.then((function(e){a||(i.next(e),a||i.complete())}),(function(e){a||i.error(e)})),{unsubscribe:function(){return a=!0}}},stop:function(){a=!0},toJSON:function(){return{id:t}},getSnapshot:function(){return r}},n[fO]=function(){return this},n);return this.children.set(t,o),o},e.prototype.spawnCallback=function(e,t){var n,r,i,a=this,o=!1,s=new Set,l=new Set;try{i=e((function(e){r=e,l.forEach((function(t){return t(e)})),o||a.send(yO(e,{origin:t}))}),(function(e){s.add(e)}))}catch(e){this.send(zO(t,e))}if(oO(i))return this.spawnPromise(i,t);var c=((n={id:t,send:function(e){return s.forEach((function(t){return t(e)}))},subscribe:function(e){var t=SO(e);return l.add(t.next),{unsubscribe:function(){l.delete(t.next)}}},stop:function(){o=!0,dO(i)&&i()},toJSON:function(){return{id:t}},getSnapshot:function(){return r}})[fO]=function(){return this},n);return this.children.set(t,c),c},e.prototype.spawnObservable=function(e,t){var n,r,i=this,a=e.subscribe((function(e){r=e,i.send(yO(e,{origin:t}))}),(function(e){i.removeChild(t),i.send(yO(zO(t,e),{origin:t}))}),(function(){i.removeChild(t),i.send(yO(VO(t),{origin:t}))})),o=(n={id:t,send:function(){},subscribe:function(t,n,r){return e.subscribe(t,n,r)},stop:function(){return a.unsubscribe()},getSnapshot:function(){return r},toJSON:function(){return{id:t}}},n[fO]=function(){return this},n);return this.children.set(t,o),o},e.prototype.spawnActor=function(e,t){return this.children.set(t,e),e},e.prototype.spawnActivity=function(e){var t=this.machine.options&&this.machine.options.activities?this.machine.options.activities[e.type]:void 0;if(t){var n=t(this.state.context,e);this.spawnEffect(e.id,n)}else G_||cO(!1,"No implementation found for activity '".concat(e.type,"'"))},e.prototype.spawnEffect=function(e,t){var n;this.children.set(e,((n={id:e,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:t||void 0,getSnapshot:function(){},toJSON:function(){return{id:e}}})[fO]=function(){return this},n))},e.prototype.attachDev=function(){var e=lT();if(this.options.devTools&&e){if(e.__REDUX_DEVTOOLS_EXTENSION__){var t="object"==typeof this.options.devTools?this.options.devTools:void 0;this.devTools=e.__REDUX_DEVTOOLS_EXTENSION__.connect(x_(x_({name:this.id,autoPause:!0,stateSanitizer:function(e){return{value:e.value,context:e.context,actions:e.actions}}},t),{features:x_({jump:!1,skip:!1},t?t.features:void 0)}),this.machine),this.devTools.init(this.state)}!function(e){if(lT()){var t=function(){var e=lT();if(e&&"__xstate__"in e)return e.__xstate__}();t&&t.register(e)}}(this)}},e.prototype.toJSON=function(){return{id:this.id}},e.prototype[fO]=function(){return this},e.prototype.getSnapshot=function(){return this.status===cT.NotStarted?this.initialState:this._state},e.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},logger:console.log.bind(console),devTools:!1},e.interpret=pT,e}();function pT(e,t){return new dT(e,t)}let hT=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce(((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_")),"");var fT=function(e){return{type:N_,assignment:e}};class mT extends qi{constructor(e){var t;const{dataSourceUid:r}=e;let{appSubUrl:i="",bootData:a}=n.config;"/"!==(null==i?void 0:i.at(-1))&&(i+="/"),super(`${i}api/datasources/proxy/uid/${r}`,{"content-type":"application/json","X-Grafana-Org-Id":String((null==a||null===(t=a.user)||void 0===t?void 0:t.orgId)||"")}),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"dataSourceUid",void 0),this.dataSourceUid=e.dataSourceUid}}function gT(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function yT(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){gT(a,r,i,o,s,"next",e)}function s(e){gT(a,r,i,o,s,"throw",e)}o(void 0)}))}}class bT extends mT{static queryToMatchers(e){const t=e.indexOf("{");return t>0?[`{__profile_type__="${e.substring(0,t)}", ${e.substring(t+1,e.length)}`]:0===t?[e]:[`{__profile_type__="${e}"}`]}fetchLabels(e,t,n){var r=this;return yT((function*(){return r._post("/querier.v1.QuerierService/LabelNames",{matchers:bT.queryToMatchers(e),start:t,end:n}).then((e=>e.json()))}))()}fetchLabelValues(e,t,n,r){var i=this;return yT((function*(){return i._post("/querier.v1.QuerierService/LabelValues",{name:e,matchers:bT.queryToMatchers(t),start:n,end:r}).then((e=>e.json()))}))()}_post(e,t){return super.fetch(e,{method:"POST",body:JSON.stringify(t)})}constructor(e){super(e)}}class vT{static buildCacheKey(e){let t="";for(const n of e)t+=String(n);return t}get(e){return this.store.get(vT.buildCacheKey(e))}set(e,t){this.store.set(vT.buildCacheKey(e),t)}delete(e){this.store.delete(vT.buildCacheKey(e))}constructor(){!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"store",new Map)}}function wT(e,t){if(!e)throw new Error(t)}function ST(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ET{setApiClient(e){this.apiClient=e}setCacheClient(e){this.cacheClient=e}cancel(e){this.apiClient.abort(e)}constructor(e){ST(this,"apiClient",void 0),ST(this,"cacheClient",void 0),this.apiClient=e.apiClient,this.cacheClient=null==e?void 0:e.cacheClient}}function xT(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function _T(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){xT(a,r,i,o,s,"next",e)}function s(e){xT(a,r,i,o,s,"throw",e)}o(void 0)}))}}class OT extends Hi{static queryToMatchers(e){const t=e.indexOf("{");return t>0?[`{__profile_type__="${e.substring(0,t)}", ${e.substring(t+1,e.length)}`]:0===t?[e]:[`{__profile_type__="${e}"}`]}fetchLabels(e,t,n){var r=this;return _T((function*(){return r._post("/querier.v1.QuerierService/LabelNames",{matchers:OT.queryToMatchers(e),start:t,end:n}).then((e=>e.json()))}))()}fetchLabelValues(e,t,n,r){var i=this;return _T((function*(){return i._post("/querier.v1.QuerierService/LabelValues",{name:e,matchers:OT.queryToMatchers(t),start:n,end:r}).then((e=>e.json()))}))()}_post(e,t){return super.fetch(e,{method:"POST",body:JSON.stringify(t)})}}function TT(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function CT(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){TT(a,r,i,o,s,"next",e)}function s(e){TT(a,r,i,o,s,"throw",e)}o(void 0)}))}}function kT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class PT extends ET{static parseLabelsResponse(e){return Array.isArray(e.names)?Array.from(new Set(e.names.filter(PT.isNotMetaLabelOrServiceName))).map((e=>({value:e,label:e}))):[]}static parseLabelValuesResponse(e){return Array.isArray(e.names)?e.names.map((e=>({value:e,label:e}))):[]}static assertParams(e,t,n){wT(Boolean(e),'Missing "query" parameter!'),wT(t>0&&n>0&&n>t,"Invalid timerange!")}listLabels({query:e,from:t,to:n}){var r=this;return CT((function*(){PT.assertParams(e,t,n);const i=[r.apiClient.baseUrl,e,t,n],a=r.cacheClient.get(i);if(a){const e=yield a,t=PT.parseLabelsResponse(e);return t.length||r.cacheClient.delete(i),t}const o=r.apiClient.fetchLabels(e,t,n);r.cacheClient.set(i,o);try{const e=yield o;return PT.parseLabelsResponse(e)}catch(e){throw r.cacheClient.delete(i),e}}))()}listLabelValues({label:e,query:t,from:n,to:r}){var i=this;return CT((function*(){PT.assertParams(t,n,r),wT(Boolean(e),"Missing label value!");const a=[i.apiClient.baseUrl,e,t,n,r],o=i.cacheClient.get(a);if(o){const e=yield o,t=PT.parseLabelsResponse(e);return t.length||i.cacheClient.delete(a),t}const s=i.apiClient.fetchLabelValues(e,t,n,r);i.cacheClient.set(a,s);try{const e=yield s;return PT.parseLabelValuesResponse(e)}catch(e){throw i.cacheClient.delete(a),e}}))()}constructor(e){super({apiClient:e.apiClient}),kT(this,"cacheClient",void 0),this.cacheClient=e.cacheClient}}kT(PT,"isNotMetaLabelOrServiceName",(e=>!/^(__.+__|service_name)$/.test(e)));const AT=new PT({apiClient:new OT,cacheClient:new vT});function RT(e,t){const n=e.filter((({type:e})=>e!==m_.partial)),r=t.filter((({type:e})=>e!==m_.partial));return n.length===r.length&&n.every((e=>r.find((({type:t,attribute:n,operator:r,value:i})=>{var a,o;return t===e.type&&n.value===e.attribute.value&&(null==r?void 0:r.value)===(null===(a=e.operator)||void 0===a?void 0:a.value)&&(null==i?void 0:i.value)===(null===(o=e.value)||void 0===o?void 0:o.value)}))))}function DT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const jT={type:m_["attribute-operator"],operator:{value:g_["is-empty"],label:"is empty"},value:{value:g_["is-empty"],label:""}},IT=e=>function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){DT(e,t,n[t])}))}return e}({},e,jT);function NT(e,t){const n=t.filter((({type:e})=>e!==m_.partial)).map((e=>{const{attribute:t,operator:n,value:r}=e;switch(n.value){case g_.in:return`${t.value}=~"${r.value}"`;case g_["not-in"]:return`${t.value}!~"${r.value}"`;case g_["is-empty"]:return`${t.value}=""`;default:return`${t.value}${n.value}"${r.value}"`}}));var r;const[,i]=null!==(r=e.match(/{.*(service_name="[^"]*").*}/))&&void 0!==r?r:[];return i&&n.unshift(i),e.replace(/{(.*)}$/,`{${n.join(",")}}`)}const LT=e=>e.at(-1)||null,MT=e=>e===g_.in||e===g_["not-in"],FT=e=>(wT(Boolean(e),"The filter is falsy!"),e.type===m_.partial);function $T(e,t){return e!==t&&t!==g_["is-empty"]&&([g_["=~"],g_["!~"],g_.in,g_["not-in"],g_["is-empty"]].includes(e)||[g_["=~"],g_["!~"],g_.in,g_["not-in"]].includes(t))}function BT(e,t){return wT(void 0!==e.operator,"No operator for the filter under edition!"),$T(e.operator.value,t)}function VT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const zT=e=>{const t=e.matchAll(/(\w+)(=|!=|=~|!~)"([^"]*)"/g);return Array.from(t).map((([,e,t,n])=>[e,t,n]))},UT=/.+:[^{]+\{(.+)\}$/,qT=/.*(\^|\$|\*|\+|\{|\}|\?).*/;function HT(e){if(!e)return[];const t=e.match(UT);return t?zT(t[1]).filter((([e])=>"service_name"!==e)).map((([e,t,n])=>{const r={id:hT(10),type:m_["attribute-operator-value"],active:!0,attribute:{value:e,label:e},operator:{value:t,label:t},value:{value:n,label:n}};return t===g_["="]&&""===n?IT(r):[g_["=~"],g_["!~"]].includes(t)&&!qT.test(n)?(i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){VT(e,t,n[t])}))}return e}({},r),a={operator:t===g_["=~"]?{value:g_.in,label:"in"}:{value:g_["not-in"],label:"not in"},value:{value:n,label:n.split("|").map((e=>e.trim())).join(", ")}},a=null!=a?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i):r;var i,a})):[]}function GT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const WT=(e,t)=>e.map((e=>{return e.type!==m_.partial?(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){GT(e,t,n[t])}))}return e}({},e),r=null!=(r={active:t})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),n):e;var n,r}));function QT(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KT(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){QT(e,t,n[t])}))}return e}function YT(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function XT(e,t){const n=RT(e,HT(t.inputParams.query));return{filters:n?WT(e,!0):e,query:NT(t.query,e),isQueryUpToDate:n}}const JT={cancelAllLoad:()=>{AT.cancel("Discarded by user")},setFilterAttribute:fT(((e,t)=>{const n=[...e.filters,{id:hT(10),type:m_.partial,active:!1,attribute:t.data}];return YT(KT({},e),{filters:n,isQueryUpToDate:RT(n,HT(e.inputParams.query))})})),editFilterAttribute:fT(((e,t)=>{if(null===e.edition)throw new Error("Cannot edit filter attribute without edition data!");const{filterId:n}=e.edition,r=e.filters.map((e=>e.id===n?YT(KT({},e),{attribute:t.data,operator:void 0,value:void 0}):e));return YT(KT({},e),{filters:r,isQueryUpToDate:RT(r,HT(e.inputParams.query)),edition:null})})),setFilterOperator:fT(((e,t)=>{const n=e.filters.map((e=>{if(!FT(e))return e;const n=t.data;return n.value===g_["is-empty"]?IT(e):YT(KT({},e),{operator:n,value:void 0})}));return KT({},e,XT(n,e))})),editFilterOperator:fT(((e,t)=>{if(null===e.edition)throw new Error("Cannot edit filter operator without edition data!");const{filterId:n}=e.edition,r=t.data;let i=null;const a=e.filters.map((t=>{const a=t.operator.value;return t.id!==n||a===r.value?t:r.value===g_["is-empty"]?IT(YT(KT({},t),{active:!1})):(a===g_["is-empty"]&&(t.value={value:"(no value)",label:"(no value)"}),!FT(t)&&$T(a,r.value)&&(i=YT(KT({},e.edition),{part:y_.value})),YT(KT({},t),{operator:r,value:MT(a)&&!MT(r.value)&&t.value?{value:t.value.value.split("|").shift(),label:t.value.label.split(", ").shift()}:t.value,active:!1}))}));return YT(KT({},e,XT(a,e)),{edition:i})})),setFilterValue:fT(((e,t)=>{const n=e.filters.map((e=>FT(e)?YT(KT({},e),{type:m_["attribute-operator-value"],active:!1,value:t.data}):e));return KT({},e,XT(n,e))})),editFilterValue:fT(((e,t)=>{if(null===e.edition)throw new Error("Cannot edit filter value without edition data!");const{filterId:n}=e.edition,r=e.filters.map((e=>e.id===n?YT(KT({},e),{type:m_["attribute-operator-value"],active:!1,value:t.data}):e));return YT(KT({},e,XT(r,e)),{edition:null})})),removeFilter:fT(((e,t)=>{const n=t.data,r=WT(e.filters.filter((({id:e})=>e!==n)),!1);return KT({},e,XT(r,e))})),removeLastFilter:fT((e=>{const{filters:t}=e,n=LT(t);if(!n)return e;if(FT(n)&&n.operator){const r=t.slice(0,t.length-1).concat(YT(KT({},n),{operator:void 0}));return YT(KT({},e),{filters:r,isQueryUpToDate:!0})}const r=t.slice(0,t.length-1).map((e=>YT(KT({},e),{active:!1})));return KT({},e,XT(r,e))})),setEdition:fT({edition:(e,t)=>t.data}),changeInputParams:fT(((e,t)=>(t.data.dataSourceUid&&AT.setApiClient(new bT({dataSourceUid:t.data.dataSourceUid})),{inputParams:t.data,query:t.data.query,filters:HT(t.data.query),isQueryUpToDate:!0}))),activateFilters:fT((e=>KT({},e,XT(e.filters,e))))};function ZT(e){const{edition:t,filters:n}=e;wT(null!==t,'"edition" is null!');const r=n.find((({id:e})=>e===t.filterId));return wT(void 0!==r,"Cannot find the filter under edition!"),r}const eC={shouldSuggestAttributes:e=>{const t=LT(e.filters);return!t||!FT(t)},shouldSuggestOperators:e=>{var t;return!(null===(t=LT(e.filters))||void 0===t?void 0:t.operator)},shouldSuggestValues:e=>{const t=LT(e.filters);return Boolean((null==t?void 0:t.operator)&&!(null==t?void 0:t.value))},isEditing:e=>null!==e.edition,shouldSuggestValuesAfterOperatorEdition:(e,t)=>!!e.edition&&BT(ZT(e),t.data.value),shouldNotSuggestValuesAfterOperatorEdition:(e,t)=>!!e.edition&&!BT(ZT(e),t.data.value),hasPartialFilter:e=>{const t=LT(e.filters);return Boolean(t&&FT(t))},shouldEditAttribute:(e,t)=>t.data.part===y_.attribute,shouldEditOperator:(e,t)=>t.data.part===y_.operator,shouldEditValue:(e,t)=>t.data.part===y_.value};function tC(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}const nC=new class{list(){return(e=function*(){return[{value:"=",label:"="},{value:"!=",label:"!="},{value:"is-empty",label:"is empty"},{value:"in",label:"in",description:"Is one of"},{value:"not-in",label:"not in",description:"Is not one of"},{value:"=~",label:"=~",description:"Matches regex"},{value:"!~",label:"!~",description:"Does not match regex"}]},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){tC(a,r,i,o,s,"next",e)}function s(e){tC(a,r,i,o,s,"throw",e)}o(void 0)}))})();var e}},rC=e=>e.startsWith("__");function iC(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function aC(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){iC(a,r,i,o,s,"next",e)}function s(e){iC(a,r,i,o,s,"throw",e)}o(void 0)}))}}function oC(e,t){if(e instanceof DOMException&&"AbortError"===e.name)return[];throw Ii.error(e,{info:t}),e}const sC={fetchLabels:function(){var e=aC((function*(e){const{from:t,to:n}=e.inputParams;try{const r=yield AT.listLabels({query:e.query,from:t,to:n}),i=[],a=[];return r.forEach((e=>{rC(e.value)?a.push(e):i.push(e)})),[...i,...a]}catch(e){return oC(e,"Error while fetching labels!")}}));return function(t){return e.apply(this,arguments)}}(),fetchOperators:aC((function*(){try{return yield nC.list()}catch(e){return oC(e,"Error while fetching operators!")}})),fetchLabelValues:function(){var e=aC((function*(e){let t,{query:n,edition:r,suggestions:i}=e;try{if(r){const i=e.filters.filter((e=>e.id!==r.filterId||(t=e,!1)));if(!t)throw new Error(`Impossible to edit filter id="${r.filterId}": no filter found!`);n=NT(n,i)}else if(t=LT(e.filters),(null==t?void 0:t.type)!==m_.partial)throw new Error("Impossible to load label values: no partial filter found!");if(i.disabled)return[];const a=t.attribute.value,{from:o,to:s}=e.inputParams;return yield AT.listLabelValues({label:a,query:n,from:o,to:s})}catch(e){return oC(e,"Error while fetching label values!")}}));return function(t){return e.apply(this,arguments)}}()},lC={always:[{cond:"shouldSuggestOperators",target:"loadOperators"},{cond:"shouldSuggestValues",target:"loadLabelValues"},{target:"idle"}]},cC={FILTER_ADD:"Filter by label values...",SELECT_LABEL:"Select a label...",SELECT_OPERATOR:"Select an operator...",SELECT_VALUE:"Select a value...",SELECT_VALUES:"Select values...",TYPE_VALUE:"Type a regex...",LOADING:"Loading...",ERROR_LOAD:"An unexpected error occurred while loading! Please try again.",SUGGESTIONS_NONE:"No suggestions available.",SUGGESTIONS_DISABLED:"Suggestions are disabled for this label."},uC=e=>e===g_["=~"]||e===g_["!~"];function dC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const pC={entry:["cancelAllLoad",fT({suggestions:e=>{let t=cC.FILTER_ADD,n=!1;const r=LT(e.filters);return r&&FT(r)&&(r.operator?(n=uC(r.operator.value),t=MT(r.operator.value)?cC.SELECT_VALUES:n?cC.TYPE_VALUE:cC.SELECT_VALUE):t=cC.SELECT_OPERATOR),i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){dC(e,t,n[t])}))}return e}({},PC.suggestions),a=null!=(a={placeholder:t,allowCustomValue:n})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i;var i,a},edition:null})],on:{START_INPUT:[{cond:"shouldSuggestAttributes",target:"loadLabels"},{cond:"shouldSuggestOperators",target:"loadOperators"},{cond:"shouldSuggestValues",target:"loadLabelValues"}],EDIT_FILTER:[{cond:"shouldEditAttribute",target:"loadLabels",actions:["setEdition"]},{cond:"shouldEditOperator",target:"loadOperators",actions:["setEdition"]},{cond:"shouldEditValue",target:"loadLabelValues",actions:["setEdition"]}],REMOVE_FILTER:[{cond:"hasPartialFilter",target:"autoSuggestProxy",actions:["removeFilter"]},{target:"idle",actions:["removeFilter"]}],REMOVE_LAST_FILTER:{target:"idle",actions:["removeLastFilter"]},CHANGE_INPUT_PARAMS:{target:"idle",actions:["changeInputParams"]},EXECUTE_QUERY:{target:"idle",actions:["activateFilters"]}}};function hC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){hC(e,t,n[t])}))}return e}function mC(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const gC={entry:fT({suggestions:()=>mC(fC({},PC.suggestions),{isVisible:!0,isLoading:!0})}),invoke:{id:"fetchLabels",src:"fetchLabels",onDone:{target:"displayLabels",actions:fT({suggestions:(e,t)=>mC(fC({},e.suggestions),{items:t.data.filter((({value:t})=>!e.filters.some((e=>{var n;return(null===(n=e.attribute)||void 0===n?void 0:n.value)===t})))),isLoading:!1})})},onError:{target:"displayLabels",actions:fT({suggestions:(e,t)=>mC(fC({},e.suggestions),{isLoading:!1,error:t.data})})}},on:{DISCARD_SUGGESTIONS:"idle"}},yC={entry:fT({suggestions:e=>mC(fC({},e.suggestions),{type:b_.attribute,isVisible:!0,placeholder:cC.SELECT_LABEL})}),on:{DISCARD_SUGGESTIONS:"idle",SELECT_SUGGESTION:[{cond:"isEditing",target:"loadOperators",actions:["editFilterAttribute"]},{target:"loadOperators",actions:["setFilterAttribute"]}],REMOVE_LAST_FILTER:{target:"idle",actions:["removeLastFilter"]}}};function bC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){bC(e,t,n[t])}))}return e}function wC(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const SC={entry:fT({suggestions:e=>{const t=e.edition?ZT(e):LT(e.filters);return wT(void 0!==typeof(null==t?void 0:t.operator),"No operator for the target filter!"),wC(vC({},PC.suggestions),{disabled:["=~","!~"].includes(t.operator.value)||rC(t.attribute.value),isVisible:!0,isLoading:!0})}}),invoke:{id:"fetchLabelValues",src:"fetchLabelValues",onDone:{target:"displayLabelValues",actions:fT({suggestions:(e,t)=>wC(vC({},e.suggestions),{items:t.data,isLoading:!1})})},onError:{target:"displayLabelValues",actions:fT({suggestions:(e,t)=>wC(vC({},e.suggestions),{items:[],isLoading:!1,error:t.data})})}},on:{DISCARD_SUGGESTIONS:"idle"}},EC={entry:fT({suggestions:e=>{const t=e.edition?ZT(e):LT(e.filters);wT(void 0!==typeof(null==t?void 0:t.operator),"No operator for the target filter!");const n=t.operator.value,r=uC(n)||e.suggestions.disabled,i=MT(n);let a,o;return a=r?cC.TYPE_VALUE:i?cC.SELECT_VALUES:cC.SELECT_VALUE,o=e.suggestions.error?cC.ERROR_LOAD:e.suggestions.disabled?cC.SUGGESTIONS_DISABLED:cC.SUGGESTIONS_NONE,wC(vC({},e.suggestions),{type:b_.value,isVisible:!0,placeholder:a,noOptionsMessage:o,allowCustomValue:r,multiple:i})}}),on:{DISCARD_SUGGESTIONS:"idle",SELECT_SUGGESTION:[{cond:"isEditing",target:"autoSuggestProxy",actions:["editFilterValue"]},{target:"idle",actions:["setFilterValue"]}],REMOVE_LAST_FILTER:{target:"loadOperators",actions:["removeLastFilter"]}}};function xC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){xC(e,t,n[t])}))}return e}function OC(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const TC={entry:fT({suggestions:()=>OC(_C({},PC.suggestions),{isVisible:!0,isLoading:!0})}),invoke:{id:"fetchOperators",src:"fetchOperators",onDone:{target:"displayOperators",actions:fT({suggestions:(e,t)=>OC(_C({},e.suggestions),{items:t.data,isLoading:!1})})},onError:{target:"displayOperators",actions:fT({suggestions:(e,t)=>OC(_C({},e.suggestions),{items:[],isLoading:!1,error:t.data})})}},on:{DISCARD_SUGGESTIONS:"idle"}},CC={entry:fT({suggestions:e=>OC(_C({},e.suggestions),{type:b_.operator,isVisible:!0,placeholder:cC.SELECT_OPERATOR,allowCustomValue:!1,multiple:!1})}),on:{DISCARD_SUGGESTIONS:"idle",SELECT_SUGGESTION:[{cond:"shouldSuggestValuesAfterOperatorEdition",target:"loadLabelValues",actions:["editFilterOperator"]},{cond:"shouldNotSuggestValuesAfterOperatorEdition",target:"autoSuggestProxy",actions:["editFilterOperator"]},{cond:"hasPartialFilter",target:"autoSuggestProxy",actions:["setFilterOperator"]},{target:"loadLabelValues",actions:["setFilterOperator"]}],REMOVE_LAST_FILTER:{target:"loadLabels",actions:["removeLastFilter"]}}};function kC(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const PC=Object.freeze({inputParams:{query:"",from:0,to:0},query:"",filters:[],isQueryUpToDate:!0,edition:null,suggestions:{type:null,items:[],isVisible:!1,isLoading:!1,error:null,placeholder:"",noOptionsMessage:"",allowCustomValue:!1,multiple:!1,disabled:!1}}),AC=e=>({id:"query-builder",initial:"idle",context:e,predictableActionArguments:!0,states:{idle:pC,loadLabels:gC,displayLabels:yC,loadOperators:TC,displayOperators:CC,loadLabelValues:SC,displayLabelValues:EC,autoSuggestProxy:lC}}),RC={guards:eC,services:sC,actions:JT};function DC(e){const{query:t}=e,n=(i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){kC(e,t,n[t])}))}return e}({},PC),a=null!=(a={inputParams:e,query:t,filters:HT(t)})?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i),r=function(e,t){return G_||"predictableActionArguments"in e||nT||(nT=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new tT(e,t)}(AC(n),RC);var i,a;return{actor:pT(r),initialContext:n}}const jC=e=>(t,n)=>{const r=e.some((e=>e.value===t.value)),i=e.some((e=>e.value===n.value));return r&&i?t.value.localeCompare(n.value):i?1:r?-1:0};function IC({selection:e,suggestions:t,onCloseMenu:n}){const i=(0,r.useStyles2)(NC),a=(0,Ei.useMemo)((()=>{const t=e.value.split("|"),n=e.label.split(", ");return t.map(((e,t)=>({value:e,label:n[t]})))}),[e]),[o,s]=(0,Ei.useState)(a),l=(0,Ei.useMemo)((()=>t.items.sort(jC(o))),[t.items]),c=(0,Ei.useCallback)((e=>{s(e.map((({value:e="",label:t=""})=>({value:e,label:t}))))}),[]),u=(0,Ei.useCallback)((()=>{n(o)}),[n,o]);return xi().createElement(r.MultiSelect,{className:i.editionSelect,placeholder:t.placeholder,loadingMessage:cC.LOADING,closeMenuOnSelect:!1,hideSelectedOptions:!1,backspaceRemovesValue:!0,autoFocus:!0,value:o,onChange:c,onCloseMenu:u,options:l,isOpen:!0,isLoading:t.isLoading,invalid:Boolean(t.error),noOptionsMessage:t.noOptionsMessage})}const NC=()=>({editionSelect:t.css`
    position: absolute;
    z-index: 1;

    [aria-label='Remove'] svg {
      display: none;
    }
  `});function LC({placeholder:e,defaultValue:n,onFocus:i,onChange:a,onBlur:o}){const s=(0,r.useStyles2)(MC),l=(0,Ei.useRef)(null),[c,u]=(0,Ei.useState)(!1);return(0,Ei.useEffect)((()=>{l.current&&l.current.focus()}),[]),xi().createElement(r.Input,{ref:l,className:(0,t.cx)(n&&s.edition),invalid:c,placeholder:e,defaultValue:n,onFocus:i,onKeyUp:e=>{const t=e.target.value.trim();"Enter"===e.code&&(t?a({value:t,label:t}):u(!0))},onBlur:e=>{const t=e.target.value.trim();t?a({value:t,label:t}):o()}})}const MC=()=>({edition:t.css`
    position: absolute;
    z-index: 1;
  `}),FC=()=>({editionSelect:t.css`
    position: absolute;
    z-index: 1;
    min-width: 160px;
    box-shadow: none;

    & input:focus {
      outline: none !important;
    }
  `});function $C({selection:e,suggestions:t,onChange:n,onCloseMenu:i}){const a=(0,r.useStyles2)(FC);return t.allowCustomValue?xi().createElement(LC,{defaultValue:e.value,placeholder:t.placeholder,onChange:n,onBlur:i}):xi().createElement(r.Select,{className:a.editionSelect,placeholder:t.placeholder,loadingMessage:cC.LOADING,closeMenuOnSelect:!1,autoFocus:!0,value:e.value,onChange:n,onCloseMenu:i,options:t.items,isOpen:!0,isLoading:t.isLoading,invalid:Boolean(t.error),noOptionsMessage:t.noOptionsMessage})}const BC=()=>{},VC=({filter:e,onClick:n,onRemove:i})=>{const a=(0,r.useStyles2)(WC),{attribute:o,operator:s,active:l}=e,c=l?a.chiclet:(0,t.cx)(a.chiclet,a.inactiveChiclet);return xi().createElement("div",{className:c,"aria-label":"Filter"},xi().createElement(r.Tag,{"aria-label":"Filter label",className:a.chicletAttribute,name:o.label,onClick:BC}),xi().createElement(r.Tag,{"aria-label":"Filter operator",className:a.chicletOperator,name:s.label,onClick:(t,r)=>n(r,e,y_.operator),tabIndex:0}),xi().createElement(r.Tag,{"aria-label":"Remove filter",className:a.chicletRemoveButton,icon:"times",name:"",onClick:(t,n)=>i(n,e),tabIndex:0}))},zC=()=>{},UC=({filter:e,onClick:n,onRemove:i})=>{const a=(0,r.useStyles2)(WC),{attribute:o,operator:s,value:l,active:c}=e,u=c?a.chiclet:(0,t.cx)(a.chiclet,a.inactiveChiclet);return xi().createElement("div",{className:u,"aria-label":"Filter"},xi().createElement(r.Tag,{"aria-label":"Filter label",className:a.chicletAttribute,name:o.label,onClick:zC}),xi().createElement(r.Tag,{"aria-label":"Filter operator",className:a.chicletOperator,name:s.label,onClick:(t,r)=>n(r,e,y_.operator),tabIndex:0}),xi().createElement(r.Tooltip,{content:l.label},xi().createElement(r.Tag,{"aria-label":"Filter value",name:l.label,className:a.chicletValue,onClick:(t,r)=>n(r,e,y_.value),tabIndex:0})),xi().createElement(r.Tag,{"aria-label":"Remove filter",className:a.chicletRemoveButton,icon:"times",name:"",onClick:(t,n)=>i(n,e),tabIndex:0}))},qC=({filter:e,onClick:n})=>{const i=(0,r.useStyles2)(WC),{attribute:a,operator:o}=e;return a||o?xi().createElement("div",{className:(0,t.cx)(i.chiclet,i.partialChiclet),"aria-label":"Partial filter"},xi().createElement(r.Tag,{colorIndex:9,name:a.label,title:`Edit "${a.label}"`,onClick:(t,r)=>n(r,e,y_.attribute),tabIndex:0}),o&&xi().createElement(r.Tag,{colorIndex:9,name:o.label,title:`Edit "${o.label}"`,className:i.chicletOperator,onClick:(t,r)=>n(r,e,y_.operator),tabIndex:0})):null},HC="rgb(61, 113, 217)",GC="#4a4b52",WC=e=>({chiclet:t.css`
    display: flex;
    align-items: center;
    border: 1px solid ${HC};
    border-radius: 2px;

    & > button {
      height: 30px;
      background-color: ${e.colors.background.primary};
      color: ${e.colors.text.maxContrast};
    }

    & > :first-child {
      background-color: ${HC};
      color: ${"#fff"};
      border-radius: 0;

      &:hover {
        cursor: not-allowed !important;
      }
    }

    & > :last-child {
      border-left: 1px solid ${HC};
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
    }
  `,partialChiclet:t.css`
    border-color: ${GC};
    border-right: 0;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;

    & > :first-child {
      background-color: ${e.colors.background.secondary};
      color: ${e.colors.text.maxContrast};
      border-radius: 0;
      border-left: 0;

      &:hover {
        cursor: pointer !important;
      }
    }

    & > :last-child {
      border-color: ${GC};
      color: ${e.colors.text.maxContrast};
    }
  `,inactiveChiclet:t.css`
    border-color: ${GC};

    & > button {
      color: ${e.colors.text.maxContrast};
    }

    & > :first-child {
      background-color: ${e.colors.background.secondary};
      color: ${e.colors.text.maxContrast};
    }

    & > :last-child {
      border-color: ${GC};
    }
  `,chicletAttribute:t.css`
    &:hover {
      opacity: 1 !important;
    }
  `,chicletOperator:t.css`
    &:hover {
      background-color: ${e.colors.background.secondary};
    }
  `,chicletValue:t.css`
    flex-grow: 1;
    text-align: left;
    max-width: 420px;
    text-overflow: ellipsis;
    text-wrap: nowrap;
    overflow: hidden;

    &:hover {
      background-color: ${e.colors.background.secondary};
    }
  `,chicletRemoveButton:t.css`
    &:hover {
      background-color: ${e.colors.background.secondary};
    }

    & svg {
      width: 12px;
      height: 12px;
    }
  `}),QC=({filter:e,onClick:t,onRemove:n})=>{switch(e.type){case m_.partial:return xi().createElement(qC,{filter:e,onClick:t});case m_["attribute-operator-value"]:return xi().createElement(UC,{filter:e,onClick:t,onRemove:n});case m_["attribute-operator"]:return xi().createElement(VC,{filter:e,onClick:t,onRemove:n});default:throw new TypeError(`Unsupported filter type "${e.type}" (${JSON.stringify(e)})!`)}},KC=(0,Ei.memo)(QC,((e,t)=>JSON.stringify(e.filter)===JSON.stringify(t.filter))),YC=()=>({chicletsList:t.css`
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 4px;
  `,editChicletContainer:t.css`
    position: relative;
  `});function XC({filters:e,onClickChiclet:t,onRemoveChiclet:n,edition:i,suggestions:a,onChangeSingleSuggestion:o,onCloseSingleSuggestionsMenu:s,onCloseMultipleSuggestionsMenu:l}){const c=(0,r.useStyles2)(YC);return xi().createElement("div",{className:c.chicletsList,"data-testid":"filtersList"},e.map((e=>xi().createElement("div",{key:e.id,className:c.editChicletContainer},xi().createElement(KC,{filter:e,onClick:t,onRemove:n}),(null==i?void 0:i.filterId)===e.id?a.multiple?xi().createElement(IC,{selection:e[i.part],suggestions:a,onCloseMenu:l}):xi().createElement($C,{key:i.part,selection:e[i.part],suggestions:a,onChange:o,onCloseMenu:s}):null))))}const JC=(0,Ei.memo)(XC),ZC=()=>({select:t.css`
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  `});function ek({suggestions:e,onFocus:t,onChange:n,onKeyDown:i,onCloseMenu:a}){const o=(0,r.useStyles2)(ZC),s=function(e){const[t,n]=(0,Ei.useState)(!1);return(0,Ei.useEffect)((()=>{!e||t?e!==t&&n(e):setTimeout((()=>n(!0)),0)}),[t,e]),t}(e.isVisible);return e.allowCustomValue?xi().createElement(LC,{placeholder:e.placeholder,onFocus:t,onChange:n,onBlur:a}):xi().createElement(r.Select,{className:o.select,placeholder:e.placeholder,loadingMessage:cC.LOADING,closeMenuOnSelect:!1,value:null,onFocus:t,onKeyDown:i,onChange:n,onCloseMenu:a,options:e.items,isOpen:s,isLoading:e.isLoading,invalid:Boolean(e.error),noOptionsMessage:e.noOptionsMessage})}const tk=()=>{};function nk(){const e=(0,r.useStyles2)(ZC);return xi().createElement(r.Select,{disabled:!0,className:e.select,placeholder:cC.FILTER_ADD,onChange:tk})}function rk({suggestions:e,onFocus:t,onKeyDown:n,onCloseMenu:i}){const a=(0,r.useStyles2)(ik),[o,s]=(0,Ei.useState)([]),l=(0,Ei.useCallback)((e=>{s(e.map((({value:e="",label:t=""})=>({value:e,label:t}))))}),[]),c=(0,Ei.useCallback)((e=>{n(e,o)}),[n,o]),u=(0,Ei.useCallback)((()=>{i(o)}),[i,o]);return xi().createElement(r.MultiSelect,{className:a.select,placeholder:e.placeholder,loadingMessage:cC.LOADING,closeMenuOnSelect:!1,hideSelectedOptions:!1,backspaceRemovesValue:!0,autoFocus:!0,value:o,onFocus:t,onKeyDown:c,onChange:l,onCloseMenu:u,options:e.items,isOpen:e.isVisible,isLoading:e.isLoading,invalid:Boolean(e.error),noOptionsMessage:e.noOptionsMessage})}const ik=()=>({select:t.css`
    [aria-label='Remove'] svg {
      display: none;
    }
  `}),ak=()=>({queryBuilder:t.css`
    display: flex;
    justify-content: flex-start;
    align-items: flex-end;
    flex-wrap: wrap;
    gap: 4px;
    width: 100%;
  `,controls:t.css`
    display: flex;
    align-self: flex-start;
    flex-grow: 1;
  `,executeButton:t.css`
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  `});function ok(e){const n=(0,r.useStyles2)(ak),{actor:i,internalProps:a}=function({dataSourceUid:e,query:t,from:n,to:r,onChangeQuery:i}){const{actor:a,initialContext:o}=(0,Ei.useMemo)((()=>DC({query:t,from:n,to:r})),[]);(0,Ei.useEffect)((()=>{a.send({type:"CHANGE_INPUT_PARAMS",data:{dataSourceUid:e,query:t,from:n,to:r}})}),[a,e,t,n,r]);const[s,l]=(0,Ei.useState)(o);return(0,Ei.useEffect)((()=>(a.start(),a.subscribe((({event:e,context:t})=>{"EXECUTE_QUERY"===e.type&&i(t.query,t.filters),l(t)})),()=>{a.stop()})),[a]),{actor:a,internalProps:s}}(e),{filters:o,edition:s,isQueryUpToDate:l,suggestions:c}=a,{onClickChiclet:u,onRemoveChiclet:d}=function(e){const t=(0,Ei.useCallback)(((t,n,r)=>{e.send({type:"EDIT_FILTER",data:{filterId:n.id,part:r}})}),[e]),n=(0,Ei.useCallback)(((t,n)=>{e.send({type:"REMOVE_FILTER",data:n.id})}),[e]);return{onClickChiclet:t,onRemoveChiclet:n}}(i),{onFocus:p,onChangeSingleSuggestion:h,onSingleSelectKeyDown:f,onCloseSingleMenu:m,onMultipleSelectKeyDown:g,onCloseMultipleMenu:y}=function(e,t,n){const r=(0,Ei.useCallback)((()=>{e.send({type:"START_INPUT"})}),[e]),i=(0,Ei.useCallback)((t=>{const{value:n="",label:r=""}=t;e.send({type:"SELECT_SUGGESTION",data:{value:n,label:r}})}),[e]),a=(0,Ei.useCallback)((t=>{"Backspace"!==t.code||t.target.value||e.send({type:"REMOVE_LAST_FILTER"})}),[e]),o=(0,Ei.useCallback)((()=>{e.send({type:"DISCARD_SUGGESTIONS"})}),[e]),s=(0,Ei.useCallback)(((t,n)=>{"Backspace"!==t.code||t.target.value||n.length||e.send({type:"REMOVE_LAST_FILTER"})}),[e]),l=(0,Ei.useCallback)((t=>{t.length?e.send({type:"SELECT_SUGGESTION",data:{value:t.map((e=>e.value)).join("|"),label:t.map((e=>e.label)).join(", ")}}):e.send({type:"DISCARD_SUGGESTIONS"})}),[e]),c=function(e){const t=(0,Ei.useRef)();return(0,Ei.useEffect)((()=>{t.current=e})),t.current}(t.isVisible);return(0,Ei.useEffect)((()=>{var e;!t.isVisible&&c&&(null===(e=document.querySelector(`#${n} input`))||void 0===e||e.blur())}),[t.isVisible,c,n]),{onFocus:r,onChangeSingleSuggestion:i,onSingleSelectKeyDown:a,onMultipleSelectKeyDown:s,onCloseSingleMenu:o,onCloseMultipleMenu:l}}(i,c,e.id),b=(0,Ei.useCallback)((()=>{i.send({type:"EXECUTE_QUERY"})}),[i]);return(0,Ei.useEffect)((()=>{if(!e.autoExecute)return;const t=({value:e,context:t,event:n})=>{"idle"!==e||t.isQueryUpToDate||"EXECUTE_QUERY"===n.type||i.send({type:"EXECUTE_QUERY"})};return i.onTransition(t),()=>{i.off(t)}}),[i,e.autoExecute]),xi().createElement("div",{id:e.id,className:(0,t.cx)(n.queryBuilder,e.className)},o.length>0?xi().createElement(JC,{filters:o,onClickChiclet:u,onRemoveChiclet:d,edition:s,suggestions:c,onChangeSingleSuggestion:h,onCloseSingleSuggestionsMenu:m,onCloseMultipleSuggestionsMenu:y}):null,xi().createElement("div",{className:n.controls},s?xi().createElement(nk,null):c.multiple?xi().createElement(rk,{suggestions:c,onFocus:p,onKeyDown:g,onCloseMenu:y}):xi().createElement(ek,{suggestions:c,onFocus:p,onChange:h,onKeyDown:f,onCloseMenu:m}),!e.autoExecute&&xi().createElement(r.Button,{onClick:b,tooltip:l?"Nothing to execute, all filters applied":"Execute new query",className:n.executeButton,disabled:l},"Execute")))}const sk=(0,Ei.memo)(ok),lk=JSON.parse('{"block:contentions:count:contentions:count":{"id":"block:contentions:count:contentions:count","description":"Total count of blocking contentions","type":"contentions","group":"block","unit":"short"},"block:delay:nanoseconds:contentions:count":{"id":"block:delay:nanoseconds:contentions:count","description":"Total nanoseconds spent in blocking delays","type":"delay","group":"block","unit":"ns"},"goroutine:goroutine:count:goroutine:count":{"id":"goroutine:goroutine:count:goroutine:count","description":"Current number of goroutines","type":"goroutine","group":"goroutine","unit":"short"},"goroutines:goroutine:count:goroutine:count":{"id":"goroutines:goroutine:count:goroutine:count","description":"Current number of goroutines","type":"goroutine","group":"goroutine","unit":"short"},"memory:alloc_in_new_tlab_bytes:bytes::":{"id":"memory:alloc_in_new_tlab_bytes:bytes::","description":"Total bytes allocated inside Thread-Local Allocation Buffers (TLAB)","type":"alloc_in_new_tlab_bytes","group":"memory","unit":"bytes"},"memory:alloc_in_new_tlab_objects:count::":{"id":"memory:alloc_in_new_tlab_objects:count::","description":"Number of objects allocated inside Thread-Local Allocation Buffers (TLAB)","type":"alloc_in_new_tlab_objects","group":"memory","unit":"short"},"memory:alloc_objects:count:space:bytes":{"id":"memory:alloc_objects:count:space:bytes","description":"Total objects allocated","type":"alloc_objects","group":"memory","unit":"short"},"memory:alloc_space:bytes:space:bytes":{"id":"memory:alloc_space:bytes:space:bytes","description":"Total bytes allocated in the heap","type":"alloc_space","group":"memory","unit":"bytes"},"memory:inuse_objects:count:space:bytes":{"id":"memory:inuse_objects:count:space:bytes","description":"Count of objects currently in use","type":"inuse_objects","group":"memory","unit":"short"},"memory:inuse_space:bytes:space:bytes":{"id":"memory:inuse_space:bytes:space:bytes","description":"Total bytes of memory currently in use","type":"inuse_space","group":"memory","unit":"bytes"},"mutex:contentions:count:contentions:count":{"id":"mutex:contentions:count:contentions:count","description":"Number of observed mutex contentions","type":"contentions","group":"mutex","unit":"short"},"mutex:delay:nanoseconds:contentions:count":{"id":"mutex:delay:nanoseconds:contentions:count","description":"Total time spent waiting due to mutex contentions","type":"delay","group":"mutex","unit":"ns"},"process_cpu:alloc_samples:count:cpu:nanoseconds":{"id":"process_cpu:alloc_samples:count:cpu:nanoseconds","description":"Count of memory allocation samples during CPU time","type":"alloc_samples","group":"memory","unit":"short"},"process_cpu:alloc_size:bytes:cpu:nanoseconds":{"id":"process_cpu:alloc_size:bytes:cpu:nanoseconds","description":"Total bytes allocated during CPU time","type":"alloc_size","group":"alloc_size","unit":"bytes"},"process_cpu:cpu:nanoseconds:cpu:nanoseconds":{"id":"process_cpu:cpu:nanoseconds:cpu:nanoseconds","description":"Total nanoseconds of CPU time consumed","type":"cpu","group":"process_cpu","unit":"ns"},"process_cpu:exception:count:cpu:nanoseconds":{"id":"process_cpu:exception:count:cpu:nanoseconds","description":"Number of exceptions within the sampled CPU time","type":"exceptions","group":"exceptions","unit":"short"},"process_cpu:lock_count:count:cpu:nanoseconds":{"id":"process_cpu:lock_count:count:cpu:nanoseconds","description":"Count of lock acquisitions attempted during CPU time","type":"lock_count","group":"locks","unit":"short"},"process_cpu:lock_time:nanoseconds:cpu:nanoseconds":{"id":"process_cpu:lock_time:nanoseconds:cpu:nanoseconds","description":"Cumulative time spent acquiring locks, in nanoseconds","type":"lock_time","group":"locks","unit":"ns"},"process_cpu:samples:count::milliseconds":{"id":"process_cpu:samples:count::milliseconds","description":"Total number of process samples collected","type":"samples","group":"process_cpu","unit":"short"},"process_cpu:samples:count:cpu:nanoseconds":{"id":"process_cpu:samples:count:cpu:nanoseconds","description":"Count of samples collected over CPU time","type":"samples","group":"process_cpu","unit":"short"}}');function ck(e){if(lk[e])return lk[e];const[t="?",n="?"]=e?e.split(":"):[];return{id:e,description:"",type:n,group:t,unit:"short"}}const uk=Object.freeze({type:"grafana-pyroscope-datasource",uid:"$dataSource"}),dk=Object.freeze({type:"grafana-pyroscope-series-datasource",uid:"grafana-pyroscope-series-datasource"}),pk=Object.freeze({type:"grafana-pyroscope-favorites-datasource",uid:"grafana-pyroscope-favorites-datasource"}),hk=Object.freeze({type:"grafana-pyroscope-labels-datasource",uid:"grafana-pyroscope-labels-datasource"});function fk(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function mk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class gk extends Sw{onActivate(){this.state.value||this.setState({value:gk.DEFAULT_VALUE})}update(e=!1){var t,n=this;return(t=function*(){if(!e&&n.state.loading)return;let t=[],r=null;n.setState({loading:!0,options:[],error:null});try{t=yield(0,xp.lastValueFrom)(n.getValueOptions({}))}catch(e){r=e}finally{n.setState({loading:!1,options:t,error:r})}},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){fk(a,r,i,o,s,"next",e)}function s(e){fk(a,r,i,o,s,"throw",e)}o(void 0)}))})()}static buildCascaderOptions(e){const t=new Map;for(const{value:n}of e){const e=ck(n),{group:r,type:i}=e,a=t.get(r)||{value:r,label:r,items:[]},o=a.items||[];o.push({value:n,label:i}),a.items=o,t.set(r,a)}return Array.from(t.values()).sort(((e,t)=>t.label.localeCompare(e.label)))}constructor(t){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){mk(e,t,n[t])}))}return e}({key:"profileMetricId",name:"profileMetricId",label:"Profile type",datasource:dk,query:gk.QUERY_DEFAULT,loading:!0,refresh:e.VariableRefresh.onTimeRangeChanged},t)),mk(this,"onSelect",(e=>{ru("g_pyroscope_app_profile_metric_selected"),this.state.skipUrlSync||u_(),this.changeValueTo(e)})),this.changeValueTo=this.changeValueTo.bind(this),this.addActivationHandler(this.onActivate.bind(this))}}mk(gk,"DEFAULT_VALUE","process_cpu:cpu:nanoseconds:cpu:nanoseconds"),mk(gk,"QUERY_DEFAULT","$dataSource and all profile metrics"),mk(gk,"QUERY_SERVICE_NAME_DEPENDENT","$dataSource and only $serviceName profile metrics"),mk(gk,"Component",(({model:e})=>{const t=(0,r.useStyles2)(yk),{loading:n,value:i,options:a,error:o}=e.useState(),s=(0,Ei.useMemo)((()=>gk.buildCascaderOptions(a)),[a]);return o?(Ii.error(o,{info:'Error while loading "profileMetricId" variable values!'}),xi().createElement(r.Tooltip,{theme:"error",content:o.toString()},xi().createElement(r.Icon,{className:t.iconError,name:"exclamation-triangle",size:"xl"}))):xi().createElement(r.Cascader,{key:hT(5),"aria-label":"Profile metrics list",width:24,separator:"/",displayAllSelectedLevels:!0,placeholder:n?"Loading...":`Select a profile metric (${a.length})`,options:s,initialValue:i,changeOnSelect:!1,onSelect:e.onSelect})}));const yk=e=>({iconError:t.css`
    height: 32px;
    align-self: center;
    color: ${e.colors.error.text};
  `});function bk(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function vk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class wk extends Sw{onActivate(){const{serviceName:e}=Mi.get(Mi.KEYS.PROFILES_EXPLORER)||{};e&&!this.state.value&&this.setState({value:e}),this.subscribeToState(((e,t)=>{if(e.value&&e.value!==t.value){const t=Mi.get(Mi.KEYS.PROFILES_EXPLORER)||{};t.serviceName=e.value,Mi.set(Mi.KEYS.PROFILES_EXPLORER,t)}}))}update(){var e,t=this;return(e=function*(){if(t.state.loading)return;let e=[],n=null;t.setState({loading:!0,options:[],error:null});try{e=yield(0,xp.lastValueFrom)(t.getValueOptions({}))}catch(e){n=e}finally{t.setState({loading:!1,options:e,error:n})}},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){bk(a,r,i,o,s,"next",e)}function s(e){bk(a,r,i,o,s,"throw",e)}o(void 0)}))})()}constructor(t){super(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vk(e,t,n[t])}))}return e}({key:"serviceName",name:"serviceName",label:"Service",datasource:dk,query:wk.QUERY_DEFAULT,loading:!0,refresh:e.VariableRefresh.onTimeRangeChanged},t)),vk(this,"selectNewValue",(e=>{ru("g_pyroscope_app_service_name_selected"),this.state.skipUrlSync||u_(),this.changeValueTo(e),["filters","filtersBaseline","filtersComparison"].forEach((e=>{Rf.findByKeyAndType(this,e,Nk).setState({filters:[]})}))})),this.addActivationHandler(this.onActivate.bind(this))}}vk(wk,"QUERY_DEFAULT","$dataSource and all services"),vk(wk,"QUERY_PROFILE_METRIC_DEPENDENT","$dataSource and only $profileMetricId services"),vk(wk,"Component",(({model:e})=>{const t=(0,r.useStyles2)(Sk),{loading:n,value:i,options:a,error:o}=e.useState(),s=(0,Ei.useMemo)((()=>function(e){const t=[];for(const n of e){const e=n.split("/");let r;const i=[];let a=t;for(let t=0;t<e.length;t+=1){r=e[t],i.push(r);const n=i.join("/"),o=a.find((e=>e.value===n));if(o)a=o.items;else{const i={value:n,label:r,items:t<e.length-1?[]:void 0};a.push(i),a=i.items||[]}}}return t}(a.map((({label:e})=>e)))),[a]);return o?(Ii.error(o,{info:'Error while loading "serviceName" variable values!'}),xi().createElement(r.Tooltip,{theme:"error",content:o.toString()},xi().createElement(r.Icon,{className:t.iconError,name:"exclamation-triangle",size:"xl"}))):xi().createElement(r.Cascader,{key:String(n)+String(i),"aria-label":"Services list",width:32,separator:"/",displayAllSelectedLevels:!0,placeholder:n?"Loading services...":`Select a service (${a.length})`,options:s,initialValue:i,changeOnSelect:!1,onSelect:e.selectNewValue})}));const Sk=e=>({iconError:t.css`
    height: 32px;
    align-self: center;
    color: ${e.colors.error.text};
  `});function Ek(e,t){const{value:n}=Rf.findByKeyAndType(e,"serviceName",wk).useState(),{value:r}=Rf.findByKeyAndType(e,"profileMetricId",gk).useState(),{filterExpression:i}=Rf.findByKeyAndType(e,t,Nk).useState();return(0,Ei.useMemo)((()=>`${r}{service_name="${n}",${i}}`),[i,r,n])}class xk extends Yv{onActivate(){this.setState({skipUrlSync:!1}),this.subscribeToState(((e,t)=>{if(e.value&&e.value!==t.value){const t=Mi.get(Mi.KEYS.PROFILES_EXPLORER)||{};t.dataSource=e.value,Mi.set(Mi.KEYS.PROFILES_EXPLORER,t)}}))}constructor(){super({pluginId:"grafana-pyroscope-datasource",key:"dataSource",name:"dataSource",label:"Data source",skipUrlSync:!0,value:Hi.selectDefaultDataSource().uid}),this.addActivationHandler(this.onActivate.bind(this))}}function _k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ok(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){_k(e,t,n[t])}))}return e}function Tk(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const Ck=e=>{let t=e.operator.value;return e.operator.value===g_.in?t=g_["=~"]:e.operator.value===g_["not-in"]&&(t=g_["!~"]),{key:e.attribute.value,operator:t,value:e.value.value}};function kk(e,t){let n;const r=e.filter((e=>e.key!==t||(n=e,!1)));return{found:n,filtersWithoutFound:r}}const Pk=(e,t)=>[...e,t];function Ak(e,t){const{found:n,filtersWithoutFound:r}=kk(e,t.key);if(!n)return Pk(e,Tk(Ok({},t),{operator:"=~"}));if(["!~","!="].includes(n.operator))return Pk(r,Tk(Ok({},t),{operator:"=~"}));const i=new Set(n.value.split("|"));return"=~"===n.operator?Pk(r,Tk(Ok({},n),{value:Array.from(i.add(t.value)).join("|")})):n.value===t.value?e:Pk(r,Tk(Ok({},t),{operator:"=~",value:Array.from(i.add(t.value)).join("|")}))}function Rk(e,t){const{found:n,filtersWithoutFound:r}=kk(e,t.key);if(!n)return Pk(e,Tk(Ok({},t),{operator:"!~"}));if(["=~","="].includes(n.operator))return Pk(r,Tk(Ok({},t),{operator:"!~"}));const i=new Set(n.value.split("|"));return"!~"===n.operator?Pk(r,Tk(Ok({},n),{value:Array.from(i.add(t.value)).join("|")})):n.value===t.value?e:Pk(r,Tk(Ok({},t),{operator:"!~",value:Array.from(i.add(t.value)).join("|")}))}function Dk(e,t){const{found:n,filtersWithoutFound:r}=kk(e,t.key);if(!n)return e;const i=n.value.split("|").filter((e=>e!==t.value));return i.length>0?Pk(r,Tk(Ok({},n),{value:i.join("|")})):[...r]}const jk=e=>e.operator in g_;function Ik(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Nk extends ag{onActivate(){const e=Rf.findByKeyAndType(this,"dataSource",xk).subscribeToState((()=>{this.setState({filters:[]})}));return()=>{e.unsubscribe()}}constructor({key:e}){super({key:e,name:e,label:"Filters",filters:Nk.DEFAULT_VALUE,expressionBuilder:e=>e.filter(jk).map((({key:e,operator:t,value:n})=>t===g_["is-empty"]?`${e}=""`:`${e}${t}"${n}"`)).join(",")}),Ik(this,"onChangeQuery",((e,t)=>{ru("g_pyroscope_app_filters_changed",{name:this.state.name,count:t.length,operators:(0,ac.uniq)(t.map((e=>e.operator.label)))}),this.setState({filters:t.map(Ck)})})),this.addActivationHandler(this.onActivate.bind(this))}}function Lk(e,t){var n;return null===(n=Rf.lookupVariable(t,e))||void 0===n?void 0:n.getValue()}function Mk(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Fk;Ik(Nk,"DEFAULT_VALUE",[]),Ik(Nk,"Component",(({model:e})=>{const{key:t}=e.useState(),n=Ek(e,t),{value:r}=Rf.findByKeyAndType(e,"dataSource",xk).useState(),{from:i,to:a}=Rf.getTimeRange(e).state.value;return xi().createElement(sk,{id:`query-builder-${t}`,autoExecute:!0,dataSourceUid:r,query:n,from:1e3*i.unix(),to:1e3*a.unix(),onChangeQuery:e.onChangeQuery})})),function(e){e.TIMESERIES="time-series",e.BARGAUGE="bar-gauge",e.HISTOGRAM="histogram"}(Fk||(Fk={}));class $k extends Yp{getUrlState(){return{panelType:this.state.panelType}}updateFromUrl(e){const t={};"string"==typeof e.panelType&&e.panelType!==this.state.panelType&&(t.panelType=Object.values(Fk).includes(e.panelType)?e.panelType:$k.DEFAULT_PANEL_TYPE),this.setState(t)}reset(){this.setState({panelType:$k.DEFAULT_PANEL_TYPE})}constructor(){super({key:"panel-type-switcher",panelType:$k.DEFAULT_PANEL_TYPE}),Mk(this,"_urlSync",new Ph(this,{keys:["panelType"]})),Mk(this,"onChange",(e=>{ru("g_pyroscope_app_panel_type_changed",{panelType:e}),this.setState({panelType:e})}))}}function Bk(e){const t=n.config.theme2.visualization;return t.getColorByName(t.palette[e%8])}Mk($k,"OPTIONS",[{label:"Time series",value:"time-series",icon:"heart-rate"},{label:"Totals",value:"bar-gauge",icon:"align-left"},{label:"Histograms",value:"histogram",icon:"graph-bar"}]),Mk($k,"DEFAULT_PANEL_TYPE","time-series"),Mk($k,"Component",(({model:e})=>{const{panelType:t}=e.useState();return xi().createElement(r.RadioButtonGroup,{"aria-label":"Panel type switcher",options:$k.OPTIONS,value:t,onChange:e.onChange,fullWidth:!1})}));const Vk=(e,t)=>{var n;return(null===(n=e.labels)||void 0===n?void 0:n[t])||"(no value)"},zk=(e,t)=>{var n,r,i;return null===(i=e.meta)||void 0===i||null===(r=i.stats)||void 0===r||null===(n=r.find((e=>e.displayName===t)))||void 0===n?void 0:n.value};function Uk({serviceName:e,profileMetricId:t,groupBy:n,filters:r}){const i=r?[...r]:[];i.unshift({key:"service_name",operator:"=",value:e||"$serviceName"});const a=i.map((({key:e,operator:t,value:n})=>`${e}${t}"${n}"`)).join(",");return new xg({datasource:uk,queries:[{refId:`${t||"$profileMetricId"}-${a}-${(null==n?void 0:n.label)||"no-group-by"}`,queryType:"metrics",profileTypeId:t||"$profileMetricId",labelSelector:`{${a},$filters}`,groupBy:(null==n?void 0:n.label)?[n.label]:[]}]})}class qk{value;next;constructor(e){this.value=e}}class Hk{#G;#W;#Q;constructor(){this.clear()}enqueue(e){const t=new qk(e);this.#G?(this.#W.next=t,this.#W=t):(this.#G=t,this.#W=t),this.#Q++}dequeue(){const e=this.#G;if(e)return this.#G=this.#G.next,this.#Q--,e.value}peek(){if(this.#G)return this.#G.value}clear(){this.#G=void 0,this.#W=void 0,this.#Q=0}get size(){return this.#Q}*[Symbol.iterator](){let e=this.#G;for(;e;)yield e.value,e=e.next}}function Gk(e){if(!Number.isInteger(e)&&e!==Number.POSITIVE_INFINITY||!(e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}function Wk(e){return{from:1e4*Math.floor((e.from.valueOf()||0)/1e4),to:1e4*Math.floor((e.to.valueOf()||0)/1e4)}}function Qk(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function Kk(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){Qk(a,r,i,o,s,"next",e)}function s(e){Qk(a,r,i,o,s,"throw",e)}o(void 0)}))}}const Yk=function(e){Gk(e);const t=new Hk;let n=0;const r=()=>{n<e&&t.size>0&&(t.dequeue()(),n++)},i=async(e,t,i)=>{const a=(async()=>e(...i))();t(a);try{await a}catch{}n--,r()},a=(a,...o)=>new Promise((s=>{((a,o,s)=>{new Promise((e=>{t.enqueue(e)})).then(i.bind(void 0,a,o,s)),(async()=>{await Promise.resolve(),n<e&&r()})()})(a,s,o)}));return Object.defineProperties(a,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value(){t.clear()}},concurrency:{get:()=>e,set(i){Gk(i),e=i,queueMicrotask((()=>{for(;n<e&&t.size>0;)r()}))}}}),a}(20);class Xk extends sh{query(){return Kk((function*(){return{state:e.LoadingState.Done,data:[{name:"Labels",fields:[{name:"Label",type:e.FieldType.other,values:[],config:{}}],length:0}]}}))()}getParams(e){var t;const{scopedVars:n,range:r}=e,i=null==n||null===(t=n.__sceneObject)||void 0===t?void 0:t.value,a=Rf.interpolate(i,"$dataSource"),o=Rf.interpolate(i,"$serviceName"),s=Rf.interpolate(i,"$profileMetricId"),l=`${s}{service_name="${o}"}`,{from:c,to:u}=Wk(r);return{dataSourceUid:a,serviceName:o,profileMetricId:s,query:l,from:c,to:u}}metricFindQuery(e,t){var n=this;return Kk((function*(){var e,r;if(!(null===(r=t.scopedVars)||void 0===r||null===(e=r.__sceneObject)||void 0===e?void 0:e.value).isActive)return[];const{dataSourceUid:i,serviceName:a,profileMetricId:o,query:s,from:l,to:c}=n.getParams(t);if(!a||!o)return Ii.warn('LabelsDataSource: either serviceName="%s" and/or profileMetricId="%s" is empty! Discarding request.',a,o),[];AT.setApiClient(new bT({dataSourceUid:i}));const u=(yield AT.listLabels({query:s,from:l,to:c})).filter((({value:e})=>!rC(e))),d=yield Promise.all(u.map((({value:e})=>Yk(Kk((function*(){const t=yield AT.listLabelValues({query:s,from:l,to:c,label:e}),n=t.length;return{value:JSON.stringify({value:e,groupBy:{label:e,values:t}}),text:`${e} (${n})`,count:n}})))))),p=d.sort(((e,t)=>t.count-e.count)).map((({value:e,text:t})=>({value:e,text:t})));return[{value:"all",text:"All"},...p]}))()}testDatasource(){return Kk((function*(){return{status:"success",message:"OK"}}))()}constructor(){super(hk.type,hk.uid)}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:10,enumerable:!0,configurable:!0,writable:!0}):e[t]=10}(Xk,"MAX_TIMESERIES_LABEL_VALUES");const Jk=()=>e=>e.pipe((0,xp.map)((e=>null==e?void 0:e.map(((e,t)=>(0,ac.merge)(e,{refId:`${e.refId}-${t}`})))))),Zk=()=>e=>e.pipe((0,xp.map)((e=>{const t=null==e?void 0:e.length;return null==e?void 0:e.map((e=>{var n,r;const i=null===(r=e.fields)||void 0===r||null===(n=r.find((e=>"number"===e.type)))||void 0===n?void 0:n.values.reduce(((e,t)=>e+t),0);return(0,ac.merge)(e,{meta:{stats:[{displayName:"totalSeriesCount",value:t},{displayName:"allValuesSum",value:i}]}})}))}))),eP=()=>e=>e.pipe((0,xp.map)((e=>null==e?void 0:e.sort(((e,t)=>{const n=zk(e,"allValuesSum")||0;return(zk(t,"allValuesSum")||0)-n}))))),tP=()=>e=>e.pipe((0,xp.map)((e=>null==e?void 0:e.slice(0,Xk.MAX_TIMESERIES_LABEL_VALUES))));class nP extends Yp{onActivate(t){const{body:n}=this.state,r=n.state.$data.subscribeToState((r=>{var i;if((null===(i=r.data)||void 0===i?void 0:i.state)!==e.LoadingState.Done)return;const{series:a}=r.data;(null==a?void 0:a.length)&&n.setState(this.getConfig(t,a)),this.publishEvent(new d_({series:a}),!0)}));return()=>{r.unsubscribe()}}getConfig(t,n){var r;let i=Number.NEGATIVE_INFINITY;for(const e of n){const t=zk(e,"allValuesSum")||0;t>i&&(i=t)}const a=null===(r=t.queryRunnerParams.groupBy)||void 0===r?void 0:r.label,o=a?"This panel displays aggregate values over the current time period":void 0;return{title:n.length>1?`${t.label} (${n.length})`:t.label,description:o,options:{reduceOptions:{values:!1,calcs:["sum"]},orientation:e.VizOrientation.Horizontal,displayMode:gh.Gradient,valueMode:yh.Text,showUnfilled:!0,sizing:vh.Manual,text:{titleSize:13,valueSize:13},namePlacement:bh.Top,minVizHeight:36,maxVizHeight:36,legend:{showLegend:!1}},fieldConfig:{defaults:{displayName:1===n.length?a:void 0,min:0,max:i,thresholds:{mode:e.ThresholdsMode.Percentage,steps:[]}},overrides:this.getOverrides(t,n)}}}getOverrides(t,n){var r;const{index:i,queryRunnerParams:a}=t,o=null===(r=a.groupBy)||void 0===r?void 0:r.label;return n.map(((t,n)=>({matcher:{id:e.FieldMatcherID.byFrameRefID,options:t.refId},properties:[{id:"displayName",value:Vk(t.fields[1],o)},{id:"color",value:{mode:"fixed",fixedColor:Bk(i+n)}}]})))}static Component({model:e}){const{body:t}=e.useState();return xi().createElement(t.Component,{model:t})}constructor({item:e,headerActions:t}){super({key:"bar-gauge-label-values",body:o_().setTitle(e.label).setData(new Dv({$data:Uk(e.queryRunnerParams),transformations:[Jk,Zk,eP]})).setHeaderActions(t(e)).build()}),this.addActivationHandler(this.onActivate.bind(this,e))}}class rP extends Yp{onActivate(t){const{body:n}=this.state,r=n.state.$data.subscribeToState((r=>{var i;if((null===(i=r.data)||void 0===i?void 0:i.state)!==e.LoadingState.Done)return;const{series:a}=r.data;(null==a?void 0:a.length)&&n.setState(this.getConfig(t,a)),this.publishEvent(new d_({series:a}),!0)}));return()=>{r.unsubscribe()}}getConfig(e,t){var n;const{legendPlacement:i}=this.state,a=null===(n=e.queryRunnerParams.groupBy)||void 0===n?void 0:n.label;return{title:t.length>1?`${e.label} (${t.length})`:e.label,options:{tooltip:{mode:r.TooltipDisplayMode.Single,sort:mh.None},legend:{showLegend:!0,displayMode:r.LegendDisplayMode.List,placement:i,calcs:[]}},fieldConfig:{defaults:{displayName:1===t.length?a:void 0,custom:{lineWidth:1}},overrides:this.getOverrides(e,t)}}}getOverrides(t,n){var r;const{index:i,queryRunnerParams:a}=t,o=null===(r=a.groupBy)||void 0===r?void 0:r.label;return n.map(((t,r)=>{const a=t.fields[1];let s=o?Vk(a,o):a.name;if(1===n.length){const n=zk(t,"allValuesSum")||0,r=(0,e.getValueFormat)(a.config.unit)(n);s=`total ${s} = ${r.text}${r.suffix}`}return{matcher:{id:e.FieldMatcherID.byFrameRefID,options:t.refId},properties:[{id:"displayName",value:s},{id:"color",value:{mode:"fixed",fixedColor:Bk(i+r)}}]}}))}static Component({model:e}){const{body:t}=e.useState();return xi().createElement(t.Component,{model:t})}constructor({item:e,headerActions:t,legendPlacement:n}){super({key:"histogram-label-values",legendPlacement:n||"bottom",body:s_().setTitle(e.label).setData(new Dv({$data:Uk(e.queryRunnerParams),transformations:[Jk,Zk,eP]})).setHeaderActions(t(e)).build()}),this.addActivationHandler(this.onActivate.bind(this,e))}}class iP extends Yp{onActivate(){const{body:t}=this.state;t.setState({menu:this.buildMenu()});const n=t.state.$data.subscribeToState(((n,r)=>{var i,a,o,s;if((null===(i=n.data)||void 0===i?void 0:i.state)!==e.LoadingState.Done)return;!(null===(a=n.data.annotations)||void 0===a?void 0:a.length)&&(null===(s=r.data)||void 0===s||null===(o=s.annotations)||void 0===o?void 0:o.length)&&(n.data.annotations=r.data.annotations);const{series:l}=n.data;if(null==l?void 0:l.length){const e=this.state.displayAllValues?this.getAllValuesConfig(l):this.getConfig(l);t.setState((0,ac.merge)({},t.state,e))}this.publishEvent(new d_({series:l}),!0)}));return()=>{n.unsubscribe()}}buildMenu(e=0){const t=[{index:0,text:"Linear",scaleDistribution:{type:hh.Linear}},{index:1,text:"Log2",scaleDistribution:{type:hh.Log,log:2}}].map((t=>({text:`${e===t.index?" ":""}${t.text}`,onClick:()=>this.onClickScaleOption(t)})));return new Gw({items:[{text:"Scale",type:"group",subMenu:t}]})}onClickScaleOption(e){const{scaleDistribution:t,text:n,index:r}=e,{body:i}=this.state;i.clearFieldConfigCache(),i.setState({menu:this.buildMenu(r),fieldConfig:(0,ac.merge)({},i.state.fieldConfig,{defaults:{custom:{scaleDistribution:t,axisLabel:t.type!==hh.Linear?n:""}}})})}getConfig(e){var t;const{body:n,item:r,legendPlacement:i}=this.state;let a,{title:o}=n.state;if(null===(t=r.queryRunnerParams.groupBy)||void 0===t?void 0:t.label){o=e.length>1?`${r.label} (${e.length})`:r.label;const t=zk(e[0],"totalSeriesCount")||0;a=t>Xk.MAX_TIMESERIES_LABEL_VALUES?`The number of series on this panel has been reduced from ${t} to ${Xk.MAX_TIMESERIES_LABEL_VALUES} to preserve readability. To view all the data, click on the expand icon on this panel.`:void 0}return{title:o,description:a,options:{tooltip:{mode:"single",sort:"none"},legend:{showLegend:!0,displayMode:"list",placement:i}},fieldConfig:{defaults:{min:0,custom:{fillOpacity:e.length>=Xk.MAX_TIMESERIES_LABEL_VALUES?0:9,gradientMode:1===e.length?fh.None:fh.Opacity,pointSize:3}},overrides:this.getOverrides(e)}}}getAllValuesConfig(e){const{legendPlacement:t}=this.state;return{options:{tooltip:{mode:r.TooltipDisplayMode.Single,sort:mh.None},legend:{showLegend:!0,displayMode:r.LegendDisplayMode.List,placement:t,calcs:[]}},fieldConfig:{defaults:{min:0,custom:{fillOpacity:0,pointSize:5}},overrides:this.getOverrides(e)}}}getOverrides(t){var n;if(this.state.overrides)return this.state.overrides(t);const{item:r}=this.state,i=null===(n=r.queryRunnerParams.groupBy)||void 0===n?void 0:n.label;return t.map(((n,a)=>{const o=n.fields[1];let s=i?Vk(o,i):o.name;if(1===t.length){const t=zk(n,"allValuesSum")||0,r=(0,e.getValueFormat)(o.config.unit)(t);s=`total ${s} = ${r.text}${r.suffix}`}return{matcher:{id:e.FieldMatcherID.byFrameRefID,options:n.refId},properties:[{id:"displayName",value:s},{id:"color",value:{mode:"fixed",fixedColor:Bk(r.index+a)}}]}}))}updateTitle(e){this.state.body.setState({title:e})}static Component({model:e}){const{body:t}=e.useState();return xi().createElement(t.Component,{model:t})}constructor({item:e,headerActions:t,displayAllValues:n,legendPlacement:r,data:i,overrides:a}){super({key:"timeseries-label-values",item:e,headerActions:t,displayAllValues:Boolean(n),legendPlacement:r||"bottom",overrides:a,body:l_().setTitle(e.label).setData(i||new Dv({$data:Uk(e.queryRunnerParams),transformations:n?[Jk,Zk,eP]:[Jk,Zk,eP,tP]})).setHeaderActions(t(e)).build()}),this.addActivationHandler(this.onActivate.bind(this))}}function aP(e,t){switch(e){case Fk.BARGAUGE:return new nP(t);case Fk.HISTOGRAM:return new rP(t);case Fk.TIMESERIES:default:return new iP(t)}}var oP=e=>"string"!=typeof e?{}:e.split(/ ?; ?/).reduce(((e,t)=>{const[n,r]=t.split(/ ?: ?/).map(((e,t)=>0===t?e.replace(/\s+/g,""):e.trim()));if(n&&r){const t=n.replace(/(\w)-(\w)/g,((e,t,n)=>`${t}${n.toUpperCase()}`));let i=r.trim();Number.isNaN(Number(r))||(i=Number(r)),e[n.startsWith("-")?n:t]=i}return e}),{}),sP=["br","col","colgroup","dl","hr","iframe","img","input","link","menuitem","meta","ol","param","select","table","tbody","tfoot","thead","tr","ul","wbr"],lP={"accept-charset":"acceptCharset",acceptcharset:"acceptCharset",accesskey:"accessKey",allowfullscreen:"allowFullScreen",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",cellpadding:"cellPadding",cellspacing:"cellSpacing",charset:"charSet",class:"className",classid:"classID",classname:"className",colspan:"colSpan",contenteditable:"contentEditable",contextmenu:"contextMenu",controlslist:"controlsList",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",datetime:"dateTime",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",enctype:"encType",for:"htmlFor",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",innerhtml:"innerHTML",inputmode:"inputMode",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParams",keytype:"keyType",marginwidth:"marginWidth",marginheight:"marginHeight",maxlength:"maxLength",mediagroup:"mediaGroup",minlength:"minLength",nomodule:"noModule",novalidate:"noValidate",playsinline:"playsInline",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rowspan:"rowSpan",spellcheck:"spellCheck",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",tabindex:"tabIndex",typemustmatch:"typeMustMatch",usemap:"useMap",accentheight:"accentHeight","accent-height":"accentHeight",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",arabicform:"arabicForm","arabic-form":"arabicForm",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",diffuseconstant:"diffuseConstant",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",edgemode:"edgeMode",enablebackground:"enableBackground","enable-background":"enableBackground",externalresourcesrequired:"externalResourcesRequired",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",imagerendering:"imageRendering","image-rendering":"imageRendering",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",numoctaves:"numOctaves",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",specularconstant:"specularConstant",specularexponent:"specularExponent",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",vmathematical:"vMathematical","v-mathematical":"vMathematical",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",ychannelselector:"yChannelSelector",zoomandpan:"zoomAndPan",onblur:"onBlur",onchange:"onChange",onclick:"onClick",oncontextmenu:"onContextMenu",ondoubleclick:"onDoubleClick",ondrag:"onDrag",ondragend:"onDragEnd",ondragenter:"onDragEnter",ondragexit:"onDragExit",ondragleave:"onDragLeave",ondragover:"onDragOver",ondragstart:"onDragStart",ondrop:"onDrop",onerror:"onError",onfocus:"onFocus",oninput:"onInput",oninvalid:"onInvalid",onkeydown:"onKeyDown",onkeypress:"onKeyPress",onkeyup:"onKeyUp",onload:"onLoad",onmousedown:"onMouseDown",onmouseenter:"onMouseEnter",onmouseleave:"onMouseLeave",onmousemove:"onMouseMove",onmouseout:"onMouseOut",onmouseover:"onMouseOver",onmouseup:"onMouseUp",onscroll:"onScroll",onsubmit:"onSubmit",ontouchcancel:"onTouchCancel",ontouchend:"onTouchEnd",ontouchmove:"onTouchMove",ontouchstart:"onTouchStart",onwheel:"onWheel"};function cP(e,t,n){const r=[...e].map(((e,r)=>uP(e,{...n,index:r,level:t+1}))).filter(Boolean);return r.length?r:null}function uP(e,t={}){if(!(e&&e instanceof Node))return null;const{actions:n=[],index:r=0,level:i=0,randomKey:a}=t;let o=e,s=`${i}-${r}`;const l=[];return a&&0===i&&(s=`${function(e=6){let t="";for(let n=e;n>0;--n)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.round(61*Math.random())];return t}()}-${s}`),Array.isArray(n)&&n.forEach((t=>{t.condition(o,s,i)&&("function"==typeof t.pre&&(o=t.pre(o,s,i),o instanceof Node||(o=e)),"function"==typeof t.post&&l.push(t.post(o,s,i)))})),l.length?l:function(e,t){const{key:n,level:r,...i}=t;switch(e.nodeType){case 1:return Ei.createElement((a=e.nodeName,/[a-z]+[A-Z]+[a-z]+/.test(a)?a:a.toLowerCase()),function(e,t){const n={key:t};if(e instanceof Element){const t=e.getAttribute("class");t&&(n.className=t),[...e.attributes].forEach((e=>{switch(e.name){case"class":break;case"style":n[e.name]=oP(e.value);break;case"allowfullscreen":case"allowpaymentrequest":case"async":case"autofocus":case"autoplay":case"checked":case"controls":case"default":case"defer":case"disabled":case"formnovalidate":case"hidden":case"ismap":case"itemscope":case"loop":case"multiple":case"muted":case"nomodule":case"novalidate":case"open":case"readonly":case"required":case"reversed":case"selected":case"typemustmatch":n[lP[e.name]||e.name]=!0;break;default:n[lP[e.name]||e.name]=e.value}}))}return n}(e,n),cP(e.childNodes,r,i));case 3:{const t=e.nodeValue?.toString()??"";if(!i.allowWhiteSpaces&&/^\s+$/.test(t)&&!/[\u00A0\u202F]/.test(t))return null;if(!e.parentNode)return t;const n=e.parentNode.nodeName.toLowerCase();return sP.includes(n)?(/\S/.test(t)&&console.warn(`A textNode is not allowed inside '${n}'. Your text "${t}" will be ignored`),null):t}case 8:default:return null;case 11:return cP(e.childNodes,r,t)}var a}(o,{key:s,level:i,...t})}function dP(e,t={}){return"string"==typeof e?function(e,t={}){if(!e||"string"!=typeof e)return null;const{includeAllNodes:n=!1,nodeOnly:r=!1,selector:i="body > *",type:a="text/html"}=t;try{const o=(new DOMParser).parseFromString(e,a);if(n){const{childNodes:e}=o.body;return r?e:[...e].map((e=>uP(e,t)))}const s=o.querySelector(i)||o.body.childNodes[0];if(!(s instanceof Node))throw new TypeError("Error parsing input");return r?s:uP(s,t)}catch(e){}return null}(e,t):e instanceof Node?uP(e,t):null}var pP=Object.defineProperty,hP=(e,t,n)=>(((e,t,n)=>{t in e?pP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),fP="react-inlinesvg",mP={IDLE:"idle",LOADING:"loading",LOADED:"loaded",FAILED:"failed",READY:"ready",UNSUPPORTED:"unsupported"};function gP(){return!("undefined"==typeof window||!window.document||!window.document.createElement)}async function yP(e,t){const n=await fetch(e,t),r=n.headers.get("content-type"),[i]=(r??"").split(/ ?; ?/);if(n.status>299)throw new Error("Not found");if(!["image/svg+xml","text/plain"].some((e=>i.includes(e))))throw new Error(`Content type isn't valid: ${i}`);return n.text()}function bP(e=1){return new Promise((t=>{setTimeout(t,1e3*e)}))}var vP,wP=class{constructor(){hP(this,"cacheApi"),hP(this,"cacheStore"),hP(this,"subscribers",[]),hP(this,"isReady",!1),this.cacheStore=new Map;let e=fP,t=!1;gP()&&(e=window.REACT_INLINESVG_CACHE_NAME??fP,t=!!window.REACT_INLINESVG_PERSISTENT_CACHE&&"caches"in window),t?caches.open(e).then((e=>{this.cacheApi=e,this.isReady=!0,this.subscribers.forEach((e=>e()))})).catch((e=>{this.isReady=!0,console.error(`Failed to open cache: ${e.message}`)})):this.isReady=!0}onReady(e){this.isReady?e():this.subscribers.push(e)}async get(e,t){return await(this.cacheApi?this.fetchAndAddToPersistentCache(e,t):this.fetchAndAddToInternalCache(e,t)),this.cacheStore.get(e)?.content??""}set(e,t){this.cacheStore.set(e,t)}isCached(e){return this.cacheStore.get(e)?.status===mP.LOADED}async fetchAndAddToInternalCache(e,t){const n=this.cacheStore.get(e);if(n?.status!==mP.LOADING){if(!n?.content){this.cacheStore.set(e,{content:"",status:mP.LOADING});try{const n=await yP(e,t);this.cacheStore.set(e,{content:n,status:mP.LOADED})}catch(t){throw this.cacheStore.set(e,{content:"",status:mP.FAILED}),t}}}else await this.handleLoading(e,(async()=>{this.cacheStore.set(e,{content:"",status:mP.IDLE}),await this.fetchAndAddToInternalCache(e,t)}))}async fetchAndAddToPersistentCache(e,t){const n=this.cacheStore.get(e);if(n?.status===mP.LOADED)return;if(n?.status===mP.LOADING)return void await this.handleLoading(e,(async()=>{this.cacheStore.set(e,{content:"",status:mP.IDLE}),await this.fetchAndAddToPersistentCache(e,t)}));this.cacheStore.set(e,{content:"",status:mP.LOADING});const r=await(this.cacheApi?.match(e));if(r){const t=await r.text();this.cacheStore.set(e,{content:t,status:mP.LOADED})}else try{await(this.cacheApi?.add(new Request(e,t)));const n=await(this.cacheApi?.match(e)),r=await(n?.text())??"";this.cacheStore.set(e,{content:r,status:mP.LOADED})}catch(t){throw this.cacheStore.set(e,{content:"",status:mP.FAILED}),t}}async handleLoading(e,t){let n=0;for(;this.cacheStore.get(e)?.status===mP.LOADING&&n<10;)await bP(.1),n+=1;n>=10&&await t()}keys(){return[...this.cacheStore.keys()]}data(){return[...this.cacheStore.entries()].map((([e,t])=>({[e]:t})))}async delete(e){this.cacheApi&&await this.cacheApi.delete(e),this.cacheStore.delete(e)}async clear(){if(this.cacheApi){const e=await this.cacheApi.keys();for(const t of e)await this.cacheApi.delete(t)}this.cacheStore.clear()}};function SP(e){const t=(0,Ei.useRef)();return(0,Ei.useEffect)((()=>{t.current=e})),t.current}function EP(e){const{baseURL:t,content:n,description:r,handleError:i,hash:a,preProcessor:o,title:s,uniquifyIDs:l=!1}=e;try{const e=function(e,t){return t?t(e):e}(n,o),i=dP(e,{nodeOnly:!0});if(!(i&&i instanceof SVGSVGElement))throw new Error("Could not convert the src to a DOM Node");const c=xP(i,{baseURL:t,hash:a,uniquifyIDs:l});if(r){const e=c.querySelector("desc");e?.parentNode&&e.parentNode.removeChild(e);const t=document.createElementNS("http://www.w3.org/2000/svg","desc");t.innerHTML=r,c.prepend(t)}if(void 0!==s){const e=c.querySelector("title");if(e?.parentNode&&e.parentNode.removeChild(e),s){const e=document.createElementNS("http://www.w3.org/2000/svg","title");e.innerHTML=s,c.prepend(e)}}return c}catch(e){return i(e)}}function xP(e,t){const{baseURL:n="",hash:r,uniquifyIDs:i}=t,a=["id","href","xlink:href","xlink:role","xlink:arcrole"],o=["href","xlink:href"];return i?([...e.children].forEach((e=>{if(e.attributes?.length){const t=Object.values(e.attributes).map((e=>{const t=e,i=/url\((.*?)\)/.exec(e.value);return i?.[1]&&(t.value=e.value.replace(i[0],`url(${n}${i[1]}__${r})`)),t}));a.forEach((e=>{const n=t.find((t=>t.name===e));n&&!((e,t)=>o.includes(e)&&!!t&&!t.includes("#"))(e,n.value)&&(n.value=`${n.value}__${r}`)}))}return e.children.length?xP(e,t):e})),e):e}function _P(e){const{cacheRequests:t=!0,children:n=null,description:r,fetchOptions:i,innerRef:a,loader:o=null,onError:s,onLoad:l,src:c,title:u,uniqueHash:d}=e,[p,h]=(0,Ei.useReducer)(((e,t)=>({...e,...t})),{content:"",element:null,isCached:t&&vP.isCached(e.src),status:mP.IDLE}),{content:f,element:m,isCached:g,status:y}=p,b=SP(e),v=SP(p),w=(0,Ei.useRef)(d??function(e){const t="abcdefghijklmnopqrstuvwxyz",n=`${t}${t.toUpperCase()}1234567890`;let r="";for(let e=0;e<8;e++)r+=(i=n)[Math.floor(Math.random()*i.length)];var i;return r}()),S=(0,Ei.useRef)(!1),E=(0,Ei.useRef)(!1),x=(0,Ei.useCallback)((e=>{S.current&&(h({status:"Browser does not support SVG"===e.message?mP.UNSUPPORTED:mP.FAILED}),s?.(e))}),[s]),_=(0,Ei.useCallback)(((e,t=!1)=>{S.current&&h({content:e,isCached:t,status:mP.LOADED})}),[]),O=(0,Ei.useCallback)((async()=>{const e=await yP(c,i);_(e)}),[i,_,c]),T=(0,Ei.useCallback)((()=>{try{const t=dP(EP({...e,handleError:x,hash:w.current,content:f}));if(!t||!(0,Ei.isValidElement)(t))throw new Error("Could not convert the src to a React element");h({element:t,status:mP.READY})}catch(e){x(new Error(e.message))}}),[f,x,e]),C=(0,Ei.useCallback)((async()=>{const e=/^data:image\/svg[^,]*?(;base64)?,(.*)/u.exec(c);let n;if(e?n=e[1]?window.atob(e[2]):decodeURIComponent(e[2]):c.includes("<svg")&&(n=c),n)_(n);else try{if(t){const e=await vP.get(c,i);_(e,!0)}else await O()}catch(e){x(e)}}),[t,O,i,x,_,c]),k=(0,Ei.useCallback)((async()=>{S.current&&h({content:"",element:null,isCached:!1,status:mP.LOADING})}),[]);(0,Ei.useEffect)((()=>{if(S.current=!0,!gP()||E.current)return()=>{};try{if(y===mP.IDLE){if(!function(){if(!document)return!1;const e=document.createElement("div");e.innerHTML="<svg />";const t=e.firstChild;return!!t&&"http://www.w3.org/2000/svg"===t.namespaceURI}()||"undefined"==typeof window||null===window)throw new Error("Browser does not support SVG");if(!c)throw new Error("Missing src");k()}}catch(e){x(e)}return E.current=!0,()=>{S.current=!1}}),[]),(0,Ei.useEffect)((()=>{if(gP()&&b)if(b.src!==c){if(!c)return void x(new Error("Missing src"));k()}else b.title===u&&b.description===r||T()}),[r,T,x,k,b,c,u]),(0,Ei.useEffect)((()=>{v&&(v.status!==mP.LOADING&&y===mP.LOADING&&C(),v.status!==mP.LOADED&&y===mP.LOADED&&T(),v.status!==mP.READY&&y===mP.READY&&l?.(c,g))}),[C,T,g,l,v,c,y]);const P=function(e,...t){const n={};for(const r in e)({}).hasOwnProperty.call(e,r)&&(t.includes(r)||(n[r]=e[r]));return n}(e,"baseURL","cacheRequests","children","description","fetchOptions","innerRef","loader","onError","onLoad","preProcessor","src","title","uniqueHash","uniquifyIDs");return gP()?m?(0,Ei.cloneElement)(m,{ref:a,...P}):[mP.UNSUPPORTED,mP.FAILED].includes(y)?n:o:o}function OP(e){vP||(vP=new wP);const{loader:t}=e,n=(0,Ei.useRef)(!1),[r,i]=(0,Ei.useState)(vP.isReady);return(0,Ei.useEffect)((()=>{n.current||(vP.onReady((()=>{i(!0)})),n.current=!0)}),[]),r?(0,_i.jsx)(_P,{...e}):t}const TP=({width:e="auto",height:t,show404:n=!1})=>{const i=(0,r.useTheme2)(),{x:a,y:o}=((e=50)=>{const[t,n]=(0,Ei.useState)({x:null,y:null});return(0,Ei.useEffect)((()=>{const t=(0,ac.throttle)((e=>{n({x:e.clientX,y:e.clientY})}),e);return window.addEventListener("mousemove",t),()=>{window.removeEventListener("mousemove",t)}}),[e]),t})(),s=(0,r.useStyles2)(CP,a,o,n);return xi().createElement(OP,{src:i.isDark?"public/plugins/grafana-pyroscope-app/img/944c737f589d02ecf603.svg":"public/plugins/grafana-pyroscope-app/img/e79edcfbe2068fae2364.svg",className:s.svg,height:t,width:e})};TP.displayName="GrotNotFound";const CP=(e,n,r,i)=>{const{innerWidth:a,innerHeight:o}=window,s=r&&r/o,l=n&&n/a,c=null!==s?kP(s,-20,5):0,u=null!==l?kP(l,-5,5):0;return{svg:(0,t.css)({"#grot-404-arm, #grot-404-magnifier":{transform:`rotate(${c}deg) translateX(${u}%)`,transformOrigin:"center",transition:"transform 50ms linear"},"#grot-404-text":{display:i?"block":"none"}})}},kP=(e,t,n)=>e*(n-t)+t,PP=({message:e})=>{const t=(0,r.useStyles2)(AP);return xi().createElement("div",{className:t.container},xi().createElement(r.Box,{paddingY:8},xi().createElement(r.Stack,{direction:"column",alignItems:"center",gap:3},xi().createElement(TP,{width:300}),xi().createElement(r.Text,{variant:"h5"},e))))};function AP(){return{container:(0,t.css)({width:"100%",display:"flex",justifyContent:"space-evenly",flexDirection:"column"})}}PP.displayName="EmptyState";class RP extends Yp{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(RP,"Component",(({model:e})=>{const{message:t}=e.useState();return xi().createElement(PP,{message:t})}));class DP extends Yp{}function jP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var IP;!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(DP,"Component",(({model:e})=>{const{message:t}=e.useState();return xi().createElement(r.Alert,{title:"Query error!",severity:"error"},t)})),function(e){e.GRID="grid",e.ROWS="rows"}(IP||(IP={}));class NP extends Yp{getUrlState(){return{layout:this.state.layout}}updateFromUrl(e){const t={};"string"==typeof e.layout&&e.layout!==this.state.layout&&(t.layout=Object.values(IP).includes(e.layout)?e.layout:NP.DEFAULT_LAYOUT),this.setState(t)}constructor(){super({key:"layout-switcher",layout:NP.DEFAULT_LAYOUT}),jP(this,"_urlSync",new Ph(this,{keys:["layout"]})),jP(this,"onChange",(e=>{ru("g_pyroscope_app_layout_changed",{layout:e}),this.setState({layout:e})}))}}function LP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}jP(NP,"OPTIONS",[{label:"Grid",value:"grid"},{label:"Rows",value:"rows"}]),jP(NP,"DEFAULT_LAYOUT","grid"),jP(NP,"Component",(({model:e})=>{const{layout:t}=e.useState();return xi().createElement(r.RadioButtonGroup,{"aria-label":"Layout switcher",options:NP.OPTIONS,value:t,onChange:e.onChange,fullWidth:!1})}));class MP extends Yp{getUrlState(){return{hideNoData:this.state.hideNoData}}updateFromUrl(e){const t={};"string"==typeof e.hideNoData&&e.hideNoData!==this.state.hideNoData&&(t.hideNoData=["on","off"].includes(e.hideNoData)?e.hideNoData:MP.DEFAULT_VALUE),this.setState(t)}constructor(){super({key:"no-data-switcher",hideNoData:MP.DEFAULT_VALUE}),LP(this,"_urlSync",new Ph(this,{keys:["hideNoData"]})),LP(this,"onChange",(e=>{ru("g_pyroscope_app_hide_no_data_changed",{hideNoData:e}),this.setState({hideNoData:e})}))}}function FP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}LP(MP,"DEFAULT_VALUE","off"),LP(MP,"Component",(({model:e})=>{const{hideNoData:t}=e.useState();return xi().createElement(r.InlineSwitch,{"data-testid":"noDataSwitcher",showLabel:!0,label:"Hide panels without data",value:"on"===t,onChange:t=>e.onChange(t.target.checked?"on":"off")})}));class $P extends Yp{setPlaceholder(e){this.setState({placeholder:e})}setResultsCount(e){this.setState({resultsCount:String(e)})}getUrlState(){return{searchText:this.state.searchText}}updateFromUrl(e){const t={};"string"==typeof e.searchText&&e.searchText!==this.state.searchText&&(t.searchText=e.searchText),this.setState(t)}reset(){this.setState({placeholder:"",searchText:"",resultsCount:""})}constructor({placeholder:e}){super({key:"quick-filter",placeholder:e,searchText:$P.DEFAULT_SEARCH_TEXT,resultsCount:""}),FP(this,"_urlSync",new Ph(this,{keys:["searchText"]})),FP(this,"onChange",(e=>{this.setState({searchText:e.target.value})})),FP(this,"clearSearchText",(()=>{this.setState({searchText:""})})),FP(this,"onFocus",(()=>{ru("g_pyroscope_app_quick_filter_focused")}))}}FP($P,"DEFAULT_SEARCH_TEXT",""),FP($P,"DEBOUNCE_DELAY",250),FP($P,"Component",(({model:e})=>{const t=(0,r.useStyles2)(BP),{placeholder:n,searchText:i,resultsCount:a}=e.useState();return xi().createElement(r.Input,{type:"text",className:"quick-filter","aria-label":"Quick filter",placeholder:n,value:i,prefix:xi().createElement(r.Icon,{name:"search"}),suffix:xi().createElement(xi().Fragment,null,""!==a&&xi().createElement(r.Tag,{className:t.resultsCount,name:a,colorIndex:9,"data-testid":"quick-filter-results-count"}),xi().createElement(r.IconButton,{name:"times","aria-label":"Clear search",onClick:e.clearSearchText})),onChange:e.onChange,onKeyDown:t=>{"Escape"===t.key&&e.clearSearchText()},onFocus:e.onFocus})}));const BP=e=>({resultsCount:t.css`
    margin-right: ${e.spacing(1)};
    border-radius: 11px;
    padding: 2px 8px;
    color: ${e.colors.text.primary};
    background-color: ${e.colors.background.secondary};
  `});function VP(e){const t=ck(e);return`${t.type} (${t.group})`}function zP(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function UP(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){zP(a,r,i,o,s,"next",e)}function s(e){zP(a,r,i,o,s,"throw",e)}o(void 0)}))}}function qP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HP(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){qP(e,t,n[t])}))}return e}class GP extends sh{static getAllFavorites(){var e;return(null===(e=Mi.get(Mi.KEYS.PROFILES_EXPLORER))||void 0===e?void 0:e.favorites)||[]}static areFavoritesEqual(e,t){return e.panelType===t.panelType&&(0,ac.isEqual)(e.queryRunnerParams,t.queryRunnerParams)}static exists(e){return GP.getAllFavorites().some((t=>GP.areFavoritesEqual(t,e)))}static addFavorite(e){const t=Mi.get(Mi.KEYS.PROFILES_EXPLORER);t.favorites.push(e),Mi.set(Mi.KEYS.PROFILES_EXPLORER,t)}static removeFavorite(e){const t=Mi.get(Mi.KEYS.PROFILES_EXPLORER);t.favorites=t.favorites.filter((t=>!GP.areFavoritesEqual(t,e))),Mi.set(Mi.KEYS.PROFILES_EXPLORER,t)}query(){return UP((function*(){return{state:e.LoadingState.Done,data:[{name:"Favories",fields:[{name:null,type:e.FieldType.other,values:[],config:{}}],length:0}]}}))()}metricFindQuery(){return UP((function*(){return GP.getAllFavorites().map((e=>{const{serviceName:t,profileMetricId:n,groupBy:r,filters:i}=e.queryRunnerParams||{},a=[t,VP(n)];return(null==r?void 0:r.label)&&a.push(r.label),(null==i?void 0:i.length)&&a.push(i.map((({key:e,operator:t,value:n})=>`${e}${t}"${n}"`)).join(", ")),{value:JSON.stringify(HP({value:JSON.stringify(e)},e)),text:a.join("  ")}}))}))()}testDatasource(){return UP((function*(){return{status:"success",message:"OK"}}))()}constructor(){var e;super(pk.type,pk.uid);const t=Mi.get(Mi.KEYS.PROFILES_EXPLORER)||{};(e=t).favorites||(e.favorites=[]),t.favorites=t.favorites.map((e=>HP({panelType:Fk.TIMESERIES},e))),Mi.set(Mi.KEYS.PROFILES_EXPLORER,t)}}function WP(e,t){const{queryRunnerParams:n}=t,r=(0,ac.defaults)((0,ac.clone)(n),{serviceName:Lk(e,"serviceName"),profileMetricId:Lk(e,"profileMetricId")}),i=Rf.lookupVariable("filters",e).state.filters.map((({key:e,operator:t,value:n})=>({key:e,operator:t,value:n})));return r.filters=(0,ac.uniqBy)([...r.filters||[],...i],(({key:e,operator:t,value:n})=>`${e}${t}${n}`)),r}function QP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class KP extends Yp{update(){this.setState({isFav:this.isStored()})}isStored(){return GP.exists(this.buildFavorite())}static buildFavorite(e){var t;const{index:n,queryRunnerParams:r,panelType:i}=e,a={index:n,queryRunnerParams:{serviceName:r.serviceName,profileMetricId:r.profileMetricId},panelType:i};return r.groupBy&&(a.queryRunnerParams.groupBy={label:r.groupBy.label}),(null===(t=r.filters)||void 0===t?void 0:t.length)&&(a.queryRunnerParams.filters=r.filters),a}buildFavorite(){const{item:e,skipVariablesInterpolation:t}=this.state;return KP.buildFavorite({index:e.index,queryRunnerParams:t?e.queryRunnerParams:WP(this,e),panelType:e.panelType})}constructor(e){super(e),QP(this,"_variableDependency",new If(this,{variableNames:["serviceName","profileMetricId","filters"],onReferencedVariableValueChanged:()=>{this.update()}})),QP(this,"onClick",(()=>{ru("g_pyroscope_app_fav_action_clicked",{favAfterClick:!this.state.isFav}),this.state.isFav?GP.removeFavorite(this.buildFavorite()):GP.addFavorite(this.buildFavorite()),this.setState({isFav:!this.state.isFav})})),this.addActivationHandler((()=>this.update()))}}QP(KP,"Component",(({model:e})=>{const t=(0,r.useStyles2)(YP),{isFav:n}=e.useState();return xi().createElement(r.IconButton,{className:n?t.favedButton:t.notFavedbutton,name:n?"favorite":"star",variant:"secondary",size:"sm","aria-label":n?"Unfavorite":"Favorite",tooltip:n?"Unfavorite":"Favorite",tooltipPlacement:"top",onClick:e.onClick})}));const YP=()=>({favedButton:t.css`
    color: #f2cc0d;
    margin: 0;
  `,notFavedbutton:t.css`
    margin: 0;
  `}),XP=function(e,t){const n=GP.exists(KP.buildFavorite(e)),r=GP.exists(KP.buildFavorite(t));return n&&r?e.label.localeCompare(t.label):r?1:n?-1:0},JP="240px";class ZP extends Yp{static buildGridItemKey(e){return`grid-item-${e.index}-${e.value}`}static getGridColumnsTemplate(e){return e===IP.ROWS?"1fr":"repeat(auto-fit, minmax(400px, 1fr))"}onActivate(){const e=Rf.lookupVariable(this.state.variableName,this),t=e.subscribeToState(((e,t)=>{!e.loading&&t.loading&&this.renderGridItems()}));e.update();const n=this.subscribeToRefreshClick(),r=this.subscribeToQuickFilterChange(),i=this.subscribeToLayoutChange(),a=this.subscribeToHideNoDataChange(),o=this.subscribeToFiltersChange();return()=>{o.unsubscribe(),a.unsubscribe(),i.unsubscribe(),r.unsubscribe(),n.unsubscribe(),t.unsubscribe()}}subscribeToRefreshClick(){const t=Rf.lookupVariable(this.state.variableName,this),n=t.state.refresh;t.setState({refresh:e.VariableRefresh.never});const r=()=>{t.update()},i=document.querySelector('[data-testid="data-testid RefreshPicker run button"]');return i||Ii.error(new Error("SceneByVariableRepeaterGrid: Refresh button not found! The list of items will never be updated.")),null==i||i.addEventListener("click",r),null==i||i.setAttribute("title","Click to completely refresh all the panels present on the screen"),{unsubscribe(){null==i||i.removeAttribute("title"),null==i||i.removeEventListener("click",r),t.setState({refresh:n})}}}subscribeToQuickFilterChange(){const e=Rf.findByKeyAndType(this,"quick-filter",$P);return this.subscribeToState(((t,n)=>{t.items.length!==n.items.length&&e.setResultsCount(t.items.length)})),e.subscribeToState((0,ac.debounce)(((e,t)=>{e.searchText!==(null==t?void 0:t.searchText)&&this.renderGridItems()}),$P.DEBOUNCE_DELAY))}subscribeToLayoutChange(){const e=Rf.findByKeyAndType(this,"layout-switcher",NP),t=this.state.body,n=(e,n)=>{e.layout!==(null==n?void 0:n.layout)&&t.setState({templateColumns:ZP.getGridColumnsTemplate(e.layout)})};return n(e.state),e.subscribeToState(n)}subscribeToHideNoDataChange(){const e=Rf.findByKeyAndType(this,"no-data-switcher",MP);if(!e.isActive)return this.setState({hideNoData:!1}),{unsubscribe:Fi};const t=(e,t)=>{e.hideNoData!==(null==t?void 0:t.hideNoData)&&(this.setState({hideNoData:"on"===e.hideNoData}),this.renderGridItems(!0))};return t(e.state),e.subscribeToState(t)}subscribeToFiltersChange(){const e=Rf.findByKeyAndType(this,"filters",Nk),t=Rf.findByKeyAndType(this,"no-data-switcher",MP);return e.subscribeToState((()=>{"on"===t.state.hideNoData&&this.renderGridItems(!0)}))}buildItemsData(e){const{mapOptionToItem:t}=this.state,n={serviceName:Lk(this,"serviceName"),profileMetricId:Lk(this,"profileMetricId"),panelType:Rf.findByKeyAndType(this,"panel-type-switcher",$k).state.panelType},r=e.state.options.map(((e,r)=>t(e,r,n))).filter(Boolean);return this.filterItems(r).sort(this.state.sortItemsFn)}shouldRenderItems(e){const{items:t}=this.state;return!e.length||t.length!==e.length||!(0,ac.isEqual)(t,e)}renderGridItems(e=!1){const t=Rf.lookupVariable(this.state.variableName,this);if(t.state.loading)return;if(t.state.error)return void this.renderErrorState(t.state.error);const n=this.buildItemsData(t);if(!e&&!this.shouldRenderItems(n))return;if(this.setState({items:n}),!this.state.items.length)return void this.renderEmptyState();const r=this.state.items.map((e=>{const t=aP(e.panelType,{item:e,headerActions:this.state.headerActions.bind(null,e,this.state.items)});return this.state.hideNoData&&this.setupHideNoData(t),new HE({key:ZP.buildGridItemKey(e),body:t})}));this.state.body.setState({autoRows:JP,children:r})}setupHideNoData(e){const t=e.subscribeToEvent(d_,(t=>{var n;if(null===(n=t.payload.series)||void 0===n?void 0:n.length)return;const r=Rf.getAncestor(e,HE),{key:i}=r.state,a=Rf.getAncestor(r,qE),o=a.state.children.filter((e=>e.state.key!==i));o.length?a.setState({children:o}):this.renderEmptyState()}));e.addActivationHandler((()=>()=>{t.unsubscribe()}))}filterItems(e){const t=Rf.findByKeyAndType(this,"quick-filter",$P),{searchText:n}=t.state;if(!n)return e;const r=n.split(",").map((e=>e.trim())).filter(Boolean).map((e=>{try{return new RegExp(e)}catch(e){return null}})).filter(Boolean);return e.filter((({label:e})=>r.some((t=>t.test(e)))))}renderEmptyState(){this.state.body.setState({autoRows:"480px",children:[new HE({body:new RP({message:"No results"})})]})}renderErrorState(e){this.state.body.setState({autoRows:"480px",children:[new HE({body:new DP({message:e.toString()})})]})}static Component({model:e}){var t;const{body:n,variableName:i}=e.useState(),{loading:a}=null===(t=Rf.lookupVariable(i,e))||void 0===t?void 0:t.useState();return a?xi().createElement(r.Spinner,null):xi().createElement(n.Component,{model:n})}constructor({key:t,variableName:n,headerActions:r,mapOptionToItem:i,sortItemsFn:a}){super({key:t,variableName:n,items:[],headerActions:r,mapOptionToItem:i,sortItemsFn:a||XP,hideNoData:!1,body:new qE({templateColumns:ZP.getGridColumnsTemplate(NP.DEFAULT_LAYOUT),autoRows:JP,isLazy:!0,$behaviors:[new Hg({key:"metricCrosshairSync",sync:e.DashboardCursorSync.Crosshair})],children:[]})}),this.addActivationHandler(this.onActivate.bind(this))}}class eA extends e.BusEventWithPayload{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(eA,"type","expand-panel");class tA extends e.BusEventWithPayload{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(tA,"type","select-label");class nA extends e.BusEventWithPayload{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(nA,"type","view-service-flame-graph");class rA extends e.BusEventWithPayload{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(rA,"type","view-service-labels");class iA extends e.BusEventWithPayload{}function aA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){aA(e,t,n[t])}))}return e}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(iA,"type","view-service-profiles");const sA=new Map([["expand-panel",Object.freeze({ariaLabel:"Expand panel",icon:"expand-arrows",tooltip:()=>"Expand this panel to view all the data for the current filters",EventConstructor:eA})],["select-label",Object.freeze({label:"Select",tooltip:({queryRunnerParams:e})=>{var t;return`View "${null===(t=e.groupBy)||void 0===t?void 0:t.label}" values breakdown`},EventConstructor:tA})],["view-flame-graph",Object.freeze({label:"Flame graph",tooltip:({queryRunnerParams:e},t)=>{const n=e.serviceName||Lk(t,"serviceName");return`View the "${ck(e.profileMetricId||Lk(t,"profileMetricId")).type}" flame graph of ${n}`},EventConstructor:nA})],["view-labels",Object.freeze({label:"Labels",tooltip:({queryRunnerParams:e},t)=>`Explore the labels of ${e.serviceName||Lk(t,"serviceName")}`,EventConstructor:rA})],["view-profiles",Object.freeze({label:"Profile types",tooltip:({queryRunnerParams:e},t)=>`View the profile types of ${e.serviceName||Lk(t,"serviceName")}`,EventConstructor:iA})]]);class lA extends Yp{buildEvent(){const{EventConstructor:e,item:t,skipVariablesInterpolation:n}=this.state;return new e({item:(r=oA({},t),i={queryRunnerParams:n?t.queryRunnerParams:WP(this,t)},i=null!=i?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(i)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})),r)});var r,i}constructor({type:e,item:t,tooltip:n,skipVariablesInterpolation:r}){const i=sA.get(e);if(!i)throw new TypeError(`Unknown event type="${e}"!`);super(oA({type:e,item:t},(0,ac.merge)({},i,{tooltip:n,skipVariablesInterpolation:r}))),aA(this,"onClick",(()=>{ru("g_pyroscope_app_select_action_clicked",{type:this.state.type}),this.publishEvent(this.buildEvent(),!0)}))}}aA(lA,"Component",(({model:e})=>{const t=(0,r.useStyles2)(cA),{ariaLabel:n,label:i,icon:a,tooltip:o,item:s}=e.useState();return xi().createElement(r.Button,{className:t.selectButton,"aria-label":n||i,variant:"primary",size:"sm",fill:"text",onClick:e.onClick,icon:a,tooltip:null==o?void 0:o(s,e),tooltipPlacement:"top"},i)}));const cA=()=>({selectButton:t.css`
    margin: 0;
    padding: 0;
  `});class uA extends Yp{onActivate(){Rf.findByKeyAndType(this,"quick-filter",$P).setPlaceholder("Search services (comma-separated regexes are supported)")}getVariablesAndGridControls(){return{variables:[Rf.findByKeyAndType(this,"profileMetricId",gk)],gridControls:[Rf.findByKeyAndType(this,"quick-filter",$P),Rf.findByKeyAndType(this,"layout-switcher",NP)]}}static Component({model:e}){const{body:t}=e.useState();return xi().createElement(t.Component,{model:t})}constructor(){super({key:"explore-all-services",$variables:new Mv({variables:[new wk({query:wk.QUERY_PROFILE_METRIC_DEPENDENT,skipUrlSync:!0})]}),body:new ZP({key:"all-services-grid",variableName:"serviceName",mapOptionToItem:(e,t,{profileMetricId:n})=>({index:t,value:e.value,label:e.label,queryRunnerParams:{serviceName:e.value,profileMetricId:n},panelType:Fk.TIMESERIES}),headerActions:e=>[new lA({type:"view-profiles",item:e}),new lA({type:"view-labels",item:e}),new lA({type:"view-flame-graph",item:e}),new KP({item:e})]})}),this.addActivationHandler(this.onActivate.bind(this))}}function dA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){dA(e,t,n[t])}))}return e}class hA extends Yp{constructor(e){super(pA({key:"drawer",isOpen:!1},e)),dA(this,"open",(({title:e,subTitle:t,body:n})=>{var r,i;this.setState((r=pA({},this.state),i=null!=(i={isOpen:!0,title:e,subTitle:t,body:n})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(i)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})),r))})),dA(this,"close",(()=>{this.setState({isOpen:!1})}))}}function fA(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}dA(hA,"Component",(({model:e})=>{const{isOpen:t,title:n,subTitle:i,body:a}=e.useState();return xi().createElement(xi().Fragment,null,a&&t&&xi().createElement(r.Drawer,{size:"lg",title:n,subtitle:i,closeOnMaskClick:!0,onClose:e.close},xi().createElement(a.Component,{model:a})))}));class mA extends Sw{update(){var e,t=this;return(e=function*(){if(t.state.loading)return;let e=[],n=null;t.setState({loading:!0,options:[],error:null});try{e=yield(0,xp.lastValueFrom)(t.getValueOptions({}))}catch(e){n=e}finally{t.setState({loading:!1,options:e,error:n})}},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){fA(a,r,i,o,s,"next",e)}function s(e){fA(a,r,i,o,s,"throw",e)}o(void 0)}))})()}constructor(){super({name:"favorite",label:" Favorite",datasource:pk,query:"$dataSource",loading:!0,refresh:e.VariableRefresh.never,skipUrlSync:!0})}}function gA(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}class yA extends Yp{onActivate(){Rf.findByKeyAndType(this,"quick-filter",$P).setPlaceholder("Search favorites (comma-separated regexes are supported)");var e=this;const t=this.subscribeToEvent(eA,function(){var t,n=(t=function*(t){e.openExpandedPanelDrawer(t.payload.item)},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){gA(a,r,i,o,s,"next",e)}function s(e){gA(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}());return()=>{t.unsubscribe()}}getVariablesAndGridControls(){return{variables:[],gridControls:[Rf.findByKeyAndType(this,"quick-filter",$P),Rf.findByKeyAndType(this,"layout-switcher",NP),Rf.findByKeyAndType(this,"no-data-switcher",MP)]}}openExpandedPanelDrawer(e){this.state.drawer.open({title:e.label,body:aP(e.panelType,{displayAllValues:!0,legendPlacement:"right",item:e,headerActions:()=>[new lA({type:"view-labels",item:e}),new lA({type:"view-flame-graph",item:e})]})})}static Component({model:e}){const{body:t,drawer:n}=e.useState();return xi().createElement(xi().Fragment,null,xi().createElement(t.Component,{model:t}),xi().createElement(n.Component,{model:n}))}constructor(){super({key:"explore-favorites",$variables:new Mv({variables:[new mA]}),body:new ZP({key:"favorites-grid",variableName:"favorite",mapOptionToItem:e=>{const{index:t,value:n,panelType:r,queryRunnerParams:i}=JSON.parse(e.value);return{index:t,value:n,label:e.label,queryRunnerParams:i,panelType:r}},sortItemsFn:(e,t)=>e.label.localeCompare(t.label),headerActions:e=>{const t=[new lA({type:"view-labels",item:e,skipVariablesInterpolation:!0}),new lA({type:"view-flame-graph",item:e,skipVariablesInterpolation:!0})];return e.queryRunnerParams.groupBy&&t.push(new lA({type:"expand-panel",item:e,tooltip:()=>"Expand this panel to view all the data",skipVariablesInterpolation:!0})),t.push(new KP({item:e,skipVariablesInterpolation:!0})),t}}),drawer:new hA}),this.addActivationHandler(this.onActivate.bind(this))}}function bA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class vA extends Yp{onActivate(){const{headerActions:e}=this.state;this.setState({body:new iP({item:{index:0,value:"",label:this.buildTitle(),panelType:Fk.TIMESERIES,queryRunnerParams:{}},headerActions:e})})}buildTitle(){const e=Lk(this,"profileMetricId"),{description:t}=ck(e);return t||VP(e)}static Component({model:e}){const{body:t}=e.useState();return t&&xi().createElement(t.Component,{model:t})}constructor({item:e,headerActions:t}){super({item:e,headerActions:t,body:void 0}),bA(this,"_variableDependency",new If(this,{variableNames:["profileMetricId"],onReferencedVariableValueChanged:()=>{var e;null===(e=this.state.body)||void 0===e||e.updateTitle(this.buildTitle())}})),this.addActivationHandler(this.onActivate.bind(this))}}bA(vA,"MIN_HEIGHT",200);class wA extends e.BusEventWithPayload{}function SA({options:e,mainLabels:t,value:n,onChange:i,onRefresh:a}){const o=(0,r.useStyles2)(EA),s=(0,r.useTheme2)(),[l,c]=(0,Ei.useState)(0),[u,d]=(0,Ei.useState)(0),p=u>l,h=(0,Ei.useRef)(null);!function(e){const{ref:t,box:n,onResize:r}=e;(0,Ei.useEffect)((()=>{let e=null==t?void 0:t.current;if(e){if(void 0===window.ResizeObserver)return window.addEventListener("resize",r,!1),()=>{window.removeEventListener("resize",r,!1)};{const t=new window.ResizeObserver((e=>{e.length&&r()}));return t.observe(e,{box:n}),()=>{e&&t.unobserve(e)}}}}),[r,t,n])}({ref:h,onResize:()=>{const e=h.current;e&&d(e.clientWidth)}});const f=e.filter((e=>t.includes(e.value))),m=e.filter((e=>!t.includes(e.value)));return(0,Ei.useEffect)((()=>{const{fontSize:e}=s.typography,t=f.map((e=>e.label||e.text||"")).join(" "),n=(0,r.measureText)(t,e).width;c(n+70*f.length)}),[f,s]),xi().createElement(r.Field,{label:"Group by labels"},xi().createElement("div",{ref:h,className:o.container},p?xi().createElement(xi().Fragment,null,xi().createElement(r.RadioButtonGroup,{"aria-label":"Labels selector",options:f,value:n,onChange:i}),xi().createElement(r.Select,{"aria-label":"Other labels selector",className:o.select,placeholder:"Other labels",options:m,value:n&&m.some((e=>e.value===n))?n:null,onChange:e=>{var t;return i(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"all")},isClearable:!0})):xi().createElement(r.Select,{"aria-label":"Labels selector",className:o.select,value:n,placeholder:"Select label",options:e,onChange:e=>i((null==e?void 0:e.value)||TA.DEFAULT_VALUE),isClearable:!0}),xi().createElement(r.RefreshPicker,{noIntervalPicker:!0,onRefresh:a,isOnCanvas:!1,onIntervalChanged:Fi,tooltip:"Click to refresh all labels"})))}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(wA,"type","view-diff-flame-graph");const EA=e=>({container:t.css`
    display: flex;
    gap: ${e.spacing(1)};
  `,select:t.css`
    max-width: ${e.spacing(22)};
  `});function xA(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function _A(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){xA(a,r,i,o,s,"next",e)}function s(e){xA(a,r,i,o,s,"throw",e)}o(void 0)}))}}function OA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class TA extends Sw{onActivate(){this.state.value||this.setState({value:TA.DEFAULT_VALUE})}constructor(){super({key:"groupBy",name:"groupBy",label:"Group by labels",datasource:hk,query:'$dataSource and $profileMetricId{service_name="$serviceName"}',loading:!0});var e=this;OA(this,"update",_A((function*(){if(e.state.loading)return;let t=[],n=null;e.setState({loading:!0,options:[],error:null});try{t=yield(0,xp.lastValueFrom)(e.getValueOptions({}))}catch(e){n=e}finally{e.setState({loading:!1,options:t,error:n})}}))),OA(this,"onChange",(e=>{ru("g_pyroscope_app_group_by_label_clicked"),u_(),this.changeValueTo(e)})),this.changeValueTo=this.changeValueTo.bind(this),this.addActivationHandler(this.onActivate.bind(this))}}OA(TA,"DEFAULT_VALUE","all"),OA(TA,"MAX_MAIN_LABELS",8),OA(TA,"Component",(({model:e})=>{const t=(0,r.useStyles2)(CA),{loading:n,value:i,options:a,error:o}=e.useState(),s=(0,Ei.useMemo)((()=>a.map((({label:e,value:t})=>"all"===t?{label:e,value:t}:{label:e,value:JSON.parse(String(t)).value}))),[a]);return n?xi().createElement(r.Field,{label:"Group by labels"},xi().createElement(r.Spinner,{className:t.spinner})):o?(Ii.error(o,{info:'Error while loading "groupBy" variable values!'}),xi().createElement(r.Field,{label:"Group by labels"},xi().createElement("div",{className:t.groupByErrorContainer},xi().createElement(r.Tooltip,{theme:"error",content:o.toString()},xi().createElement(r.Icon,{className:t.iconError,name:"exclamation-triangle",size:"xl"})),xi().createElement(r.RefreshPicker,{noIntervalPicker:!0,onRefresh:e.update,isOnCanvas:!1,onIntervalChanged:Fi})))):xi().createElement(SA,{options:s,value:i,mainLabels:(e=>e.slice(0,TA.MAX_MAIN_LABELS).map((({value:e})=>e)))(s),onChange:e.onChange,onRefresh:e.update})}));const CA=e=>({spinner:t.css`
    height: 32px;
    line-height: 32px;
  `,groupByErrorContainer:t.css`
    display: flex;
  `,iconError:t.css`
    height: 32px;
    align-self: center;
    color: ${e.colors.error.text};
  `});class kA extends e.BusEventWithPayload{}function PA({option:e,checked:n,onChange:i}){var a;const o=(0,r.useStyles2)(AA),[s,l]=(0,Ei.useState)(!1),c=(0,Ei.useRef)(null),u=null===(a=c.current)||void 0===a?void 0:a.closest("label");return(0,Ei.useEffect)((()=>{if(!u||n)return void l(!1);const e=()=>{l(!0)},t=()=>{l(!1)};return u.addEventListener("mouseenter",e),u.addEventListener("mouseleave",t),()=>{u.removeEventListener("mouseleave",t),u.removeEventListener("mouseenter",e)}}),[n,u]),xi().createElement(xi().Fragment,null,xi().createElement(r.Tooltip,{content:e.description,show:!n&&s,placement:"top"},xi().createElement("span",{className:o.tooltipAnchor})),xi().createElement(r.Checkbox,{ref:c,className:(0,t.cx)(o.checkbox,"checkbox",n&&"checked"),checked:n,label:e.label,onChange:()=>i(e.value)}))}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(kA,"type","select-for-compare");const AA=e=>({tooltipAnchor:t.css`
    position: relative;
    left: 42px;
  `,checkbox:t.css`
    column-gap: 4px;

    &:last-child {
      & :nth-child(1) {
        grid-column-start: 2;
      }
      & :nth-child(2) {
        grid-column-start: 1;
      }
    }

    span {
      color: ${e.colors.text.secondary};
    }
    span:hover {
      color: ${e.colors.text.primary};
    }

    &.checked span {
      color: ${e.colors.text.primary};
    }
  `});function RA({item:t,itemStats:n,statsDescription:i,compareActionChecks:a,onChangeCompareTarget:o}){const s=(0,r.useStyles2)(DA),{index:l,value:c}=t,u=Bk(l),d=(0,Ei.useMemo)((()=>{if(!n)return xi().createElement(r.Spinner,{inline:!0});const{allValuesSum:t,unit:i}=n,{text:a,suffix:o}=(0,e.getValueFormat)(i)(t);return`${a}${o}`}),[n]),p=(0,Ei.useMemo)((()=>[{label:"Baseline",value:Ud.BASELINE,description:a[0]?"":`Click to select "${c}" as baseline for comparison`},{label:"Comparison",value:Ud.COMPARISON,description:a[1]?"":`Click to select "${c}" as target for comparison`}]),[a,c]);return xi().createElement("div",{className:s.container,"data-testid":`stats-panel-${c}`},xi().createElement("h1",{style:{color:u},className:s.title,title:`${i}: ${d}`},d),xi().createElement("div",{className:s.compareActions},xi().createElement(PA,{option:p[0],checked:a[0],onChange:o}),xi().createElement(PA,{option:p[1],checked:a[1],onChange:o})))}const DA=e=>({container:t.css`
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    width: 100%;
    background-color: ${e.colors.background.canvas};
    padding: ${e.spacing(1)};
    border: 1px solid ${e.colors.border.weak};
    border-right: none;
    border-radius: 2px 0 0 2px;
  `,title:t.css`
    font-size: 24px;
    width: 100%;
    text-align: center;
    margin-top: ${e.spacing(5)};
  `,compareActions:t.css`
    display: flex;
    justify-content: space-between;
    font-size: 11px;
    border-top: 1px solid ${e.colors.border.weak};
    padding: ${e.spacing(1)} 0 0 0;

    & .checkbox:nth-child(2) {
      padding-right: 4px;
      border-right: 1px solid ${e.colors.border.strong};
    }
    & .checkbox:nth-child(4) {
      padding-left: 4px;
    }
  `});function jA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class IA extends Yp{onActivate(){const e=Rf.findByKeyAndType(this,"group-by-labels",ZA).getCompare();this.updateCompareActions(e.get(Ud.BASELINE),e.get(Ud.COMPARISON)),this.setState({statsDescription:this.getStatsDescription()})}updateCompareActions(e,t){const{item:n}=this.state;this.setState({compareActionChecks:[(null==e?void 0:e.value)===n.value,(null==t?void 0:t.value)===n.value]})}getStatsDescription(){const e=Lk(this,"profileMetricId"),{description:t}=ck(e);return t||VP(e)}getStats(){return this.state.itemStats}updateStats(e){this.setState({itemStats:e})}static Component({model:e}){const{item:t,itemStats:n,statsDescription:r,compareActionChecks:i}=e.useState();return xi().createElement(RA,{item:t,itemStats:n,statsDescription:r,compareActionChecks:i,onChangeCompareTarget:e.onChangeCompareTarget})}constructor({item:e}){super({item:e,itemStats:void 0,compareActionChecks:[!1,!1],statsDescription:""}),jA(this,"onChangeCompareTarget",(e=>{this.publishEvent(new kA({compareTarget:e,item:this.state.item}),!0)})),this.addActivationHandler(this.onActivate.bind(this))}}jA(IA,"WIDTH_IN_PIXELS",186);class NA extends Yp{static buildPanelKey(e){return`compare-panel-${e.value}`}onActivate(){const{statsPanel:e,timeseriesPanel:t}=this.state,n=t.subscribeToEvent(d_,(t=>{var n,r;const i=null===(n=t.payload.series)||void 0===n?void 0:n[0];if(!i)return void e.updateStats({allValuesSum:0,unit:"short"});const a=zk(i,"allValuesSum")||0;(null===(r=e.getStats())||void 0===r?void 0:r.allValuesSum)!==a&&e.updateStats({allValuesSum:a,unit:i.fields[1].config.unit||"short"})}));return()=>{n.unsubscribe()}}static Component({model:e}){const n=(0,r.useStyles2)(LA),{statsPanel:i,timeseriesPanel:a}=e.useState(),{compareActionChecks:o}=i.useState(),s=o[0]||o[1];return xi().createElement("div",{className:(0,t.cx)(n.container,s&&"selected")},xi().createElement("div",{className:n.statsPanel},xi().createElement(i.Component,{model:i})),xi().createElement("div",{className:n.timeseriesPanel},xi().createElement(a.Component,{model:a})))}constructor({item:e,headerActions:t}){super({key:"label-value-panel",statsPanel:new IA({item:e}),timeseriesPanel:new iP({item:e,headerActions:t})}),this.addActivationHandler(this.onActivate.bind(this))}}const LA=e=>({container:t.css`
    display: flex;
    min-width: 0px;
    min-height: ${FA};
    flex-flow: row;

    box-sizing: border-box;
    border: 1px solid transparent;
    &.selected {
      border: 1px solid ${e.colors.primary.main};
    }

    & > div {
      display: flex;
      position: relative;
      flex-direction: row;
      align-self: stretch;
      min-height: ${FA};
    }
  `,statsPanel:t.css`
    width: ${IA.WIDTH_IN_PIXELS}px;
  `,timeseriesPanel:t.css`
    flex-grow: 1;

    & [data-viz-panel-key] > * {
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
    }
  `});function MA({label:e}){const t='service_name="$serviceName"';return new xg({datasource:uk,queries:[{refId:`$profileMetricId-${t}-${e}`,queryType:"metrics",profileTypeId:"$profileMetricId",labelSelector:`{${t}}`,groupBy:[e]}]})}const FA="160px";class $A extends Yp{static buildGridItemKey(e){return`grid-item-${e.index}-${e.value}`}onActivate(){this.subscribeOnceToDataChange();const e=this.subscribeToGroupByChange(),t=this.subscribeToRefreshClick(),n=this.subscribeToQuickFilterChange(),r=this.subscribeToLayoutChange(),i=this.subscribeToHideNoDataChange(),a=this.subscribeToFiltersChange();return()=>{a.unsubscribe(),i.unsubscribe(),r.unsubscribe(),n.unsubscribe(),t.unsubscribe(),e.unsubscribe()}}subscribeOnceToDataChange(t=!1){const n=this.state.$data.subscribeToState((r=>{var i;(null===(i=r.data)||void 0===i?void 0:i.state)!==e.LoadingState.Loading&&(n.unsubscribe(),this.renderGridItems(t),this.setState({isLoading:!1}))}))}subscribeToGroupByChange(){return Rf.findByKeyAndType(this,"groupBy",TA).subscribeToState(((e,t)=>{!e.loading&&t.loading&&this.refetchData()}))}subscribeToRefreshClick(){const e=()=>{this.refetchData()},t=document.querySelector('[data-testid="data-testid RefreshPicker run button"]');return t||Ii.error(new Error("SceneByVariableRepeaterGrid: Refresh button not found! The list of items will never be updated.")),null==t||t.addEventListener("click",e),null==t||t.setAttribute("title","Click to completely refresh all the panels present on the screen"),{unsubscribe(){null==t||t.removeAttribute("title"),null==t||t.removeEventListener("click",e)}}}subscribeToQuickFilterChange(){const e=Rf.findByKeyAndType(this,"quick-filter",$P);return this.subscribeToState(((t,n)=>{t.items.length!==n.items.length&&e.setResultsCount(t.items.length)})),e.subscribeToState((0,ac.debounce)(((e,t)=>{e.searchText!==(null==t?void 0:t.searchText)&&this.renderGridItems()}),$P.DEBOUNCE_DELAY))}subscribeToLayoutChange(){const e=Rf.findByKeyAndType(this,"layout-switcher",NP),t=this.state.body,n=(e,n)=>{e.layout!==(null==n?void 0:n.layout)&&t.setState({templateColumns:e.layout===IP.ROWS?"1fr":"repeat(auto-fit, minmax(600px, 1fr))"})};return n(e.state),e.subscribeToState(n)}subscribeToHideNoDataChange(){const e=Rf.findByKeyAndType(this,"no-data-switcher",MP);return this.setState({hideNoData:"on"===e.state.hideNoData}),e.subscribeToState(((e,t)=>{e.hideNoData!==(null==t?void 0:t.hideNoData)&&(this.setState({hideNoData:"on"===e.hideNoData}),this.refetchData(!0))}))}subscribeToFiltersChange(){const e=Rf.findByKeyAndType(this,"filters",Nk),t=Rf.findByKeyAndType(this,"no-data-switcher",MP);return e.subscribeToState((()=>{"on"===t.state.hideNoData&&this.refetchData()}))}refetchData(e=!1){this.setState({isLoading:!0,$data:new Dv({$data:MA({label:this.state.label}),transformations:[Jk,Zk,eP]})}),this.subscribeOnceToDataChange(e)}shouldRenderItems(e){const{items:t}=this.state;return!e.length||t.length!==e.length||!(0,ac.isEqual)(t,e)}buildItemsData(e){const t=Lk(this,"serviceName"),n=Lk(this,"profileMetricId"),{label:r,startColorIndex:i,sortItemsFn:a}=this.state,o=e.map(((e,a)=>{var o;const s=e.fields[1],l=(null===(o=s.labels)||void 0===o?void 0:o[r])||"",c=Vk(s,r);return{index:i+a,value:l,label:c,queryRunnerParams:{serviceName:t,profileMetricId:n,filters:[{key:r,operator:"=",value:l}]},panelType:Fk.TIMESERIES}}));return this.filterItems(o).sort(a)}renderGridItems(t=!1){if(!this.state.$data.state.data)return;const{state:n,series:r,errors:i}=this.state.$data.state.data;if(n===e.LoadingState.Loading)return;if(n===e.LoadingState.Error)return void this.renderErrorState(null==i?void 0:i[0]);const a=this.buildItemsData(r);if(!t&&!this.shouldRenderItems(a))return;if(this.setState({items:a}),!this.state.items.length)return void this.renderEmptyState();const o=a.map((e=>new HE({key:$A.buildGridItemKey(e),body:this.buildVizPanel(e)})));this.state.body.setState({autoRows:FA,children:o})}buildVizPanel(e){const t=new NA({item:e,headerActions:this.state.headerActions.bind(null,e,this.state.items)}),n=t.subscribeToEvent(d_,(e=>{var n;if(!this.state.hideNoData||(null===(n=e.payload.series)||void 0===n?void 0:n.length))return;const r=Rf.getAncestor(t,HE),{key:i}=r.state,a=Rf.getAncestor(r,qE),o=a.state.children.filter((e=>e.state.key!==i));o.length?a.setState({children:o}):this.renderEmptyState()}));return t.addActivationHandler((()=>()=>{n.unsubscribe()})),t}filterItems(e){const t=Rf.findByKeyAndType(this,"quick-filter",$P),{searchText:n}=t.state;if(!n)return e;const r=n.split(",").map((e=>e.trim())).filter(Boolean).map((e=>{try{return new RegExp(e)}catch(e){return null}})).filter(Boolean);return e.filter((({label:e})=>r.some((t=>t.test(e)))))}renderEmptyState(){this.state.body.setState({autoRows:"480px",children:[new HE({body:new RP({message:"No results"})})]})}renderErrorState(e){this.state.body.setState({autoRows:"480px",children:[new HE({body:new DP({message:e.toString()})})]})}static Component({model:e}){const{body:t,isLoading:n}=e.useState();return n?xi().createElement(r.Spinner,null):xi().createElement("div",{style:{marginBottom:"2px"}},xi().createElement(t.Component,{model:t}))}constructor({key:t,label:n,startColorIndex:r,headerActions:i}){super({key:t,label:n,startColorIndex:r,items:[],isLoading:!0,$data:new Dv({$data:MA({label:n}),transformations:[Jk,Zk,eP]}),hideNoData:!1,headerActions:i,sortItemsFn:XP,body:new qE({templateColumns:"1fr",autoRows:FA,isLazy:!0,$behaviors:[new Hg({key:"metricCrosshairSync",sync:e.DashboardCursorSync.Crosshair})],children:[]})}),this.addActivationHandler(this.onActivate.bind(this))}}class BA extends e.BusEventWithPayload{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(BA,"type","clear-label-from-filters");class VA extends e.BusEventWithPayload{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(VA,"type","exclude-label-from-filters");class zA extends e.BusEventWithPayload{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(zA,"type","include-label-in-filters");const UA=e=>{const n=(0,r.useStyles2)(HA),{include:i,exclude:a}=function({status:e,label:t,onInclude:n,onExclude:r,onClear:i}){const a="included"===e,o="excluded"===e;return{include:{isSelected:a,tooltip:a?`Clear "${t}" from the filters`:`Include "${t}" in the filters`,onClick:a?i:n},exclude:{isSelected:o,tooltip:o?`Clear "${t}" from the filters`:`Exclude "${t}" in the filters`,onClick:o?i:r}}}(e);return xi().createElement("div",{className:n.container},xi().createElement(r.Button,{size:"sm",fill:"outline",variant:i.isSelected?"primary":"secondary","aria-selected":i.isSelected,className:(0,t.cx)(n.includeButton,i.isSelected&&"selected"),onClick:i.onClick,tooltip:i.tooltip,tooltipPlacement:"top","data-testid":"filter-button-include"},"Include"),xi().createElement(r.Button,{size:"sm",fill:"outline",variant:a.isSelected?"primary":"secondary","aria-selected":a.isSelected,className:(0,t.cx)(n.excludeButton,a.isSelected&&"selected"),onClick:a.onClick,tooltip:a.tooltip,tooltipPlacement:"top","data-testid":"filter-button-exclude"},"Exclude"))},qA=(0,Ei.memo)(UA),HA=e=>({container:t.css`
      display: flex;
      justify-content: center;
    `,includeButton:t.css`
      border-radius: ${e.shape.radius.default} 0 0 ${e.shape.radius.default};

      &:not(.selected) {
        border-right: none;
      }
    `,excludeButton:t.css`
      border-radius: 0 ${e.shape.radius.default} ${e.shape.radius.default} 0;

      &:not(.selected) {
        border-left: none;
      }
    `});function GA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class WA extends Yp{getStatus(e){const{key:t,value:n}=this.state.item.queryRunnerParams.filters[0],r=e.find((e=>e.key===t));return r?uC(r.operator)&&r.value.split("|").includes(n)?"=~"===r.operator?"included":"excluded":r.value===n?"="===r.operator?"included":"excluded":"clear":"clear"}constructor({item:e}){super({item:e}),GA(this,"onInclude",(()=>{ru("g_pyroscope_app_include_action_clicked"),this.publishEvent(new zA({item:this.state.item}),!0)})),GA(this,"onExclude",(()=>{ru("g_pyroscope_app_exclude_action_clicked"),this.publishEvent(new VA({item:this.state.item}),!0)})),GA(this,"onClear",(()=>{this.publishEvent(new BA({item:this.state.item}),!0)}))}}function QA({compare:e,onClickCompare:n,onClickClear:i}){const a=(0,r.useStyles2)(KA),o=e.size<2,s=e.size>0,l=(0,Ei.useMemo)((()=>{var t,n,r,i;return 2===e.size?`Compare "${null===(r=e.get(Ud.BASELINE))||void 0===r?void 0:r.label}" vs "${null===(i=e.get(Ud.COMPARISON))||void 0===i?void 0:i.label}"`:0===e.size?"Select both a baseline and a comparison panel to compare their flame graphs":e.has(Ud.BASELINE)?`Select another panel to compare against "${null===(t=e.get(Ud.BASELINE))||void 0===t?void 0:t.label}"`:`Select another panel to compare against "${null===(n=e.get(Ud.COMPARISON))||void 0===n?void 0:n.label}"`}),[e]);return xi().createElement("div",{className:a.container},xi().createElement(r.Button,{"arial-label":"Compare",className:a.compareButton,variant:"primary",disabled:o,onClick:o?Fi:n,tooltip:l},"Compare (",e.size,"/2)"),xi().createElement(r.Button,{"data-testid":"clearComparison",className:(0,t.cx)(a.clearButton,o?void 0:a.clearButtonActive),icon:"times",variant:"secondary",tooltip:s?"Clear comparison selection":"",disabled:!s,onClick:s?i:Fi}))}GA(WA,"Component",(({model:e})=>{const{item:t}=e.useState(),{filters:n}=Rf.findByKeyAndType(e,"filters",Nk).useState(),r=(0,Ei.useMemo)((()=>e.getStatus(n)),[n,e]);return xi().createElement(qA,{label:t.value,status:r,onInclude:e.onInclude,onExclude:e.onExclude,onClear:e.onClear})}));const KA=e=>({container:t.css`
    display: flex;
    align-items: center;
    width: ${IA.WIDTH_IN_PIXELS}px;
  `,compareButton:t.css`
    width: ${IA.WIDTH_IN_PIXELS-32}px;
    border-right: none;
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  `,clearButton:t.css`
    box-sizing: border-box;
    width: 32px !important;
    height: 32px !important;
    color: ${e.colors.text.secondary};
    background-color: transparent;
    border-left: none !important;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;

    &:not([disabled]),
    &:not([disabled]):hover {
      background-color: transparent;
      box-shadow: none;
    }
  `,clearButtonActive:t.css`
    border-color: ${e.colors.border.medium};

    &:hover {
      border-color: ${e.colors.border.medium};
    }
  `});function YA(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function XA(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){YA(a,r,i,o,s,"next",e)}function s(e){YA(a,r,i,o,s,"throw",e)}o(void 0)}))}}function JA(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ZA extends Yp{onActivate(e){var t=this;return XA((function*(){const n=Rf.findByKeyAndType(t,"groupBy",TA);yield n.update(),e&&t.initVariablesAndControls(e),t.renderBody(n.state);const r=t.subscribeToGroupByChange(),i=t.subscribeToPanelEvents();return()=>{var e;i.unsubscribe(),r.unsubscribe(),null===(e=t.state.panelTypeChangeSub)||void 0===e||e.unsubscribe()}}))()}initVariablesAndControls(e){const{queryRunnerParams:t,panelType:n}=e,{groupBy:r}=t;(null==r?void 0:r.label)&&Rf.findByKeyAndType(this,"groupBy",TA).changeValueTo(r.label),n&&Rf.findByKeyAndType(this,"panel-type-switcher",$k).setState({panelType:n})}subscribeToGroupByChange(){const e=Rf.findByKeyAndType(this,"groupBy",TA),t=Rf.findByKeyAndType(this,"quick-filter",$P);return e.subscribeToState(((e,n)=>{e.value!==(null==n?void 0:n.value)&&(t.clearSearchText(),this.renderBody(e))}))}subscribeToPanelEvents(){const e=this.subscribeToEvent(tA,(e=>{this.selectLabel(e.payload.item)}));var t=this;const n=this.subscribeToEvent(eA,function(){var e=XA((function*(e){t.openExpandedPanelDrawer(e.payload.item)}));return function(t){return e.apply(this,arguments)}}()),r=this.subscribeToEvent(kA,(e=>{const{compareTarget:t,item:n}=e.payload;this.selectForCompare(t,n)})),i=this.subscribeToEvent(zA,(e=>{this.includeLabelValueInFilters(e.payload.item)})),a=this.subscribeToEvent(VA,(e=>{this.excludeLabelValueFromFilters(e.payload.item)})),o=this.subscribeToEvent(BA,(e=>{this.clearLabelValueFromFilters(e.payload.item)}));return{unsubscribe(){o.unsubscribe(),a.unsubscribe(),i.unsubscribe(),r.unsubscribe(),n.unsubscribe(),e.unsubscribe()}}}subscribeToPanelTypeChange(){return Rf.findByKeyAndType(this,"panel-type-switcher",$k).subscribeToState(((e,t)=>{var n;e.panelType!==(null==t?void 0:t.panelType)&&(null===(n=this.state.body)||void 0===n||n.renderGridItems())}))}renderBody(e){var t;null===(t=this.state.panelTypeChangeSub)||void 0===t||t.unsubscribe(),"all"===e.value?(this.setState({panelTypeChangeSub:this.subscribeToPanelTypeChange()}),this.switchToLabelNamesGrid()):this.switchToLabelValuesGrid(e)}switchToLabelNamesGrid(){Rf.findByKeyAndType(this,"quick-filter",$P).setPlaceholder("Search labels (comma-separated regexes are supported)"),this.setState({body:this.buildSceneLabelNamesGrid()})}buildSceneLabelNamesGrid(){return new ZP({key:"service-labels-grid",variableName:"groupBy",mapOptionToItem:(e,t,{serviceName:n,profileMetricId:r,panelType:i})=>{if("all"===e.value)return null;const{value:a,groupBy:o}=JSON.parse(e.value);return{index:t-1,value:a,label:a,queryRunnerParams:{serviceName:n,profileMetricId:r,groupBy:o,filters:[]},panelType:i}},headerActions:e=>[new lA({type:"select-label",item:e}),new lA({type:"expand-panel",item:e}),new KP({item:e})]})}switchToLabelValuesGrid(e){Rf.findByKeyAndType(this,"quick-filter",$P).setPlaceholder("Search label values (comma-separated regexes are supported)"),this.clearCompare();const{value:t,options:n}=e,r=n.filter((e=>"all"!==e.value)).findIndex((e=>JSON.parse(e.value).value===t)),i=r>-1?r:0;this.setState({body:this.buildSceneLabelValuesGrid(t,i)})}buildSceneLabelValuesGrid(e,t){return new $A({key:"service-label-values-grid",startColorIndex:t,label:e,headerActions:e=>[new lA({type:"view-flame-graph",item:e,tooltip:(e,t)=>{const{queryRunnerParams:n,label:r}=e,i=n.profileMetricId||Lk(t,"profileMetricId"),a=Lk(t,"groupBy");return`View the "${ck(i).type}" flame graph for "${a}=${r}"`}}),new WA({item:e}),new KP({item:e})]})}selectLabel({queryRunnerParams:e}){const t=e.groupBy.label,n=Rf.findByKeyAndType(this,"groupBy",TA);u_(),n.changeValueTo(t),this.state.drawer.close()}includeLabelValueInFilters(e){const[t]=e.queryRunnerParams.filters,n=Rf.findByKeyAndType(this,"filters",Nk);n.setState({filters:Ak(n.state.filters,t)})}excludeLabelValueFromFilters(e){const t=Rf.findByKeyAndType(this,"filters",Nk),[n]=e.queryRunnerParams.filters;t.setState({filters:Rk(t.state.filters,n)})}clearLabelValueFromFilters(e){const t=Rf.findByKeyAndType(this,"filters",Nk),[n]=e.queryRunnerParams.filters;t.setState({filters:Dk(t.state.filters,n)})}openExpandedPanelDrawer(e){const t=`${Lk(this,"serviceName")}  ${VP(Lk(this,"profileMetricId"))}  ${e.label}`;this.state.drawer.open({title:t,body:aP(e.panelType,{displayAllValues:!0,legendPlacement:"right",item:e,headerActions:()=>[new lA({type:"select-label",item:e}),new KP({item:e})]})})}selectForCompare(e,t){var n;const r=new Map(this.state.compare);(null===(n=r.get(e))||void 0===n?void 0:n.value)===t.value?r.delete(e):r.set(e,t),this.setState({compare:r}),this.updateStatsPanels()}updateStatsPanels(){const{compare:e}=this.state,t=e.get(Ud.BASELINE),n=e.get(Ud.COMPARISON),r=Rf.findAllObjects(this,(e=>e instanceof IA));for(const e of r)e.updateCompareActions(t,n)}getCompare(){return this.state.compare}clearCompare(){this.setState({compare:new Map})}updateCompareFilters(){const{compare:e}=this.state,t=e.get(Ud.BASELINE),n=e.get(Ud.COMPARISON),r=WP(this,t),i=WP(this,n);Rf.findByKeyAndType(this,"filtersBaseline",Nk).setState({filters:r.filters}),Rf.findByKeyAndType(this,"filtersComparison",Nk).setState({filters:i.filters})}constructor({item:e}){super({key:"group-by-labels",body:void 0,drawer:new hA,compare:new Map,panelTypeChangeSub:void 0}),JA(this,"onClickCompareButton",(()=>{ru("g_pyroscope_app_compare_link_clicked"),this.updateCompareFilters(),this.publishEvent(new wA({}),!0)})),JA(this,"onClickClearCompareButton",(()=>{this.clearCompare(),this.updateStatsPanels()})),this.addActivationHandler((()=>{this.onActivate(e)}))}}JA(ZA,"Component",(({model:e})=>{const t=(0,r.useStyles2)(eR),{body:n,drawer:i,compare:a}=e.useState(),o=Rf.findByKeyAndType(e,"groupBy",TA),{value:s}=o.useState(),l=(0,Ei.useMemo)((()=>"all"===s?Rf.findByKeyAndType(e,"profiles-explorer",LM).state.gridControls:[Rf.findByKeyAndType(e,"quick-filter",$P),Rf.findByKeyAndType(e,"layout-switcher",NP),Rf.findByKeyAndType(e,"no-data-switcher",MP)]),[s,e]);return xi().createElement("div",{className:t.container,"data-testid":"groupByLabelsContainer"},xi().createElement(o.Component,{model:o}),xi().createElement("div",{className:t.sceneControls},xi().createElement(r.Stack,{wrap:"wrap"},"all"!==s&&xi().createElement(QA,{compare:a,onClickCompare:e.onClickCompareButton,onClickClear:e.onClickClearCompareButton}),l.map((e=>xi().createElement(e.Component,{key:e.state.key,model:e}))))),n&&xi().createElement(n.Component,{model:n}),xi().createElement(i.Component,{model:i}))}));const eR=e=>({container:t.css`
    margin-top: ${e.spacing(1)};
  `,sceneControls:t.css`
    margin-bottom: ${e.spacing(1)};

    & .quick-filter {
      flex: 1;
      min-width: 112px;
    }
  `});class tR extends Yp{onActivate(e){e&&this.initVariables(e);const t=Rf.findByKeyAndType(this,"profileMetricId",gk);return t.setState({query:gk.QUERY_SERVICE_NAME_DEPENDENT}),t.update(!0),()=>{t.setState({query:gk.QUERY_DEFAULT}),t.update(!0)}}initVariables(e){const{queryRunnerParams:t}=e,{serviceName:n,profileMetricId:r,filters:i}=t;n&&Rf.findByKeyAndType(this,"serviceName",wk).changeValueTo(n),r&&Rf.findByKeyAndType(this,"profileMetricId",gk).changeValueTo(r),i&&Rf.findByKeyAndType(this,"filters",Nk).setState({filters:i})}getVariablesAndGridControls(){return{variables:[Rf.findByKeyAndType(this,"serviceName",wk),Rf.findByKeyAndType(this,"profileMetricId",gk),Rf.findByKeyAndType(this,"filters",Nk)],gridControls:[]}}static Component({model:e}){const{body:t}=e.useState();return xi().createElement(t.Component,{model:t})}constructor({item:t}){super({key:"explore-service-labels",body:new LE({direction:"column",$behaviors:[new Hg({key:"metricCrosshairSync",sync:e.DashboardCursorSync.Crosshair})],children:[new ME({minHeight:vA.MIN_HEIGHT,body:new vA({item:t,headerActions:e=>[new lA({type:"view-flame-graph",item:e}),new KP({item:e})]})}),new ME({body:new ZA({item:t})})]})}),this.addActivationHandler(this.onActivate.bind(this,t))}}class nR extends Yp{onActivate(e){Rf.findByKeyAndType(this,"quick-filter",$P).setPlaceholder("Search profile types (comma-separated regexes are supported)"),e&&this.initVariables(e)}initVariables(e){e.queryRunnerParams.serviceName&&Rf.findByKeyAndType(this,"serviceName",wk).changeValueTo(e.queryRunnerParams.serviceName)}getVariablesAndGridControls(){return{variables:[Rf.findByKeyAndType(this,"serviceName",wk)],gridControls:[Rf.findByKeyAndType(this,"quick-filter",$P),Rf.findByKeyAndType(this,"layout-switcher",NP)]}}static Component({model:e}){const{body:t}=e.useState();return xi().createElement(t.Component,{model:t})}constructor({item:e}){super({key:"explore-service-profile-types",$variables:new Mv({variables:[new gk({query:gk.QUERY_SERVICE_NAME_DEPENDENT,skipUrlSync:!0})]}),body:new ZP({key:"profile-metrics-grid",variableName:"profileMetricId",mapOptionToItem:(e,t,{serviceName:n})=>({index:t,value:e.value,label:e.label,queryRunnerParams:{serviceName:n,profileMetricId:e.value},panelType:Fk.TIMESERIES}),headerActions:e=>[new lA({type:"view-labels",item:e}),new lA({type:"view-flame-graph",item:e}),new KP({item:e})]})}),this.addActivationHandler(this.onActivate.bind(this,e))}}function rR(t,n){return{from:t,to:n,value:{from:(0,e.dateTimeParse)(t),to:(0,e.dateTimeParse)(n),raw:{from:t,to:n}}}}const iR=()=>rR("now-30m","now");function aR(e,t){if(t){const n=e.services.get(t)||new Map;return Array.from(n.values()).sort(((e,t)=>t.group.localeCompare(e.group))).map((({id:e,type:t,group:n})=>({value:e,text:`${t} (${n})`})))}return Array.from(e.profileMetrics.keys()).map((e=>ck(e))).sort(((e,t)=>t.group.localeCompare(e.group))).map((({id:e,type:t,group:n})=>({value:e,text:`${t} (${n})`})))}function oR(e,t){if(t){const n=e.profileMetrics.get(t)||new Set;return Array.from(n).sort(((e,t)=>e.localeCompare(t))).map((e=>({text:e,value:e})))}return Array.from(e.services.keys()).sort(((e,t)=>e.localeCompare(t))).map((e=>({text:e,value:e})))}class sR{static build(e,t){const n=`${e}-${t.name}`,r=sR.cache.get(n);if(r instanceof t)return r;const i=new t({dataSourceUid:e});return sR.cache.set(n,i),i}}function lR(e){let t,n;for(const{name:r,value:i}of e)if("service_name"===r&&(t=i),"__profile_type__"===r&&(n=i),t&&n)return[t,n];return[]}function cR(e){const t=new Map,n=new Map;if(!e.labelsSet)return Ii.warn("Pyroscope SeriesApiClient: no data received!"),{services:t,profileMetrics:n};for(const{labels:r}of e.labelsSet){const[e,i]=lR(r);if(!e||!i){Ii.warn('Pyroscope ServicesApiClient: "service_name" and/or "__profile_type__" are missing in the labels received!',r);continue}const a=t.get(e)||new Map;a.set(i,ck(i)),t.set(e,a);const o=n.get(i)||new Set;o.add(e),n.set(i,o)}return{services:t,profileMetrics:n}}function uR(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(sR,"cache",new Map);class dR extends mT{list(e){var t,n=this;return(t=function*(){const{from:t,to:r}=e;return n.fetch("/querier.v1.QuerierService/Series",{method:"POST",body:JSON.stringify({start:t,end:r,labelNames:["service_name","__profile_type__"],matchers:[]})}).then((e=>e.json())).then(cR)},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){uR(a,r,i,o,s,"next",e)}function s(e){uR(a,r,i,o,s,"throw",e)}o(void 0)}))})()}constructor(e){super(e)}}function pR(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}const hR=new class extends ET{list(e){var t,n=this;return(t=function*(){const{from:t,to:r}=Wk(e.timeRange),i=[n.apiClient.baseUrl,t,r],a=n.cacheClient.get(i);if(a){const{services:e,profileMetrics:t}=yield a;return e.size||t.size||n.cacheClient.delete(i),{services:e,profileMetrics:t}}const o=n.apiClient.list({from:t,to:r});n.cacheClient.set(i,o);try{const{services:e,profileMetrics:t}=yield o;return{services:e,profileMetrics:t}}catch(e){throw n.cacheClient.delete(i),e}},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){pR(a,r,i,o,s,"next",e)}function s(e){pR(a,r,i,o,s,"throw",e)}o(void 0)}))})()}constructor(e){super(e)}}({cacheClient:new vT});function fR(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function mR(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){fR(a,r,i,o,s,"next",e)}function s(e){fR(a,r,i,o,s,"throw",e)}o(void 0)}))}}class gR extends sh{fetchSeries(e,t){return mR((function*(){const n=sR.build(e,dR);return hR.setApiClient(n),hR.list({timeRange:t})}))()}query(){return mR((function*(){return{state:e.LoadingState.Done,data:[{name:"PyroscopeSeries",fields:[{name:"PyroscopeSeries",type:e.FieldType.other,values:[],config:{}}],length:0}]}}))()}metricFindQuery(e,t){var n=this;return mR((function*(){var r,i;const a=null===(i=t.scopedVars)||void 0===i||null===(r=i.__sceneObject)||void 0===r?void 0:r.value,o=Rf.interpolate(a,"$dataSource"),s=Rf.interpolate(a,"$serviceName"),l=Rf.interpolate(a,"$profileMetricId"),c=yield n.fetchSeries(o,t.range);switch(e){case"$dataSource and all services":return oR(c);case"$dataSource and all profile metrics":return aR(c);case"$dataSource and only $profileMetricId services":return oR(c,l);case"$dataSource and only $serviceName profile metrics":return aR(c,s);default:throw new TypeError(`Unsupported query "${e}"!`)}}))()}testDatasource(){return mR((function*(){return{status:"success",message:"OK"}}))()}constructor(){super(dk.type,dk.uid)}}const yR=/^\d+[yYmMsSwWhHdD]$/;function bR(t){if("string"!=typeof t)return null;if(-1!==t.indexOf("now"))return t;if(yR.test(t))return t;if(8===t.length){const n=(0,e.toUtc)(t,"YYYYMMDD");if(n.isValid())return n.toISOString()}else if(15===t.length){const n=(0,e.toUtc)(t,"YYYYMMDDTHHmmss");if(n.isValid())return n.toISOString()}else if(24===t.length)return(0,e.toUtc)(t).toISOString();const n=parseInt(t,10);return isNaN(n)?null:(0,e.toUtc)(n).toISOString()}function vR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class wR extends e.MutableDataFrame{addRange(e){var t,n;this.add((t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){vR(e,t,n[t])}))}return e}({},e),n=null!=(n={isRegion:!0})?n:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})),t))}constructor(){super(),[{name:"time",type:e.FieldType.time},{name:"timeEnd",type:e.FieldType.time},{name:"isRegion",type:e.FieldType.boolean},{name:"color",type:e.FieldType.other},{name:"text",type:e.FieldType.string}].forEach((e=>this.addField(e)))}}function SR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ER(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){SR(e,t,n[t])}))}return e}var xR;!function(e){e.ANNOTATIONS="annotations",e.DEFAULT="default"}(xR||(xR={}));const _R={from:(0,e.dateTime)(0),to:(0,e.dateTime)(0),raw:{from:"",to:""}};class OR extends Yp{onActivate(){var t;this.setState((0,ac.omit)(this.getAncestorTimeRange().state,"key")),this._subs.add(this.getAncestorTimeRange().subscribeToState((e=>{this.setState((0,ac.omit)(e,"key"))}))),this._subs.add(null===(t=this.getTimeseries().state.$data)||void 0===t?void 0:t.subscribeToState(((t,n)=>{var r,i,a,o,s,l;t.data&&t.data.state===e.LoadingState.Done&&((null===(r=t.data.annotations)||void 0===r?void 0:r.length)||(null===(a=n.data)||void 0===a||null===(i=a.annotations)||void 0===i?void 0:i.length)?!(null===(o=t.data.annotations)||void 0===o?void 0:o.length)&&(null===(l=n.data)||void 0===l||null===(s=l.annotations)||void 0===s?void 0:s.length)&&(t.data.annotations=n.data.annotations):this.updateTimeseriesAnnotation())})))}getAncestorTimeRange(){if(!this.parent||!this.parent.parent)throw new Error(typeof this+" must be used within $timeRange scope");return Rf.getTimeRange(this.parent.parent)}getTimeseries(){try{const e=Rf.getAncestor(this,My);if("timeseries"!==e.state.pluginId)throw new TypeError("Incorrect VizPanel type!");return e}catch(e){throw new Error("Ancestor timeseries panel not found!")}}updateTimeseriesAnnotation(){const{annotationTimeRange:e,annotationColor:t,annotationTitle:n}=this.state,{$data:r}=this.getTimeseries().state,i=null==r?void 0:r.state.data;if(!i)return;const a=new wR;var o,s;a.addRange({color:t,text:n,time:1e3*e.from.unix(),timeEnd:1e3*e.to.unix()}),null==r||r.setState({data:(o=ER({},i),s={annotations:[a]},s=null!=s?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(s)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(s,e))})),o)})}setAnnotationTimeRange(e,t=!1){this.setState({annotationTimeRange:e}),t&&this.updateTimeseriesAnnotation()}nullifyAnnotationTimeRange(){this.setAnnotationTimeRange(_R)}getUrlState(){const{annotationTimeRange:e}=this.state;return{diffFrom:"string"==typeof e.raw.from?e.raw.from:e.raw.from.toISOString(),diffTo:"string"==typeof e.raw.to?e.raw.to:e.raw.to.toISOString()}}updateFromUrl(e){const{diffFrom:t,diffTo:n}=e;if(!n&&!t)return;const{annotationTimeRange:r}=this.state;var i,a;this.setAnnotationTimeRange(this.buildAnnotationTimeRange(null!==(i=bR(t))&&void 0!==i?i:r.from,null!==(a=bR(n))&&void 0!==a?a:r.to))}buildAnnotationTimeRange(t,n){return function(t,n,r,i,a){const o=a&&"now"===n;return{from:e.dateMath.parse(t,!1,r,i),to:e.dateMath.parse(o?"now-"+a:n,!0,r,i),raw:{from:t,to:n}}}(t,n,this.getTimeZone(),this.state.fiscalYearStartMonth,this.state.UNSAFE_nowDelay)}onTimeRangeChange(e){const{mode:t}=this.state;"default"!==t?this.setAnnotationTimeRange(e,!0):this.getAncestorTimeRange().onTimeRangeChange(e)}onTimeZoneChange(e){this.getAncestorTimeRange().onTimeZoneChange(e)}getTimeZone(){return this.getAncestorTimeRange().getTimeZone()}onRefresh(){this.getAncestorTimeRange().onRefresh()}constructor(e){super(ER({from:_R.raw.from,to:_R.raw.to,value:_R,annotationTimeRange:_R},e)),SR(this,"_variableDependency",new If(this,{variableNames:["dataSource","serviceName"],onReferencedVariableValueChanged:()=>{this.nullifyAnnotationTimeRange(),this.updateTimeseriesAnnotation()}})),SR(this,"_urlSync",new Ph(this,{keys:["diffFrom","diffTo"]})),this.addActivationHandler(this.onActivate.bind(this))}}class TR extends e.BusEventWithPayload{}function CR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kR;!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(TR,"type","switch-timerange-selection-mode"),function(e){e.TIMEPICKER="timepicker",e.FLAMEGRAPH="flame-graph"}(kR||(kR={}));class PR extends Yp{constructor(){super({mode:"flame-graph"}),CR(this,"onChange",(e=>{this.setState({mode:e}),this.publishEvent(new TR({mode:e}),!0)}))}}CR(PR,"OPTIONS",[{label:"Time picker",value:"timepicker"},{label:"Flame graph",value:"flame-graph"}]),CR(PR,"Component",(({model:e})=>{const t=(0,r.useStyles2)(AR),{mode:n}=e.useState();return xi().createElement("div",{className:t.container},xi().createElement("label",{className:t.label},xi().createElement("span",null,"Range selection mode"),xi().createElement(r.Tooltip,{content:xi().createElement("div",{className:t.tooltip},xi().createElement("div",null,"Use these buttons to change the behaviour when selecting a range with the mouse on the time series:"),xi().createElement("dl",null,xi().createElement("dt",null,"Time picker"),xi().createElement("dd",null,"Time range zoom in (default behaviour)"),xi().createElement("dt",null,"Flame graph"),xi().createElement("dd",null,"Time range for building the flame graph (the stack traces will be retrieved only for the selected range)"))),placement:"top"},xi().createElement(r.Icon,{name:"question-circle"}))),xi().createElement(r.RadioButtonGroup,{size:"sm",options:PR.OPTIONS,value:n,onChange:e.onChange,"aria-label":"Range selection mode"}))}));const AR=e=>({container:t.css`
    display: flex;
    flex-direction: column;
  `,tooltip:t.css`
    padding: ${e.spacing(1)};
    & dl {
      margin-top: ${e.spacing(2)};
      display: grid;
      grid-gap: ${e.spacing(1)} ${e.spacing(2)};
      grid-template-columns: max-content;
    }
    & dt {
      font-weight: bold;
    }
    & dd {
      margin: 0;
      grid-column-start: 2;
    }
  `,label:t.css`
    font-size: 12px;
    text-align: right;
    margin-bottom: 2px;
    color: ${e.colors.text.secondary};
  `});function RR({filterKey:e}){return new xg({datasource:uk,queries:[{refId:`$profileMetricId-$serviceName-${e}}`,queryType:"metrics",profileTypeId:"$profileMetricId",labelSelector:`{service_name="$serviceName",$${e}}`}]})}var DR=__webpack_require__(4308),jR=__webpack_require__.n(DR);const IR={COLOR:jR()("#d066d4"),OVERLAY:jR()("#d066d4").alpha(.3)},NR={COLOR:jR()("#1398f6"),OVERLAY:jR()("#1398f6").alpha(.3)};function LR(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MR(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){LR(e,t,n[t])}))}return e}class FR extends Yp{onActivate(e){const{$timeRange:t,timeseriesPanel:n}=this.state;e&&t.setState((0,ac.omit)(this.getAncestorTimeRange().state,"key")),n.updateTitle(this.buildTimeseriesTitle());const r=this.subscribeToEvents();return()=>{r.unsubscribe()}}static buildTimeSeriesPanel({target:t,filterKey:n,title:r,color:i}){const a=new iP({item:{index:0,value:t,label:"",queryRunnerParams:{},panelType:Fk.TIMESERIES},data:new Dv({$data:RR({filterKey:n}),transformations:[Jk,Zk]}),overrides:t=>t.map((t=>{const n=t.fields[1],r=zk(t,"allValuesSum")||0,o=(0,e.getValueFormat)(n.config.unit)(r),s=`${o.text}${o.suffix}`,[l,c,u]=FR.getDiffRange(a),d=l&&c?`Total = ${s} / Flame graph range = ${(0,e.dateTimeFormat)(l,{format:e.systemDateFormats.fullDate,timeZone:u})}  ${(0,e.dateTimeFormat)(c,{format:e.systemDateFormats.fullDate,timeZone:u})}`:`Total = ${s}`;return{matcher:{id:e.FieldMatcherID.byFrameRefID,options:t.refId},properties:[{id:"displayName",value:d},{id:"color",value:{mode:"fixed",fixedColor:i}}]}})),headerActions:()=>[new PR]});return a.state.body.setState({$timeRange:new OR({key:`${t}-annotation-timerange`,mode:xR.ANNOTATIONS,annotationColor:t===Ud.BASELINE?IR.OVERLAY.toString():NR.OVERLAY.toString(),annotationTitle:`${r} flame graph range`})}),a}static getDiffRange(e){var t,n,r,i;let a,o;const s=null===(r=e.state.body.state.$data)||void 0===r||null===(n=r.state.data)||void 0===n||null===(t=n.annotations)||void 0===t?void 0:t[0];return null==s||s.fields.some((({name:e,values:t})=>(a="time"===e?t[0]:a,o="timeEnd"===e?t[0]:o,a&&o))),[a,o,null===(i=e.state.$timeRange)||void 0===i?void 0:i.state.timeZone]}getAncestorTimeRange(){if(!this.parent||!this.parent.parent)throw new Error(typeof this+" must be used within $timeRange scope");return Rf.getTimeRange(this.parent.parent)}subscribeToEvents(){const e=this.subscribeToEvent(TR,(e=>{this.state.timeseriesPanel.state.body.state.$timeRange.setState({mode:e.payload.mode===kR.FLAMEGRAPH?xR.ANNOTATIONS:xR.DEFAULT})})),t=this.state.$timeRange.subscribeToState(((e,t)=>{e.from===t.from&&e.to===t.to||this.updateTitle("")}));return{unsubscribe(){t.unsubscribe(),e.unsubscribe()}}}buildTimeseriesTitle(){const e=Lk(this,"profileMetricId"),{description:t}=ck(e);return t||VP(e)}useDiffTimeRange(){return this.state.timeseriesPanel.state.body.state.$timeRange.useState()}applyPreset({from:e,to:t,diffFrom:n,diffTo:r,label:i}){this.setDiffRange(n,r),this.state.$timeRange.setState(rR(e,t)),this.updateTitle(i)}setDiffRange(e,t){const n=this.state.timeseriesPanel.state.body.state.$timeRange;n.setAnnotationTimeRange(n.buildAnnotationTimeRange(e,t),!0)}autoSelectDiffRange(t){const{$timeRange:n,target:r}=this.state,{from:i,to:a}=n.state.value;if(t)return void this.setDiffRange(i.toISOString(),a.toISOString());const o=a.diff(i),s=Math.min(Math.round(.25*o),864e5);r===Ud.BASELINE?this.setDiffRange(i.toISOString(),(0,e.dateTime)(i).add(s).toISOString()):this.setDiffRange((0,e.dateTime)(a).subtract(s).toISOString(),a.toISOString())}updateTitle(e=""){const t=this.state.target===Ud.BASELINE?"Baseline":"Comparison",n=e?`${t} (${e})`:t;this.setState({title:n})}constructor({target:e,useAncestorTimeRange:t}){const n=e===Ud.BASELINE?"filtersBaseline":"filtersComparison",r=e===Ud.BASELINE?"Baseline":"Comparison",i=e===Ud.BASELINE?IR.COLOR.toString():NR.COLOR.toString();super({key:`${e}-panel`,target:e,filterKey:n,title:r,color:i,$timeRange:new Fh(MR({key:`${e}-panel-timerange`},rR("now-1h","now"))),timePicker:new oE({isOnCanvas:!0}),refreshPicker:new yE({isOnCanvas:!0}),timeseriesPanel:FR.buildTimeSeriesPanel({target:e,filterKey:n,title:r,color:i})}),LR(this,"_variableDependency",new If(this,{variableNames:["profileMetricId"],onReferencedVariableValueChanged:()=>{this.state.timeseriesPanel.updateTitle(this.buildTimeseriesTitle())}})),this.addActivationHandler(this.onActivate.bind(this,t))}}LR(FR,"Component",(({model:e})=>{const{target:t,color:n,title:i,timeseriesPanel:a,timePicker:o,refreshPicker:s,filterKey:l}=e.useState(),c=(0,r.useStyles2)($R,n),u=Rf.findByKey(e,l);return xi().createElement("div",{className:c.panel,"data-testid":`panel-${t}`},xi().createElement("div",{className:c.panelHeader},xi().createElement("h6",null,xi().createElement("div",{className:c.colorCircle}),i),xi().createElement("div",{className:c.timePicker},xi().createElement(o.Component,{model:o}),xi().createElement(s.Component,{model:s}))),xi().createElement("div",{className:c.filter},xi().createElement(u.Component,{model:u})),xi().createElement("div",{className:c.timeseries},a&&xi().createElement(a.Component,{model:a})))}));const $R=(e,n)=>({panel:t.css`
    background-color: ${e.colors.background.primary};
    padding: ${e.spacing(1)} ${e.spacing(1)} 0 ${e.spacing(1)};
    border: 1px solid ${e.colors.border.weak};
    border-radius: 2px;
  `,panelHeader:t.css`
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: ${e.spacing(2)};
    flex-wrap: wrap;

    & > h6 {
      font-size: 15px;
      height: 32px;
      line-height: 32px;
      margin: 0 ${e.spacing(1)} 0 0;
    }
  `,colorCircle:t.css`
    display: inline-block;
    background-color: ${n};
    border-radius: 50%;
    width: 9px;
    height: 9px;
    margin-right: 6px;
  `,timePicker:t.css`
    display: flex;
    justify-content: flex-end;
    gap: ${e.spacing(1)};
  `,filter:t.css`
    display: flex;
    margin-bottom: ${e.spacing(3)};
  `,timeseries:t.css`
    height: 200px;

    & [data-viz-panel-key] > * {
      border: 0 none;
    }

    & [data-viz-panel-key] [data-testid='uplot-main-div'] {
      cursor: crosshair;
    }
  `});function BR(){const[e,t]=(0,Ei.useState)(null),[n,r]=(0,Ei.useState)();return{onOpen(e){r((()=>e))},isOpen:t=>t===e,open(e){t(e),null==n||n()},close(){t(null)}}}var VR=class extends T{#x;#C=void 0;#K;#Y;constructor(e,t){super(),this.#x=e,this.setOptions(t),this.bindMethods(),this.#X()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#x.defaultMutationOptions(e),g(this.options,t)||this.#x.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#K,observer:this}),t?.mutationKey&&this.options.mutationKey&&h(t.mutationKey)!==h(this.options.mutationKey)?this.reset():"pending"===this.#K?.state.status&&this.#K.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#K?.removeObserver(this)}onMutationUpdate(e){this.#X(),this.#H(e)}getCurrentResult(){return this.#C}reset(){this.#K?.removeObserver(this),this.#K=void 0,this.#X(),this.#H()}mutate(e,t){return this.#Y=t,this.#K?.removeObserver(this),this.#K=this.#x.getMutationCache().build(this.#x,this.options),this.#K.addObserver(this),this.#K.execute(e)}#X(){const e=this.#K?.state??{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0};this.#C={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#H(e){O.batch((()=>{if(this.#Y&&this.hasListeners()){const t=this.#C.variables,n=this.#C.context;"success"===e?.type?(this.#Y.onSuccess?.(e.data,t,n),this.#Y.onSettled?.(e.data,null,t,n)):"error"===e?.type&&(this.#Y.onError?.(e.error,t,n),this.#Y.onSettled?.(void 0,e.error,t,n))}this.listeners.forEach((e=>{e(this.#C)}))}))}};const zR=Object.freeze({collapsedFlamegraphs:!1,maxNodes:16384,enableFlameGraphDotComExport:!0,enableFunctionDetails:!0});function UR(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function qR(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){UR(a,r,i,o,s,"next",e)}function s(e){UR(a,r,i,o,s,"throw",e)}o(void 0)}))}}class HR extends Hi{get(){var e=this,t=()=>super.fetch;return qR((function*(){return t().call(e,"/settings.v1.SettingsService/Get",{method:"POST",body:JSON.stringify({})}).then((e=>e.json())).then((e=>{if(!e.settings)return{};const t=e.settings.find((({name:e})=>e===HR.PLUGIN_SETTING_NAME));if(!t)throw new Error("Setting not found!");return JSON.parse(t.value)}))}))()}set(e){var t=this,n=()=>super.fetch;return qR((function*(){return n().call(t,"/settings.v1.SettingsService/Set",{method:"POST",body:JSON.stringify({setting:{name:HR.PLUGIN_SETTING_NAME,value:JSON.stringify(e)}})}).then((e=>e.json()))}))()}}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(HR,"PLUGIN_SETTING_NAME","pluginSettings");const GR=new HR;function WR({enabled:e}={}){const{isFetching:t,error:n,data:r}=ca({enabled:e,queryKey:["settings"],queryFn:()=>GR.get().then((e=>Object.keys(zR).reduce(((e,t)=>{var n,r,i;return null!==(i=(n=e)[r=t])&&void 0!==i||(n[r]=zR[t]),e}),e)))}),{mutateAsync:i}=function(e,t){const n=Ti(void 0),[r]=Ei.useState((()=>new VR(n,e)));Ei.useEffect((()=>{r.setOptions(e)}),[r,e]);const i=Ei.useSyncExternalStore(Ei.useCallback((e=>r.subscribe(O.batchCalls(e))),[r]),(()=>r.getCurrentResult()),(()=>r.getCurrentResult())),a=Ei.useCallback(((e,t)=>{r.mutate(e,t).catch(na)}),[r]);if(i.error&&ta(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:a,mutateAsync:i.mutate}}({mutationFn:e=>GR.set(e),networkMode:"always"});return{isFetching:t,error:GR.isAbortError(n)?null:n,settings:r,mutate:i}}function QR({severity:e,title:t,message:n,error:i,errorContext:a}){return i&&Ii.error(i,a),xi().createElement(r.Alert,{title:t,severity:e},i&&xi().createElement(xi().Fragment,null,i.message,xi().createElement("br",null)),n)}const KR={RadioButton:{container:"data-testid radio-button"},Breadcrumbs:{breadcrumb:e=>`data-testid ${e} breadcrumb`},TimePicker:{openButton:"data-testid TimePicker Open Button",overlayContent:"data-testid TimePicker Overlay Content",fromField:"data-testid Time Range from field",toField:"data-testid Time Range to field",applyTimeRange:"data-testid TimePicker submit button",copyTimeRange:"data-testid TimePicker copy button",pasteTimeRange:"data-testid TimePicker paste button",calendar:{label:"data-testid Time Range calendar",openButton:"data-testid Open time range calendar",closeButton:"data-testid Close time range Calendar"},absoluteTimeRangeTitle:"data-testid-absolute-time-range-narrow"},DataSourcePermissions:{form:()=>'form[name="addPermission"]',roleType:"Role to add new permission to",rolePicker:"Built-in role picker",permissionLevel:"Permission Level"},DateTimePicker:{input:"data-testid date-time-input"},DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value",drop:"TestData drop values"}},DataSourceHttpSettings:{urlInput:"data-testid Datasource HTTP settings url"},Jaeger:{traceIDInput:"Trace ID"},Prometheus:{configPage:{connectionSettings:"Data source connection URL",manageAlerts:"prometheus-alerts-manager",scrapeInterval:"data-testid scrape interval",queryTimeout:"data-testid query timeout",defaultEditor:"data-testid default editor",disableMetricLookup:"disable-metric-lookup",prometheusType:"data-testid prometheus type",prometheusVersion:"data-testid prometheus version",cacheLevel:"data-testid cache level",incrementalQuerying:"prometheus-incremental-querying",queryOverlapWindow:"data-testid query overlap window",disableRecordingRules:"disable-recording-rules",customQueryParameters:"data-testid custom query parameters",httpMethod:"data-testid http method",exemplarsAddButton:"data-testid Add exemplar config button",internalLinkSwitch:"data-testid Internal link switch"},queryEditor:{explain:"data-testid prometheus explain switch wrapper",editorToggle:"data-testid QueryEditorModeToggle",options:"data-testid prometheus options",legend:"data-testid prometheus legend wrapper",format:"data-testid prometheus format",step:"prometheus-step",type:"data-testid prometheus type",exemplars:"prometheus-exemplars",builder:{metricSelect:"data-testid metric select",hints:"data-testid prometheus hints",metricsExplorer:"data-testid metrics explorer",queryAdvisor:"data-testid query advisor"},code:{queryField:"data-testid prometheus query field",metricsBrowser:{openButton:"data-testid open metrics browser",selectMetric:"data-testid select a metric",metricList:"data-testid metric list",labelNamesFilter:"data-testid label names filter",labelValuesFilter:"data-testid label values filter",useQuery:"data-testid use query",useAsRateQuery:"data-testid use as rate query",validateSelector:"data-testid validate selector",clear:"data-testid clear"}}},exemplarMarker:"data-testid Exemplar marker",variableQueryEditor:{queryType:"data-testid query type",labelnames:{metricRegex:"data-testid label names metric regex"},labelValues:{labelSelect:"data-testid label values label select"},metricNames:{metricRegex:"data-testid metric names metric regex"},varQueryResult:"data-testid variable query result",seriesQuery:"data-testid prometheus series query",classicQuery:"data-testid prometheus classic query"},annotations:{minStep:"prometheus-annotation-min-step",title:"data-testid prometheus annotation title",tags:"data-testid prometheus annotation tags",text:"data-testid prometheus annotation text",seriesValueAsTimestamp:"data-testid prometheus annotation series value as timestamp"}}},Menu:{MenuComponent:e=>`${e} menu`,MenuGroup:e=>`${e} menu group`,MenuItem:e=>`${e} menu item`,SubMenu:{container:"data-testid SubMenu container",icon:"data-testid SubMenu icon"}},Panels:{Panel:{title:e=>`data-testid Panel header ${e}`,headerItems:e=>`data-testid Panel header item ${e}`,menuItems:e=>`data-testid Panel menu item ${e}`,menu:e=>`data-testid Panel menu ${e}`,containerByTitle:e=>`${e} panel`,headerCornerInfo:e=>`Panel header ${e}`,status:e=>`data-testid Panel status ${e}`,loadingBar:()=>"Panel loading bar",HoverWidget:{container:"data-testid hover-header-container",dragIcon:"data-testid drag-icon"},PanelDataErrorMessage:"data-testid Panel data error message"},Visualization:{Graph:{container:"Graph container",VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:e=>`gpl alias ${e}`,showLegendSwitch:"gpl show legend"},xAxis:{labels:()=>"div.flot-x-axis > div.flot-tick-label"}},BarGauge:{value:"Bar gauge value",valueV2:"data-testid Bar gauge value"},PieChart:{svgSlice:"data testid Pie Chart Slice"},Text:{container:()=>".markdown-html"},Table:{header:"table header",footer:"table-footer",body:"data-testid table body"}}},VizLegend:{seriesName:e=>`data-testid VizLegend series ${e}`},Drawer:{General:{title:e=>`Drawer title ${e}`,expand:"Drawer expand",contract:"Drawer contract",close:"data-testid Drawer close",rcContentWrapper:()=>".rc-drawer-content-wrapper",subtitle:"data-testid drawer subtitle"}},PanelEditor:{General:{content:"Panel editor content"},OptionsPane:{content:"Panel editor option pane content",select:"Panel editor option pane select",fieldLabel:e=>`${e} field property editor`},DataPane:{content:"Panel editor data pane content"},applyButton:"data-testid Apply changes and go back to dashboard",toggleVizPicker:"data-testid toggle-viz-picker",toggleVizOptions:"data-testid toggle-viz-options",toggleTableView:"toggle-table-view",showZoomField:"Map controls Show zoom control field property editor",showAttributionField:"Map controls Show attribution field property editor",showScaleField:"Map controls Show scale field property editor",showMeasureField:"Map controls Show measure tools field property editor",showDebugField:"Map controls Show debug field property editor",measureButton:"show measure tools"},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:()=>".json-formatter-key"}},Tab:{title:e=>`Tab ${e}`,active:()=>'[class*="-activeTabStyle"]'},RefreshPicker:{runButton:"RefreshPicker run button",intervalButton:"RefreshPicker interval button",runButtonV2:"data-testid RefreshPicker run button",intervalButtonV2:"data-testid RefreshPicker interval button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",queryHistoryButton:"data-testid query-history-button",addQuery:"data-testid query-tab-add-query"},QueryHistory:{queryText:"Query text"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:e=>`data-testid ${e}`,title:e=>`Query editor row title ${e}`,container:e=>`Query editor row ${e}`},AlertTab:{content:"data-testid Alert editor tab content"},Alert:{alert:e=>`Alert ${e}`,alertV2:e=>`data-testid Alert ${e}`},TransformTab:{content:"data-testid Transform editor tab content",newTransform:e=>`data-testid New transform ${e}`,transformationEditor:e=>`data-testid Transformation editor ${e}`,transformationEditorDebugger:e=>`data-testid Transformation editor debugger ${e}`},Transforms:{card:e=>`data-testid New transform ${e}`,disableTransformationButton:"data-testid Disable transformation button",Reduce:{modeLabel:"data-testid Transform mode label",calculationsLabel:"data-testid Transform calculations label"},SpatialOperations:{actionLabel:"root Action field property editor",locationLabel:"root Location Mode field property editor",location:{autoOption:"Auto location option",coords:{option:"Coords location option",latitudeFieldLabel:"root Latitude field field property editor",longitudeFieldLabel:"root Longitude field field property editor"},geohash:{option:"Geohash location option",geohashFieldLabel:"root Geohash field field property editor"},lookup:{option:"Lookup location option",lookupFieldLabel:"root Lookup field field property editor",gazetteerFieldLabel:"root Gazetteer field property editor"}}},searchInput:"data-testid search transformations",noTransformationsMessage:"data-testid no transformations message",addTransformationButton:"data-testid add transformation button",removeAllTransformationsButton:"data-testid remove all transformations button"},NavBar:{Configuration:{button:"Configuration"},Toggle:{button:"data-testid Toggle menu"},Reporting:{button:"Reporting"}},NavMenu:{Menu:"data-testid navigation mega-menu",item:"data-testid Nav menu item"},NavToolbar:{container:"data-testid Nav toolbar"},PageToolbar:{container:()=>".page-toolbar",item:e=>`${e}`,itemButton:e=>`data-testid ${e}`},QueryEditorToolbarItem:{button:e=>`QueryEditor toolbar item button ${e}`},BackButton:{backArrow:"data-testid Go Back"},OptionsGroup:{group:e=>e?`Options group ${e}`:"Options group",toggle:e=>e?`Options group ${e} toggle`:"Options group toggle"},PluginVisualization:{item:e=>`Plugin visualization item ${e}`,current:()=>'[class*="-currentVisualizationItem"]'},Select:{option:"Select option",input:()=>'input[id*="time-options-input"]',singleValue:()=>'div[class*="-singleValue"]'},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container",containerV2:"data-testid Folder picker select container",input:"data-testid folder-picker-input"},ReadonlyFolderPicker:{container:"data-testid Readonly folder picker select container"},DataSourcePicker:{container:"data-testid Data source picker select container",input:()=>'input[id="data-source-picker"]',inputV2:"data-testid Select a data source",dataSourceList:"data-testid Data source list dropdown",advancedModal:{dataSourceList:"data-testid Data source list",builtInDataSourceList:"data-testid Built in data source list"}},TimeZonePicker:{container:"Time zone picker select container",containerV2:"data-testid Time zone picker select container"},WeekStartPicker:{container:"Choose starting day of the week",containerV2:"data-testid Choose starting day of the week",placeholder:"Choose starting day of the week"},TraceViewer:{spanBar:"data-testid SpanBar--wrapper"},QueryField:{container:"data-testid Query field"},QueryBuilder:{queryPatterns:"data-testid Query patterns",labelSelect:"data-testid Select label",valueSelect:"data-testid Select value",matchOperatorSelect:"data-testid Select match operator"},ValuePicker:{button:e=>`data-testid Value picker button ${e}`,select:e=>`data-testid Value picker select ${e}`},Search:{section:"Search section",sectionV2:"data-testid Search section",items:"Search items",itemsV2:"data-testid Search items",cards:"data-testid Search cards",collapseFolder:e=>`data-testid Collapse folder ${e}`,expandFolder:e=>`data-testid Expand folder ${e}`,dashboardItem:e=>`${KR.Search.dashboardItems} ${e}`,dashboardCard:e=>`data-testid Search card ${e}`,folderHeader:e=>`data-testid Folder header ${e}`,folderContent:e=>`data-testid Folder content ${e}`,dashboardItems:"data-testid Dashboard search item"},DashboardLinks:{container:"data-testid Dashboard link container",dropDown:"data-testid Dashboard link dropdown",link:"data-testid Dashboard link"},LoadingIndicator:{icon:"data-testid Loading indicator"},CallToActionCard:{button:e=>`Call to action button ${e}`,buttonV2:e=>`data-testid Call to action button ${e}`},DataLinksContextMenu:{singleLink:"data-testid Data link"},CodeEditor:{container:"data-testid Code editor container"},DashboardImportPage:{textarea:"data-testid-import-dashboard-textarea",submit:"data-testid-load-dashboard"},ImportDashboardForm:{name:"data-testid-import-dashboard-title",submit:"data-testid-import-dashboard-submit"},PanelAlertTabContent:{content:"data-testid Unified alert editor tab content"},VisualizationPreview:{card:e=>`data-testid suggestion-${e}`},ColorSwatch:{name:"data-testid-colorswatch"},DashboardRow:{title:e=>`data-testid dashboard-row-title-${e}`},UserProfile:{profileSaveButton:"data-testid-user-profile-save",preferencesSaveButton:"data-testid-shared-prefs-save",orgsTable:"data-testid-user-orgs-table",sessionsTable:"data-testid-user-sessions-table",extensionPointTabs:"data-testid-extension-point-tabs",extensionPointTab:e=>`data-testid-extension-point-tab-${e}`},FileUpload:{inputField:"data-testid-file-upload-input-field",fileNameSpan:"data-testid-file-upload-file-name"},DebugOverlay:{wrapper:"debug-overlay"},OrgRolePicker:{input:"Role"},AnalyticsToolbarButton:{button:"Dashboard insights"},Variables:{variableOption:"data-testid variable-option"},Annotations:{annotationsTypeInput:"annotations-type-input",annotationsChoosePanelInput:"choose-panels-input"},Tooltip:{container:"data-testid tooltip"}},YR={pages:{Login:{url:"/login",username:"data-testid Username input field",password:"data-testid Password input field",submit:"data-testid Login button",skip:"data-testid Skip change password button"},Home:{url:"/"},DataSource:{name:"data-testid Data source settings page name input field",delete:"Data source settings page Delete button",readOnly:"data-testid Data source settings page read only message",saveAndTest:"data-testid Data source settings page Save and Test button",alert:"data-testid Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:e=>`Data source list item ${e}`},EditDataSource:{url:e=>`/datasources/edit/${e}`,settings:"Datasource settings page basic settings"},AddDataSource:{url:"/datasources/new",dataSourcePlugins:e=>`Data source plugin item ${e}`,dataSourcePluginsV2:e=>`Add new data source ${e}`},ConfirmModal:{delete:"data-testid Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",itemButton:e=>`data-testid ${e}`,addNewPanel:"Add new panel",addNewRow:"Add new row",addNewPanelLibrary:"Add new panel from panel library"},Dashboard:{url:e=>`/d/${e}`,DashNav:{nav:"Dashboard navigation",navV2:"data-testid Dashboard navigation",publicDashboardTag:"data-testid public dashboard tag",shareButton:"data-testid share-button"},SubMenu:{submenu:"Dashboard submenu",submenuItem:"data-testid template variable",submenuItemLabels:e=>`data-testid Dashboard template variables submenu Label ${e}`,submenuItemValueDropDownValueLinkTexts:e=>`data-testid Dashboard template variables Variable Value DropDown value link text ${e}`,submenuItemValueDropDownDropDown:"Variable options",submenuItemValueDropDownOptionTexts:e=>`data-testid Dashboard template variables Variable Value DropDown option text ${e}`,Annotations:{annotationsWrapper:"data-testid annotation-wrapper",annotationLabel:e=>`data-testid Dashboard annotations submenu Label ${e}`,annotationToggle:e=>`data-testid Dashboard annotations submenu Toggle ${e}`}},Settings:{Actions:{close:"data-testid dashboard-settings-close"},General:{deleteDashBoard:"Dashboard settings page delete dashboard button",sectionItems:e=>`Dashboard settings section item ${e}`,saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Tab General"},Annotations:{List:{addAnnotationCTA:KR.CallToActionCard.button("Add annotation query"),addAnnotationCTAV2:KR.CallToActionCard.buttonV2("Add annotation query"),annotations:"data-testid list-annotations"},Settings:{name:"Annotations settings name input"},NewAnnotation:{panelFilterSelect:"data-testid annotations-panel-filter",showInLabel:"show-in-label",previewInDashboard:"data-testid annotations-preview",delete:"data-testid annotations-delete",apply:"data-testid annotations-apply",enable:"data-testid annotation-enable",hide:"data-testid annotation-hide"}},Variables:{List:{addVariableCTA:KR.CallToActionCard.button("Add variable"),addVariableCTAV2:KR.CallToActionCard.buttonV2("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:e=>`Variable editor Table Name field ${e}`,tableRowDefinitionFields:e=>`Variable editor Table Definition field ${e}`,tableRowArrowUpButtons:e=>`Variable editor Table ArrowUp button ${e}`,tableRowArrowDownButtons:e=>`Variable editor Table ArrowDown button ${e}`,tableRowDuplicateButtons:e=>`Variable editor Table Duplicate button ${e}`,tableRowRemoveButtons:e=>`Variable editor Table Remove button ${e}`},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalNameInputV2:"data-testid Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalTypeSelectV2:"data-testid Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalLabelInputV2:"data-testid Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",generalHideSelectV2:"data-testid Variable editor Form Hide select",selectionOptionsMultiSwitch:"data-testid Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"data-testid Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"data-testid Variable editor Form IncludeAll field",previewOfValuesOption:"data-testid Variable editor Preview of Values option",submitButton:"data-testid Variable editor Run Query button",applyButton:"data-testid Variable editor Apply button"},QueryVariable:{queryOptionsDataSourceSelect:KR.DataSourcePicker.inputV2,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRefreshSelectV2:"data-testid Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsRegExInputV2:"data-testid Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsSortSelectV2:"data-testid Variable editor Form Query Sort select",queryOptionsQueryInput:"data-testid Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field",constantOptionsQueryInputV2:"data-testid Variable editor Form Constant Query field"},DatasourceVariable:{datasourceSelect:"data-testid datasource variable datasource type"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field",textBoxOptionsQueryInputV2:"data-testid Variable editor Form TextBox Query field"},CustomVariable:{customValueInput:"data-testid custom-variable-input"},IntervalVariable:{intervalsValueInput:"data-testid interval variable intervals input",autoEnabledCheckbox:"data-testid interval variable auto value checkbox",stepCountIntervalSelect:"data-testid interval variable step count input",minIntervalInput:"data-testid interval variable mininum interval input"},GroupByVariable:{dataSourceSelect:KR.DataSourcePicker.inputV2,infoText:"data-testid group by variable info text",modeToggle:"data-testid group by variable mode toggle"},AdHocFiltersVariable:{datasourceSelect:KR.DataSourcePicker.inputV2,infoText:"data-testid ad-hoc filters variable info text"}}}},Annotations:{marker:"data-testid annotation-marker"},Rows:{Repeated:{ConfigSection:{warningMessage:"data-testid Repeated rows warning message"}}}},Dashboards:{url:"/dashboards",dashboards:e=>`Dashboard search item ${e}`},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},ShareDashboardModal:{PublicDashboard:{Tab:"Tab Public dashboard",WillBePublicCheckbox:"data-testid public dashboard will be public checkbox",LimitedDSCheckbox:"data-testid public dashboard limited datasources checkbox",CostIncreaseCheckbox:"data-testid public dashboard cost may increase checkbox",PauseSwitch:"data-testid public dashboard pause switch",EnableAnnotationsSwitch:"data-testid public dashboard on off switch for annotations",CreateButton:"data-testid public dashboard create button",DeleteButton:"data-testid public dashboard delete button",CopyUrlInput:"data-testid public dashboard copy url input",CopyUrlButton:"data-testid public dashboard copy url button",SettingsDropdown:"data-testid public dashboard settings dropdown",TemplateVariablesWarningAlert:"data-testid public dashboard disabled template variables alert",UnsupportedDataSourcesWarningAlert:"data-testid public dashboard unsupported data sources alert",NoUpsertPermissionsWarningAlert:"data-testid public dashboard no upsert permissions alert",EnableTimeRangeSwitch:"data-testid public dashboard on off switch for time range",EmailSharingConfiguration:{Container:"data-testid email sharing config container",ShareType:"data-testid public dashboard share type",EmailSharingInput:"data-testid public dashboard email sharing input",EmailSharingInviteButton:"data-testid public dashboard email sharing invite button",EmailSharingList:"data-testid public dashboard email sharing list",DeleteEmail:"data-testid public dashboard delete email button",ReshareLink:"data-testid public dashboard reshare link button"}}},PublicDashboard:{page:"public-dashboard-page",NotAvailable:{container:"public-dashboard-not-available",title:"public-dashboard-title",pausedDescription:"public-dashboard-paused-description"}},RequestViewAccess:{form:"request-view-access-form",recipientInput:"request-view-access-recipient-input",submitButton:"request-view-access-submit-button"},PublicDashboardConfirmAccess:{submitButton:"data-testid confirm-access-submit-button"},Explore:{url:"/explore",General:{container:"data-testid Explore",graph:"Explore Graph",table:"Explore Table",scrollView:"data-testid explorer scroll view"}},SoloPanel:{url:e=>`/d-solo/${e}`},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"data-testid Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"data-testid Plugin signature info",disabledInfo:"data-testid Plugin disabled info"},PlaylistForm:{name:"Playlist name",interval:"Playlist interval",itemDelete:"data-testid playlist-form-delete-item"},BrowseDashboards:{table:{body:"data-testid browse-dashboards-table",row:e=>`data-testid browse dashboards row ${e}`,checkbox:e=>`data-testid ${e} checkbox`},NewFolderForm:{form:"data-testid new folder form",nameInput:"data-testid new-folder-name-input",createButton:"data-testid new-folder-create-button"}},Search:{url:"/?search=openn",FolderView:{url:"/?search=open&layout=folders"}},PublicDashboards:{ListItem:{linkButton:"public-dashboard-link-button",configButton:"public-dashboard-configuration-button",trashcanButton:"public-dashboard-remove-button",pauseSwitch:"data-testid public dashboard pause switch"}},UserListPage:{tabs:{allUsers:"data-testid all-users-tab",orgUsers:"data-testid org-users-tab",anonUserDevices:"data-testid anon-user-devices-tab",publicDashboardsUsers:"data-testid public-dashboards-users-tab",users:"data-testid users-tab"},org:{url:"/org/users"},admin:{url:"/admin/users"},publicDashboards:{container:"data-testid public-dashboards-users-list"},UserListAdminPage:{container:"data-testid user-list-admin-page"},UsersListPage:{container:"data-testid users-list-page"},UserAnonListPage:{container:"data-testid user-anon-list-page"},UsersListPublicDashboardsPage:{container:"data-testid users-list-public-dashboards-page",DashboardsListModal:{listItem:e=>`data-testid dashboards-list-item-${e}`}}},ProfilePage:{url:"/profile"}},components:KR};function XR({children:e,delay:t}){const[n,r]=(0,Ei.useState)(!1);return(0,Ei.useEffect)((()=>{window.setTimeout((()=>{r(!0)}),t)}),[e,t]),xi().createElement(xi().Fragment,null,n?e:null)}function JR({menu:e,title:n,placement:i="bottom",offset:a,dragClassCancel:o,menuButtonClass:s,onVisibleChange:l,onOpenMenu:c}){const u=n?YR.components.Panels.Panel.menu(n):"panel-menu-button",d=(0,Ei.useCallback)((e=>(e&&c&&c(),l)),[c,l]),p=n?`Menu for panel with title ${n}`:"Menu for panel with no title";return xi().createElement(r.Dropdown,{overlay:e,placement:i,offset:a,onVisibleChange:d},xi().createElement(r.ToolbarButton,{"aria-label":p,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":u,className:(0,t.cx)(s,o)}))}function ZR({menu:e,title:n,dragClass:i,children:a,offset:o=-32,onOpenMenu:s}){const l=(0,r.useStyles2)(eD),c=(0,Ei.useRef)(null),u=YR.components.Panels.Panel.HoverWidget,d=(0,Ei.useCallback)((e=>{var t;null===(t=c.current)||void 0===t||t.setPointerCapture(e.pointerId)}),[]),p=(0,Ei.useCallback)((e=>{var t;null===(t=c.current)||void 0===t||t.releasePointerCapture(e.pointerId)}),[]),[h,f]=(0,Ei.useState)(!1);return void 0===a||0===xi().Children.count(a)?null:xi().createElement("div",{className:(0,t.cx)(l.container,{"show-on-hover":!h}),style:{top:`${o}px`},"data-testid":u.container},i&&xi().createElement("div",{className:(0,t.cx)(l.square,l.draggable,i),onPointerDown:d,onPointerUp:p,ref:c,"data-testid":u.dragIcon},xi().createElement(r.Icon,{name:"expand-arrows",className:l.draggableIcon})),!n&&xi().createElement("h6",{className:(0,t.cx)(l.untitled,{[l.draggable]:!!i},i)},"Untitled"),a,e&&xi().createElement(JR,{menu:e,title:n,placement:"bottom",menuButtonClass:l.menuButton,onVisibleChange:f,onOpenMenu:s}))}function eD(e){return{hidden:(0,t.css)({visibility:"hidden",opacity:"0"}),container:(0,t.css)({label:"hover-container-widget",transition:"all .1s linear",display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:e.colors.background.secondary,color:e.colors.text.primary,border:`1px solid ${e.colors.border.weak}`,borderRadius:e.shape.radius.default,height:e.spacing(4),boxShadow:e.shadows.z1}),square:(0,t.css)({display:"flex",justifyContent:"center",alignItems:"center",width:e.spacing(4),height:"100%"}),draggable:(0,t.css)({cursor:"move",[e.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,t.css)({background:"inherit",border:"none","&:hover":{background:e.colors.secondary.main}}),untitled:(0,t.css)({color:e.colors.text.disabled,fontStyle:"italic",padding:e.spacing(0,1),marginBottom:0}),draggableIcon:(0,t.css)({transform:"rotate(45deg)",color:e.colors.text.secondary,"&:hover":{color:e.colors.text.primary}})}}function tD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nD(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){tD(e,t,n[t])}))}return e}const rD=(0,Ei.forwardRef)(((e,n)=>{var{className:i,children:a,href:o,onClick:s,target:l,title:c}=e,u=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,["className","children","href","onClick","target","title"]);const d=(0,r.useStyles2)(iD);return o?xi().createElement("a",nD({ref:n,href:o,onClick:s,target:l,title:c,className:(0,t.cx)(d.linkItem,i)},u),a):s?xi().createElement(r.Button,{ref:n,className:(0,t.cx)(d.item,i),variant:"secondary",fill:"text",onClick:s},a):xi().createElement("span",nD({ref:n,className:(0,t.cx)(d.item,i)},u),a)}));rD.displayName="TitleItem";const iD=e=>{const n=(0,t.css)({color:`${e.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${e.shape.radius.default}`,padding:`${e.spacing(0,1)}`,height:`${e.spacing(e.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":(r=nD({},aD(e)),i={zIndex:1},i=null!=i?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(i)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})),r),"&: focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},"&:hover ":{boxShadow:`${e.shadows.z1}`,background:`${e.colors.background.secondary}`,color:`${e.colors.text.primary}`}});var r,i;return{item:n,linkItem:(0,t.cx)(n,(0,t.css)({cursor:"pointer"}))}};function aD(e){return{outline:"2px dotted transparent",outlineOffset:"2px",boxShadow:`0 0 0 2px ${e.colors.background.canvas}, 0 0 0px 4px ${e.colors.primary.main}`,transitionTimingFunction:"cubic-bezier(0.19, 1, 0.22, 1)",transitionDuration:"0.2s",transitionProperty:"outline, outline-offset, box-shadow"}}function oD({description:e,className:n}){const i=(0,r.useStyles2)(sD);return""!==e?xi().createElement(r.Tooltip,{interactive:!0,content:()=>{const t="function"==typeof e?e():e;return xi().createElement("div",{className:"panel-info-content markdown-html"},xi().createElement("div",{dangerouslySetInnerHTML:{__html:t}}))}},xi().createElement(rD,{className:(0,t.cx)(n,i.description)},xi().createElement(r.Icon,{name:"info-circle",size:"md"}))):null}const sD=()=>({description:(0,t.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function lD({message:e,onClick:t,ariaLabel:n="status"}){const i=(0,r.useStyles2)(cD);return xi().createElement(r.ToolbarButton,{className:i.buttonStyles,onClick:t,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:e||"","aria-label":n})}const cD=e=>{const{headerHeight:n,padding:r}=e.components.panel;return{buttonStyles:(0,t.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:e.spacing(r),width:e.spacing(n),height:e.spacing(n),borderRadius:e.shape.radius.default})}};function uD({children:n,padding:i="md",title:a="",description:o="",displayMode:s="default",titleItems:l,menu:c,dragClass:u,dragClassCancel:d,hoverHeader:p=!1,hoverHeaderOffset:h,loadingState:f,statusMessage:m,statusMessageOnClick:g,actions:y,onCancelQuery:b,onOpenMenu:v}){const w=(0,r.useTheme2)(),S=(0,r.useStyles2)(fD),[E,x]=(0,Ei.useState)(0),_=(0,Ei.useRef)(null);(0,Ei.useEffect)((()=>{_.current&&x(_.current.offsetWidth)}),[_]);const O=!p,T=pD(w,O),{contentStyle:C}=hD(i,w),k={height:T,cursor:u?"move":"auto"},P={};"transparent"===s&&(P.backgroundColor="transparent",P.border="none");const A=a?YR.components.Panels.Panel.title(a):"Panel",R=xi().createElement(xi().Fragment,null,a&&xi().createElement("h6",{title:a,className:S.title},a),xi().createElement("div",{className:(0,t.cx)(S.titleItems,d),"data-testid":"title-items-container"},xi().createElement(oD,{description:o,className:d}),l),f===e.LoadingState.Streaming&&xi().createElement(r.Tooltip,{content:b?"Stop streaming":"Streaming"},xi().createElement(rD,{className:d,"data-testid":"panel-streaming",onClick:b},xi().createElement(r.Icon,{name:"circle-mono",size:"md",className:S.streaming}))),f===e.LoadingState.Loading&&b&&xi().createElement(XR,{delay:2e3},xi().createElement(r.Tooltip,{content:"Cancel query"},xi().createElement(rD,{className:(0,t.cx)(d,S.pointer),"data-testid":"panel-cancel-query",onClick:b},xi().createElement(r.Icon,{name:"sync-slash",size:"md"})))),xi().createElement("div",{className:S.rightAligned},y&&xi().createElement("div",{className:S.rightActions},dD(y,(e=>e)))));return xi().createElement("div",{className:S.container,style:P,"data-testid":A},xi().createElement("div",{className:S.loadingBarContainer},f===e.LoadingState.Loading?xi().createElement(r.LoadingBar,{width:E,ariaLabel:"Panel loading bar"}):null),p&&xi().createElement(xi().Fragment,null,xi().createElement(ZR,{menu:c,title:a,offset:h,dragClass:u,onOpenMenu:v},R),m&&xi().createElement("div",{className:S.errorContainerFloating},xi().createElement(lD,{message:m,onClick:g,ariaLabel:"Panel status"}))),O&&xi().createElement("div",{className:(0,t.cx)(S.headerContainer,u),style:k,"data-testid":"header-container"},m&&xi().createElement("div",{className:d},xi().createElement(lD,{message:m,onClick:g,ariaLabel:"Panel status"})),R,c&&xi().createElement(JR,{menu:c,title:a,placement:"bottom-end",menuButtonClass:(0,t.cx)(S.menuItem,d,"show-on-hover"),onOpenMenu:v})),xi().createElement("div",{className:S.content,style:C,ref:_},n))}const dD=(e,t)=>{const n=xi().Children.toArray(e).filter(Boolean);return n.length>0?t(n):null},pD=(e,t)=>t?e.spacing.gridSize*e.components.panel.headerHeight:0,hD=(e,t)=>({contentStyle:{padding:("md"===e?t.components.panel.padding:0)*t.spacing.gridSize}}),fD=e=>{const{background:n,borderColor:r,padding:i}=e.components.panel;return{container:(0,t.css)({label:"panel-container",backgroundColor:n,border:`1px solid ${r}`,position:"relative",borderRadius:e.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".show-on-hover":{visibility:"hidden",opacity:"0"},"&:focus-visible, &:hover":{".show-on-hover":{visibility:"visible",opacity:"1"}},"&:focus-visible":{outline:`1px solid ${e.colors.action.focus}`},"&:focus-within":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),loadingBarContainer:(0,t.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",overflow:"hidden"}),content:(0,t.css)({label:"panel-content",flexGrow:1}),headerContainer:(0,t.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,t.css)({cursor:"pointer"}),streaming:(0,t.css)({label:"panel-streaming",marginRight:0,color:e.colors.success.text,"&:hover":{color:e.colors.success.text}}),title:(0,t.css)({label:"panel-title",marginBottom:0,padding:e.spacing(0,i),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:e.typography.h6.fontSize,fontWeight:e.typography.h6.fontWeight}),items:(0,t.css)({display:"flex"}),item:(0,t.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,t.css)({visibility:"hidden"}),menuItem:(0,t.css)({label:"panel-menu",border:"none",background:e.colors.secondary.main,"&:hover":{background:e.colors.secondary.shade}}),errorContainerFloating:(0,t.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:e.zIndex.tooltip}),rightActions:(0,t.css)({display:"flex",padding:e.spacing(0,i),gap:e.spacing(1)}),rightAligned:(0,t.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,t.css)({display:"flex",height:"100%"})}},mD=e=>({panelWrap:t.css`
    margin-bottom: ${e.spacing(1)};
  `});function gD({isLoading:t,title:n,description:i,children:a,className:o="",headerActions:s,dataTestId:l}){const c=(0,r.useStyles2)(mD),u=t?e.LoadingState.Loading:e.LoadingState.Done;return xi().createElement("div",{className:`${o} ${c.panelWrap}`,"data-testid":l||"panel"},xi().createElement(uD,{loadingState:u,title:n,description:i,actions:s},a))}function yD(e){return"function"==typeof e}function bD(e){return function(t){if(function(e){return yD(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}var vD=function(e){var t,n=(t=function(e){Error.call(e),e.stack=(new Error).stack},function(e){t(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}();function wD(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var SD=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=(0,Zy.__values)(a),s=o.next();!s.done;s=o.next())s.value.remove(this)}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var l=this.initialTeardown;if(yD(l))try{l()}catch(e){i=e instanceof vD?e.errors:[e]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var u=(0,Zy.__values)(c),d=u.next();!d.done;d=u.next()){var p=d.value;try{ED(p)}catch(e){i=null!=i?i:[],e instanceof vD?i=(0,Zy.__spreadArray)((0,Zy.__spreadArray)([],(0,Zy.__read)(i)),(0,Zy.__read)(e.errors)):i.push(e)}}}catch(e){n={error:e}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}if(i)throw new vD(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)ED(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&wD(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&wD(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function ED(e){yD(e)?e():e.unsubscribe()}SD.EMPTY;var xD=null,_D=null,OD=!1,TD=!1,CD={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=CD.delegate;return(null==i?void 0:i.setTimeout)?i.setTimeout.apply(i,(0,Zy.__spreadArray)([e,t],(0,Zy.__read)(n))):setTimeout.apply(void 0,(0,Zy.__spreadArray)([e,t],(0,Zy.__read)(n)))},clearTimeout:function(e){var t=CD.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function kD(){}var PD=AD("C",void 0,void 0);function AD(e,t,n){return{kind:e,value:t,error:n}}var RD=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,function(e){return e instanceof SD||e&&"closed"in e&&yD(e.remove)&&yD(e.add)&&yD(e.unsubscribe)}(t)&&t.add(n)):n.destination=FD,n}return(0,Zy.__extends)(t,e),t.create=function(e,t,n){return new ND(e,t,n)},t.prototype.next=function(e){this.isStopped?MD(function(e){return AD("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?MD(AD("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?MD(PD,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(SD),DD=Function.prototype.bind;function jD(e,t){return DD.call(e,t)}var ID=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){LD(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){LD(e)}else LD(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){LD(e)}},e}(),ND=function(e){function t(t,n,r){var i,a,o=e.call(this)||this;return yD(t)||!t?i={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:o&&TD?((a=Object.create(t)).unsubscribe=function(){return o.unsubscribe()},i={next:t.next&&jD(t.next,a),error:t.error&&jD(t.error,a),complete:t.complete&&jD(t.complete,a)}):i=t,o.destination=new ID(i),o}return(0,Zy.__extends)(t,e),t}(RD);function LD(e){OD||function(e){CD.setTimeout((function(){if(!xD)throw e;xD(e)}))}(e)}function MD(e,t){var n=_D;n&&CD.setTimeout((function(){return n(e,t)}))}var FD={closed:!0,next:kD,error:function(e){throw e},complete:kD};function $D(e,t,n,r,i){return new BD(e,t,n,r,i)}var BD=function(e){function t(t,n,r,i,a,o){var s=e.call(this,t)||this;return s.onFinalize=a,s.shouldUnsubscribe=o,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return(0,Zy.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(RD);function VD(e,t){return bD((function(n,r){var i=0;n.subscribe($D(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}function zD(e,t){return bD((function(n,r){var i=0;n.subscribe($D(r,(function(n){r.next(e.call(t,n,i++))})))}))}function UD(e){return e}const qD={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var HD,GD=new Uint8Array(16);function WD(){if(!HD&&!(HD="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return HD(GD)}for(var QD=[],KD=0;KD<256;++KD)QD.push((KD+256).toString(16).slice(1));const YD=function(e,t,n){if(qD.randomUUID&&!t&&!e)return qD.randomUUID();var r=(e=e||{}).random||(e.rng||WD)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e,t=0){return(QD[e[t+0]]+QD[e[t+1]]+QD[e[t+2]]+QD[e[t+3]]+"-"+QD[e[t+4]]+QD[e[t+5]]+"-"+QD[e[t+6]]+QD[e[t+7]]+"-"+QD[e[t+8]]+QD[e[t+9]]+"-"+QD[e[t+10]]+QD[e[t+11]]+QD[e[t+12]]+QD[e[t+13]]+QD[e[t+14]]+QD[e[t+15]]).toLowerCase()}(r)};var XD=__webpack_require__(8449);const JD="grafana-llm-app",ZD=`/api/plugins/${JD}`;let ej=new XD.SemVer("0.2.0");const tj="openai/v1/chat/completions";function nj(e){return"error"in e}function rj(){return(0,xp.pipe)((0,xp.pipe)(VD((e=>"content"in e.choices[0].delta)),zD((e=>e.choices[0].delta.content))),function(e,t){return bD(function(e,t,n,r,i){return function(r,i){var a=n,o=t,s=0;r.subscribe($D(i,(function(t){var n=s++;o=a?e(o,t,n):(a=!0,t),i.next(o)}),void 0))}}(e,t,arguments.length>=2))}(((e,t)=>e+t),""))}function ij(t){const r={scope:e.LiveChannelScope.Plugin,namespace:JD,path:tj+"/"+YD(),data:t};return(0,n.getGrafanaLiveSrv)().getStream(r).pipe(VD((t=>(0,e.isLiveChannelMessageEvent)(t)))).pipe((s=yD(i=e=>{if(nj(e.message))throw new Error(e.message.error)})?{next:i,error:a,complete:o}:i)?bD((function(e,t){var n;null===(n=s.subscribe)||void 0===n||n.call(s);var r=!0;e.subscribe($D(t,(function(e){var n;null===(n=s.next)||void 0===n||n.call(s,e),t.next(e)}),(function(){var e;r=!1,null===(e=s.complete)||void 0===e||e.call(s),t.complete()}),(function(e){var n;r=!1,null===(n=s.error)||void 0===n||n.call(s,e),t.error(e)}),(function(){var e,t;r&&(null===(e=s.unsubscribe)||void 0===e||e.call(s)),null===(t=s.finalize)||void 0===t||t.call(s)})))})):UD,(l=e=>{return nj(e.message)||!("done"in(t=e.message.choices[0].delta)&&null!=t.done);var t},void 0===c&&(c=!1),bD((function(e,t){e.subscribe($D(t,(function(e){var n=l(e,0);(n||c)&&t.next(e),!n&&t.complete()})))}))),zD((e=>e.message)));var i,a,o,s,l,c}let aj=!1;const oj=async()=>{const e=await(async()=>{try{if(!(await(0,n.getBackendSrv)().get(`${ZD}/settings`,void 0,void 0,{showSuccessAlert:!1,showErrorAlert:!1})).enabled)return{configured:!1,ok:!1,error:"The Grafana LLM plugin is not enabled."}}catch(e){return(0,n.logDebug)(String(e)),(0,n.logDebug)("Failed to check if OpenAI is enabled. This is expected if the Grafana LLM plugin is not installed, and the above error can be ignored."),aj=!0,{configured:!1,ok:!1,error:"The Grafana LLM plugin is not installed."}}let e;try{e=await(0,n.getBackendSrv)().get(`${ZD}/health`,void 0,void 0,{showSuccessAlert:!1,showErrorAlert:!1})}catch(e){return aj||((0,n.logDebug)(String(e)),(0,n.logDebug)("Failed to check if OpenAI is enabled. This is expected if the Grafana LLM plugin is not installed, and the above error can be ignored."),aj=!0),{configured:!1,ok:!1,error:"The Grafana LLM plugin is not installed."}}const{details:t}=e;return void 0!==t?.version&&function(e){try{ej=new XD.SemVer(e)}catch(e){(0,n.logWarning)("Failed to parse version of grafana-llm-app; assuming old version is present.")}}(t.version),void 0===t?.openAI?{configured:!1,ok:!1,error:"The Grafana LLM plugin is outdated; please update it."}:"boolean"==typeof t.openAI?{configured:t.openAI,ok:t.openAI}:t.openAI})();return e.configured&&e.ok};function sj({children:e,onClick:t,disabled:n,interactionName:i}){const a=(0,r.useStyles2)(lj),{isEnabled:o,error:s,isFetching:l}=function(){const{data:e,isFetching:t,error:n}=ca({queryKey:["llm"],queryFn:()=>oj()});return n&&Ii.error(n,{info:"Error while checking the status of the Grafana LLM plugin!"}),{isEnabled:Boolean(e),isFetching:t,error:n}}();let c="ai",u="";return l?(c="fa fa-spinner",u="Checking the status of the Grafana LLM plugin..."):s?(c="exclamation-triangle",u="Error while checking the status of the Grafana LLM plugin!"):o||(c="shield-exclamation",u="Grafana LLM plugin missing or not configured! Please check the plugins administration page."),xi().createElement(r.Button,{className:a.aiButton,size:"md",fill:"text",icon:c,disabled:!o||n,tooltip:u,tooltipPlacement:"top",onClick:e=>{ru(i),t(e)}},e)}const lj=()=>({aiButton:t.css`
    padding: 0 4px;
  `});function cj(){return cj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cj.apply(this,arguments)}const uj=["children","options"];var dj,pj;!function(e){e.blockQuote="0",e.breakLine="1",e.breakThematic="2",e.codeBlock="3",e.codeFenced="4",e.codeInline="5",e.footnote="6",e.footnoteReference="7",e.gfmTask="8",e.heading="9",e.headingSetext="10",e.htmlBlock="11",e.htmlComment="12",e.htmlSelfClosing="13",e.image="14",e.link="15",e.linkAngleBraceStyleDetector="16",e.linkBareUrlDetector="17",e.linkMailtoDetector="18",e.newlineCoalescer="19",e.orderedList="20",e.paragraph="21",e.ref="22",e.refImage="23",e.refLink="24",e.table="25",e.tableSeparator="26",e.text="27",e.textBolded="28",e.textEmphasized="29",e.textEscaped="30",e.textMarked="31",e.textStrikethroughed="32",e.unorderedList="33"}(dj||(dj={})),function(e){e[e.MAX=0]="MAX",e[e.HIGH=1]="HIGH",e[e.MED=2]="MED",e[e.LOW=3]="LOW",e[e.MIN=4]="MIN"}(pj||(pj={}));const hj=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","className","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce(((e,t)=>(e[t.toLowerCase()]=t,e)),{for:"htmlFor"}),fj={amp:"&",apos:"'",gt:">",lt:"<",nbsp:"",quot:""},mj=["style","script"],gj=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,yj=/mailto:/i,bj=/\n{2,}$/,vj=/^(\s*>[\s\S]*?)(?=\n{2,})/,wj=/^ *> ?/gm,Sj=/^ {2,}\n/,Ej=/^(?:( *[-*_])){3,} *(?:\n *)+\n/,xj=/^\s*(`{3,}|~{3,}) *(\S+)?([^\n]*?)?\n([\s\S]+?)\s*\1 *(?:\n *)*\n?/,_j=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,Oj=/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,Tj=/^(?:\n *)*\n/,Cj=/\r\n?/g,kj=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,Pj=/^\[\^([^\]]+)]/,Aj=/\f/g,Rj=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,Dj=/^\s*?\[(x|\s)\]/,jj=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Ij=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Nj=/^([^\n]+)\n *(=|-){3,} *(?:\n *)+\n/,Lj=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,Mj=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,Fj=/^<!--[\s\S]*?(?:-->)/,$j=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,Bj=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,Vj=/^\{.*\}$/,zj=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,Uj=/^<([^ >]+@[^ >]+)>/,qj=/^<([^ >]+:\/[^ >]+)>/,Hj=/-([a-z])?/gi,Gj=/^(.*\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,Wj=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,Qj=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,Kj=/^\[([^\]]*)\] ?\[([^\]]*)\]/,Yj=/(\[|\])/g,Xj=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,Jj=/\t/g,Zj=/(^ *\||\| *$)/g,eI=/^ *:-+: *$/,tI=/^ *:-+ *$/,nI=/^ *-+: *$/,rI="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|~~.*?~~|==.*?==|.|\\n)*?)",iI=new RegExp(`^([*_])\\1${rI}\\1\\1(?!\\1)`),aI=new RegExp(`^([*_])${rI}\\1(?!\\1|\\w)`),oI=new RegExp(`^==${rI}==`),sI=new RegExp(`^~~${rI}~~`),lI=/^\\([^0-9A-Za-z\s])/,cI=/^[\s\S]+?(?=[^0-9A-Z\s\u00c0-\uffff&#;.()'"]|\d+\.|\n\n| {2,}\n|\w+:\S|$)/i,uI=/^\n+/,dI=/^([ \t]*)/,pI=/\\([^\\])/g,hI=/ *\n+$/,fI=/(?:^|\n)( *)$/,mI="(?:\\d+\\.)",gI="(?:[*+-])";function yI(e){return"( *)("+(1===e?mI:gI)+") +"}const bI=yI(1),vI=yI(2);function wI(e){return new RegExp("^"+(1===e?bI:vI))}const SI=wI(1),EI=wI(2);function xI(e){return new RegExp("^"+(1===e?bI:vI)+"[^\\n]*(?:\\n(?!\\1"+(1===e?mI:gI)+" )[^\\n]*)*(\\n|$)","gm")}const _I=xI(1),OI=xI(2);function TI(e){const t=1===e?mI:gI;return new RegExp("^( *)("+t+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+t+" (?!"+t+" ))\\n*|\\s*\\n*$)")}const CI=TI(1),kI=TI(2);function PI(e,t){const n=1===t,r=n?CI:kI,i=n?_I:OI,a=n?SI:EI;return{match(e,t,n){const i=fI.exec(n);return i&&(t.list||!t.inline&&!t.simple)?r.exec(e=i[1]+e):null},order:1,parse(e,t,r){const o=n?+e[2]:void 0,s=e[0].replace(bj,"\n").match(i);let l=!1;return{items:s.map((function(e,n){const i=a.exec(e)[0].length,o=new RegExp("^ {1,"+i+"}","gm"),c=e.replace(o,"").replace(a,""),u=n===s.length-1,d=-1!==c.indexOf("\n\n")||u&&l;l=d;const p=r.inline,h=r.list;let f;r.list=!0,d?(r.inline=!1,f=c.replace(hI,"\n\n")):(r.inline=!0,f=c.replace(hI,""));const m=t(f,r);return r.inline=p,r.list=h,m})),ordered:n,start:o}},render:(t,n,r)=>e(t.ordered?"ol":"ul",{key:r.key,start:"20"===t.type?t.start:void 0},t.items.map((function(t,i){return e("li",{key:i},n(t,r))})))}}const AI=new RegExp("^\\[((?:\\[[^\\]]*\\]|[^\\[\\]]|\\](?=[^\\[]*\\]))*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*\\)"),RI=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/,DI=[vj,xj,_j,jj,Nj,Ij,Fj,Gj,_I,CI,OI,kI],jI=[...DI,/^[^\n]+(?:  \n|\n{2,})/,Lj,Bj];function II(e){return e.replace(/[]/g,"a").replace(/[]/g,"c").replace(/[]/g,"d").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"u").replace(/[]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function NI(e){return nI.test(e)?"right":eI.test(e)?"center":tI.test(e)?"left":null}function LI(e,t,n,r){const i=n.inTable;n.inTable=!0;let a=e.trim().split(/( *(?:`[^`]*`|<.*?>.*?<\/.*?>(?!<\/.*?>)|\\\||\|) *)/).reduce(((e,i)=>("|"===i.trim()?e.push(r?{type:"26"}:{type:"27",text:i}):""!==i&&e.push.apply(e,t(i,n)),e)),[]);n.inTable=i;let o=[[]];return a.forEach((function(e,t){"26"===e.type?0!==t&&t!==a.length-1&&o.push([]):("27"!==e.type||null!=a[t+1]&&"26"!==a[t+1].type||(e.text=e.text.trimEnd()),o[o.length-1].push(e))})),o}function MI(e,t,n){n.inline=!0;const r=e[2]?e[2].replace(Zj,"").split("|").map(NI):[],i=e[3]?function(e,t,n){return e.trim().split("\n").map((function(e){return LI(e,t,n,!0)}))}(e[3],t,n):[],a=LI(e[1],t,n,!!i.length);return n.inline=!1,i.length?{align:r,cells:i,header:a,type:"25"}:{children:a,type:"21"}}function FI(e,t){return null==e.align[t]?{}:{textAlign:e.align[t]}}function $I(e){return function(t,n){return n.inline?e.exec(t):null}}function BI(e){return function(t,n){return n.inline||n.simple?e.exec(t):null}}function VI(e){return function(t,n){return n.inline||n.simple?null:e.exec(t)}}function zI(e){return function(t){return e.exec(t)}}function UI(e,t,n){if(t.inline||t.simple)return null;if(n&&!n.endsWith("\n"))return null;let r="";e.split("\n").every((e=>!DI.some((t=>t.test(e)))&&(r+=e+"\n",e.trim())));const i=r.trimEnd();return""==i?null:[r,i]}function qI(e){try{if(decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"").match(/^\s*(javascript|vbscript|data(?!:image)):/i))return}catch(e){return null}return e}function HI(e){return e.replace(pI,"$1")}function GI(e,t,n){const r=n.inline||!1,i=n.simple||!1;n.inline=!0,n.simple=!0;const a=e(t,n);return n.inline=r,n.simple=i,a}function WI(e,t,n){const r=n.inline||!1,i=n.simple||!1;n.inline=!1,n.simple=!0;const a=e(t,n);return n.inline=r,n.simple=i,a}function QI(e,t,n){const r=n.inline||!1;n.inline=!1;const i=e(t,n);return n.inline=r,i}const KI=(e,t,n)=>({children:GI(t,e[1],n)});function YI(){return{}}function XI(){return null}function JI(...e){return e.filter(Boolean).join(" ")}function ZI(e,t,n){let r=e;const i=t.split(".");for(;i.length&&(r=r[i[0]],void 0!==r);)i.shift();return r||n}const eN=e=>{let{children:t="",options:n}=e,r=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(n=a[r])>=0||(i[n]=e[n]);return i}(e,uj);return Ei.cloneElement(function(e="",t={}){t.overrides=t.overrides||{},t.slugify=t.slugify||II,t.namedCodesToUnicode=t.namedCodesToUnicode?cj({},fj,t.namedCodesToUnicode):fj;const n=t.createElement||Ei.createElement;function r(e,r,...i){const a=ZI(t.overrides,`${e}.props`,{});return n(function(e,t){const n=ZI(t,e);return n?"function"==typeof n||"object"==typeof n&&"render"in n?n:ZI(t,`${e}.component`,e):e}(e,t.overrides),cj({},r,a,{className:JI(null==r?void 0:r.className,a.className)||void 0}),...i)}function i(e){e=e.replace(Rj,"");let n=!1;t.forceInline?n=!0:t.forceBlock||(n=!1===Xj.test(e));const i=u(c(n?e:`${e.trimEnd().replace(uI,"")}\n\n`,{inline:n}));for(;"string"==typeof i[i.length-1]&&!i[i.length-1].trim();)i.pop();if(null===t.wrapper)return i;const a=t.wrapper||(n?"span":"div");let o;if(i.length>1||t.forceWrapper)o=i;else{if(1===i.length)return o=i[0],"string"==typeof o?r("span",{key:"outer"},o):o;o=null}return Ei.createElement(a,{key:"outer"},o)}function a(e){const t=e.match(gj);return t?t.reduce((function(e,t,n){const r=t.indexOf("=");if(-1!==r){const a=function(e){return-1!==e.indexOf("-")&&null===e.match($j)&&(e=e.replace(Hj,(function(e,t){return t.toUpperCase()}))),e}(t.slice(0,r)).trim(),o=function(e){const t=e[0];return('"'===t||"'"===t)&&e.length>=2&&e[e.length-1]===t?e.slice(1,-1):e}(t.slice(r+1).trim()),s=hj[a]||a,l=e[s]=function(e,t){return"style"===e?t.split(/;\s?/).reduce((function(e,t){const n=t.slice(0,t.indexOf(":"));return e[n.trim().replace(/(-[a-z])/g,(e=>e[1].toUpperCase()))]=t.slice(n.length+1).trim(),e}),{}):"href"===e||"src"===e?qI(t):(t.match(Vj)&&(t=t.slice(1,t.length-1)),"true"===t||"false"!==t&&t)}(a,o);"string"==typeof l&&(Lj.test(l)||Bj.test(l))&&(e[s]=Ei.cloneElement(i(l.trim()),{key:n}))}else"style"!==t&&(e[hj[t]||t]=!0);return e}),{}):null}const o=[],s={},l={0:{match:VI(vj),order:1,parse:(e,t,n)=>({children:t(e[0].replace(wj,""),n)}),render:(e,t,n)=>r("blockquote",{key:n.key},t(e.children,n))},1:{match:zI(Sj),order:1,parse:YI,render:(e,t,n)=>r("br",{key:n.key})},2:{match:VI(Ej),order:1,parse:YI,render:(e,t,n)=>r("hr",{key:n.key})},3:{match:VI(_j),order:0,parse:e=>({lang:void 0,text:e[0].replace(/^ {4}/gm,"").replace(/\n+$/,"")}),render:(e,t,n)=>r("pre",{key:n.key},r("code",cj({},e.attrs,{className:e.lang?`lang-${e.lang}`:""}),e.text))},4:{match:VI(xj),order:0,parse:e=>({attrs:a(e[3]||""),lang:e[2]||void 0,text:e[4],type:"3"})},5:{match:BI(Oj),order:3,parse:e=>({text:e[2]}),render:(e,t,n)=>r("code",{key:n.key},e.text)},6:{match:VI(kj),order:0,parse:e=>(o.push({footnote:e[2],identifier:e[1]}),{}),render:XI},7:{match:$I(Pj),order:1,parse:e=>({target:`#${t.slugify(e[1])}`,text:e[1]}),render:(e,t,n)=>r("a",{key:n.key,href:qI(e.target)},r("sup",{key:n.key},e.text))},8:{match:$I(Dj),order:1,parse:e=>({completed:"x"===e[1].toLowerCase()}),render:(e,t,n)=>r("input",{checked:e.completed,key:n.key,readOnly:!0,type:"checkbox"})},9:{match:VI(t.enforceAtxHeadings?Ij:jj),order:1,parse:(e,n,r)=>({children:GI(n,e[2],r),id:t.slugify(e[2]),level:e[1].length}),render:(e,t,n)=>r(`h${e.level}`,{id:e.id,key:n.key},t(e.children,n))},10:{match:VI(Nj),order:0,parse:(e,t,n)=>({children:GI(t,e[1],n),level:"="===e[2]?1:2,type:"9"})},11:{match:zI(Lj),order:1,parse(e,t,n){const[,r]=e[3].match(dI),i=new RegExp(`^${r}`,"gm"),o=e[3].replace(i,""),s=(l=o,jI.some((e=>e.test(l)))?QI:GI);var l;const c=e[1].toLowerCase(),u=-1!==mj.indexOf(c),d={attrs:a(e[2]),noInnerParse:u,tag:(u?c:e[1]).trim()};return n.inAnchor=n.inAnchor||"a"===c,u?d.text=e[3]:d.children=s(t,o,n),n.inAnchor=!1,d},render:(e,t,n)=>r(e.tag,cj({key:n.key},e.attrs),e.text||t(e.children,n))},13:{match:zI(Bj),order:1,parse:e=>({attrs:a(e[2]||""),tag:e[1].trim()}),render:(e,t,n)=>r(e.tag,cj({},e.attrs,{key:n.key}))},12:{match:zI(Fj),order:1,parse:()=>({}),render:XI},14:{match:BI(RI),order:1,parse:e=>({alt:e[1],target:HI(e[2]),title:e[3]}),render:(e,t,n)=>r("img",{key:n.key,alt:e.alt||void 0,title:e.title||void 0,src:qI(e.target)})},15:{match:$I(AI),order:3,parse:(e,t,n)=>({children:WI(t,e[1],n),target:HI(e[2]),title:e[3]}),render:(e,t,n)=>r("a",{key:n.key,href:qI(e.target),title:e.title},t(e.children,n))},16:{match:$I(qj),order:0,parse:e=>({children:[{text:e[1],type:"27"}],target:e[1],type:"15"})},17:{match:(e,t)=>t.inAnchor?null:$I(zj)(e,t),order:0,parse:e=>({children:[{text:e[1],type:"27"}],target:e[1],title:void 0,type:"15"})},18:{match:$I(Uj),order:0,parse(e){let t=e[1],n=e[1];return yj.test(n)||(n="mailto:"+n),{children:[{text:t.replace("mailto:",""),type:"27"}],target:n,type:"15"}}},20:PI(r,1),33:PI(r,2),19:{match:VI(Tj),order:3,parse:YI,render:()=>"\n"},21:{match:UI,order:3,parse:KI,render:(e,t,n)=>r("p",{key:n.key},t(e.children,n))},22:{match:$I(Wj),order:0,parse:e=>(s[e[1]]={target:e[2],title:e[4]},{}),render:XI},23:{match:BI(Qj),order:0,parse:e=>({alt:e[1]||void 0,ref:e[2]}),render:(e,t,n)=>s[e.ref]?r("img",{key:n.key,alt:e.alt,src:qI(s[e.ref].target),title:s[e.ref].title}):null},24:{match:$I(Kj),order:0,parse:(e,t,n)=>({children:t(e[1],n),fallbackChildren:t(e[0].replace(Yj,"\\$1"),n),ref:e[2]}),render:(e,t,n)=>s[e.ref]?r("a",{key:n.key,href:qI(s[e.ref].target),title:s[e.ref].title},t(e.children,n)):r("span",{key:n.key},t(e.fallbackChildren,n))},25:{match:VI(Gj),order:1,parse:MI,render(e,t,n){const i=e;return r("table",{key:n.key},r("thead",null,r("tr",null,i.header.map((function(e,a){return r("th",{key:a,style:FI(i,a)},t(e,n))})))),r("tbody",null,i.cells.map((function(e,a){return r("tr",{key:a},e.map((function(e,a){return r("td",{key:a,style:FI(i,a)},t(e,n))})))}))))}},27:{match:zI(cI),order:4,parse:e=>({text:e[0].replace(Mj,((e,n)=>t.namedCodesToUnicode[n]?t.namedCodesToUnicode[n]:e))}),render:e=>e.text},28:{match:BI(iI),order:2,parse:(e,t,n)=>({children:t(e[2],n)}),render:(e,t,n)=>r("strong",{key:n.key},t(e.children,n))},29:{match:BI(aI),order:3,parse:(e,t,n)=>({children:t(e[2],n)}),render:(e,t,n)=>r("em",{key:n.key},t(e.children,n))},30:{match:BI(lI),order:1,parse:e=>({text:e[1],type:"27"})},31:{match:BI(oI),order:3,parse:KI,render:(e,t,n)=>r("mark",{key:n.key},t(e.children,n))},32:{match:BI(sI),order:3,parse:KI,render:(e,t,n)=>r("del",{key:n.key},t(e.children,n))}};!0===t.disableParsingRawHTML&&(delete l[11],delete l[13]);const c=function(e){let t=Object.keys(e);function n(r,i){let a=[],o="";for(;r;){let s=0;for(;s<t.length;){const l=t[s],c=e[l],u=c.match(r,i,o);if(u){const e=u[0];r=r.substring(e.length);const t=c.parse(u,n,i);null==t.type&&(t.type=l),a.push(t),o=e;break}s++}}return a}return t.sort((function(t,n){let r=e[t].order,i=e[n].order;return r!==i?r-i:t<n?-1:1})),function(e,t){return n(function(e){return e.replace(Cj,"\n").replace(Aj,"").replace(Jj,"    ")}(e),t)}}(l),u=(d=function(e,t){return function(n,r,i){const a=e[n.type].render;return t?t((()=>a(n,r,i)),n,r,i):a(n,r,i)}}(l,t.renderRule),function e(t,n={}){if(Array.isArray(t)){const r=n.key,i=[];let a=!1;for(let r=0;r<t.length;r++){n.key=r;const o=e(t[r],n),s="string"==typeof o;s&&a?i[i.length-1]+=o:null!==o&&i.push(o),a=s}return n.key=r,i}return d(t,e,n)});var d;const p=i(e);return o.length?r("div",null,p,r("footer",{key:"footer"},o.map((function(e){return r("div",{id:t.slugify(e.identifier),key:e.identifier},e.identifier,u(c(e.footnote,{inline:!0})))})))):p}(t,n),r)},tN=e=>{const t=document.querySelector('[placeholder^="Search"]');null!==t?(((e,t)=>{const n=Object.getOwnPropertyDescriptor(e,"value").set,r=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"value").set;n&&n!==r?r.call(e,t):n.call(e,t)})(t,e.target.textContent.trim()),t.dispatchEvent(new Event("input",{bubbles:!0}))):Ii.error(new Error("Cannot find search input element!"))},nN={overrides:{code:{component:({children:e})=>{const t=(0,r.useStyles2)(iN);return"string"==typeof e&&e.includes("\n")?xi().createElement("code",null,e):xi().createElement("code",{className:t.searchLink,title:"Search for this node",onClick:tN},e)}}}};function rN({reply:e}){var t;const n=(0,r.useStyles2)(iN);return xi().createElement("div",{className:n.container},null==e||null===(t=e.messages)||void 0===t?void 0:t.filter((e=>"system"!==e.role)).map((e=>xi().createElement(xi().Fragment,null,xi().createElement("div",{className:n.reply},xi().createElement(eN,{options:nN},e.content)),xi().createElement("hr",null)))),xi().createElement("div",{className:n.reply},xi().createElement(eN,{options:nN},e.text)))}const iN=()=>({container:t.css`
    width: 100%;
    height: 100%;
  `,reply:t.css`
    font-size: 13px;

    & ol,
    & ul {
      margin: 0 0 16px 24px;
    }
  `,searchLink:t.css`
    color: rgb(255, 136, 51);
    border: 1px solid transparent;
    padding: 2px 4px;
    cursor: pointer;
    font-size: 13px;

    &:hover,
    &:focus,
    &:active {
      box-sizing: border-box;
      border: 1px solid rgb(255, 136, 51, 0.8);
      border-radius: 4px;
    }
  `}),aN=()=>({textarea:t.css`
    margin-bottom: 8px;
  `,sendButton:t.css`
    float: right;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  `});function oN({onSubmit:e}){const t=(0,r.useStyles2)(aN),{question:n,onChangeInput:i,onClickSend:a}=function(e){const[t,n]=(0,Ei.useState)(""),r=(0,Ei.useCallback)((e=>{n(e.target.value)}),[]),i=(0,Ei.useCallback)((()=>{const r=t.trim();r&&(e(r),n(""))}),[t,e]);return{question:t,onChangeInput:r,onClickSend:i}}(e);return xi().createElement("div",null,xi().createElement(r.TextArea,{className:t.textarea,placeholder:"Ask a follow-up question...",value:n,onChange:i,onKeyDown:e=>{"Enter"!==e.code||e.shiftKey||a()}}),xi().createElement(r.Button,{className:t.sendButton,onClick:a},"Send"))}var sN;!function(e){e.system="system",e.user="user"}(sN||(sN={}));const lN={system:{empty:()=>"\n    You are a performance profiling expert and excel at analyzing profiles in the DOT format.\n    In the DOT format, a row like N47 -> N61 means the function from N47 called the function from N61.\n"},user:{single:(e,t)=>`\n    Analyze this flamegraph in DOT format and address these key aspects:\n    - **Performance Bottleneck**: Identify the primary factors slowing down the process, consuming excessive memory, or causing a bottleneck in the system.\n    - **Root Cause**: Explain clearly why these bottlenecks are occurring.\n    - **Recommended Fix**: Suggest practical solutions for these issues.\n\n    Guidelines:\n    - Always use full function names without splitting them from package names.\n    - Exclude numeric values, percentages, and node names (e.g., N1, N3, Node 1, Node 2).\n    - Focus on user code over low-level runtime optimizations.\n    - For standard library or runtime functions, explain their presence/function and link them to user code functions calling them. Avoid repetitive mentions from the same call chain.\n    - Do not mention that the flamegraph profile is in DOT format.\n    - Only use h5 and h6 markdown headers (e.g., ##### Performance Bottleneck, ###### Recommended Fix)\n    - Do not use h1,h2,h3,h4 headers (e.g., ## Bottleneck, ### Root Cause, #### Recommended Fix)\n\n    Format the response using markdown headers for each section corresponding to the key aspects.\n\n    The profile type is: ${e}\n    Profile in DOT format:\n    ${t[0]}\n`,anton:(e,t)=>`\nGive me actionable feedback and suggestions on how I improve the application performance.\n\nDo not break function names.\nDo not show any numeric values, absolute or percents.\nDo not show node names like N1, N3, or Node 1, Node 2.\nDo not suggest low-level runtime optimisations, focus on the user code.\n\nAlways use full function names.\nNever split function and package name.\n\nRemove any numeric values, absolute or percents, from the output.\nRemove node names like N1, N3, or Node 1, Node 2 from the output.\n\nIf the function is widely known (e.g., a runtime or stdlib function), provide me concise explanation why the function is present in the profile and what could be the cause.\nIf a function is defined in the runtime or in the standard library, tell me which function in the user code calls it.\nAvoid mentioning functions from the same call-chain.\n\n5 suggestions is enough.\nThe profile type is ${e}\nBelow is the performance profile in DOT format:\n${t[0]}\n`,diff:(e,t)=>`\nAnalyze the differences between these two performance profiles presented in DOT format. Provide a detailed comparison focusing on the following aspects:\n\n- Performance Change: Determine how the performance has changed from the first profile to the second. Identify if there are new bottlenecks, improved or worsened performance areas, or significant changes in resource consumption.\n- Function Impact: Highlight no more than 3 specific functions that have undergone notable changes in their performance impact. Discuss any new functions that have appeared in the second profile or any existing functions that have significantly increased or decreased in resource usage.\n- Potential Causes: Discuss the possible reasons for these changes in performance, linking them to the differences in function execution or resource usage between the two profiles.\n\nGuidelines for Analysis:\n- Use full function names without separating them from their package names\n- Focus on user code rather than low-level runtime optimizations or standard library functions unless they are directly relevant to the user code's performance changes\n- Exclude numeric values, percentages, and node names (e.g., N1, N3, Node 1, Node 2) from the analysis\n- Format the response using markdown headers for each section to structure the analysis clearly\n\nThe profile type is: ${e}\n\nFirst performance profile in DOT format:\n${t[0]}\n\nSecond performance profile in DOT format:\n${t[1]}\n`}},cN=({system:e,user:t,profileType:n,profiles:r})=>{const i=lN.system[e];if("function"!=typeof i)throw new Error(`Cannot find system prompt "${e}"!`);const a=lN.user[t];if("function"!=typeof a)throw new Error(`Cannot find user prompt "${t}"!`);return{system:i(n,r),user:a(n,r)}};function uN(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}class dN extends mT{get(e){var t,n=this;return(t=function*(){const t=new URLSearchParams({query:e.query,from:String(1e3*e.timeRange.from.unix()),until:String(1e3*e.timeRange.to.unix()),format:e.format});e.maxNodes&&t.set("max-nodes",String(e.maxNodes));const r=yield n.fetch(`/pyroscope/render?${t.toString()}`);switch(e.format){case"dot":return r.text();case"json":return r.json();default:throw new TypeError(`Unknown format "${e.format}"!`)}},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){uN(a,r,i,o,s,"next",e)}function s(e){uN(a,r,i,o,s,"throw",e)}o(void 0)}))})()}constructor(e){super(e)}}function pN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class hN extends Yp{validateFetchParams(e,t){let n,r=t;return e&&2!==t.length?(n=new Error(`Invalid number of fetch parameters for analyzing the diff flame graph (${t.length})!`),r=[]):e||1===t.length||(n=new Error(`Invalid number of fetch parameters for analyzing the flame graph (${t.length})!`),r=[]),{params:r,error:n}}constructor(){super({key:"ai-panel"}),pN(this,"useSceneAiPanel",((e,t)=>{const n=Rf.findByKeyAndType(this,"dataSource",xk).useState().value,{params:r,error:i}=this.validateFetchParams(e,t),{error:a,isFetching:o,profiles:s}=function(e,t){const n=sR.build(e,dN),{isFetching:r,error:i,data:a}=ca({queryKey:["dot-profiles",e,...t.flatMap((({query:e,timeRange:t})=>[e,t.from.unix(),t.to.unix()])),100],queryFn:()=>Promise.all(t.map((({query:e,timeRange:t})=>n.get({query:e,timeRange:t,format:"dot",maxNodes:100}).then((e=>e.replace(/fontsize=\d+ /g,"").replace(/id="node\d+" /g,"").replace(/labeltooltip=".*\)" /g,"").replace(/tooltip=".*\)" /g,"").replace(/(N\d+ -> N\d+).*/g,"$1").replace(/N\d+ \[label="other.*\n/,"").replace(/shape=box /g,"").replace(/fillcolor="#\w{6}"/g,"").replace(/color="#\w{6}" /g,""))))))});return{isFetching:r,error:i,profiles:a||[]}}(n,r),l=ck(Lk(this,"profileMetricId")).type,{reply:c,error:u,retry:d}=function(e,t){const[n,r]=(0,Ei.useState)(""),[i,a]=(0,Ei.useState)(!1),[o,s]=(0,Ei.useState)(!1),[l,c]=(0,Ei.useState)([]),[u,d]=(0,Ei.useState)(null),[p,h]=(0,Ei.useState)(),f=(0,Ei.useCallback)((e=>{c(e),d(null),r(""),a(!0),s(!1);const t=ij({model:"gpt-4-1106-preview",messages:e}).pipe(rj()).subscribe({next:r,error(e){d(e),a(!1),s(!0),h(void 0)},complete(){a(!1),s(!0),h(void 0)}});h(t)}),[]),m=(0,Ei.useCallback)((e=>{const t=[{role:"assistant",content:n},{role:"user",content:e}];try{f([...l,...t])}catch(e){d(e)}}),[l,n,f]);return(0,Ei.useEffect)((()=>{if(!t.length||l.length>0)return;const n=cN({system:"empty",user:2===t.length?"diff":"single",profileType:e,profiles:t});try{f([{role:"system",content:n.system},{role:"system",content:n.user}])}catch(e){d(e)}}),[l.length,e,t,t.length,f]),(0,Ei.useEffect)((()=>()=>{p&&(p.unsubscribe(),h(void 0))}),[p]),{reply:{text:n,hasStarted:i,hasFinished:o,messages:l,askFollowupQuestion:m},retry(){if(l.length>0)try{f(l)}catch(e){d(e)}},error:u}}(l,s);return{data:{validationError:i,isLoading:o||!o&&!a&&!u&&!c.text.trim(),fetchError:a,llmError:u,reply:c,shouldDisplayReply:Boolean((null==c?void 0:c.hasStarted)||(null==c?void 0:c.hasFinished)),shouldDisplayFollowUpForm:!a&&!u&&Boolean(null==c?void 0:c.hasFinished)},actions:{retry:d,submitFollowupQuestion(e){c.askFollowupQuestion(e)}}}}))}}pN(hN,"Component",(({model:e,isDiff:t,fetchParams:n,onClose:i})=>{const a=(0,r.useStyles2)(fN),{data:o,actions:s}=e.useSceneAiPanel(t,n);return xi().createElement(gD,{className:a.sidePanel,title:"Flame graph analysis",isLoading:o.isLoading,headerActions:xi().createElement(r.IconButton,{title:"Close panel",name:"times-circle",variant:"secondary","aria-label":"close",onClick:i}),dataTestId:"ai-panel"},xi().createElement("div",{className:a.content},o.validationError&&xi().createElement(QR,{severity:"error",title:"Validation error!",error:o.validationError}),o.fetchError&&xi().createElement(QR,{severity:"error",title:"Error while loading profile data!",message:"Sorry for any inconvenience, please try again later.",error:o.fetchError}),o.shouldDisplayReply&&xi().createElement(rN,{reply:o.reply}),o.isLoading&&xi().createElement(xi().Fragment,null,xi().createElement(r.Spinner,{inline:!0}),"Analyzing..."),o.llmError&&xi().createElement(r.Alert,{title:"An error occured while generating content using OpenAI!",severity:"warning"},xi().createElement("div",null,xi().createElement("div",null,xi().createElement("p",null,o.llmError.message),xi().createElement("p",null,"Sorry for any inconvenience, please retry or if the problem persists, contact your organization admin."))),xi().createElement(r.Button,{className:a.retryButton,variant:"secondary",fill:"outline",onClick:()=>s.retry()},"Retry")),o.shouldDisplayFollowUpForm&&xi().createElement(oN,{onSubmit:s.submitFollowupQuestion})))}));const fN=e=>({sidePanel:t.css`
    flex: 1 0 50%;
    margin-left: 8px;
    max-width: calc(50% - 4px);
  `,title:t.css`
    margin: -4px 0 4px 0;
  `,content:t.css`
    padding: ${e.spacing(1)};
  `,retryButton:t.css`
    float: right;
  `});class mN extends e.BusEventWithPayload{}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(mN,"type","diff-auto-select");class gN extends e.BusEventWithPayload{}function yN(){const{searchParams:e,pushNewUrl:t}=function(){const e=(0,Ho.useHistory)(),t=(0,Ho.useLocation)();return{searchParams:new URLSearchParams(t.search),pushNewUrl:t=>{const n=new URLSearchParams(window.location.search);for(const[e,r]of Object.entries(t))n.set(e,r);e.replace({search:n.toString()})}}}();var n;const r=Number(null!==(n=e.get("maxNodes"))&&void 0!==n?n:""),i=e=>{t({maxNodes:String(e)})};return function(e,t){const{isFetching:n,error:r,settings:i}=WR({enabled:!e});e||n||(r?(Yo(["Error while retrieving the plugin settings!","Some features might not work as expected (e.g. flame graph max nodes). Please try to reload the page, sorry for the inconvenience."]),Ii.error(r),t(zR.maxNodes)):t(i.maxNodes))}(r>0,i),[r,i]}function bN(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}!function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(gN,"type","diff-choose-preset");class vN extends mT{get(e){var t,n=this;return(t=function*(){const t=new URLSearchParams({leftQuery:e.leftQuery,leftFrom:String(1e3*e.leftTimeRange.from.unix()),leftUntil:String(1e3*e.leftTimeRange.to.unix()),rightQuery:e.rightQuery,rightFrom:String(1e3*e.rightTimeRange.from.unix()),rightUntil:String(1e3*e.rightTimeRange.to.unix())});e.maxNodes&&t.set("max-nodes",String(e.maxNodes));const r=yield n.fetch(`/pyroscope/render-diff?${t.toString()}`);return yield r.json()},function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){bN(a,r,i,o,s,"next",e)}function s(e){bN(a,r,i,o,s,"throw",e)}o(void 0)}))})()}constructor(e){super(e)}}function wN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SN({enabled:e,dataSourceUid:t,baselineTimeRange:n,baselineQuery:r,comparisonTimeRange:i,comparisonQuery:a}){const[o]=yN(),s=sR.build(t,vN),{isFetching:l,error:c,data:u,refetch:d}=ca({placeholderData:e=>e,enabled:Boolean(e&&o),queryKey:["diff-profile",t,r,n.from.unix(),n.to.unix(),a,i.from.unix(),i.to.unix(),o],queryFn:()=>{s.abort();const e={leftQuery:r,leftTimeRange:n,rightQuery:a,rightTimeRange:i,maxNodes:o};return s.get(e).then((e=>({profile:{version:e.version,flamebearer:e.flamebearer,metadata:e.metadata}})))}});return p=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){wN(e,t,n[t])}))}return e}({isFetching:l,error:s.isAbortError(c)?null:c},u),h=null!=(h={refetch:d})?h:{},Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(h)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(h)).forEach((function(e){Object.defineProperty(p,e,Object.getOwnPropertyDescriptor(h,e))})),p;var p,h}function EN({onClickAutoSelect:e,onClickChoosePreset:t,onOpenLearnHow:n}){const i=(0,r.useStyles2)(xN),[a,o]=(0,Ei.useState)(!1);return xi().createElement(QR,{severity:"info",title:"Select both the baseline and the comparison flame graph ranges to view the diff flame graph",message:xi().createElement("div",{className:i.infoMsg},xi().createElement("p",null,"How?"),xi().createElement("p",null,xi().createElement(r.Button,{variant:"primary",onClick:e},"Auto-select")," ","or"," ",xi().createElement(r.Button,{variant:"primary",fill:"text",className:i.textButton,onClick:t},"choose a preset")),xi().createElement("p",null,"Alternatively:"),xi().createElement(r.Collapse,{label:"Click here to learn how to select the flame graph ranges with the mouse",collapsible:!0,className:i.collapse,isOpen:a,onToggle:()=>{a||n(),o(!a)}},xi().createElement("div",{className:i.collapseContent},xi().createElement("ol",null,xi().createElement("li",null,"Ensure that the Flame graph range selection mode is selected"),xi().createElement("li",null,"Use your mouse to select the desired time ranges on both the baseline and the comparison time series")),xi().createElement("img",{src:"public/plugins/grafana-pyroscope-app/img/8cdf4d2e2df8326311ab.gif",alt:"How to view the diff flame graph"}))))})}const xN=e=>({infoMsg:t.css`
    padding: ${e.spacing(2)} 0 0 0;
  `,textButton:t.css`
    padding: 0;
  `,collapse:t.css`
    background: transparent;
    border: 0;
  `,collapseContent:t.css`
    padding: 0 ${e.spacing(5)};

    & img {
      max-width: 100%;
      width: auto;
      margin-top: ${e.spacing(2)};
    }
  `});function _N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ON extends Yp{buildTitle(){const e=Lk(this,"serviceName"),t=ck(Lk(this,"profileMetricId")).type;return xi().createElement(xi().Fragment,null,xi().createElement(_o,{size:"small"}),"Diff flame graph for ",e," (",t,")")}constructor(){super({key:"diff-flame-graph",aiPanel:new hN}),_N(this,"useSceneDiffFlameGraph",(()=>{const{aiPanel:e}=this.useState(),{baselineTimeRange:t,comparisonTimeRange:n}=this.parent.useDiffTimeRanges(),r=Ek(this,"filtersBaseline"),i=Ek(this,"filtersComparison"),{settings:a,error:o}=WR(),s=Rf.findByKeyAndType(this,"dataSource",xk).useState().value,l=Boolean(r&&i&&t.from.unix()&&t.to.unix()&&n.from.unix()&&n.to.unix()),{isFetching:c,error:u,profile:d}=SN({enabled:l,dataSourceUid:s,baselineTimeRange:t,baselineQuery:r,comparisonTimeRange:n,comparisonQuery:i}),p=l&&!c&&!u&&0===(null==d?void 0:d.flamebearer.numTicks),h=Boolean(l&&!u&&!p&&d),f=!l;return{data:{title:this.buildTitle(),isLoading:c,fetchProfileError:u,noProfileDataAvailable:p,shouldDisplayFlamegraph:h,hasMissingSelections:f,profile:d,settings:a,fetchSettingsError:o,ai:{panel:e,fetchParams:[{query:r,timeRange:t},{query:i,timeRange:n}]}},actions:{}}})),_N(this,"onClickAutoSelect",(()=>{ru("g_pyroscope_app_diff_auto_select_clicked"),this.publishEvent(new mN({wholeRange:!1}),!0)})),_N(this,"onClickChoosePreset",(()=>{ru("g_pyroscope_app_diff_choose_preset_clicked"),this.publishEvent(new gN({}),!0)})),_N(this,"onOpenLearnHow",(()=>{ru("g_pyroscope_app_diff_learn_how_clicked")}))}}_N(ON,"Component",(({model:e})=>{var t,n;const i=(0,r.useStyles2)(TN),{data:a}=e.useSceneDiffFlameGraph(),o=BR(),s=a.isLoading||a.hasMissingSelections||a.noProfileDataAvailable;(0,Ei.useEffect)((()=>{s&&o.close()}),[s,o]),a.fetchSettingsError&&Yo(["Error while retrieving the plugin settings!","Some features might not work as expected (e.g. flamegraph export options). Please try to reload the page, sorry for the inconvenience."]);const l=(0,Ei.useMemo)((()=>xi().createElement(xi().Fragment,null,a.title,a.isLoading&&xi().createElement(r.Spinner,{inline:!0,className:i.spinner}))),[a.isLoading,a.title,i.spinner]);return xi().createElement("div",{className:i.flex},xi().createElement(gD,{dataTestId:"diff-flame-graph-panel",className:i.flamegraphPanel,title:l,isLoading:a.isLoading,headerActions:xi().createElement(sj,{disabled:s||o.isOpen("ai"),onClick:()=>o.open("ai"),interactionName:"g_pyroscope_app_explain_flamegraph_clicked"},"Explain Flame Graph")},a.hasMissingSelections&&xi().createElement(EN,{onClickAutoSelect:e.onClickAutoSelect,onClickChoosePreset:e.onClickChoosePreset,onOpenLearnHow:e.onOpenLearnHow}),a.fetchProfileError&&xi().createElement(QR,{severity:"error",title:"Error while loading profile data!",error:a.fetchProfileError}),a.noProfileDataAvailable&&xi().createElement(QR,{severity:"warning",title:"No profile data available",message:"Please verify that you've selected adequate filters and time ranges."}),a.shouldDisplayFlamegraph&&xi().createElement(tp,{diff:!0,profile:a.profile,enableFlameGraphDotComExport:null===(t=a.settings)||void 0===t?void 0:t.enableFlameGraphDotComExport,collapsedFlamegraphs:null===(n=a.settings)||void 0===n?void 0:n.collapsedFlamegraphs})),o.isOpen("ai")&&xi().createElement(a.ai.panel.Component,{model:a.ai.panel,isDiff:!0,fetchParams:a.ai.fetchParams,onClose:o.close}))}));const TN=e=>({flex:t.css`
    display: flex;
  `,flamegraphPanel:t.css`
    min-width: 0;
    flex-grow: 1;
  `,sidePanel:t.css`
    flex: 1 0 50%;
    margin-left: 8px;
    max-width: calc(50% - 4px);
  `,spinner:t.css`
    margin-left: ${e.spacing(1)};
  `,aiButton:t.css`
    margin-top: ${e.spacing(1)};
  `}),CN="https://grafana.qualtrics.com/jfe/form/SV_6Gav4IUU6jcYfd4",kN=()=>{const e=(0,r.useStyles2)(PN);return xi().createElement("div",{className:e.wrapper},xi().createElement("a",{href:CN,className:e.feedback,title:"Share your thoughts about Profiles in Grafana.",target:"_blank",rel:"noreferrer noopener"},xi().createElement(r.Icon,{name:"comment-alt-message"})," Give feedback"),xi().createElement("a",{href:CN,className:e.feedback,title:"Share your thoughts about Profiles in Grafana.",target:"_blank",rel:"noreferrer noopener"},xi().createElement(r.Badge,{text:"Preview",color:"blue",icon:"rocket"})))},PN=e=>({wrapper:(0,t.css)({display:"flex",gap:e.spacing(1),justifyContent:"flex-end",paddingTop:"4px"}),feedback:(0,t.css)({alignSelf:"center",color:e.colors.text.secondary,fontSize:e.typography.bodySmall.fontSize,"&:hover":{color:e.colors.text.link}})});function AN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class RN extends Yp{onActivate(){[Ud.BASELINE,Ud.COMPARISON].forEach((e=>{this._subs.add(Rf.findByKeyAndType(this,`${e}-panel`,FR).state.$timeRange.subscribeToState(((e,t)=>{e.from===t.from&&e.to===t.to||this.setState({value:null})})))}))}openSelect(){this.setState({isSelectOpen:!0})}closeSelect(){this.setState({isSelectOpen:!1})}reset(){this.setState({value:null,isSelectOpen:!1,isModalOpen:!1})}static Component({model:e}){const t=(0,r.useStyles2)(DN),{value:n,isSelectOpen:i,isModalOpen:a}=e.useState();return xi().createElement(xi().Fragment,null,xi().createElement("div",{className:t.presetsContainer},xi().createElement(r.Select,{className:t.select,placeholder:"Choose a preset",value:n,options:RN.PRESETS,onChange:e.onChangePreset,isOpen:i,onOpenMenu:e.onOpenSelect,onCloseMenu:e.onCloseSelect}),xi().createElement(r.Button,{icon:"save",variant:"secondary",tooltip:"Save the current time ranges and filters as a custom preset",onClick:e.onClickSave})),xi().createElement(r.Modal,{title:"Custom user presets",isOpen:a,closeOnEscape:!0,closeOnBackdropClick:!0,onDismiss:e.closeModal},xi().createElement("p",null,"This feature, which would allow you to save the current time ranges and filters, is currently not implemented."),xi().createElement("p",null,"Please let us know if you would be interested to use it by"," ",xi().createElement("a",{href:CN,target:"_blank",rel:"noreferrer noopener",className:t.link},"leaving us your feedback.")),xi().createElement("p",null,"Thank you!"),xi().createElement(r.Modal.ButtonRow,null,xi().createElement(r.Button,{variant:"secondary",fill:"outline",onClick:e.closeModal},"Cancel"),xi().createElement(r.Button,{onClick:e.closeModal,disabled:!0},"Save"))))}constructor(){super({name:"compare-presets",label:"Comparison presets",value:null,isModalOpen:!1,isSelectOpen:!1}),AN(this,"_variableDependency",new If(this,{variableNames:["dataSource","serviceName"],onReferencedVariableValueChanged:()=>{this.reset()}})),AN(this,"onChangePreset",(e=>{var t;ru("g_pyroscope_app_diff_preset_selected",{value:e.value}),this.closeSelect(),"dummy"!==e.value?(null===(t=e.value)||void 0===t?void 0:t.startsWith("auto-select-"))?this.publishEvent(new mN({wholeRange:"auto-select-whole"===e.value}),!0):([Ud.BASELINE,Ud.COMPARISON].forEach((t=>{Rf.findByKeyAndType(this,`${t}-panel`,FR).applyPreset(e[t])})),this.setState({value:e.value})):this.setState({value:null,isModalOpen:!0})})),AN(this,"onClickSave",(()=>{ru("g_pyroscope_app_diff_preset_save_clicked"),this.setState({isModalOpen:!0})})),AN(this,"closeModal",(()=>{this.setState({isModalOpen:!1})})),AN(this,"onOpenSelect",(()=>{setTimeout((()=>this.openSelect()),0)})),AN(this,"onCloseSelect",(()=>{this.closeSelect()})),this.addActivationHandler(this.onActivate.bind(this))}}AN(RN,"PRESETS",[{label:"Built-in presets",value:"built-in",options:[{value:"last hour (30m-window)",label:"Last hour (30m-window)",baseline:{from:"now-1h",to:"now",diffFrom:"now-1h",diffTo:"now-30m",label:"last hour"},comparison:{from:"now-1h",to:"now",diffFrom:"now-30m",diffTo:"now",label:"last hour"}},{value:"last hour (1h-window)",label:"Last hour (1h-window)",baseline:{from:"now-1h",to:"now",diffFrom:"now-1h",diffTo:"now",label:"last hour"},comparison:{from:"now-1h",to:"now",diffFrom:"now-1h",diffTo:"now",label:"last hour"}},{value:"6h ago vs now",label:"6h ago vs now (30m-window)",baseline:{from:"now-375m",to:"now-315m",diffFrom:"now-375m",diffTo:"now-345m",label:"6h ago"},comparison:{from:"now-1h",to:"now",diffFrom:"now-30m",diffTo:"now",label:"last hour"}},{value:"24h ago vs now",label:"24h ago vs now (30m-window)",baseline:{from:"now-1455m",to:"now-1395m",diffFrom:"now-1455m",diffTo:"now-1425m",label:"24h ago"},comparison:{from:"now-1h",to:"now",diffFrom:"now-30m",diffTo:"now",label:"last hour"}},{value:"auto-select-25",label:"Auto-select (25% range)"},{value:"auto-select-whole",label:"Auto-select (whole range)"}]},{label:"My presets",value:"custom",options:[{label:"Dummy preset saved earlier",value:"dummy"}]}]);const DN=e=>({presetsContainer:t.css`
    display: flex;
  `,select:t.css`
    min-width: ${e.spacing(24)};
    text-align: left;
  `,link:t.css`
    color: ${e.colors.text.link};
  `});class jN extends Yp{onActivate(){n.locationService.partial({},!0);const e=Rf.findByKeyAndType(this,"profileMetricId",gk);return e.setState({query:gk.QUERY_SERVICE_NAME_DEPENDENT}),e.update(!0),this.subscribeToEvents(),()=>{e.setState({query:gk.QUERY_DEFAULT}),e.update(!0)}}subscribeToEvents(){this._subs.add(this.subscribeToEvent(mN,(e=>{this.autoSelectDiffRanges(e.payload.wholeRange)}))),this._subs.add(this.subscribeToEvent(gN,(()=>{this.state.presetsPicker.openSelect()})))}autoSelectDiffRanges(e){const{baselinePanel:t,comparisonPanel:n}=this.state;t.autoSelectDiffRange(e),n.autoSelectDiffRange(e)}getVariablesAndGridControls(){return{variables:[Rf.findByKeyAndType(this,"serviceName",wk),Rf.findByKeyAndType(this,"profileMetricId",gk),this.state.presetsPicker],gridControls:[]}}static Component({model:e}){const t=(0,r.useStyles2)(IN),{baselinePanel:n,comparisonPanel:i,body:a}=e.useState();return xi().createElement("div",{className:t.container},xi().createElement("div",{className:t.columns},xi().createElement(n.Component,{model:n}),xi().createElement(i.Component,{model:i})),xi().createElement(a.Component,{model:a}))}constructor({useAncestorTimeRange:t}){super({key:"explore-diff-flame-graph",baselinePanel:new FR({target:Ud.BASELINE,useAncestorTimeRange:t}),comparisonPanel:new FR({target:Ud.COMPARISON,useAncestorTimeRange:t}),$behaviors:[new Hg({key:"metricCrosshairSync",sync:e.DashboardCursorSync.Crosshair}),e=>{const t=new Map,n=e.subscribeToEvent(d_,(n=>{var r;const i=null===(r=n.payload.series)||void 0===r?void 0:r[0];(null==i?void 0:i.refId)?(t.set(i.refId,Math.max(...i.fields[1].values)),function(e,t){const n=Rf.findAllObjects(e,(e=>e instanceof My&&"timeseries"===e.state.pluginId));for(const e of n)e.clearFieldConfigCache(),e.setState({fieldConfig:(0,ac.merge)((0,ac.cloneDeep)(e.state.fieldConfig),{defaults:{max:t}})})}(e,Math.max(...t.values()))):Ii.warn("Missing refId! Cannot sync y-axis on the timeseries.",n.payload.series)}));return()=>{n.unsubscribe()}}],body:new ON,presetsPicker:new RN}),function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}(this,"useDiffTimeRanges",(()=>{const{baselinePanel:e,comparisonPanel:t}=this.state,{annotationTimeRange:n}=e.useDiffTimeRange(),{annotationTimeRange:r}=t.useDiffTimeRange();return{baselineTimeRange:n,comparisonTimeRange:r}})),this.addActivationHandler(this.onActivate.bind(this))}}const IN=e=>({container:t.css`
    width: 100%;
    display: flex;
    flex-direction: column;
  `,columns:t.css`
    display: flex;
    flex-direction: row;
    gap: ${e.spacing(1)};
    margin-bottom: ${e.spacing(1)};

    & > div {
      flex: 1 1 0;
    }
  `});function NN(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function LN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){NN(a,r,i,o,s,"next",e)}function s(e){NN(a,r,i,o,s,"throw",e)}o(void 0)}))}}class MN extends mT{githubLogin(e){var t=this;return LN((function*(){const n=yield t.fetch("/vcs.v1.VCSService/GithubLogin",{method:"POST",body:JSON.stringify({authorizationCode:e})});return yield n.json()}))()}githubApp(){var e=this;return LN((function*(){const t=yield e.fetch("/vcs.v1.VCSService/GithubApp",{method:"POST",body:JSON.stringify({})});return(yield t.json()).clientID}))()}}function FN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class $N{isUserTokenExpired(e=0){return Date.now()>=this.expiry.getTime()-e}static decode(e){if(void 0===e||""===e)return;let t;try{t=atob(e)}catch(e){return void Ii.error(e,{info:"Failed to base64 decode GitSession value"})}const{payload:n,isLegacy:r}=$N.tryDecode(t);return r?new $N(e,864e13):new $N(n.metadata,Number(n.expiry))}static tryDecode(e){try{return{payload:JSON.parse(e),isLegacy:!1}}catch(e){return{payload:void 0,isLegacy:!0}}}constructor(e,t){FN(this,"oauthTokenMetadata",void 0),FN(this,"expiry",void 0),this.oauthTokenMetadata=e,this.expiry=new Date(t)}}function BN(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const VN="pyroscope_git_session";class zN{getCookie(){return this.syncCookieWithBrowser(),this.sessionCookie}setCookie(e){e.startsWith(`${VN}=`)||(e=`${VN}=${e}`);const t=zN.getCookieFromJar(e,VN);void 0!==t&&(this.deleteLegacyCookie(),this.rawCookie=t,this.sessionCookie=$N.decode(t.value),document.cookie=`${e}; path=/`)}deleteCookie(){document.cookie=`${VN}=; Path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;`,this.deleteLegacyCookie(),this.rawCookie=void 0,this.sessionCookie=void 0}deleteLegacyCookie(){document.cookie="GitSession=; Path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC;"}syncCookieWithBrowser(){var e,t;const n=zN.getCookieFromJar(document.cookie,VN);(null==n?void 0:n.key)===(null===(e=this.rawCookie)||void 0===e?void 0:e.key)&&(null==n?void 0:n.value)===(null===(t=this.rawCookie)||void 0===t?void 0:t.value)||(void 0!==n?this.setCookie(`${n.key}=${n.value}`):this.deleteCookie())}static getCookieFromJar(e,t){return e.split(";").map((e=>{const[t,...n]=e.trim().split("="),r=n.join("=");return{key:t.trim(),value:null==r?void 0:r.trim()}})).find((({key:e})=>e===t))}constructor(){BN(this,"rawCookie",void 0),BN(this,"sessionCookie",void 0)}}const UN=new zN,qN=800,HN=950;function GN(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function WN(){var e;return e=function*(e,t,n,r,i){if(r&&r.close(),null==n?void 0:n.isUserTokenExpired())try{return void(yield t.refresh())}catch(e){Ii.error(e,{info:"Failed to refresh GitHub user token"}),UN.deleteCookie()}try{i(function(e,t){const n=function(e,t){const n=new URL("/login/oauth/authorize","https://github.com");return n.searchParams.set("client_id",e),n.searchParams.set("scope","repo"),n.searchParams.set("state",btoa(JSON.stringify({redirect_uri:window.location.origin,nonce:t}))),n.toString()}(e,t),{top:r}=window;var i,a;const o=(null!==(i=null==r?void 0:r.outerWidth)&&void 0!==i?i:0)/2+(null!==(a=null==r?void 0:r.screenX)&&void 0!==a?a:0)-qN/2;var s,l;const c=(null!==(s=null==r?void 0:r.outerHeight)&&void 0!==s?s:0)/2+(null!==(l=null==r?void 0:r.screenY)&&void 0!==l?l:0)-HN/2;return window.open(n,"GitHub Login",`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${qN}, height=${HN}, top=${c}, left=${o}`)}(yield e.githubApp(),lL))}catch(e){Ko(e,["Failed to start login flow.",e.message])}},WN=function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){GN(a,r,i,o,s,"next",e)}function s(e){GN(a,r,i,o,s,"throw",e)}o(void 0)}))},WN.apply(this,arguments)}function QN(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function KN(){var e;return e=function*(e,t,n){const r=t.get("code");if(!r)return"";const i=t.get("state");if(!i)throw new Error("Invalid state parameter!");let a;try{a=JSON.parse(atob(i))}catch(e){throw new Error("Invalid state parameter!")}if(a.nonce!==n)throw new Error("Invalid nonce parameter!");return(yield e.githubLogin(r)).cookie},KN=function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){QN(a,r,i,o,s,"next",e)}function s(e){QN(a,r,i,o,s,"throw",e)}o(void 0)}))},KN.apply(this,arguments)}function YN(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function XN(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function JN(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){XN(a,r,i,o,s,"next",e)}function s(e){XN(a,r,i,o,s,"throw",e)}o(void 0)}))}}const ZN={isLoginInProgress:!1,isLoggedIn:!1,isSessionExpired:!1,login:JN((function*(){}))},eL=(0,Ei.createContext)(ZN);function tL(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function nL(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){tL(a,r,i,o,s,"next",e)}function s(e){tL(a,r,i,o,s,"throw",e)}o(void 0)}))}}function rL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const iL=Object.freeze({sha:"<unknown>",date:void 0,author:{login:"unknown author",avatarURL:""},message:"",URL:""});class aL extends mT{getFile(e,t,n,r){var i=this;return nL((function*(){return(yield i.postWithRefresh("/vcs.v1.VCSService/GetFile",JSON.stringify({repositoryURL:e,ref:t,localPath:n,rootPath:r}))).json()}))()}getCommits(e){var t=this;return nL((function*(){return yield Promise.all(e.map((({repositoryUrl:e,gitRef:n})=>e&&n?t.getCommit(e,n).catch((t=>(Ii.error(t,{info:`Error while fetching commit from repo "${e}" (${n})!'`}),iL))):iL)))}))()}refresh(){var e=this;return nL((function*(){return e.refreshSession()}))()}getCommit(e,t){var n=this;return nL((function*(){var r;const i=yield n.postWithRefresh("/vcs.v1.VCSService/GetCommit",JSON.stringify({repositoryURL:e,ref:t})),a=yield i.json();return(r=a).date&&(r.date=new Date(a.date)),a}))()}postWithRefresh(e,t){var n=this;return nL((function*(){var r;if(n.isRefreshing)return n.queueRequest(e,t);if(null===(r=n.sessionManager.getCookie())||void 0===r?void 0:r.isUserTokenExpired(aL.BIAS_MS)){n.isRefreshing=!0;try{yield n.refreshSession()}catch(e){n.sessionManager.deleteCookie(),n.flushQueue(e)}n.flushQueue(),n.isRefreshing=!1}return n.post(e,t)}))()}post(e,t){var n=this;return nL((function*(){return n.fetch(e,{method:"POST",body:t})}))()}refreshSession(){var e=this;return nL((function*(){const t=yield e.fetch("/vcs.v1.VCSService/GithubRefresh",{method:"POST",body:JSON.stringify({})}),n=yield t.json();e.sessionManager.setCookie(n.cookie)}))()}queueRequest(e,t){var n=this;return nL((function*(){return new Promise(((r,i)=>{n.pendingQueue.push((a=>{a?i(a):r(n.post(e,t))}))}))}))()}flushQueue(e=void 0){this.pendingQueue.forEach((t=>t(e))),this.pendingQueue=[]}constructor(e){super(e),rL(this,"sessionManager",void 0),rL(this,"pendingQueue",void 0),rL(this,"isRefreshing",void 0),this.sessionManager=UN,this.isRefreshing=!1,this.pendingQueue=[]}}function oL(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function sL(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){oL(a,r,i,o,s,"next",e)}function s(e){oL(a,r,i,o,s,"throw",e)}o(void 0)}))}}rL(aL,"BIAS_MS",3e5);const lL=btoa(String.fromCharCode(...crypto.getRandomValues(new Uint8Array(32))));function cL({dataSourceUid:e,children:t}){const n=sR.build(e,MN),r=sR.build(e,aL),[i,a]=(0,Ei.useState)(ZN.isLoginInProgress),[o,s]=function(){const[e,t]=(0,Ei.useState)(UN.getCookie());return[e,e=>{e?(UN.setCookie(e),t(UN.getCookie())):(UN.deleteCookie(),t(void 0))}]}(),[l,c]=(0,Ei.useState)();(0,Ei.useEffect)((()=>{s("")}),[e]),function({vcsClient:e,externalWindow:t,setExternalWindow:n,setSessionCookie:r,nonce:i}){(0,Ei.useEffect)((()=>{const a=function(){var o,s=(o=function*(){if(t&&!t.closed){try{const a=function(e){try{return new URL(e.location.href).searchParams}catch(e){return null}}(t);if(null!==a){const o=yield function(e,t,n){return KN.apply(this,arguments)}(e,a,i);if(o)return r(o),t.close(),void n(null)}}catch(e){return Ko(e,["Error while login in with GitHub!",e.message]),t.close(),void n(null)}window.setTimeout(a,700)}else n(null)},function(){var e=this,t=arguments;return new Promise((function(n,r){var i=o.apply(e,t);function a(e){YN(i,n,r,a,s,"next",e)}function s(e){YN(i,n,r,a,s,"throw",e)}a(void 0)}))});return function(){return s.apply(this,arguments)}}();return t&&a(),()=>{t&&(t.close(),n(null))}}),[t,n,r,i,e])}({vcsClient:n,externalWindow:l,setExternalWindow:c,setSessionCookie:s,nonce:lL});const u=!!l&&!l.closed;u!==i&&a(u);const d=(0,Ei.useCallback)(sL((function*(){try{yield function(e,t,n,r,i){return WN.apply(this,arguments)}(n,r,o,l,c)}catch(e){Ko(e,["Failed to login to GitHub",e.message])}})),[n,r,o,l]);return xi().createElement(eL.Provider,{value:{isLoginInProgress:i,isLoggedIn:Boolean(o&&!o.isUserTokenExpired()),isSessionExpired:Boolean(null==o?void 0:o.isUserTokenExpired()),login:d}},t)}function uL({filters:e,maxNodes:t}){const n=e?[...e]:[];n.unshift({key:"service_name",operator:"=",value:"$serviceName"});const r=n.map((({key:e,operator:t,value:n})=>`${e}${t}"${n}"`)).join(",");return new xg({datasource:uk,queries:[{refId:"profile",queryType:"profile",profileTypeId:"$profileMetricId",labelSelector:`{${r},$filters}`,maxNodes:t}]})}function dL(e){const[,t=""]=e.match(/.+\{.*service_name="([^"]+)".*\}/)||[],[,n=""]=e.match(/([^{]+)\{.*}/)||[],r=e.substring(e.indexOf("{")),i=r.replace(/(\{|\})/,"").split(",").map((e=>{var t;return null===(t=e.match(/\W*([^=!~]+)(=|!=|=~|!~)"(.*)"/))||void 0===t?void 0:t[0]})).filter((e=>e&&!e.includes("service_name")));return{serviceId:t,profileMetricId:n,labelsSelector:r,labels:i}}var pL=__webpack_require__(585);function hL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fL(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}class mL extends pL.Message{constructor(e,t,n,r,i){super(),hL(this,"profile_typeID",void 0),hL(this,"label_selector",void 0),hL(this,"start",void 0),hL(this,"end",void 0),hL(this,"max_nodes",void 0),this.profile_typeID=e,this.label_selector=t,this.start=n,this.end=r,this.max_nodes=i}}function gL(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function yL(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){gL(a,r,i,o,s,"next",e)}function s(e){gL(a,r,i,o,s,"throw",e)}o(void 0)}))}}fL([pL.Field.d(1,"string")],mL.prototype,"profile_typeID",void 0),fL([pL.Field.d(2,"string")],mL.prototype,"label_selector",void 0),fL([pL.Field.d(3,"int64")],mL.prototype,"start",void 0),fL([pL.Field.d(4,"int64")],mL.prototype,"end",void 0),fL([pL.Field.d(5,"int64")],mL.prototype,"max_nodes",void 0);class bL extends mT{static buildPprofRequest(e,t,n){const{profileMetricId:r,labelsSelector:i}=dL(e),a=1e3*t.from.unix(),o=1e3*t.to.unix(),s=new mL(r,i,a,o,n);return mL.encode(s).finish()}selectMergeProfile({query:e,timeRange:t,maxNodes:n}){var r=this;return yL((function*(){return(yield r.fetch("/querier.v1.QuerierService/SelectMergeProfile",{method:"POST",headers:{"content-type":"application/proto"},body:new Blob([bL.buildPprofRequest(e,t,n)])})).blob()}))()}selectMergeProfileJson({profileMetricId:e,labelsSelector:t,start:n,end:r,stackTrace:i,maxNodes:a}){var o=this;return yL((function*(){return(yield o.fetch("/querier.v1.QuerierService/SelectMergeProfile",{method:"POST",body:JSON.stringify({profile_typeID:e,label_selector:t,start:1e3*n,end:1e3*r,stackTraceSelector:{call_site:i.map((e=>({name:e})))},maxNodes:a})})).json()}))()}}function vL(e,t){const{serviceId:n,profileMetricId:r}=dL(e),i=`${t.from.format("YYYY-MM-DD_HHmm")}-to-${t.to.format("YYYY-MM-DD_HHmm")}`;return`${n.replace(/\//g,"-")}_${r}_${i}`}function wL(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}const SL=new class extends qi{upload(e,t){var n,r=this;return(n=function*(){const n=yield r.fetch("/upload/v1",{method:"POST",body:JSON.stringify({name:e,profile:btoa(JSON.stringify(t)),fileTypeData:{units:t.metadata.units,spyName:t.metadata.spyName},type:"json"})});return yield n.json()},function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){wL(a,r,i,o,s,"next",e)}function s(e){wL(a,r,i,o,s,"throw",e)}o(void 0)}))})()}constructor(){super("https://flamegraph.com/api",{"content-type":"application/json"})}};function EL(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function xL(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){EL(a,r,i,o,s,"next",e)}function s(e){EL(a,r,i,o,s,"throw",e)}o(void 0)}))}}function _L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class OL extends Yp{fetchFlamebearerProfile({dataSourceUid:e,query:t,timeRange:n,maxNodes:r}){return xL((function*(){const i=sR.build(e,dN);let a;try{a=yield i.get({query:t,timeRange:n,format:"json",maxNodes:r||zR.maxNodes})}catch(e){return Ko(e,["Error while loading flamebearer profile data!",e.message]),null}return a}))()}fetchPprofProfile({dataSourceUid:e,query:t,timeRange:n,maxNodes:r}){return xL((function*(){const i=sR.build(e,bL);let a;try{const e=yield i.selectMergeProfile({query:t,timeRange:n,maxNodes:r||zR.maxNodes});a=yield new Response(e.stream().pipeThrough(new CompressionStream("gzip"))).blob()}catch(e){return Ko(e,["Failed to export to pprof!",e.message]),null}return a}))()}constructor(){super({key:"export-flame-graph-menu"}),_L(this,"useSceneExportMenu",(({query:e,timeRange:t})=>{const n=Rf.findByKeyAndType(this,"dataSource",xk).useState().value,[r]=yN(),{settings:i}=WR();var a=this;const o=function(){var i=xL((function*(){ru("g_pyroscope_app_export_profile",{format:"json"});const i=yield a.fetchFlamebearerProfile({dataSourceUid:n,query:e,timeRange:t,maxNodes:r});if(!i)return;const o=`${vL(e,t)}.json`,s=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(i))}`;Bd()(s,o)}));return function(){return i.apply(this,arguments)}}();var s=this;const l=function(){var i=xL((function*(){ru("g_pyroscope_app_export_profile",{format:"pprof"});const i=yield s.fetchPprofProfile({dataSourceUid:n,query:e,timeRange:t,maxNodes:r});if(!i)return;const a=`${vL(e,t)}.pb.gz`;Bd()(i,a)}));return function(){return i.apply(this,arguments)}}();var c=this;const u=function(){var i=xL((function*(){ru("g_pyroscope_app_export_profile",{format:"flamegraph.com"});const i=yield c.fetchFlamebearerProfile({dataSourceUid:n,query:e,timeRange:t,maxNodes:r});if(i)try{const n=yield SL.upload(vL(e,t),i);if(!n.url)throw new Error("Empty URL received.");const r=document.createElement("a");r.target="_blank",r.href=n.url,document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(e){return void Ko(e,["Failed to export to flamegraph.com!",e.message])}}));return function(){return i.apply(this,arguments)}}();return{data:{shouldDisplayFlamegraphDotCom:Boolean(null==i?void 0:i.enableFlameGraphDotComExport)},actions:{downloadPng:()=>{ru("g_pyroscope_app_export_profile",{format:"png"});const n=`${vL(e,t)}.png`;document.querySelector('canvas[data-testid="flameGraph"]').toBlob((e=>{if(e)Bd()(e,n);else{const e=new Error("Error while creating the image, no blob.");Ko(e,["Failed to export to png!",e.message])}}),"image/png")},downloadJson:o,downloadPprof:l,uploadToFlamegraphDotCom:u}}}))}}function TL(){return(0,Ei.useContext)(eL)}_L(OL,"Component",(({model:e,query:t,timeRange:n})=>{const{actions:i}=e.useSceneExportMenu({query:t,timeRange:n});return xi().createElement(r.Dropdown,{overlay:xi().createElement(r.Menu,null,xi().createElement(r.Menu.Item,{label:"png",onClick:i.downloadPng}),xi().createElement(r.Menu.Item,{label:"json",onClick:i.downloadJson}),xi().createElement(r.Menu.Item,{label:"pprof",onClick:i.downloadPprof}))},xi().createElement(r.Button,{icon:"download-alt",size:"sm",variant:"secondary",fill:"outline","aria-label":"Export profile data",tooltip:"Export profile data"}))}));const CL="gpt-4-1106-preview",kL=({functionDetails:e,lines:t})=>{const n=`\nYou are a code optimization expert. I will give you code, each line annotated with amount of time spent on a particular line (it's in the beginning of each line), and a function name.\n\nI want you to write back a new improved code for this function and explain why you made changes.\n\nMake sure to take annotations into strong consideration. If a suggested performance improvement isn't backed up by information from the annotations, do not include it.\n\nDo not mention the actual numbers from the annotations, users can already see how much time was spent on each line. Do not list various lines and their time spent. When you mention functions or lines, do not mention the time spent on them.\n\nIf you can't find any meaningful performance optimizations, say so. Ask for context if you think other context might help make decisions. If you think the problem is with user input and not the actual code itself, say so.\n\nWhen you output code in markdown, please don't specify language after 3 backticks (e.g instead of saying "\`\`\`go" say "\`\`\`"), and always add a new line after 3 backticks.\n\nFunction name is \`${e.name}\`. Do not mention the function name, users can already see it.\n\nWhen posting a response, follow the outline below:\n* give a brief explanation of things that could be improve\n* print new code if it's possible\n* explain each change in more details\n\n\nAnnotated code is below:\n\`\`\`\n${function(e,t){return t.map((t=>`(${t.cum} ${e.unit}) ${t.line}`)).join("\n")}(e,t)}\n\`\`\`\n`;return{system:"",user:n}};const PL=()=>({title:t.css`
    margin: -4px 0 4px 0;
  `,content:t.css``});function AL({suggestionPromptInputs:e}){const t=(0,r.useStyles2)(PL),{data:n,actions:i}=function(e){const{reply:t,error:n}=function(e){const[t,n]=(0,Ei.useState)(""),[r,i]=(0,Ei.useState)(!1),[a,o]=(0,Ei.useState)(!1),[s,l]=(0,Ei.useState)([]),[c,u]=(0,Ei.useState)(null),d=(0,Ei.useCallback)((e=>{l(e),u(null),n(""),i(!0),o(!1),ij({model:CL,messages:e}).pipe(rj()).subscribe({next:n,error(e){u(e),i(!1),o(!0)},complete(){i(!1),o(!0)}})}),[]),p=(0,Ei.useCallback)((e=>{const n=[{role:"assistant",content:t},{role:"user",content:e}];try{d([...s,...n])}catch(e){u(e)}}),[s,t,d]);return(0,Ei.useEffect)((()=>{if(s.length>0)return;const t=kL(e);try{d([{role:"system",content:t.system},{role:"system",content:t.user}])}catch(e){u(e)}}),[s.length,e,d]),{reply:{text:t,hasStarted:r,hasFinished:a,messages:s,askFollowupQuestion:p},error:c}}(e);return{data:{isLoading:!n&&!t.text.trim(),llmError:n,reply:t,shouldDisplayReply:Boolean((null==t?void 0:t.hasStarted)||(null==t?void 0:t.hasFinished)),shouldDisplayFollowUpForm:!n&&Boolean(null==t?void 0:t.hasFinished)},actions:{submitFollowupQuestion(e){t.askFollowupQuestion(e)}}}}(e);return xi().createElement(xi().Fragment,null,xi().createElement("h6",{className:t.title},"Code Optimization Suggestions"),xi().createElement("div",{className:t.content},n.isLoading&&xi().createElement(xi().Fragment,null,xi().createElement(r.Spinner,{inline:!0}),"Analyzing..."),n.fetchError&&xi().createElement(QR,{severity:"error",title:"Error while fetching profiles!",message:"Sorry for any inconvenience, please try again later."}),n.llmError&&xi().createElement(QR,{severity:"error",title:"Failed to generate content using OpenAI!",error:n.llmError,message:"Sorry for any inconvenience, please try again later or if the problem persists, contact your organization admin."}),n.shouldDisplayReply&&xi().createElement(rN,{reply:n.reply}),n.shouldDisplayFollowUpForm&&xi().createElement(oN,{onSubmit:i.submitFollowupQuestion})))}function RL(e,t){let n=e;const r=e.match(/raw\.githubusercontent\.com\/([^/]+)\/([^/]+)\/(.+)/);if(r){const[,e,t,i]=r;n=`https://github.com/${e}/${t}/blob/${i}`}return void 0===t||e.includes("#")||(n+=`#L${t}`),n}const DL=5;function jL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IL(e,t){const{isLoggedIn:n}=TL(),{version:r}=t,[i,a]=(0,Ei.useState)(!1);var o,s,l;const{fileInfo:c,error:u,isFetching:d}=function({enabled:e,dataSourceUid:t,repository:n,gitRef:r,localPath:i,rootPath:a}){const o=sR.build(t,aL),{isFetching:s,error:l,data:c}=ca({enabled:Boolean(e&&i),queryKey:["vcs-file",n,r,i,a],queryFn:()=>o.getFile(n,r,i,a).then((e=>({content:e.content,URL:e.URL}))).then((e=>({URL:e.URL,content:atob(e.content)})))});return{isFetching:s,error:o.isAbortError(l)?null:l,fileInfo:c}}({enabled:n,dataSourceUid:e,localPath:t.fileName,repository:null!==(o=null==r?void 0:r.repository)&&void 0!==o?o:"",gitRef:null!==(s=null==r?void 0:r.git_ref)&&void 0!==s?s:"",rootPath:null!==(l=null==r?void 0:r.root_path)&&void 0!==l?l:""}),p=(0,Ei.useMemo)((()=>(null==c?void 0:c.content)?function(e,t){if(!t.size)return[];const n=Array.from(t.values()).sort(((e,t)=>e.line-t.line)),r=e.split("\n"),i=Math.max(0,n[0].line-DL-1),a=Math.min(r.length,n[n.length-1].line+DL);return r.slice(i,a).map(((e,n)=>{const r=n+i+1,a=t.get(r);var o,s;return{line:e,number:r,cum:null!==(o=null==a?void 0:a.cum)&&void 0!==o?o:0,flat:null!==(s=null==a?void 0:a.flat)&&void 0!==s?s:0}}))}(c.content,t.callSites):function(e){if(!e.size)return[];const t=Array.from(e.values()).sort(((e,t)=>e.line-t.line)),n=Math.max(0,t[0].line-DL-1),r=t[t.length-1].line+DL+1,i=[];for(let t=n+1;t<r;t++){const n=e.get(t);var a,o;i.push({line:void 0,number:t,cum:null!==(a=null==n?void 0:n.cum)&&void 0!==a?a:0,flat:null!==(o=null==n?void 0:n.flat)&&void 0!==o?o:0})}return i}(t.callSites)),[null==c?void 0:c.content,t.callSites]);return{data:{fetchError:u,openAiSuggestions:i,isLoadingCode:d,unit:t.unit,githubUrl:(null==c?void 0:c.URL)?RL(c.URL,t.startLine):void 0,lines:p.map((e=>{var t,n,r;return n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){jL(e,t,n[t])}))}return e}({},e),r=null!=(r={line:null!==(t=e.line)&&void 0!==t?t:"???"})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(r)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})),n})),noCodeAvailable:Boolean(u)||!p.some((e=>e.line))},actions:{setOpenAiSuggestions:a}}}function NL(t){switch(t){case"nanoseconds":return(0,e.getValueFormat)("ns");case"microseconds":return(0,e.getValueFormat)("s");case"milliseconds":return(0,e.getValueFormat)("ms");case"seconds":return(0,e.getValueFormat)("s");case"count":return(0,e.getValueFormat)("short");default:return(0,e.getValueFormat)(t)}}const LL=({lines:e,unit:n,githubUrl:i,isLoadingCode:a,noCodeAvailable:o,onOptimizeCodeClick:s})=>{const l=(0,r.useStyles2)(VL),c=NL(n),u=e=>{if(e<=0)return".";const t=c(e);return t.suffix?t.text+t.suffix:t.text};FL(e);const[d,p]=e.reduce((([e,t],{flat:n,cum:r})=>[e+n,t+r]),[0,0]);return xi().createElement("div",{"data-testid":"function-details-code-container"},xi().createElement("div",{className:l.container},xi().createElement("div",{className:l.header},xi().createElement("div",{className:l.breakdownLabel},xi().createElement("h6",null,"Breakdown per line"),xi().createElement("span",null,a&&xi().createElement(r.Spinner,{inline:!0}),!a&&o&&"(file information unavailable)")),xi().createElement("div",{className:l.buttons},xi().createElement(r.LinkButton,{disabled:Boolean(a||!i),href:i,target:"_blank",icon:"github",fill:"text"},"View on GitHub"),xi().createElement(sj,{onClick:s,disabled:a||o,interactionName:"g_pyroscope_app_optimize_code_clicked"},"Optimize Code")))),xi().createElement("pre",{className:l.codeBlock,"data-testid":"function-details-code"},xi().createElement("div",{className:(0,t.cx)(l.highlighted,l.codeBlockHeader)},ML("Total:",u(d),u(p)," (self, total)")),e.map((({line:e,number:t,cum:n,flat:r})=>xi().createElement("div",{key:e+t+n+r,className:r+n>0?l.highlighted:""},ML(`${t} `,u(r),u(n),e))))))},ML=(e,t,n,r)=>{const i=e.padStart(7," ")+t.padStart(12," ")+n.padStart(12," ");return r?`${i} ${r}`:i},FL=e=>{if(0===e.length)return;let t=$L(e[0].line);for(let n=1;n<e.length;n++){const{line:r}=e[n];if(""===r.trim())continue;const i=$L(r);t=BL(t,i)}if(t)for(let n=0;n<e.length;n++)e[n].line=e[n].line.substring(t.length)},$L=e=>{const t=e.match(/^[ \t]*/);var n;return null!==(n=null==t?void 0:t[0])&&void 0!==n?n:""},BL=(e,t)=>{let n=0;for(let r=0;r<Math.min(e.length,t.length)&&e[r]===t[r];r++)n++;return e.substring(0,n)},VL=e=>({container:t.css`
    display: flex;
    flex-direction: row;
    align-items: flex-start;
    width: 100%;
  `,header:t.css`
    display: flex;
    justify-content: space-between;
    align-items: end;
    width: 100%;
  `,breakdownLabel:t.css`
    & > h6 {
      display: inline-block;
      margin-top: ${e.spacing(1)};
    }

    & > span {
      margin-left: ${e.spacing(1)};
      font-size: ${e.typography.bodySmall.fontSize};
    }

    & > svg {
      margin-left: ${e.spacing(1)};
    }
  `,buttons:t.css`
    display: flex;
    flex-wrap: no-wrap;
  `,codeBlock:t.css`
    position: relative;
    min-height: 240px;
    font-size: 12px;
    overflow-x: auto;
    white-space: pre;
    color: ${e.colors.text.secondary};
  `,highlighted:t.css`
    color: ${e.colors.text.maxContrast};
  `,codeBlockHeader:t.css`
    margin-bottom: 8px;
  `});function zL({dataSourceUid:e,functionDetails:t}){var n,r;const{data:i,actions:a}=IL(e,t);return i.fetchError&&404!==(null===(r=i.fetchError)||void 0===r||null===(n=r.response)||void 0===n?void 0:n.status)&&Ko(i.fetchError,["Failed to fetch file information!",i.fetchError.message]),xi().createElement(xi().Fragment,null,xi().createElement(LL,{lines:i.lines,unit:i.unit,githubUrl:i.githubUrl,isLoadingCode:i.isLoadingCode,noCodeAvailable:i.noCodeAvailable,onOptimizeCodeClick:()=>{var e;a.setOpenAiSuggestions(!0),null===(e=document.getElementById("ai-suggestions-panel"))||void 0===e||e.scrollIntoView({behavior:"smooth"})}}),xi().createElement("h6",{id:"ai-suggestions-panel",style:{height:0,marginBottom:0}}),i.openAiSuggestions?xi().createElement(AL,{suggestionPromptInputs:{functionDetails:t,lines:i.lines}}):null)}const UL=e=>({ellipsis:t.css`
    color: ${e.colors.primary.text};
    text-overflow: ellipsis;
    overflow: hidden;
    direction: rtl;
    white-space: nowrap;
  `}),qL=({enableIntegration:e,repository:t})=>{const n=(0,r.useStyles2)(UL),{isLoginInProgress:i,isLoggedIn:a,login:o}=TL();return e?i?xi().createElement(xi().Fragment,null,xi().createElement(r.Spinner,null),xi().createElement("span",null,"Connecting to GitHub...")):a?xi().createElement(xi().Fragment,null,xi().createElement(r.Icon,{name:"github",size:"lg"}),xi().createElement("a",{className:n.ellipsis,href:t.commitUrl,target:"_blank",rel:"noreferrer",title:"View commit"},xi().createElement(r.Icon,{name:"external-link-alt"}),"",t.commitName)):xi().createElement(r.LinkButton,{icon:"github",variant:"primary",onClick:o},"Connect to ",t.name):xi().createElement(xi().Fragment,null,"-")};function HL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GL(e,t){const n=e.map((e=>{var n,r,i;return r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){HL(e,t,n[t])}))}return e}({},e.commit),i=null!=(i={samples:{unit:null!==(n=e.unit)&&void 0!==n?n:"count",current:Array.from(e.callSites.values()).reduce(((e,{cum:t})=>e+t),0),total:t}})?i:{},Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(i)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})),r}));return n}const WL="https://github.com/";function QL(e,t){if(!(null==t?void 0:t.repository))return null;const n=t.repository,r=n.replace(WL,""),i=t.git_ref;return{isGitHub:e,url:n,name:r,commitUrl:i?`${n}/commit/${i}`:n,commitName:i?`${r}@${i.substring(0,7)}`:r}}const KL=(e,t,n)=>{let r;try{r=n?JSON.parse(e.stringTable[Number(n.buildId)]):void 0}catch(e){}return{name:e.stringTable[Number(t.name)],version:r,startLine:Number.isNaN(Number(t.startLine))?void 0:Number(t.startLine),fileName:e.stringTable[Number(t.filename)],callSites:new Map,unit:e.stringTable[Number(e.sampleType[0].unit)],commit:iL}};function YL(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function XL(){var e;return e=function*(e,t){const n=sR.build(e,aL),r=t.map((e=>{var t,n,r;return{repositoryUrl:(null==e||null===(t=e.version)||void 0===t?void 0:t.repository)||"",gitRef:(null==e||null===(n=e.version)||void 0===n?void 0:n.git_ref)||"HEAD",rootPath:(null==e||null===(r=e.version)||void 0===r?void 0:r.root_path)||""}}));return(yield n.getCommits(r)).forEach(((e,n)=>{t[n].commit=e})),t},XL=function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){YL(a,r,i,o,s,"next",e)}function s(e){YL(a,r,i,o,s,"throw",e)}o(void 0)}))},XL.apply(this,arguments)}const JL=e=>Array.from(e.callSites.values()).reduce(((e,{cum:t})=>e+t),0),ZL=(e,t)=>JL(t)-JL(e);function eM(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function tM(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){eM(a,r,i,o,s,"next",e)}function s(e){eM(a,r,i,o,s,"throw",e)}o(void 0)}))}}function nM({dataSourceUid:e,query:t,timeRange:n,stackTrace:r}){const{profileMetricId:i,labelsSelector:a}=dL(t),[o,s]=[n.from.unix(),n.to.unix()],{isLoggedIn:l}=TL(),c=sR.build(e,bL),{isFetching:u,error:d,data:p}=ca({enabled:Boolean(i&&a&&r.length>0&&o>0&&s>0),queryKey:["function-details",i,a,o,s,r,l],queryFn:tM((function*(){const t=yield c.selectMergeProfileJson({profileMetricId:i,labelsSelector:a,start:o,end:s,stackTrace:r,maxNodes:500}),n=function(e,t){var n,r,i,a;const o=new Map,s=new Map(null===(n=t.location)||void 0===n?void 0:n.map((e=>[e.id,e]))),l=new Map(null===(r=t.function)||void 0===r?void 0:r.map((e=>[e.id,e]))),c=new Map(null===(i=t.mapping)||void 0===i?void 0:i.map((e=>[e.id,e])));return null===(a=t.sample)||void 0===a||a.filter((e=>void 0!==e.locationId)).forEach((n=>function(e,t,n,r,i,a,o){const s=new Set;a.locationId.forEach(((l,c)=>{const u=n.get(l);if(!u)return;const d=r.get(u.line[0].functionId);if(!d)return;if(t.stringTable[Number(d.name)]!==e)return;if(s.has(l))return;s.add(l);const p=o.get(u.mappingId)||KL(t,d,i.get(u.mappingId)),h=Number(u.line[0].line),f=p.callSites.get(h)||{line:Number(u.line[0].line),flat:0,cum:0},m=0===c?Number(a.value[0]):0,g=Number(a.value[0]);f.flat+=m,f.cum+=g,p.callSites.set(h,f),o.set(u.mappingId,p)}))}(e,t,s,l,c,n,o))),Array.from(o.values())}(r[r.length-1],t).sort(ZL);return l?function(e,t){return XL.apply(this,arguments)}(e,n):n}))}),h=(0,Ei.useMemo)((()=>(null==p?void 0:p.length)?p:[{name:r.at(-1),startLine:void 0,fileName:"",callSites:new Map,unit:"",commit:iL}]),[p,r]);return{isFetching:u,error:c.isAbortError(d)?null:d,functionsDetails:h}}const rM=[60,3600,86400,604800,2592e3,31536e3,1/0],iM=["second","minute","hour","day","week","month","year"],aM=new Intl.RelativeTimeFormat("en-US",{numeric:"auto"}),oM=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"2-digit"});const sM=e=>({container:t.css`
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
  `,firstLine:t.css`
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 1em;
  `,sha:t.css`
    font-family: monospace;
  `,sample:t.css`
    font-size: 12px;
  `,secondLine:t.css`
    display: flex;
    flex-direction: row;
    align-items: center;
    font-size: 12px;
    color: ${e.colors.text.secondary};
  `,avatar:t.css`
    display: inline-block;
    margin-right: 4px;
    border-radius: 50%;
    background: grey;
    width: 16px;
    height: 16px;
  `,message:t.css`
    font-size: 12px;
    color: ${e.colors.text.secondary};
  `});function lM({commit:e}){const t=(0,r.useStyles2)(sM),{author:n,samples:i}=e,a=n.login,o=n.avatarURL,s=NL(i.unit)(i.current),l=Math.round(i.current/i.total*100);return xi().createElement("div",{className:t.container},xi().createElement("div",{className:t.firstLine},xi().createElement("span",{className:t.sha},hM(e.sha)),xi().createElement("span",{className:t.sample},s.text,s.suffix," (",l,"%)")),xi().createElement("div",{className:t.secondLine},o&&xi().createElement("img",{className:t.avatar,src:o,alt:a}),xi().createElement("span",null,a," on ",(c=e.date)?`${oM.format(c)} (${function(e){const t=e.getTime(),n=Math.round((t-Date.now())/1e3),r=rM.findIndex((e=>e>Math.abs(n))),i=r?rM[r-1]:1;return aM.format(Math.floor(n/i),iM[r])}(c)})`:"?")),xi().createElement("span",{className:t.message},fM(e.message)));var c}const cM=e=>({container:t.css`
    display: flex;
    flex-direction: row;
    justify-content: flex-start;
    align-items: center;
    gap: 1em;
  `,sha:t.css`
    font-family: monospace;
  `,message:t.css`
    color: ${e.colors.text.secondary};
  `});function uM({commit:e}){const t=(0,r.useStyles2)(cM);return xi().createElement("div",{className:t.container},xi().createElement("span",{className:t.sha},hM(e.sha)),xi().createElement("div",{className:t.message},xi().createElement("span",null,fM(e.message))))}function dM({commits:e,selectedCommit:t,onChange:n}){return xi().createElement(r.Select,{options:e.map((e=>({label:e.sha,value:e}))),value:{label:t.sha,value:t},hideSelectedOptions:!0,isSearchable:!1,noOptionsMessage:"No commits found",formatOptionLabel:pM,onChange:e=>{e.value&&n(e.value)}})}function pM(e,t){var n;const{value:r}=e;return r?(null===(n=t.selectValue[0])||void 0===n?void 0:n.value)===r?xi().createElement(uM,{commit:r}):xi().createElement(lM,{commit:r}):null}const hM=e=>e===iL.sha?e:e.substring(0,7),fM=e=>e.split("\n")[0],mM=({onDismiss:e})=>xi().createElement(r.Alert,{severity:"info",title:"Integrate with Github",buttonContent:"Dismiss",onRemove:e},xi().createElement("p",null,"This language supports integration with ",xi().createElement(r.Icon,{name:"github"})," GitHub."),xi().createElement("p",null,"To activate this feature, you will need to add two new labels when sending profiles"," ",xi().createElement("code",null,"service_repository")," and ",xi().createElement("code",null,"service_ref"),"."," "),xi().createElement("p",null,"They should respectively be set to the full repository GitHub URL and the current"," ",xi().createElement(r.TextLink,{href:"https://docs.github.com/en/rest/git/refs?apiVersion=2022-11-28#about-git-references",external:!0},"git ref")," ","of the running service."),xi().createElement(r.Icon,{name:"document-info"})," ",xi().createElement(r.TextLink,{href:"https://grafana.com/docs/grafana-cloud/monitor-applications/profiles/pyroscope-github-integration/",external:!0},"Learn more"));function gM({isLoading:e,children:t}){return e?xi().createElement(r.Spinner,{inline:!0}):xi().createElement(xi().Fragment,null,t)}const yM=(0,Ei.memo)(gM);function bM(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function vM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class wM extends Yp{constructor(){super({key:"function-details-panel"}),vM(this,"useSceneFunctionDetailsPanel",((e,t)=>{var n,r;const i=Rf.findByKeyAndType(this,"dataSource",xk).useState().value,a=Ek(this,"filters"),{functionsDetails:o,error:s,isFetching:l}=nM({dataSourceUid:i,query:a,timeRange:t,stackTrace:e}),[c,u]=(0,Ei.useState)(),[d,p]=(0,Ei.useState)(o[0]),[h,f]=(0,Ei.useState)(Mi.has(Mi.KEYS.GITHUB_INTEGRATION));o&&c!==o&&(u(o),d!==o[0]&&p(o[0]));const m=((null==d||null===(n=d.version)||void 0===n?void 0:n.repository)||"").startsWith(WL),g=null==d||null===(r=d.fileName)||void 0===r?void 0:r.endsWith(".go"),y=!h&&!m&&g,b=(0,Ei.useMemo)((()=>o.map((e=>Array.from(e.callSites.values()).reduce(((e,{cum:t})=>e+t),0))).reduce(((e,t)=>e+t),0)),[o]),v=GL(o,b),w=v.find((({sha:e})=>{var t;return e===(null==d||null===(t=d.commit)||void 0===t?void 0:t.sha)}));return{data:{isLoading:l,fetchFunctionDetailsError:s,functionDetails:d,repository:QL(m,null==d?void 0:d.version),commits:v,selectedCommit:w,isGitHubSupported:g,shouldDisplayGitHubBanner:y,dataSourceUid:i},actions:{selectCommit(e){const t=o.find((({commit:t})=>t.sha===e.sha));p(t)},copyFilePathToClipboard(){return(e=function*(){try{(null==d?void 0:d.fileName)&&(yield navigator.clipboard.writeText(d.fileName),Xo(["File path copied to clipboard!"]))}catch(e){}},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){bM(a,r,i,o,s,"next",e)}function s(e){bM(a,r,i,o,s,"throw",e)}o(void 0)}))})();var e},dismissGitHubBanner(){Mi.set(Mi.KEYS.GITHUB_INTEGRATION,{}),f(!0)}}}}))}}vM(wM,"LABEL_WIDTH",16),vM(wM,"Component",(({model:e,timeRange:t,stackTrace:n,onClose:i})=>{const a=(0,r.useStyles2)(SM),{data:o,actions:s}=e.useSceneFunctionDetailsPanel(n,t);return xi().createElement(gD,{className:a.sidePanel,title:"Function Details",isLoading:!1,headerActions:xi().createElement(r.IconButton,{name:"times-circle",variant:"secondary","aria-label":"close",onClick:i}),dataTestId:"function-details-panel"},xi().createElement("div",{className:a.content},o.fetchFunctionDetailsError&&xi().createElement(QR,{severity:"error",title:"Error while fetching function details!",error:o.fetchFunctionDetailsError}),xi().createElement("div",{className:a.container},xi().createElement("div",{className:a.row,"data-testid":"row-function-name"},xi().createElement(r.InlineLabel,{width:wM.LABEL_WIDTH},"Function name"),xi().createElement(r.Tooltip,{content:o.functionDetails.name,placement:"top"},xi().createElement("span",{className:a.textValue},o.functionDetails.name))),xi().createElement("div",{className:a.row,"data-testid":"row-start-line"},xi().createElement(r.InlineLabel,{tooltip:"The line where this function definition starts",width:wM.LABEL_WIDTH},"Start line"),xi().createElement("span",{className:a.textValue},xi().createElement(yM,{isLoading:o.isLoading},void 0!==o.functionDetails.startLine?o.functionDetails.startLine:"-"))),xi().createElement("div",{className:a.row,"data-testid":"row-file-path"},xi().createElement(r.InlineLabel,{tooltip:"File path where that function is defined",width:wM.LABEL_WIDTH},"File"),xi().createElement(yM,{isLoading:o.isLoading},o.functionDetails.fileName?xi().createElement(xi().Fragment,null,xi().createElement(r.Tooltip,{content:o.functionDetails.fileName,placement:"top"},xi().createElement("span",{className:a.textValue},"/"===(null==(l=o.functionDetails.fileName)?void 0:l[0])?l.substring(1)+"/":l)),xi().createElement(r.IconButton,{name:"clipboard-alt",tooltip:"Copy to clipboard",onClick:s.copyFilePathToClipboard})):"-")),o.shouldDisplayGitHubBanner&&xi().createElement("div",{className:a.row,"data-testid":"row-github-banner"},xi().createElement(mM,{onDismiss:s.dismissGitHubBanner})),xi().createElement("div",{className:a.row,"data-testid":"row-repository"},xi().createElement(r.InlineLabel,{tooltip:"The repository configured for the selected service",width:wM.LABEL_WIDTH},"Repository"),xi().createElement(yM,{isLoading:o.isLoading},o.repository?o.repository.isGitHub?xi().createElement(qL,{enableIntegration:o.isGitHubSupported,repository:o.repository}):xi().createElement(r.TextLink,{href:o.repository,external:!0},o.repository):"-")),xi().createElement("div",{className:a.row,"data-testid":"row-commit"},xi().createElement(r.InlineLabel,{width:wM.LABEL_WIDTH,tooltip:"The version of the application (commit) where the function is defined. Use the dropdown menu to target a specific commit."},"Commit"),xi().createElement(yM,{isLoading:o.isLoading},xi().createElement(dM,{commits:o.commits,selectedCommit:o.selectedCommit,onChange:s.selectCommit})))),xi().createElement(zL,{dataSourceUid:o.dataSourceUid,functionDetails:o.functionDetails})));var l}));const SM=e=>({sidePanel:t.css`
    flex: 1 0 50%;
    margin-left: 8px;
    max-width: calc(50% - 4px);
  `,title:t.css`
    margin: -4px 0 4px 0;
  `,content:t.css`
    padding: ${e.spacing(1)};
  `,container:t.css`
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  `,row:t.css`
    width: 100%;
    display: flex;
    flex-direction: row;
    align-items: center;
    padding-bottom: 10px;
    > * {
      margin-right: 10px !important;
    }
  `,textValue:t.css`
    text-overflow: ellipsis;
    overflow: hidden;
    direction: rtl;
    white-space: nowrap;
  `});function EM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class xM extends Yp{onActivate(){let t;const n=this.subscribeToState(((n,r)=>{var i;n.$data!==r.$data&&(t&&t.unsubscribe(),t=null===(i=n.$data)||void 0===i?void 0:i.subscribeToState((t=>{var n;(null===(n=t.data)||void 0===n?void 0:n.state)===e.LoadingState.Done&&this.setState({lastTimeRange:t.data.timeRange})})))}));return()=>{n.unsubscribe(),null==t||t.unsubscribe()}}buildTitle(){const e=Lk(this,"serviceName"),t=ck(Lk(this,"profileMetricId")).type;return xi().createElement(xi().Fragment,null,xi().createElement(_o,{size:"small"}),"Flame graph for ",e," (",t,")")}constructor(){super({key:"flame-graph",$data:new xg({datasource:uk,queries:[]}),lastTimeRange:void 0,exportMenu:new OL,aiPanel:new hN,functionDetailsPanel:new wM}),EM(this,"useSceneFlameGraph",(()=>{var t,n,i;const{isLight:a}=(0,r.useTheme2)(),o=(0,Ei.useMemo)((()=>()=>(0,e.createTheme)({colors:{mode:a?"light":"dark"}})),[a]),[s]=yN(),{settings:l,error:c}=WR(),{$data:u,lastTimeRange:d,exportMenu:p,aiPanel:h,functionDetailsPanel:f}=this.useState();c&&Yo(["Error while retrieving the plugin settings!","Some features might not work as expected (e.g. collapsed flame graphs). Please try to reload the page, sorry for the inconvenience."]),(0,Ei.useEffect)((()=>{s&&this.setState({$data:uL({maxNodes:s})})}),[s]);const m=u.useState(),g=(null==m||null===(t=m.data)||void 0===t?void 0:t.state)===e.LoadingState.Loading,y=null==m||null===(i=m.data)||void 0===i||null===(n=i.series)||void 0===n?void 0:n[0],b=Number(null==y?void 0:y.length)>1,v=Ek(this,"filters");return{data:{title:this.buildTitle(),isLoading:g,isFetchingProfileData:g,hasProfileData:b,profileData:y,settings:l,export:{menu:p,query:v,timeRange:d},ai:{panel:h,fetchParams:[{query:v,timeRange:d}]},gitHub:{panel:f,timeRange:d}},actions:{getTheme:o}}})),this.addActivationHandler(this.onActivate.bind(this))}}EM(xM,"Component",(({model:t})=>{var n;const i=(0,r.useStyles2)(_M),{data:a,actions:o}=t.useSceneFlameGraph(),s=BR(),l=function(t){const{login:n,isSessionExpired:r}=TL(),{settings:i}=WR(),a=null==i?void 0:i.enableFunctionDetails,[o,s]=(0,Ei.useState)([]),l=(0,Ei.useCallback)((({item:i},o)=>a&&0!==i.level?[{label:"Function details",icon:"info-circle",onClick:()=>{ru("g_pyroscope_app_function_details_clicked"),s(function(t,n){let r=[];const i=n.fields.find((({name:e})=>"label"===e));if(!i)return r;const a=(0,e.getDisplayProcessor)({field:i,theme:(0,e.createTheme)()});let o=t;for(;o&&o.level>0;){var s;for(const e of o.itemIndexes)r.unshift(a(i.values[e]).text);o=null===(s=o.parents)||void 0===s?void 0:s[0]}return r}(i,o)),t.open("function-details"),r&&n()}}]:[]),[a,r,n,t]);return{data:{stacktrace:o},actions:{getExtraFlameGraphMenuItems:l}}}(s),c=a.isLoading||!a.hasProfileData;(0,Ei.useEffect)((()=>{c&&s.close()}),[c,s]);const u=(0,Ei.useMemo)((()=>xi().createElement(xi().Fragment,null,a.title,a.isLoading&&xi().createElement(r.Spinner,{inline:!0,className:i.spinner}))),[a.isLoading,a.title,i.spinner]);return xi().createElement("div",{className:i.flex},xi().createElement(gD,{dataTestId:"flame-graph-panel",className:i.flamegraphPanel,title:u,isLoading:a.isLoading,headerActions:xi().createElement(sj,{disabled:c||s.isOpen("ai"),onClick:()=>s.open("ai"),interactionName:"g_pyroscope_app_explain_flamegraph_clicked"},"Explain Flame Graph")},xi().createElement(Zc,{data:a.profileData,disableCollapsing:!(null===(n=a.settings)||void 0===n?void 0:n.collapsedFlamegraphs),getTheme:o.getTheme,getExtraContextMenuButtons:l.actions.getExtraFlameGraphMenuItems,extraHeaderElements:xi().createElement(a.export.menu.Component,{model:a.export.menu,query:a.export.query,timeRange:a.export.timeRange})})),s.isOpen("ai")&&xi().createElement(a.ai.panel.Component,{model:a.ai.panel,fetchParams:a.ai.fetchParams,onClose:s.close}),s.isOpen("function-details")&&xi().createElement(a.gitHub.panel.Component,{model:a.gitHub.panel,timeRange:a.gitHub.timeRange,stackTrace:l.data.stacktrace,onClose:s.close}))}));const _M=e=>({flex:t.css`
    display: flex;
  `,flamegraphPanel:t.css`
    min-width: 0;
    flex-grow: 1;
  `,spinner:t.css`
    margin-left: ${e.spacing(1)};
  `});class OM extends Yp{onActivate(e){e&&this.initVariables(e);const t=Rf.findByKeyAndType(this,"profileMetricId",gk);return t.setState({query:gk.QUERY_SERVICE_NAME_DEPENDENT}),t.update(!0),()=>{t.setState({query:gk.QUERY_DEFAULT}),t.update(!0)}}initVariables(e){const{serviceName:t,profileMetricId:n,filters:r}=e.queryRunnerParams;t&&Rf.findByKeyAndType(this,"serviceName",wk).changeValueTo(t),n&&Rf.findByKeyAndType(this,"profileMetricId",gk).changeValueTo(n),r&&Rf.findByKeyAndType(this,"filters",Nk).setState({filters:r})}getVariablesAndGridControls(){return{variables:[Rf.findByKeyAndType(this,"serviceName",wk),Rf.findByKeyAndType(this,"profileMetricId",gk),Rf.findByKeyAndType(this,"filters",Nk)],gridControls:[]}}static Component({model:e}){const t=(0,r.useStyles2)(TM),{mainTimeseries:n,body:i}=e.useState();return xi().createElement("div",{className:t.flex},xi().createElement("div",{className:t.mainTimeseries},xi().createElement(n.Component,{model:n})),xi().createElement(i.Component,{model:i}))}constructor({item:e}){super({key:"explore-service-flame-graph",mainTimeseries:new vA({item:e,headerActions:e=>[new lA({type:"view-labels",item:e}),new KP({item:e})]}),body:new xM}),this.addActivationHandler(this.onActivate.bind(this,e))}}const TM=e=>({flex:t.css`
    display: flex;
    flex-direction: column;
    width: 100%;
    gap: ${e.spacing(1)};
  `,mainTimeseries:t.css`
    height: ${vA.MIN_HEIGHT}px;
  `});function CM(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function kM(){return PM.apply(this,arguments)}function PM(){var t;return t=function*(){ru("g_pyroscope_app_share_link_clicked");try{yield navigator.clipboard.writeText(function(){const t=new URL(window.location.toString()),{searchParams:n}=t;return n.get("from")||n.set("from",iR().from),n.get("to")||n.set("to",iR().to),["from","to","from-2","to-2","from-3","to-3","diffFrom","diffTo","diffFrom-2","diffTo-2"].forEach((t=>{const r=n.get(t);r&&n.set(t,String(e.dateMath.parse(r).valueOf()))})),t}().toString()),Xo(["Link copied to clipboard!"])}catch(e){Ii.error(e,{info:"Error while creating the shareable link!"})}},PM=function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){CM(a,r,i,o,s,"next",e)}function s(e){CM(a,r,i,o,s,"throw",e)}o(void 0)}))},PM.apply(this,arguments)}function AM({options:e,value:n,onChange:i}){const a=(0,r.useStyles2)(RM),o=e.findIndex((e=>e.value===n));return xi().createElement("div",{className:a.explorationTypeContainer,"data-testid":"exploration-types"},xi().createElement("div",{className:a.label},"Exploration"),xi().createElement("div",{className:a.breadcrumb},e.map(((s,l)=>{const c=n===s.value,u=(d=l,o===e.length-1?d===o?"primary":"secondary":d<=o?"primary":"secondary");var d;const p=[c&&"active","primary"===u&&"primary"];return xi().createElement(Ei.Fragment,{key:s.value},xi().createElement(r.Button,{className:(0,t.cx)(a.button,...p),variant:u,size:"sm","aria-label":s.label,icon:s.icon,onClick:c?Fi:()=>i(s.value),tooltip:s.description,tooltipPlacement:"top","data-testid":c?"is-active":void 0},s.label),l<e.length-3&&xi().createElement("div",{className:o!==e.length-1&&l<=o-1?(0,t.cx)(a.arrow,"arrow",...p):a.arrow}))}))))}const RM=e=>({explorationTypeContainer:t.css`
    display: flex;
    align-items: center;
  `,label:t.css`
    display: flex;
    gap: 2px;
    align-items: center;
    font-size: 14px;
    margin-right: ${e.spacing(1)};

    ${e.breakpoints.down("xxl")} {
      display: none;
    }
  `,breadcrumb:t.css`
    display: flex;
    align-items: center;
    height: 32px;
    line-height: 32px;

    .active {
      background-color: ${e.colors.primary.main};
    }

    .arrow.primary {
      background-color: ${e.colors.primary.main};
    }

    & button.primary:not(.active),
    & .arrow.primary:not(.active) {
      opacity: 0.7;
    }

    & button.primary:not(.active):hover {
      opacity: 1;
      background-color: ${e.colors.primary.main};
    }
  `,button:t.css`
    height: 27px;
    line-height: 27px;
    border-radius: 15px;

    &:hover {
      border-color: ${e.colors.primary.main};
    }

    &.active:hover {
      cursor: default;
      background-color: ${e.colors.primary.main};
    }

    &:nth-last-child(2) {
      margin-left: ${e.spacing(1)};
    }

    &:nth-last-child(1) {
      margin-left: ${e.spacing(2)};
    }
  `,arrow:t.css`
    background-color: ${e.colors.text.disabled};
    width: 10px;
    height: 2px;
  `});function DM(e){const i=(0,n.useChromeHeaderHeight)(),a=(0,r.useStyles2)(jM,null!=i?i:0),{data:o,actions:s}=function({explorationType:e,controls:t,body:n,$variables:r,onChangeExplorationType:i}){const[a,o]=e===NM.DIFF_FLAME_GRAPH?[]:t,s=r.state.variables[0],l=null==n?void 0:n.state.primary;if("function"!=typeof l.getVariablesAndGridControls)throw new Error(`Error while rendering "${l.constructor.name}": the "getVariablesAndGridControls" method is missing! Please implement it.`);const{variables:c,gridControls:u}=l.getVariablesAndGridControls(),d=s.useState().value,p=(0,Ho.useHistory)();return{data:{explorationType:e,dataSourceVariable:s,timePickerControl:a,refreshPickerControl:o,sceneVariables:c,gridControls:u,body:n,dataSourceUid:d},actions:{onChangeExplorationType:i,onClickShareLink:kM,onClickUserSettings:(0,Ei.useCallback)((()=>{ru("g_pyroscope_app_user_settings_clicked"),p.push(`${fi}${mi.SETTINGS}`,{referrer:window.location.href})}),[p])}}}(e),{explorationType:l,dataSourceVariable:c,timePickerControl:u,refreshPickerControl:d,sceneVariables:p,gridControls:h}=o;return xi().createElement("div",{className:a.header,"data-testid":"allControls"},xi().createElement(kN,null),xi().createElement("div",{className:a.appControls,"data-testid":"appControls"},xi().createElement("div",{className:a.appControlsLeft},xi().createElement(AM,{options:LM.EXPLORATION_TYPE_OPTIONS,value:l,onChange:s.onChangeExplorationType})),xi().createElement("div",{className:a.appControlsRight},u&&xi().createElement(u.Component,{key:u.state.key,model:u}),d&&xi().createElement(d.Component,{key:d.state.key,model:d}),xi().createElement("div",{className:a.appMiscButtons},xi().createElement(r.IconButton,{name:"cog",tooltip:"View/edit user settings",onClick:s.onClickUserSettings}),xi().createElement(r.IconButton,{name:"share-alt",tooltip:"Copy shareable link to the clipboard",onClick:s.onClickShareLink}),xi().createElement(So,null)))),xi().createElement("div",{id:`scene-controls-${l}`,className:a.sceneControls,"data-testid":"sceneControls"},xi().createElement(r.Field,{label:c.state.label,className:(0,t.cx)(a.sceneVariable,c.state.name),"data-testid":c.state.name},xi().createElement(c.Component,{model:c})),p.map((e=>xi().createElement(r.Field,{key:e.state.name,label:"Filters"===e.state.label?xi().createElement("div",{className:a.sceneVariableLabel},xi().createElement(r.Icon,{name:"filter",className:a.icon}),e.state.label):e.state.label,className:(0,t.cx)(a.sceneVariable,e.state.name),"data-testid":e.state.name},xi().createElement(e.Component,{model:e})))),h.map((e=>xi().createElement(r.Field,{key:e.state.key,id:e.state.key,className:a.gridControl,label:""},xi().createElement(e.Component,{model:e}))))))}const jM=(e,n)=>({header:t.css`
    background-color: ${e.colors.background.canvas};
    position: sticky;
    top: ${n}px;
    z-index: 1;
    padding-bottom: ${e.spacing(2)};
  `,appControls:t.css`
    display: flex;
    padding: ${e.spacing(1)} 0;
    justify-content: space-between;
    gap: ${e.spacing(2)};
  `,appControlsLeft:t.css`
    display: flex;
    gap: ${e.spacing(1)};
  `,appControlsRight:t.css`
    display: flex;
    gap: ${e.spacing(1)};
  `,appMiscButtons:t.css`
    display: flex;
    align-items: center;
    gap: 4px;
    border: 1px solid ${e.colors.border.weak};
    background-color: ${e.colors.background.secondary};
    height: 32px;
    padding: 0 ${e.spacing(1)};

    & svg {
      width: 18px;
      height: 18px;
    }
  `,sceneControls:t.css`
    display: flex;
    flex-wrap: wrap;
    gap: ${e.spacing(1)};
    padding: 0;
    margin-top: 20px;
  `,sceneVariable:t.css`
    display: flex;
    margin-bottom: 0;

    & #dataSource {
      width: ${e.spacing(32)};
    }

    &.filters {
      flex-grow: 1;
    }

    &.compare-presets {
      margin-left: auto;
      text-align: right;
    }
  `,sceneVariableLabel:t.css`
    font-size: 12px;
    font-weight: 500;
    line-height: 15px;
    height: 15px;
    margin-bottom: 4px;
    color: ${e.colors.text.primary};
    max-width: 480px;
  `,icon:t.css`
    display: inline-block;
    margin-right: 4px;
  `,gridControl:t.css`
    margin-bottom: 0;

    &#quick-filter {
      flex: 1;
      min-width: 112px;
    }
  `});function IM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var NM;!function(e){e.ALL_SERVICES="all",e.PROFILE_TYPES="profiles",e.LABELS="labels",e.FLAME_GRAPH="flame-graph",e.DIFF_FLAME_GRAPH="diff-flame-graph",e.FAVORITES="favorites"}(NM||(NM={}));class LM extends Yp{onActivate(){const e=this.subscribeToEvents();return this.state.explorationType||this.setExplorationType({type:LM.DEFAULT_EXPLORATION_TYPE}),()=>{e.unsubscribe()}}getUrlState(){return{explorationType:this.state.explorationType}}updateFromUrl(e){if("string"==typeof e.explorationType&&e.explorationType!==this.state.explorationType){const t=e.explorationType;this.setExplorationType({type:Object.values(NM).includes(t)?t:LM.DEFAULT_EXPLORATION_TYPE})}}registerRuntimeDataSources(){try{c_({dataSource:new gR}),c_({dataSource:new GP}),c_({dataSource:new Xk})}catch(e){const{message:t}=e;/A runtime data source with uid (.+) has already been registered/.test(t)||Ko(e,["Fail to register all the runtime data sources!","The application cannot work as expected, please try reloading the page or if the problem persists, contact your organization admin."])}}subscribeToEvents(){const e=this.subscribeToEvent(iA,(e=>{this.setExplorationType({type:"profiles",comesFromUserAction:!0,item:e.payload.item})})),t=this.subscribeToEvent(rA,(e=>{this.setExplorationType({type:"labels",comesFromUserAction:!0,item:e.payload.item})})),n=this.subscribeToEvent(nA,(e=>{this.setExplorationType({type:"flame-graph",comesFromUserAction:!0,item:e.payload.item})})),r=this.subscribeToEvent(wA,(()=>{this.setExplorationType({type:"diff-flame-graph",comesFromUserAction:!0})}));return{unsubscribe(){r.unsubscribe(),n.unsubscribe(),t.unsubscribe(),e.unsubscribe()}}}setExplorationType({type:e,comesFromUserAction:t,item:n}){t&&(u_(),this.resetVariables(e)),this.setState({explorationType:e,body:this.buildBodyScene(e,n,t)})}resetVariables(e){if(Rf.findByKeyAndType(this,"quick-filter",$P).reset(),Rf.findByKeyAndType(this,"groupBy",TA).changeValueTo(TA.DEFAULT_VALUE),Rf.findByKeyAndType(this,"panel-type-switcher",$k).reset(),["labels","flame-graph","diff-flame-graph"].includes(e)||Rf.findByKeyAndType(this,"filters",Nk).setState({filters:Nk.DEFAULT_VALUE}),"diff-flame-graph"===e){const[e,t,n]=["filters","filtersBaseline","filtersComparison"].map((e=>Rf.findByKey(this,e))),r=e.state.filters;r.length&&(t.setState({filters:r}),n.setState({filters:r}))}if("diff-flame-graph"!==e&&"diff-flame-graph"===this.state.explorationType){["filtersBaseline","filtersComparison"].forEach((e=>{Rf.findByKeyAndType(this,e,Nk).setState({filters:Nk.DEFAULT_VALUE})}));const{from:e,to:t,value:n}=this.state.$timeRange.state;["baseline-panel-timerange","comparison-panel-timerange"].forEach((r=>{Rf.findByKeyAndType(this,r,Fh).setState({from:e,to:t,value:n})})),["baseline-annotation-timerange","comparison-annotation-timerange"].forEach((e=>{Rf.findByKeyAndType(this,e,OR).nullifyAnnotationTimeRange()}))}}buildBodyScene(e,t,n){let r;switch(e){case"profiles":r=new nR({item:t});break;case"labels":r=new tR({item:t});break;case"flame-graph":r=new OM({item:t});break;case"diff-flame-graph":r=new jN({useAncestorTimeRange:Boolean(n)});break;case"favorites":r=new yA;break;default:r=new uA}return new ix({direction:"column",primary:r})}static Component({model:e}){const t=(0,r.useStyles2)(MM),{data:n,actions:i}=e.useProfilesExplorer(),{explorationType:a,controls:o,body:s,$variables:l,dataSourceUid:c}=n;return xi().createElement(cL,{dataSourceUid:c},xi().createElement(DM,{explorationType:a,controls:o,body:s,$variables:l,onChangeExplorationType:i.onChangeExplorationType}),xi().createElement("div",{className:t.body,"data-testid":"sceneBody"},s&&xi().createElement(s.Component,{model:s})))}constructor(){super({key:"profiles-explorer",explorationType:void 0,body:void 0,$timeRange:new Fh(iR()),$variables:new Mv({variables:[new xk,new wk,new gk,new Nk({key:"filters"}),new Nk({key:"filtersBaseline"}),new Nk({key:"filtersComparison"}),new TA]}),controls:[new oE({isOnCanvas:!0}),new yE({isOnCanvas:!0})],gridControls:[new $P({placeholder:""}),new $k,new NP,new MP]}),IM(this,"_urlSync",new Ph(this,{keys:["explorationType"]})),IM(this,"onChangeExplorationType",(e=>{ru("g_pyroscope_app_exploration_type_clicked",{explorationType:e}),this.setExplorationType({type:e,comesFromUserAction:!0})})),IM(this,"useProfilesExplorer",(()=>{const{explorationType:e,controls:t,body:n,$variables:r}=this.useState();return{data:{explorationType:e,controls:t,body:n,$variables:r,dataSourceUid:r.state.variables[0].useState().value},actions:{onChangeExplorationType:this.onChangeExplorationType}}})),Uw().initSync(this),this.registerRuntimeDataSources(),this.addActivationHandler(this.onActivate.bind(this))}}IM(LM,"EXPLORATION_TYPE_OPTIONS",[{value:"all",label:"All services",description:"Overview of all services, for any given profile type"},{value:"profiles",label:"Profile types",description:"Overview of all the profile types for a single service"},{value:"labels",label:"Labels",description:"Single service label exploration and filtering"},{value:"flame-graph",label:"Flame graph",description:"Single service flame graph"},{value:"diff-flame-graph",label:"Diff flame graph",description:"Compare the differences between two flame graphs"},{value:"favorites",label:"Favorites",description:"Overview of favorited visualizations",icon:"favorite"}]),IM(LM,"DEFAULT_EXPLORATION_TYPE",LM.EXPLORATION_TYPE_OPTIONS[0].value);const MM=()=>({body:t.css`
    position: relative;
    z-index: 0;
    background: transparent;
  `});function FM(){const e=(0,Ei.useMemo)((()=>new LM),[]);return xi().createElement(e.Component,{model:e})}function $M(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function BM(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function VM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){BM(e,t,n[t])}))}return e}function zM(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function UM(){const e=(0,r.useStyles2)(qM),{data:t,actions:n}=function(){var e;const{settings:t,error:n,mutate:r}=WR(),[i,a]=yN(),[o,s]=(0,Ei.useState)(null!=t?t:zR),l=(0,Ho.useHistory)(),c=(0,Ei.useRef)(null===(e=l.location.state)||void 0===e?void 0:e.referrer);return(0,Ei.useEffect)((()=>{t&&s(t)}),[t]),{data:zM(VM({},o),{fetchError:n}),actions:{toggleCollapsedFlamegraphs(){s((e=>zM(VM({},e),{collapsedFlamegraphs:!e.collapsedFlamegraphs})))},updateMaxNodes(e){s((t=>zM(VM({},t),{maxNodes:Number(e.target.value)})))},toggleEnableFlameGraphDotComExport(){s((e=>zM(VM({},e),{enableFlameGraphDotComExport:!e.enableFlameGraphDotComExport})))},toggleEnableFunctionDetails(){s((e=>zM(VM({},e),{enableFunctionDetails:!e.enableFunctionDetails})))},saveSettings(){return(e=function*(){a(o.maxNodes);try{yield r(o),Xo(["Plugin settings successfully saved!"])}catch(e){Ko(e,["Error while saving the plugin settings!","Please try again later, sorry for the inconvenience."])}},function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){$M(a,r,i,o,s,"next",e)}function s(e){$M(a,r,i,o,s,"throw",e)}o(void 0)}))})();var e},goBack(){if(!c.current)return void l.push(`${fi}${mi.PROFILES_EXPLORER_VIEW}`);const e=new URL(c.current);i&&e.searchParams.set("maxNodes",String(i)),l.push(`${e.pathname}${e.search}`)}}}}();return t.fetchError&&Ko(t.fetchError,["Error while retrieving the plugin settings!","Please try to reload the page, sorry for the inconvenience."]),xi().createElement(xi().Fragment,null,xi().createElement(ko,{title:"Profiles settings"}),xi().createElement(r.Form,{className:e.settingsForm,onSubmit:n.saveSettings},(()=>xi().createElement(xi().Fragment,null,xi().createElement(r.FieldSet,{label:"Flame graph","data-testid":"flamegraph-settings"},xi().createElement(r.InlineFieldRow,null,xi().createElement(r.InlineField,{label:"Collapsed flame graphs",labelWidth:24},xi().createElement(r.InlineSwitch,{label:"Toggle collapsed flame graphs",name:"collapsed-flamegraphs",value:t.collapsedFlamegraphs,onChange:n.toggleCollapsedFlamegraphs}))),xi().createElement(r.InlineFieldRow,null,xi().createElement(r.InlineField,{label:"Maximum number of nodes",tooltip:"",labelWidth:24},xi().createElement(r.Input,{name:"max-nodes",type:"number",min:"1",value:t.maxNodes,onChange:n.updateMaxNodes})))),xi().createElement(r.FieldSet,{label:"Function details","data-testid":"function-details-settings"},xi().createElement(r.InlineFieldRow,null,xi().createElement(r.InlineField,{label:"Enable function details",labelWidth:24,tooltip:xi().createElement("div",{className:e.tooltip},xi().createElement("p",null,"The function details feature enables mapping of resource usage to lines of source code. If the GitHub integration is configured, then the source code will be downloaded from GitHub."),xi().createElement("p",null,xi().createElement("a",{href:"https://grafana.com/docs/grafana-cloud/monitor-applications/profiles/pyroscope-github-integration/",target:"_blank",rel:"noreferrer noopener"},"Learn more"))),interactive:!0},xi().createElement(r.InlineSwitch,{label:"Toggle function details",name:"function-details-feature",value:t.enableFunctionDetails,onChange:n.toggleEnableFunctionDetails})))),xi().createElement("div",{className:e.buttons},xi().createElement(r.Button,{variant:"primary",type:"submit"},"Save settings"),xi().createElement(r.Button,{variant:"secondary",onClick:n.goBack,"aria-label":"Back to Explore Profiles"},"Back to Explore Profiles"))))))}const qM=e=>({settingsForm:t.css`
    & > fieldset {
      border: 0 none;
      border-bottom: 1px solid ${e.colors.border.weak};
      padding-left: 0;
    }

    & > fieldset > legend {
      font-size: ${e.typography.h4.fontSize};
    }
  `,buttons:t.css`
    display: flex;
    gap: ${e.spacing(1)};
  `,tooltip:t.css`
    p {
      margin: ${e.spacing(1)};
    }

    a {
      color: ${e.colors.text.link};
    }

    em {
      font-style: normal;
      font-weight: ${e.typography.fontWeightBold};
    }
  `}),HM=pi.mK.map((({path:e})=>e.replace("%PLUGIN_ID%",pi.id)));function GM(){return function(){const e=(0,Ho.useHistory)();(0,Ei.useEffect)((()=>{const t=(e=>t=>{const n=t.target.closest('[aria-label="Navigation"] a');if(!n)return;const r=n.getAttribute("href");r&&HM.includes(r)&&(e.replace({pathname:r,search:new URLSearchParams(window.location.search).toString()}),t.preventDefault())})(e);return document.body.addEventListener("click",t,!0),()=>{document.body.removeEventListener("click",t,!0)}}),[e])}(),xi().createElement(Ho.Switch,null,xi().createElement(Ho.Route,{path:qo(mi.PROFILES_EXPLORER_VIEW),exact:!0},xi().createElement(FM,null)),xi().createElement(Ho.Route,{path:qo(mi.ADHOC_VIEW),exact:!0},xi().createElement(hp,null)),xi().createElement(Ho.Route,{path:qo(mi.SETTINGS),exact:!0},xi().createElement(UM,null)),xi().createElement(Ho.Route,null,xi().createElement(Ho.Redirect,{to:qo(mi.PROFILES_EXPLORER_VIEW)})))}function WM({error:t}){return xi().createElement(n.PluginPage,{layout:e.PageLayoutType.Canvas},xi().createElement("div",{className:"pyroscope-app"},xi().createElement(ko,{title:"Explore Profiles"}),xi().createElement(QR,{severity:"error",title:"Fatal error!",message:"Please try reloading the page or, if the problem persists, contact your organization admin. Sorry for the inconvenience.",error:t,errorContext:{handheldBy:"React error boundary"}})))}!function(){if(Si())return;const e=function(){const e=bi();if(e&&vi.has(e))return vi.get(e)}();if(!e)return;const{environment:t,faroUrl:r,appName:i}=e,{apps:a,bootData:o,buildInfo:s}=n.config,l=a[hi].version,c=o.user.email,u=`v${s.version} (${s.edition})`;var d;d=function(e){const t=function(e){var t,n,r,i,a,o,s,l,c;const u=[],d=xe(e.unpatchedConsole,e.internalLoggerLevel);return e.transports?((e.url||e.apiKey)&&d.error('if "transports" is defined, "url" and "apiKey" should not be defined'),u.push(...e.transports)):e.url?u.push(new jt({url:e.url,apiKey:e.apiKey})):d.error('either "url" or "transports" must be defined'),{app:e.app,batching:Object.assign(Object.assign({},Le),e.batching),dedupe:null===(t=e.dedupe)||void 0===t||t,globalObjectKey:e.globalObjectKey||"faro",instrumentations:null!==(n=e.instrumentations)&&void 0!==n?n:di(),internalLoggerLevel:null!==(r=e.internalLoggerLevel)&&void 0!==r?r:Se,isolate:null!==(i=e.isolate)&&void 0!==i&&i,logArgsSerializer:null!==(a=e.logArgsSerializer)&&void 0!==a?a:ye,metas:function(){const t=lt;return e.metas&&t.push(...e.metas),te(window.k6)?[...t,ct]:t}(),parseStacktrace:tt,paused:null!==(o=e.paused)&&void 0!==o&&o,preventGlobalExposure:null!==(s=e.preventGlobalExposure)&&void 0!==s&&s,transports:u,unpatchedConsole:null!==(l=e.unpatchedConsole)&&void 0!==l?l:Ee,beforeSend:e.beforeSend,eventDomain:null!==(c=e.eventDomain)&&void 0!==c?c:"browser",ignoreErrors:e.ignoreErrors,ignoreUrls:e.ignoreUrls,sessionTracking:Object.assign(Object.assign({},at),e.sessionTracking),user:e.user,view:e.view,trackResources:e.trackResources,trackWebVitalsAttribution:e.trackWebVitalsAttribution}}(e);if(t)return Ne(t)}({url:r,app:{name:i,release:l,version:gi,environment:t,namespace:u},user:{email:c},instrumentations:[...di({captureConsole:!1})],isolate:!0,beforeSend:e=>{var t,n,r;return(null!==(n=null===(t=e.meta.page)||void 0===t?void 0:t.url)&&void 0!==n?n:"").includes(hi)?(e.meta.view={name:new URLSearchParams(null===(r=e.meta.page)||void 0===r?void 0:r.url).get("explorationType")||""},e):null}}),wi=d}();const QM=e=>({pageContainer:t.css`
    display: flex;
    flex-direction: column;
    padding: ${e.spacing(1)} ${e.spacing(2)} ${e.spacing(2)} ${e.spacing(2)};
    flex-basis: 100%;
    flex-grow: 1;
  `}),KM=(new e.AppPlugin).setRootPage((function(){const t=(0,r.useStyles2)(QM),[i,a]=(0,Ei.useState)();return i?xi().createElement(WM,{error:i}):xi().createElement(r.ErrorBoundary,{onError:a},(()=>xi().createElement(Ci,{client:U},xi().createElement(Uo,null,xi().createElement("div",{className:t.pageContainer},xi().createElement(n.PluginPage,{layout:e.PageLayoutType.Custom},xi().createElement("div",{className:"pyroscope-app"},xi().createElement(GM,null))))))))}))})(),__webpack_exports__})()));
//# sourceMappingURL=module.js.map